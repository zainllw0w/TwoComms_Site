# Руководство по управлению оффлайн магазинами

## Обзор функционала

Создан полнофункциональный интерфейс для управления оффлайн магазинами в admin-panel с возможностью:

- **Drag-and-drop** переноса товаров между блоками
- **Формирования заказов** с указанием размеров, цветов и цен
- **Экспорта накладных** в Excel формате
- **Управления товарами** в магазинах с полной статистикой

## Структура интерфейса

### 1. Все товары (левая колонка)
- Отображение всех товаров сайта в красивых карточках
- Фильтрация по категориям
- Drag-and-drop функциональность для переноса товаров

### 2. Формирование заказа (средняя колонка)
- Зона для перетаскивания товаров
- Форма для указания:
  - Размера (XS-XXL)
  - Цвета (если доступен)
  - Себестоимости
  - Цены продажи
  - Количества
- Кнопки действий:
  - "Добавить в магазин"
  - "Сформировать накладную"

### 3. Товары в магазине (правая колонка)
- Список всех товаров в магазине
- Возможность редактирования цен и количества
- Полная статистика по категориям
- Удаление товаров

## Технические детали

### Модели данных
- `StoreProduct` - товары в магазине
- `StoreOrder` - заказы/накладные
- `StoreOrderItem` - товары в заказе
- `StoreInvoice` - сгенерированные накладные

### API endpoints
- `GET /admin-panel/offline-store/{id}/manage/` - главная страница управления
- `POST /admin-panel/offline-store/{id}/add-to-order/` - добавление товара в заказ
- `POST /admin-panel/offline-store/{id}/add-to-store/` - добавление товаров в магазин
- `POST /admin-panel/offline-store/{id}/generate-invoice/` - генерация Excel накладной
- `POST /admin-panel/offline-store/{id}/product/{id}/update/` - обновление товара
- `POST /admin-panel/offline-store/{id}/product/{id}/remove/` - удаление товара

### Excel накладная
Формат накладной:
```
Накладна для магазину: [Название магазина]
Дата: [Дата создания]

Товар                                    Ціна продажу (грн)
Футболка Покровск (S) [Белая]           1500
Футболка Покровск (M) [Черная]          1500
Худи Киев (L) [Синее]                   2000

Підсумки по категоріях:
Футболки: 2 шт., сума 3000 грн
Худи: 1 шт., сума 2000 грн

ВСЬОГО: 5000 грн
```

## Использование

1. **Переход в управление магазином:**
   - Откройте admin-panel (`/admin-panel/`)
   - Перейдите в раздел "Оффлайн магазины"
   - Нажмите кнопку "Управление" у нужного магазина

2. **Добавление товаров в заказ:**
   - Перетащите товар из левой колонки в среднюю
   - Или кликните на товар для выбора
   - Заполните форму (размер, цвет, цены, количество)
   - Нажмите "Добавить в заказ"

3. **Добавление товаров в магазин:**
   - После формирования заказа нажмите "Добавить в магазин"
   - Товары будут перенесены в правую колонку

4. **Генерация накладной:**
   - Нажмите "Сформировать накладную"
   - Excel файл автоматически скачается

5. **Управление товарами в магазине:**
   - Редактируйте цены и количество через кнопку "✏️"
   - Удаляйте товары кнопкой "×"
   - Просматривайте статистику по категориям

## Статистика

Интерфейс показывает:
- Общее количество товаров в магазине
- Сумму себестоимости
- Сумму продажной цены
- Общую маржу
- Статистику по категориям

## Особенности

- **Responsive дизайн** - адаптируется под разные экраны
- **Drag-and-drop** - интуитивный интерфейс
- **Real-time обновления** - статистика обновляется автоматически
- **Уведомления** - информативные сообщения о действиях
- **Валидация** - проверка корректности данных

## Безопасность

- Все операции доступны только для staff пользователей
- CSRF защита для всех POST запросов
- Валидация данных на сервере
- Безопасная работа с файлами

## Расширение функционала

Код структурирован для легкого расширения:
- Модульная архитектура views
- Переиспользуемые компоненты
- Четкое разделение логики
- Документированные API endpoints

