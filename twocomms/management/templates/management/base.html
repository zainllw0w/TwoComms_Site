{% load static %}
<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TwoComms Management</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Orbitron:wght@500&display=swap"
        rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/management.css' %}">

    <style>
        /* Semicircle SVG Styles */
        .gauge-container {
            width: 180px;
            height: 90px;
            /* Half height */
            position: relative;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .gauge-body {
            width: 180px;
            height: 180px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 50%;
            position: absolute;
            top: 0;
            box-sizing: border-box;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .gauge-fill {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            position: absolute;
            top: 0;
            box-sizing: border-box;
            border: 2px solid var(--accent-color);
            border-bottom: none;
            border-right: none;
            border-left: none;
            /* Just simple representation for now or use clip-path */
            /* Better approach: SVG */
        }
    </style>
</head>

<body>

    <!-- Top Header -->
    <header class="top-header">
        <div class="brand-title">TwoComms <span>Management</span></div>
        <nav class="nav-links">
            <a href="#" class="nav-item active">–ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</a>
            <a href="#" class="nav-item">–û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å</a>
            <a href="#" class="nav-item">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
            <a href="#" class="nav-item">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
            <div class="app-container">
                <!-- New Sidebar -->
                <aside class="sidebar">
                    <div class="brand-section">
                        <div class="brand-logo-circle"></div>
                        <div class="brand-title">TwoComms</div>
                    </div>

                    <!-- Main Menu -->
                    <nav class="sidebar-menu">
                        <div class="menu-category">–û—Å–Ω–æ–≤–Ω–æ–µ</div>
                        <button class="sidebar-btn active" data-tab="home" onclick="switchTab('home')">
                            <span>üè†</span> –ì–æ–ª–æ–≤–Ω–∞
                        </button>
                        <button class="sidebar-btn" data-tab="stats" onclick="switchTab('stats')">
                            <span>üìä</span> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                        </button>
                        <button class="sidebar-btn" data-tab="reports" onclick="switchTab('reports')">
                            <span>üìë</span> –û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å
                        </button>

                        <div class="menu-category">–î–µ–π—Å—Ç–≤–∏—è</div>
                        <button class="sidebar-btn" onclick="alert('Feature coming soon')">
                            <span>üìÑ</span> –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–∫–ª–∞–¥–Ω—É—é
                        </button>
                        <button class="sidebar-btn" onclick="alert('Feature coming soon')">
                            <span>‚úâÔ∏è</span> –û—Ç–ø—Ä–∞–≤–∫–∞ –ö–ü
                        </button>

                        <div class="menu-category">–°–∏—Å—Ç–µ–º–∞</div>
                        <button class="sidebar-btn" data-tab="settings" onclick="switchTab('settings')">
                            <span>‚öôÔ∏è</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                        </button>
                    </nav>

                    <!-- User Profile -->
                    <div class="user-profile">
                        <div class="avatar-circle">M</div>
                        <div class="user-info">
                            <span class="user-name">{{ user.username }}</span>
                            <span class="user-role">Manager</span> <!-- Placeholder -->
                        </div>
                    </div>
                </aside>

                <!-- Main Content Area -->
                <main class="main-content">
                    <!-- Top Bar -->
                    <header class="top-bar">
                        <div class="page-title" id="pageTitle">Management Dashboard</div>
                        <div class="top-actions">
                            <button class="btn btn-secondary">üîî</button>
                            <button class="btn btn-secondary">Log Out</button>
                        </div>
                    </header>

                    <!-- Scrollable Content -->
                    <div class="content-scroll">
                        {% block content %}{% endblock %}
                    </div>
                </main>
            </div>

            <!-- JavaScript for SPA Tabs -->
            <script>
                function switchTab(tabId) {

                    // Close modal on outside click
                    window.onclick = function (event) {
                        if (event.target.classList.contains('modal-overlay')) {
                            event.target.classList.remove('open');
                        }
                    }

                    // Form Handling
                    document.addEventListener('submit', function (e) {
                        if (e.target.classList.contains('ajax-form')) {
                            e.preventDefault();
                            const formData = new FormData(e.target);

                            fetch(e.target.action, {
                                method: 'POST',
                                body: formData,
                                headers: {
                                    'X-Requested-With': 'XMLHttpRequest'
                                }
                            })
                                .then(response => response.json())
                                .then(data => {
                                    if (data.status === 'success') {
                                        // Close modal and refresh table (or append row)
                                        closeModal('modal-add-client');
                                        // Ideally: Append row to table dynamically
                                        location.reload(); // Temporary for simplicity in first iteration
                                    } else {
                                        alert('–û—à–∏–±–∫–∞: ' + JSON.stringify(data.errors));
                                    }
                                });
                        }
                    });
            </script>
</body>

</html>