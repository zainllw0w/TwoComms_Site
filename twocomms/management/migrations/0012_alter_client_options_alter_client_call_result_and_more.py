# Generated by Django 5.2.6 on 2025-12-17 01:58

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('management', '0011_commercial_offer_email_v4'),
        ('orders', '0041_wholesaleinvoice_admin_tg_chat_id_and_more'),
        ('storefront', '0036_productimage_order'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AlterModelOptions(
            name='client',
            options={'ordering': ['-created_at'], 'verbose_name': 'Клієнт', 'verbose_name_plural': 'Клієнти'},
        ),
        migrations.AlterField(
            model_name='client',
            name='call_result',
            field=models.CharField(choices=[('order', 'Оформив замовлення'), ('sent_email', 'Відправили КП на e-mail'), ('sent_messenger', 'Відправили КП у месенджери'), ('wrote_ig', 'Написали в Instagram'), ('no_answer', 'Не відповідає'), ('not_interested', 'Не цікавить'), ('invalid_number', 'Номер недоступний'), ('xml_connected', 'Підключив XML'), ('thinking', 'Подумає'), ('expensive', 'Дорого'), ('waiting_payment', 'Очікується оплата'), ('waiting_prepayment', 'Очікується передоплата'), ('test_batch', 'Замовив тестову партію'), ('other', 'Інше')], default='no_answer', max_length=50, verbose_name='Підсумок розмови'),
        ),
        migrations.AlterField(
            model_name='client',
            name='call_result_details',
            field=models.TextField(blank=True, help_text="Якщо вибрано 'Інше'", verbose_name='Деталі підсумку'),
        ),
        migrations.AlterField(
            model_name='client',
            name='next_call_at',
            field=models.DateTimeField(blank=True, null=True, verbose_name='Наступний дзвінок'),
        ),
        migrations.AlterField(
            model_name='client',
            name='phone',
            field=models.CharField(max_length=50, verbose_name='Номер телефону'),
        ),
        migrations.AlterField(
            model_name='client',
            name='role',
            field=models.CharField(choices=[('supervisor', 'Управляючий'), ('manager', 'Менеджер'), ('realizer', 'Реалізатор'), ('owner', 'Власник'), ('other', 'Інше')], default='manager', max_length=50, verbose_name='Статус'),
        ),
        migrations.AlterField(
            model_name='client',
            name='shop_name',
            field=models.CharField(max_length=255, verbose_name='Назва магазину / Instagram'),
        ),
        migrations.AlterField(
            model_name='client',
            name='source',
            field=models.CharField(blank=True, max_length=255, verbose_name='Джерело контакту'),
        ),
        migrations.AlterField(
            model_name='commercialofferemaillog',
            name='cta_type',
            field=models.CharField(blank=True, choices=[('TELEGRAM_MANAGER', 'Telegram менеджера'), ('WHATSAPP_MANAGER', 'WhatsApp менеджера'), ('TELEGRAM_GENERAL', 'Telegram загальний'), ('MAILTO_COOPERATION', 'Email cooperation@'), ('REPLY_HINT_ONLY', 'Відповідь на лист (без лінка)'), ('CUSTOM_URL', 'Custom URL')], max_length=32, verbose_name='CTA тип'),
        ),
        migrations.AlterField(
            model_name='commercialofferemailsettings',
            name='cta_type',
            field=models.CharField(blank=True, choices=[('TELEGRAM_MANAGER', 'Telegram менеджера'), ('WHATSAPP_MANAGER', 'WhatsApp менеджера'), ('TELEGRAM_GENERAL', 'Telegram загальний'), ('MAILTO_COOPERATION', 'Email cooperation@'), ('REPLY_HINT_ONLY', 'Відповідь на лист (без лінка)'), ('CUSTOM_URL', 'Custom URL')], max_length=32, verbose_name='CTA тип'),
        ),
        migrations.CreateModel(
            name='Shop',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255, verbose_name='Назва магазину')),
                ('photo', models.ImageField(blank=True, null=True, upload_to='shops/photos/', verbose_name='Фото магазину')),
                ('owner_full_name', models.CharField(blank=True, max_length=255, verbose_name='ПІБ власника')),
                ('shop_type', models.CharField(choices=[('full', 'Опт / повний магазин'), ('test', 'Тестова партія')], default='full', max_length=10, verbose_name='Тип магазину')),
                ('registration_place', models.CharField(blank=True, max_length=255, verbose_name='Місце реєстрації')),
                ('is_physical', models.BooleanField(default=False, verbose_name='Фізичний магазин')),
                ('city', models.CharField(blank=True, max_length=120, verbose_name='Місто')),
                ('address', models.TextField(blank=True, verbose_name='Адреса')),
                ('website_url', models.URLField(blank=True, verbose_name='Сайт')),
                ('instagram_url', models.URLField(blank=True, verbose_name='Instagram / Instashop')),
                ('prom_url', models.URLField(blank=True, verbose_name='Prom.ua')),
                ('other_sales_channel', models.CharField(blank=True, max_length=500, verbose_name='Інше (де ще продають)')),
                ('test_package', models.JSONField(blank=True, default=dict, verbose_name='Тестова партія: комплектація')),
                ('test_connected_at', models.DateField(blank=True, null=True, verbose_name='Дата підключення (старт 14 днів)')),
                ('test_period_days', models.PositiveIntegerField(default=14, verbose_name='Тривалість тесту (днів)')),
                ('next_contact_at', models.DateTimeField(blank=True, null=True, verbose_name='Наступний контакт')),
                ('notes', models.TextField(blank=True, verbose_name='Нотатки')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='management_shops_created', to=settings.AUTH_USER_MODEL, verbose_name='Додав (менеджер)')),
                ('managed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='management_shops_managed', to=settings.AUTH_USER_MODEL, verbose_name='Веде (менеджер)')),
                ('test_product', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='management_test_shops', to='storefront.product', verbose_name='Тестова партія: товар')),
            ],
            options={
                'verbose_name': 'Магазин',
                'verbose_name_plural': 'Магазини',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ShopCommunication',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('contacted_at', models.DateTimeField(verbose_name='Коли звʼязувались')),
                ('contact_person', models.CharField(blank=True, max_length=255, verbose_name='З ким')),
                ('phone', models.CharField(blank=True, max_length=50, verbose_name='Номер')),
                ('note', models.TextField(blank=True, verbose_name='Нотатка')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='management_shop_comms_created', to=settings.AUTH_USER_MODEL, verbose_name='Створив')),
                ('shop', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='communications', to='management.shop', verbose_name='Магазин')),
            ],
            options={
                'verbose_name': 'Комунікація (магазин)',
                'verbose_name_plural': 'Комунікації (магазин)',
                'ordering': ['-contacted_at', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ShopPhone',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('role', models.CharField(choices=[('owner', 'Власник'), ('manager', 'Менеджер'), ('admin', 'Адміністратор'), ('other', 'Інший')], default='owner', max_length=20, verbose_name='Роль')),
                ('role_other', models.CharField(blank=True, max_length=120, verbose_name='Хто це (якщо інший)')),
                ('phone', models.CharField(max_length=50, verbose_name='Телефон')),
                ('is_primary', models.BooleanField(default=False, verbose_name='Основний')),
                ('sort_order', models.PositiveIntegerField(default=0, verbose_name='Порядок')),
                ('shop', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='phones', to='management.shop', verbose_name='Магазин')),
            ],
            options={
                'verbose_name': 'Контакт магазину',
                'verbose_name_plural': 'Контакти магазину',
                'ordering': ['sort_order', 'id'],
            },
        ),
        migrations.CreateModel(
            name='ShopShipment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('ttn_number', models.CharField(db_index=True, max_length=64, verbose_name='ТТН')),
                ('shipped_at', models.DateField(db_index=True, verbose_name='Дата відправки')),
                ('is_test_batch', models.BooleanField(db_index=True, default=False, verbose_name='Тестова партія')),
                ('uploaded_invoice_file', models.FileField(blank=True, null=True, upload_to='shops/invoices/', verbose_name='Накладна (Excel файл)')),
                ('invoice_summary', models.JSONField(blank=True, default=dict, verbose_name='Сводка накладной')),
                ('invoice_total_amount', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Сума накладної')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='management_shop_shipments_created', to=settings.AUTH_USER_MODEL, verbose_name='Створив')),
                ('shop', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='shipments', to='management.shop', verbose_name='Магазин')),
                ('wholesale_invoice', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='management_shop_shipments', to='orders.wholesaleinvoice', verbose_name='Накладна (система)')),
            ],
            options={
                'verbose_name': 'Відправка (ТТН)',
                'verbose_name_plural': 'Відправки (ТТН)',
                'ordering': ['-shipped_at', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ShopInventoryMovement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('kind', models.CharField(choices=[('receipt', 'Надходження'), ('sale', 'Продаж'), ('adjust', 'Коригування')], db_index=True, max_length=20, verbose_name='Тип')),
                ('product_name', models.CharField(max_length=255, verbose_name='Товар')),
                ('category', models.CharField(blank=True, max_length=120, verbose_name='Категорія')),
                ('size', models.CharField(blank=True, max_length=40, verbose_name='Розмір')),
                ('color', models.CharField(blank=True, max_length=80, verbose_name='Колір')),
                ('delta_qty', models.IntegerField(verbose_name='Зміна кількості (±)')),
                ('note', models.CharField(blank=True, max_length=255, verbose_name='Коментар')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='management_shop_inventory_moves_created', to=settings.AUTH_USER_MODEL, verbose_name='Створив')),
                ('shop', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='inventory_moves', to='management.shop', verbose_name='Магазин')),
                ('shipment', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='inventory_moves', to='management.shopshipment', verbose_name='ТТН')),
            ],
            options={
                'verbose_name': 'Рух товару (магазин)',
                'verbose_name_plural': 'Рух товару (магазин)',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddIndex(
            model_name='shop',
            index=models.Index(fields=['shop_type', '-created_at'], name='mgmt_shop_type_dt'),
        ),
        migrations.AddIndex(
            model_name='shop',
            index=models.Index(fields=['managed_by', '-created_at'], name='mgmt_shop_mgr_dt'),
        ),
        migrations.AddIndex(
            model_name='shopcommunication',
            index=models.Index(fields=['shop', '-contacted_at'], name='mgmt_shop_comm_dt'),
        ),
        migrations.AddIndex(
            model_name='shopphone',
            index=models.Index(fields=['shop', 'is_primary'], name='mgmt_shop_phone_primary'),
        ),
        migrations.AddIndex(
            model_name='shopshipment',
            index=models.Index(fields=['shop', '-shipped_at'], name='mgmt_ship_shop_dt'),
        ),
        migrations.AddIndex(
            model_name='shopinventorymovement',
            index=models.Index(fields=['shop', 'kind', '-created_at'], name='mgmt_inv_shop_kind'),
        ),
    ]
