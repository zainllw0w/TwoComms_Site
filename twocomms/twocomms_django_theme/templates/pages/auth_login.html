{% extends 'base.html' %}{% load static %}{% block title %}–í—Ö—ñ–¥ ‚Äî TwoComms{% endblock %}{% block content %}
<div class="row justify-content-center">
  <div class="col-12 col-md-7 col-lg-5">
    <div class="card glass p-3 p-md-4">
      <div class="d-flex align-items-center mb-3" style="gap:.75rem">
        <div class="rounded-3 d-inline-flex align-items-center justify-content-center" style="width:44px;height:44px;background:linear-gradient(135deg,var(--accent-color),#7c3aed);color:#fff">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor"><path d="M11 7L9.6 8.4l2.6 2.6H2v2h10.2l-2.6 2.6L11 17l5-5-5-5z"/></svg>
        </div>
        <div>
          <h1 class="h5 fw-bold mb-0">–í—Ö—ñ–¥ –¥–æ –∞–∫–∞—É–Ω—Ç—É</h1>
          <div class="text-secondary small">–®–≤–∏–¥–∫–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –∑–∞–º–æ–≤–ª–µ–Ω—å, –±–∞–ª—ñ–≤ —Ç–∞ –æ–±—Ä–∞–Ω–æ–≥–æ</div>
        </div>
      </div>

      <a href="{% url 'social:begin' 'google-oauth2' %}" class="btn btn-outline-light w-100 mb-3 d-flex align-items-center justify-content-center" style="gap:.5rem">
        <img src="{% static 'img/google.svg' %}" alt="Google" width="18" height="18" loading="lazy">
        <span>–£–≤—ñ–π—Ç–∏ —á–µ—Ä–µ–∑ Google</span>
      </a>
      <div class="text-secondary small mb-3">–ü—Ä–æ–¥–æ–≤–∂—É—é—á–∏, –≤–∏ –ø–æ–≥–æ–¥–∂—É—î—Ç–µ—Å—å –∑ —É–º–æ–≤–∞–º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è</div>

      {% if form.non_field_errors %}
      <div class="alert alert-danger" role="alert">
        <div class="d-flex" style="gap:.5rem;align-items:flex-start">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" class="flex-shrink-0"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
          <div>
            {% for e in form.non_field_errors %}<div>{{ e }}</div>{% endfor %}
          </div>
        </div>
      </div>
      {% endif %}

      <form method="post" novalidate class="vstack gap-3 position-relative">{% csrf_token %}
        {% if request.GET.next %}<input type="hidden" name="next" value="{{ request.GET.next }}">{% endif %}
        <div>
          <label for="id_username" class="form-label">–õ–æ–≥—ñ–Ω</label>
          {{ form.username }}
          <div class="form-text">–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Å–≤—ñ–π –Ω—ñ–∫–Ω–µ–π–º. –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è ‚Äî –∑–∞ —Ö–≤–∏–ª–∏–Ω—É.</div>
          {% if form.username.errors %}
            <div class="invalid-feedback d-block">
              {% for e in form.username.errors %}{{ e }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
            </div>
          {% endif %}
        </div>
        <div>
          <label for="id_password" class="form-label">–ü–∞—Ä–æ–ª—å</label>
          <div class="input-group">
            {{ form.password }}
            <button class="btn btn-outline-secondary" type="button" data-toggle-password aria-label="–ü–æ–∫–∞–∑–∞—Ç–∏ –ø–∞—Ä–æ–ª—å">üëÅ</button>
          </div>
          {% if form.password.errors %}
            <div class="invalid-feedback d-block">
              {% for e in form.password.errors %}{{ e }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
            </div>
          {% endif %}
        </div>
        <button class="btn btn-cta d-inline-flex align-items-center" type="submit" data-submit-btn style="gap:.5rem">
          <span class="spinner-border spinner-border-sm me-1 d-none" role="status" aria-hidden="true"></span>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M11 7L9.6 8.4l2.6 2.6H2v2h10.2l-2.6 2.6L11 17l5-5-5-5z"/></svg>
          <span>–£–≤—ñ–π—Ç–∏</span>
        </button>
      </form>

      <div class="text-secondary small mt-3">–ù–µ–º–∞—î –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É? <a href="{% url 'register' %}">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—å</a></div>
    </div>
  </div>
</div>

{% block extra_js %}{% endblock %}
<script>
(function(){
  document.addEventListener('DOMContentLoaded', function(){
    try{
      var form = document.querySelector('form.vstack');
      var btn = form && form.querySelector('[data-submit-btn]');
      if(form){
        // –¢—Ä–µ–∫–∏–Ω–≥
        form.addEventListener('submit', function(){
          try{ if(window.trackEvent){ window.trackEvent('Lead', {lead_type:'login'}); } }catch(_){ }
          if(btn){ var sp=btn.querySelector('.spinner-border'); if(sp){ sp.classList.remove('d-none'); } btn.setAttribute('disabled','disabled'); }
        });
      }
      // –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è
      var toggle = document.querySelector('[data-toggle-password]');
      var pwd = document.getElementById('id_password');
      if(toggle && pwd){
        toggle.addEventListener('click', function(){
          var t = pwd.getAttribute('type') === 'password' ? 'text' : 'password';
          pwd.setAttribute('type', t);
        });
      }
    }catch(_){ }
  });
})();
</script>
{% endblock %}