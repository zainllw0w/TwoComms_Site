{% load static %}
{% load responsive_images %}
<div class="vstack gap-3" style="min-width: 300px;">
  {% if items %}
    {% for it in items %}
      <div class="d-flex align-items-center justify-content-between border rounded-3 p-2 bg-elevate" data-cart-row data-key="{{ it.key }}">
        <div class="d-flex align-items-center gap-2">
          <div class="rounded-3 overflow-hidden bg-elevate" style="width:48px;height:48px;">
            {% if it.color_variant and it.color_variant.images.exists %}
              <img src="{{ it.color_variant.images.first.image.url }}" 
                   class="w-100 h-100 object-fit-cover" 
                   alt="{{ it.product.title }}"
                   width="48" height="48">
            {% elif it.product.main_image %}
              <img src="{{ it.product.main_image.url }}" 
                   class="w-100 h-100 object-fit-cover" 
                   alt="{{ it.product.title }}"
                   width="48" height="48">
            {% else %}
              {% static 'img/placeholder.jpg' as ph_url %}
              <img src="{{ ph_url }}" 
                   class="w-100 h-100 object-fit-cover" 
                   alt="{{ it.product.title }}"
                   width="48" height="48">
            {% endif %}
          </div>
          <div>
            <div class="fw-semibold small">{{ it.product.title }}</div>
            <div class="text-secondary small">
              Розмір: {{ it.size }} • ×{{ it.qty }}
              {% if it.color_variant %}
              <br>
              <div class="d-flex align-items-center gap-1">
                {% with p=it.color_variant.color.primary_hex s=it.color_variant.color.secondary_hex %}
                <span class="swatch" style="width: 12px; height: 12px;" 
                      data-primary="{{ p }}" 
                      data-secondary="{{ s|default:'' }}">
                </span>
                {% endwith %}
                <span>Колір</span>
              </div>
              {% endif %}
            </div>
          </div>
        </div>
        <div class="d-flex align-items-center gap-2">
          <div class="text-nowrap small fw-semibold">{{ it.line_total }} грн</div>
          <button type="button"
                  class="btn btn-sm btn-outline-light"
                  onclick="CartRemoveKey('{{ it.key }}', this); return false;"
                  aria-label="Видалити">×</button>
        </div>
      </div>
    {% endfor %}
    <div class="d-flex justify-content-between align-items-center">
      <div class="fw-semibold">Разом</div>
      <div class="fw-semibold">{{ total }} грн</div>
    </div>
    <a href="{% url 'delivery' %}" class="btn btn-outline-light w-100">Умови доставки та оплати</a>
    <div class="mono-checkout-mini" data-mono-status-scope>
      <button type="button" class="btn btn-outline-light w-100 mono-checkout-btn-mini" data-mono-checkout-trigger="mini">
        <span class="mono-checkout-label">Оформити через</span>
        <span class="mono-checkout-logo" aria-hidden="true">
          <svg class="mono-cat-icon" viewBox="0 0 32 32" role="presentation" focusable="false">
            <path class="mono-cat-head" d="M6 6.5V18c0 4.7 3.8 8.5 8.5 8.5h3c4.7 0 8.5-3.8 8.5-8.5V6.5l-3.8-2.2-5.7 3-5.7-3z"/>
            <circle class="mono-cat-eye" cx="12.5" cy="14" r="1.4"/>
            <circle class="mono-cat-eye" cx="19.5" cy="14" r="1.4"/>
            <path class="mono-cat-mouth" d="M12 18c0 1.2 1.6 2.1 4 2.1s4-0.9 4-2.1"/>
          </svg>
          <span class="mono-logo-word mono-logo-word--mono">mono</span>
          <span class="mono-logo-word mono-logo-word--checkout">checkout</span>
        </span>
      </button>
      <div class="mono-checkout-status text-secondary text-center mt-2" data-mono-checkout-status role="status" aria-live="polite"></div>
    </div>
  {% else %}
    <div class="text-secondary small">Кошик порожній.</div>
  {% endif %}
</div>
