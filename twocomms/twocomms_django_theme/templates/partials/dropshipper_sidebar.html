{% load static %}
<aside class="ds-sidebar" aria-label="Навігація розділу дропшиппінгу">
  <div class="ds-sidebar__inner">
    <header class="ds-sidebar__brand">
      <div class="ds-sidebar__logo">
        <img src="{% static 'img/logo.svg' %}" alt="TwoComms" loading="lazy" width="40" height="40">
      </div>
      <div class="ds-sidebar__brand-meta">
        <span class="ds-sidebar__title">Дропшип панель</span>
        <span class="ds-sidebar__subtitle">Керуйте усім в одному місці</span>
      </div>
    </header>

    {% if user.is_authenticated %}
    {% with profile=request.user.userprofile %}
    <div class="ds-sidebar__company ds-sidebar__company--featured" data-company-sidebar>
      <div class="ds-sidebar__company-bg" aria-hidden="true">
        <span class="ds-sidebar__company-glow ds-sidebar__company-glow--one"></span>
        <span class="ds-sidebar__company-glow ds-sidebar__company-glow--two"></span>
        <span class="ds-sidebar__company-logos">
          <span class="ds-sidebar__company-logo ds-sidebar__company-logo--one"></span>
          <span class="ds-sidebar__company-logo ds-sidebar__company-logo--two"></span>
          <span class="ds-sidebar__company-logo ds-sidebar__company-logo--three"></span>
        </span>
      </div>
      <div class="ds-sidebar__company-content">
        <div class="ds-sidebar__company-header">
          <span class="ds-sidebar__company-icon">
            <i class="fas fa-building-columns" aria-hidden="true"></i>
          </span>
          <div class="ds-sidebar__company-info">
            <span class="ds-sidebar__company-label">Ваша компанія</span>
            <strong class="ds-sidebar__company-name" data-company-sidebar-name>{{ profile.company_name|default:"Створіть компанію" }}</strong>
            {% if profile.company_name %}
              <span class="ds-sidebar__company-status ds-sidebar__company-status--ok" data-company-sidebar-status>
                <i class="fas fa-circle-check" aria-hidden="true"></i> Актуально
              </span>
            {% else %}
              <span class="ds-sidebar__company-status ds-sidebar__company-status--warn" data-company-sidebar-status>
                <i class="fas fa-pen" aria-hidden="true"></i> Заповніть дані
              </span>
            {% endif %}
          </div>
        </div>
        <div class="ds-sidebar__company-tags" data-company-sidebar-tags>
          <span class="ds-sidebar__company-pill" data-company-sidebar-phone>
            <i class="fas fa-phone" aria-hidden="true"></i>
            {{ profile.phone|default:request.user.username }}
          </span>
          {% if profile.website %}
            <span class="ds-sidebar__company-pill" data-company-sidebar-link>
              <i class="fas fa-globe" aria-hidden="true"></i>
              {{ profile.website }}
            </span>
          {% elif profile.instagram %}
            <span class="ds-sidebar__company-pill" data-company-sidebar-link>
              <i class="fab fa-instagram" aria-hidden="true"></i>
              {{ profile.instagram }}
            </span>
          {% else %}
            <span class="ds-sidebar__company-pill" data-company-sidebar-link hidden>
              —
            </span>
          {% endif %}
        </div>
        <button type="button" class="ds-sidebar__company-action" data-company-edit data-tab-link="company">
          <span>{% if profile.company_name %}Редагувати компанію{% else %}Створити компанію{% endif %}</span>
          <i class="fas fa-chevron-right" aria-hidden="true"></i>
        </button>
      </div>
    </div>
    {% endwith %}
    {% else %}
      {# Блок для незареєстрованих користувачів #}
      <div class="ds-sidebar__auth">
        <h3 class="ds-sidebar__auth-title">
          <i class="fas fa-rocket" aria-hidden="true"></i>
          Почніть заробляти
        </h3>
        <p class="ds-sidebar__auth-text">Увійдіть для доступу до всіх функцій</p>
        <div class="ds-sidebar__auth-actions">
          <button type="button" class="ds-btn ds-btn--primary ds-btn--sm" data-open-auth-modal="login">
            <i class="fas fa-sign-in-alt" aria-hidden="true"></i>
            <span>Увійти</span>
          </button>
          <button type="button" class="ds-btn ds-btn--ghost ds-btn--sm" data-open-auth-modal="register">
            <i class="fas fa-user-plus" aria-hidden="true"></i>
            <span>Реєстрація</span>
          </button>
        </div>
      </div>
    {% endif %}

    <nav class="ds-sidebar__nav" role="tablist">
      <a class="ds-sidebar__link {% if active_tab == 'dashboard' %}is-active{% endif %}"
         href="{% url 'orders:dropshipper_dashboard' %}"
         data-tab-target="main">
        <span class="ds-sidebar__icon">
          <i class="fas fa-home" aria-hidden="true"></i>
        </span>
        <span class="ds-sidebar__label">Головна</span>
      </a>

      <a class="ds-sidebar__link {% if active_tab == 'products' %}is-active{% endif %}"
         href="{% url 'orders:dropshipper_products' %}"
         data-tab-target="products">
        <span class="ds-sidebar__icon">
          <i class="fas fa-box-open" aria-hidden="true"></i>
        </span>
        <span class="ds-sidebar__label">Товари</span>
      </a>

      <a class="ds-sidebar__link {% if active_tab == 'orders' %}is-active{% endif %}"
         href="{% url 'orders:dropshipper_orders' %}"
         data-tab-target="orders"
         data-orders-link
         {% if not user.is_authenticated %}data-require-auth="true"{% endif %}>
        <span class="ds-sidebar__icon">
          <i class="fas fa-shopping-cart" aria-hidden="true"></i>
        </span>
        <span class="ds-sidebar__label">
          Замовлення
          {% if user.is_authenticated %}<span class="ds-sidebar__badge" data-orders-badge {% if not total_orders_count or total_orders_count == 0 %}hidden{% endif %}>{{ total_orders_count|default:0 }}</span>{% endif %}
        </span>
      </a>

      <a class="ds-sidebar__link {% if active_tab == 'statistics' %}is-active{% endif %}"
         href="{% url 'orders:dropshipper_statistics' %}"
         data-tab-target="statistics"
         {% if not user.is_authenticated %}data-require-auth="true"{% endif %}>
        <span class="ds-sidebar__icon">
          <i class="fas fa-chart-line" aria-hidden="true"></i>
        </span>
        <span class="ds-sidebar__label">Статистика</span>
      </a>

      <a class="ds-sidebar__link {% if active_tab == 'payouts' %}is-active{% endif %}"
         href="{% url 'orders:dropshipper_payouts' %}"
         data-tab-target="payouts"
         {% if not user.is_authenticated %}data-require-auth="true"{% endif %}>
        <span class="ds-sidebar__icon">
          <i class="fas fa-money-bill-wave" aria-hidden="true"></i>
        </span>
        <span class="ds-sidebar__label">Виплати</span>
      </a>
    </nav>

    <div class="ds-sidebar__support">
      <a href="https://t.me/twocomms"
         class="ds-support-btn"
         target="_blank"
         rel="noopener"
         aria-label="Написати в Telegram">
        <span class="ds-support-btn__icon" aria-hidden="true">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="12" r="11" fill="url(#tgGrad)"/>
            <path d="M16.59 7.227a.7.7 0 0 1 .39.748l-1.1 6.43c-.07.41-.33.53-.66.33l-1.8-1.33-1.05 1.01c-.12.12-.23.23-.47.23l.17-2.35 4.28-3.87c.18-.16-.04-.25-.28-.09l-5.29 3.34-2.28-.71c-.5-.16-.51-.5.11-.74l8.32-3.21c.38-.14.72-.02.86.24Z" fill="#fff"/>
            <defs>
              <linearGradient id="tgGrad" x1="4" y1="4" x2="20" y2="20" gradientUnits="userSpaceOnUse">
                <stop stop-color="#4fd1ff"/>
                <stop offset="1" stop-color="#217ee9"/>
              </linearGradient>
            </defs>
          </svg>
        </span>
        <span class="ds-support-btn__meta">
          <span class="ds-support-btn__title">Зв'язок 24/7</span>
          <span class="ds-support-btn__subtitle">@twocomms</span>
        </span>
      </a>
    </div>
  </div>
</aside>
