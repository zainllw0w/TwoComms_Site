{% load static %}
{% load cache %}
{% load seo_tags %}
{% load responsive_images %}
<!DOCTYPE html>
<html lang='uk' data-bs-theme='dark'>
<head>
  <!-- Critical CSS inline для предотвращения CLS -->
  <style>
    /* Critical CSS для предотвращения CLS */
    * {
        box-sizing: border-box;
    }
    
    html {
        scroll-behavior: smooth;
    }
    
    body {
        margin: 0;
        padding: 0;
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: #0a0a0a;
        color: #ffffff;
        line-height: 1.6;
        overflow-x: hidden;
    }
    
    /* Предотвращение смещения навбара */
    .navbar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1030;
        background: rgba(0,0,0,0.8);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(255,255,255,0.1);
        height: 60px;
        display: flex;
        align-items: center;
    }
    
    /* Предотвращение смещения main контейнера */
    main.container-xxl {
        margin-top: 60px;
        min-height: calc(100vh - 60px);
        padding: 1rem 0;
        width: 100%;
        max-width: 100%;
    }
    
    /* Hero section - фиксированные размеры */
    .hero-section {
        min-height: 100vh;
        display: flex;
        align-items: center;
        background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
        position: relative;
        overflow: hidden;
    }
    
    .hero-container {
        position: relative;
        z-index: 2;
        width: 100%;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1rem;
    }
    
    /* Hero particles - фиксированные размеры */
    .hero-particles {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1;
        pointer-events: none;
    }
    
    /* Предотвращение смещения изображений */
    img {
        max-width: 100%;
        height: auto;
        display: block;
    }
    
    /* Карточки товаров - фиксированные размеры */
    .product-card {
        aspect-ratio: 1;
        overflow: hidden;
        border-radius: 8px;
        background: #1a1a1a;
        transition: transform 0.3s ease;
    }
    
    .product-card img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    /* Категории - фиксированные размеры */
    .category-item {
        aspect-ratio: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 1rem;
        border-radius: 8px;
        background: #1a1a1a;
        text-decoration: none;
        color: inherit;
        transition: transform 0.3s ease;
    }
    
    .category-icon {
        width: 48px;
        height: 48px;
        margin-bottom: 0.5rem;
    }
    
    /* Footer - фиксированная высота */
    .footer {
        background: #111111;
        padding: 2rem 0;
        margin-top: auto;
    }
    
    /* Мобильная навигация - фиксированная высота */
    .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        height: 60px;
        background: rgba(0,0,0,0.9);
        backdrop-filter: blur(10px);
        border-top: 1px solid rgba(255,255,255,0.1);
        z-index: 1030;
        display: flex;
        align-items: center;
        justify-content: space-around;
    }
    
    /* Отступ для контента от мобильной навигации */
    @media (max-width: 768px) {
        main.container-xxl {
            padding-bottom: 60px;
        }
    }
    
    /* Font display optimization */
    @font-face {
        font-family: 'Inter';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url('https://fonts.gstatic.com/s/inter/v12/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfAZ9hiJ-Ek-_EeA.woff2') format('woff2');
    }
    
    @font-face {
        font-family: 'Inter';
        font-style: normal;
        font-weight: 500;
        font-display: swap;
        src: url('https://fonts.gstatic.com/s/inter/v12/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuI6fAZ9hiJ-Ek-_EeA.woff2') format('woff2');
    }
    
    @font-face {
        font-family: 'Inter';
        font-style: normal;
        font-weight: 600;
        font-display: swap;
        src: url('https://fonts.gstatic.com/s/inter/v12/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYAZ9hiJ-Ek-_EeA.woff2') format('woff2');
    }
    
    @font-face {
        font-family: 'Inter';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: url('https://fonts.gstatic.com/s/inter/v12/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuFuYAZ9hiJ-Ek-_EeA.woff2') format('woff2');
    }
    
    /* Фиксированные размеры для изображений товаров */
    .product-image {
        width: 100%;
        aspect-ratio: 1;
        object-fit: cover;
    }
    
    .product-image-large {
        width: 100%;
        aspect-ratio: 4/3;
        object-fit: cover;
    }
    
    /* Фиксированные размеры для иконок категорий */
    .category-icon {
        width: 48px;
        height: 48px;
        object-fit: contain;
    }
    
    .category-icon-small {
        width: 24px;
        height: 24px;
        object-fit: contain;
    }
    
    /* Фиксированные размеры для логотипа */
    .logo {
        height: 40px;
        width: auto;
    }
    
    /* Фиксированные размеры для аватаров */
    .avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        object-fit: cover;
    }
    
    .avatar-large {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        object-fit: cover;
    }
    
    /* Skeleton loading для изображений */
    .image-skeleton {
        background: linear-gradient(90deg, #1a1a1a 25%, #2a2a2a 50%, #1a1a1a 75%);
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
    }
    
    @keyframes loading {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
    }
    
    /* Предотвращение смещения при загрузке контента */
    .content-loading {
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .content-loaded {
        opacity: 1;
    }
  </style>
  
  <!-- Preload critical resources -->
  <link rel="preload" href="https://fonts.gstatic.com/s/inter/v12/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfAZ9hiJ-Ek-_EeA.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="https://fonts.gstatic.com/s/inter/v12/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuI6fAZ9hiJ-Ek-_EeA.woff2" as="font" type="font/woff2" crossorigin>
  
  <!-- DNS prefetch for external resources -->
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="dns-prefetch" href="//fonts.gstatic.com">
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
  
  <!-- Preconnect to critical origins -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
  <meta name="csrf-token" content="{{ csrf_token }}">
  
  <!-- Расширенные SEO Meta Tags -->
  {% block seo_meta %}
    <title>{% block title %}TwoComms — Стріт & Мілітарі Одяг{% endblock %}</title>
    <meta name="robots" content="{% block robots %}index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1{% endblock %}">
    <meta name="description" content="{% block description %}TwoComms - магазин стріт & мілітарі одягу з ексклюзивним дизайном. Футболки, худі, лонгсліви з характером. Якісний одяг для сучасного стилю.{% endblock %}">
    <meta name="keywords" content="{% block keywords %}стріт одяг, мілітарі одяг, футболки, худі, лонгсліви, TwoComms, ексклюзивний дизайн, якісний одяг, одяг з характером, стріт стиль, мілітарі стиль{% endblock %}">
    <link rel="canonical" href="{% block canonical %}{{ request.scheme }}://{{ request.get_host }}{{ request.path }}{% endblock %}">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="{% block og_type %}website{% endblock %}">
    <meta property="og:url" content="{% block og_url %}{{ request.scheme }}://{{ request.get_host }}{{ request.path }}{% endblock %}">
    <meta property="og:title" content="{% block og_title %}TwoComms — Стріт & Мілітарі Одяг{% endblock %}">
    <meta property="og:description" content="{% block og_description %}TwoComms - магазин стріт & мілітарі одягу з ексклюзивним дизайном. Футболки, худі, лонгсліви з характером. Якісний одяг для сучасного стилю.{% endblock %}">
    <meta property="og:image" content="{% block og_image %}{{ request.scheme }}://{{ request.get_host }}{% static 'img/logo.svg' %}{% endblock %}">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="TwoComms">
    <meta property="og:locale" content="uk_UA">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="{% block twitter_url %}{{ request.scheme }}://{{ request.get_host }}{{ request.path }}{% endblock %}">
    <meta property="twitter:title" content="{% block twitter_title %}TwoComms — Стріт & Мілітарі Одяг{% endblock %}">
    <meta property="twitter:description" content="{% block twitter_description %}TwoComms - магазин стріт & мілітарі одягу з ексклюзивним дизайном. Футболки, худі, лонгсліви з характером. Якісний одяг для сучасного стилю.{% endblock %}">
    <meta property="twitter:image" content="{% block twitter_image %}{{ request.scheme }}://{{ request.get_host }}{% static 'img/logo.svg' %}{% endblock %}">
  {% endblock %}
  
  <!-- Performance and Caching -->
  <meta http-equiv="Cache-Control" content="public, max-age=3600">
  <meta http-equiv="Expires" content="{% now 'D, d M Y H:i:s' %} GMT">
  
  <!-- PWA Support -->
  <link rel="manifest" href="{% static 'site.webmanifest' %}">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="TwoComms">
  
  <!-- Favicon and Icons -->
  <link rel='apple-touch-icon' sizes='180x180' href='{% static 'img/favicon-180x180.png' %}'>
  <link rel='icon' type='image/png' sizes='32x32' href='{% static 'img/favicon-32x32.png' %}'>
  <link rel='icon' type='image/png' sizes='192x192' href='{% static 'img/favicon-192x192.png' %}'>
  <meta name='application-name' content='TwoComms'>
  <meta name='theme-color' content='#111111'>
  <meta name='msapplication-TileColor' content='#111111'>
  <meta name='msapplication-TileImage' content='{% static 'img/favicon-180x180.png' %}'>
  <link rel='mask-icon' href='{% static 'img/logo.svg' %}' color='#7c3aed'>
  <link rel='icon' href='{% static 'img/favicon.ico' %}' sizes='any' type='image/x-icon'>
  
  <!-- Early performance hint: enable lite mode for save-data/low-memory/low-CPU -->
  <script>(function(){try{var c=navigator.connection||navigator.mozConnection||navigator.webkitConnection;var save=c&&c.saveData;var lowRam=Number(navigator.deviceMemory||0)&&navigator.deviceMemory<=1;var lowCPU=Number(navigator.hardwareConcurrency||0)&&navigator.hardwareConcurrency<=1;if(save||lowRam||lowCPU){document.documentElement.classList.add('perf-lite');}}catch(e){}})();</script>
  
  <!-- Асинхронная загрузка Bootstrap CSS -->
  <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css' rel='preload' as='style' onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css' rel='stylesheet'></noscript>
  
  <!-- Асинхронная загрузка основного CSS -->
  <link href="{% static 'css/styles.min.css' %}?v=2025.09.11.001" rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link href="{% static 'css/styles.min.css' %}?v=2025.09.11.001" rel="stylesheet"></noscript>
  
  <!-- Lite mode CSS -->
  <style>
  /* Lite mode on constrained devices: reduce expensive visual effects */
  .perf-lite .hero.bg-hero,
  .perf-lite .bottom-nav,
  .perf-lite #mini-cart-panel-mobile,
  .perf-lite #user-panel-mobile { backdrop-filter: none !important; }
  .perf-lite .card.product,
  .perf-lite .bottom-nav-item:hover .bottom-nav-icon svg,
  .perf-lite .bottom-nav-item.active .bottom-nav-icon svg { filter: none !important; box-shadow: none !important; }
  .perf-lite .hint-wiggle,
  .perf-lite .reveal,
  .perf-lite .reveal-fast { transition: none !important; }
  /* Отключаем только тяжелые фоновые эффекты на слабых устройствах */
  .perf-lite body::before, .perf-lite body::after { opacity: 0.3 !important; animation-duration: 20s !important; }
  .perf-lite .cart-sparks-container, .perf-lite .avatar-glow, .perf-lite .avatar-glow-large, .perf-lite .avatar-glow-mobile, .perf-lite .cart-glow, .perf-lite .cart-glow-mobile { opacity: 0.5 !important; }
  @media (max-width: 576px){
    .perf-lite .bottom-nav { box-shadow: none !important; }
  }
  </style>
  
  {% block extra_css %}{% endblock %}
  
  <!-- Structured Data (JSON-LD) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "TwoComms",
    "url": "{{ request.scheme }}://{{ request.get_host }}",
    "logo": "{{ request.scheme }}://{{ request.get_host }}{% static 'img/logo.svg' %}",
    "description": "Магазин стріт & мілітарі одягу з ексклюзивним дизайном",
    "foundingDate": "2024",
    "address": {
      "@type": "PostalAddress",
      "addressCountry": "UA",
      "addressLocality": "Україна"
    },
    "contactPoint": {
      "@type": "ContactPoint",
      "contactType": "customer service",
      "availableLanguage": "Ukrainian"
    },
    "sameAs": [
      "https://instagram.com/twocomms",
      "https://t.me/twocomms"
    ]
  }
  </script>
  
  <!-- Google Analytics (deferred) -->
  <script>
  (function(){
    function loadGA(){
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-109EFTWM05');
      
      var script = document.createElement('script');
      script.async = true;
      script.src = 'https://www.googletagmanager.com/gtag/js?id=G-109EFTWM05';
      document.head.appendChild(script);
    }
    
    if('requestIdleCallback' in window){ 
      requestIdleCallback(loadGA, {timeout: 2000}); 
    } else { 
      window.addEventListener('load', loadGA, {once:true}); 
    }
  })();
  </script>
  
  <!-- Microsoft Clarity (deferred) -->
  <script>
  (function(){
    function loadClarity(){
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "t7u94cvpqc");
    }
    
    if('requestIdleCallback' in window){ 
      requestIdleCallback(loadClarity, {timeout: 2000}); 
    } else { 
      window.addEventListener('load', loadClarity, {once:true}); 
    }
  })();
  </script>
  
  <!-- Meta Pixel Code (deferred) -->
  <script>
  (function(){
    function loadPixel(){
      !function(f,b,e,v,n,t,s){
        if(f.fbq)return; n=f.fbq=function(){ n.callMethod ? n.callMethod.apply(n,arguments) : n.queue.push(arguments) };
        if(!f._fbq) f._fbq=n; n.push=n; n.loaded=!0; n.version='2.0'; n.queue=[]; t=b.createElement(e); t.async=!0; t.src=v; s=b.getElementsByTagName(e)[0]; s.parentNode.insertBefore(t,s);
      }(window, document,'script','https://connect.facebook.net/en_US/fbevents.js');
      
      fbq('init', '823958313630148');
      fbq('track', 'PageView');
    }
    
    if('requestIdleCallback' in window){ 
      requestIdleCallback(loadPixel, {timeout: 2000}); 
    } else { 
      window.addEventListener('load', loadPixel, {once:true}); 
    }
  })();
  </script>
  
  <noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=823958313630148&ev=PageView&noscript=1"
  /></noscript>
  
  {% block structured_data %}{% endblock %}
  
  <!-- Event tracking helper -->
  <script>
  (function(){
    window.trackEvent = function(eventName, payload){
      try{ if(window.fbq) fbq('track', eventName, payload||{}); }catch(_){ }
      try{ if(window.gtag) gtag('event', eventName, payload||{}); }catch(_){ }
      try{ if(window.ym) ym(window.YM_ID||0, 'reachGoal', eventName, payload||{}); }catch(_){ }
    };
  })();
  </script>
</head>

<body class='bg-body text-body content-loading' style='font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;'>
  {% include 'partials/header.html' %}
  
  <main class='container-xxl py-4 py-md-5'>
    {% block breadcrumbs %}{% endblock %}
    {% block content %}{% endblock %}
  </main>
  
  {% cache 86400 footer_block %}{% include 'partials/footer.html' %}{% endcache %}

  <!-- Мобильные мини-панели (только для мобильной версии) -->
  <div id="mini-cart-panel-mobile" class="cart-panel d-none d-md-none">
    <!-- Анимация искр для корзины -->
    <div class="cart-sparks-container">
      <div class="cart-spark cart-spark-1"></div>
      <div class="cart-spark cart-spark-2"></div>
      <div class="cart-spark cart-spark-3"></div>
      <div class="cart-spark cart-spark-4"></div>
      <div class="cart-spark cart-spark-5"></div>
      <div class="cart-spark cart-spark-6"></div>
    </div>
    
    <!-- Заголовок корзины -->
    <div class="cart-header">
      <div class="cart-header-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12L8.1 13h7.45c.75 0 1.41-.41 1.75-1.03L21.7 4H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
        </svg>
      </div>
      <div class="cart-title">Кошик</div>
      <button type="button" class="close-btn" data-cart-close-mobile aria-label="Закрити">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      </button>
    </div>
    
    <!-- Содержимое корзины -->
    <div id="mini-cart-content-mobile" class="cart-content">
      <div class="cart-loading">
        <div class="loading-spinner"></div>
        <div class="loading-text">Завантаження…</div>
      </div>
    </div>
    
    <!-- Меню действий корзины -->
    <div class="cart-menu">
      <a href="{% url 'cart' %}" class="cart-menu-item">
        <div class="cart-menu-icon">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
          </svg>
        </div>
        <span>Переглянути кошик</span>
        <div class="cart-menu-arrow">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
            <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
          </svg>
        </div>
      </a>
      
      <a href="{% url 'checkout' %}" class="cart-menu-item checkout-item">
        <div class="cart-menu-icon">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
          </svg>
        </div>
        <span>Оформити замовлення</span>
        <div class="cart-menu-arrow">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
            <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
          </svg>
        </div>
      </a>
    </div>
    
    <!-- Информационная панель -->
    <div class="cart-info">
      <div class="cart-info-item">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
        </svg>
        <span>Безкоштовна доставка від 1000 грн</span>
      </div>
      <div class="cart-info-item">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
        </svg>
        <span>Гарантія якості</span>
      </div>
    </div>
  </div>

  <!-- Мобильная навигация -->
  <nav class="bottom-nav d-md-none">
    <a href="{% url 'home' %}" class="bottom-nav-item active" data-nav="home">
      <div class="bottom-nav-icon">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
        </svg>
      </div>
      <span class="bottom-nav-label">Головна</span>
    </a>
    
    <a href="{% url 'categories' %}" class="bottom-nav-item" data-nav="categories">
      <div class="bottom-nav-icon">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
        </svg>
      </div>
      <span class="bottom-nav-label">Категорії</span>
    </a>
    
    <button type="button" class="bottom-nav-item" data-cart-toggle-mobile>
      <div class="bottom-nav-icon">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12L8.1 13h7.45c.75 0 1.41-.41 1.75-1.03L21.7 4H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
        </svg>
        <span class="cart-badge" id="cart-badge-mobile">0</span>
      </div>
      <span class="bottom-nav-label">Кошик</span>
    </button>
    
    <a href="{% url 'profile' %}" class="bottom-nav-item" data-nav="profile">
      <div class="bottom-nav-icon">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
        </svg>
      </div>
      <span class="bottom-nav-label">Профіль</span>
    </a>
  </nav>

  <!-- JavaScript -->
  <script defer src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js'></script>
  <script defer src='{% static 'js/main.js' %}?v=29'></script>
  
  <!-- CLS Prevention Script -->
  <script>
  // Предотвращение CLS при загрузке
  (function() {
    // Показываем контент только после загрузки критических ресурсов
    function showContent() {
      document.body.classList.add('content-loaded');
      document.body.classList.remove('content-loading');
    }
    
    // Проверяем загрузку шрифтов
    if ('fonts' in document) {
      document.fonts.ready.then(showContent);
    } else {
      // Fallback для старых браузеров
      window.addEventListener('load', showContent);
    }
    
    // Предотвращение смещения при загрузке изображений
    const images = document.querySelectorAll('img');
    images.forEach(img => {
      if (img.complete) {
        img.classList.add('loaded');
      } else {
        img.addEventListener('load', function() {
          this.classList.add('loaded');
        });
      }
    });
    
    // Предотвращение смещения при загрузке CSS
    const stylesheets = document.querySelectorAll('link[rel="stylesheet"]');
    let loadedStylesheets = 0;
    
    stylesheets.forEach(link => {
      if (link.sheet) {
        loadedStylesheets++;
      } else {
        link.addEventListener('load', function() {
          loadedStylesheets++;
          if (loadedStylesheets === stylesheets.length) {
            showContent();
          }
        });
      }
    });
    
    // Fallback timeout
    setTimeout(showContent, 3000);
  })();
  </script>
  
  {% block extra_js %}{% endblock %}
</body>
</html>
