/* CLS (Cumulative Layout Shift) Fixes */

/* 1. Фиксируем размеры для main.container-xxl */
main.container-xxl {
  min-height: 100vh; /* Предотвращаем смещения при загрузке контента */
  position: relative;
  contain: layout; /* Изолируем layout от внешних влияний */
}

/* 2. Фиксируем размеры для hero-section */
.hero-section {
  min-height: 100vh;
  height: 100vh; /* Фиксированная высота */
  max-height: 100vh; /* Предотвращаем переполнение */
  position: relative;
  contain: layout size; /* Изолируем layout и размеры */
  overflow: hidden;
}

/* 3. Фиксируем размеры для hero-particles */
.hero-particles {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  contain: layout; /* Изолируем layout */
  z-index: 1;
}

.hero-particles .particle {
  position: absolute;
  width: 4px;
  height: 4px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 50%;
  animation: float 6s ease-in-out infinite;
  contain: layout; /* Изолируем layout */
}

/* 4. Предотвращаем смещения при загрузке изображений */
img {
  height: auto;
  max-width: 100%;
  contain: layout; /* Изолируем layout */
}

/* 5. Фиксируем размеры для карточек товаров */
.product-card {
  min-height: 400px; /* Предотвращаем смещения при загрузке */
  contain: layout; /* Изолируем layout */
}

.product-card img {
  width: 100%;
  height: 250px; /* Фиксированная высота */
  object-fit: cover;
  contain: layout; /* Изолируем layout */
}

/* 6. Фиксируем размеры для категорий */
.category-card {
  min-height: 200px; /* Предотвращаем смещения при загрузке */
  contain: layout; /* Изолируем layout */
}

.category-card img {
  width: 100%;
  height: 120px; /* Фиксированная высота */
  object-fit: cover;
  contain: layout; /* Изолируем layout */
}

/* 7. Предотвращаем смещения при загрузке шрифтов */
body {
  font-display: swap; /* Показываем fallback шрифт пока загружается основной */
}

/* 8. Фиксируем размеры для навигации */
.navbar {
  height: 70px; /* Фиксированная высота */
  contain: layout; /* Изолируем layout */
}

/* 9. Предотвращаем смещения при загрузке кнопок */
.btn {
  min-height: 44px; /* Минимальная высота для touch targets */
  contain: layout; /* Изолируем layout */
}

/* 10. Фиксируем размеры для футера */
footer {
  min-height: 200px; /* Предотвращаем смещения при загрузке */
  contain: layout; /* Изолируем layout */
}

/* 11. Анимации для частиц (оптимизированные) */
@keyframes float {
  0%, 100% {
    transform: translateY(0px) translateX(0px);
    opacity: 0.1;
  }
  25% {
    transform: translateY(-20px) translateX(10px);
    opacity: 0.3;
  }
  50% {
    transform: translateY(-10px) translateX(-5px);
    opacity: 0.2;
  }
  75% {
    transform: translateY(-15px) translateX(8px);
    opacity: 0.25;
  }
}

/* 12. Предотвращаем смещения при загрузке контента */
.content-loading {
  min-height: 200px;
  background: linear-gradient(90deg, #1a1a1a 25%, #2a2a2a 50%, #1a1a1a 75%);
  background-size: 200% 100%;
  animation: loading 1.5s infinite;
  contain: layout; /* Изолируем layout */
}

@keyframes loading {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

/* 13. Оптимизация для мобильных устройств */
@media (max-width: 768px) {
  .hero-section {
    min-height: 80vh; /* Меньшая высота на мобильных */
    height: 80vh;
  }
  
  main.container-xxl {
    min-height: 80vh;
  }
  
  .product-card {
    min-height: 350px;
  }
  
  .product-card img {
    height: 200px;
  }
}

/* 14. Предотвращаем смещения при загрузке скриптов */
.script-loading {
  opacity: 0;
  transition: opacity 0.3s ease;
}

.script-loaded {
  opacity: 1;
}

/* 15. Фиксируем размеры для модальных окон */
.modal {
  contain: layout; /* Изолируем layout */
}

.modal-dialog {
  contain: layout; /* Изолируем layout */
}

/* 16. Предотвращаем смещения при загрузке форм */
.form-group {
  min-height: 60px; /* Предотвращаем смещения при валидации */
  contain: layout; /* Изолируем layout */
}

/* 17. Оптимизация для производительности */
* {
  will-change: auto; /* Отключаем will-change по умолчанию */
}

.hero-particles .particle {
  will-change: transform, opacity; /* Включаем только для анимированных элементов */
}

/* 18. Предотвращаем смещения при загрузке иконок */
.icon {
  width: 24px;
  height: 24px;
  contain: layout; /* Изолируем layout */
}

/* 19. Фиксируем размеры для алертов */
.alert {
  min-height: 50px; /* Предотвращаем смещения при появлении */
  contain: layout; /* Изолируем layout */
}

/* 20. Предотвращаем смещения при загрузке таблиц */
.table {
  contain: layout; /* Изолируем layout */
}

.table th,
.table td {
  min-height: 40px; /* Предотвращаем смещения при загрузке данных */
  contain: layout; /* Изолируем layout */
}
