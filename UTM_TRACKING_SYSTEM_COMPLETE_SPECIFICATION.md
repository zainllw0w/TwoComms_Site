# üéØ –ü–û–õ–ù–ê–Ø –°–ü–ï–¶–ò–§–ò–ö–ê–¶–ò–Ø: –°–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è UTM-–º–µ—Ç–æ–∫ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π

**–í–µ—Ä—Å–∏—è:** 2.0 (–û–±–Ω–æ–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞)  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-30  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-01-30  
**–°—Ç–∞—Ç—É—Å:** üìã –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –í—ã—Å–æ–∫–∏–π

---

## ‚ö° –ö–†–ê–¢–ö–û–ï –†–ï–ó–Æ–ú–ï

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—É—é —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è UTM-–º–µ—Ç–æ–∫ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π –≤ Django-–ø—Ä–æ–µ–∫—Ç–µ TwoComms.

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

- ‚úÖ **–ü–æ–ª–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** –¥–ª—è Meta, Google Ads, TikTok –∏ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- ‚úÖ **–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º, –∫–∞–º–ø–∞–Ω–∏—è–º, –∫—Ä–µ–∞—Ç–∏–≤–∞–º
- ‚úÖ **–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ IP, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ –±—Ä–∞—É–∑–µ—Ä–æ–≤
- ‚úÖ **–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤–∏–∑–∏—Ç—ã** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏—Ö—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ **–°–∏—Å—Ç–µ–º–∞ –±–∞–ª–ª–æ–≤** - –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç–∏
- ‚úÖ **–í–æ—Ä–æ–Ω–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–π** - –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –æ—Ç –ø–µ—Ä–µ—Ö–æ–¥–∞ –¥–æ –ø–æ–∫—É–ø–∫–∏
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** - —Å–≤—è–∑—å —Å Meta Pixel, Google Analytics, –∑–∞–∫–∞–∑–∞–º–∏

### –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è:

- **–î–∏–∑–∞–π–Ω:** –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–∏–∑–∞–π–Ω –∏ –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑—É—é—â–µ–≥–æ –∞–≥–µ–Ω—Ç–∞. –í –¥–æ–∫—É–º–µ–Ω—Ç–µ –æ–ø–∏—Å–∞–Ω–∞ —Ç–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.
- **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –í—Å–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏, –º–æ–¥–µ–ª–∏, middleware –∏ views –æ–ø–∏—Å–∞–Ω—ã —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∫–æ–¥–∞.
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:** –£—á—Ç–µ–Ω—ã —Ä–µ–∞–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º (—á—Ç–æ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, —á—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é).

---

## üìã –°–û–î–ï–†–ñ–ê–ù–ò–ï

1. [–í–≤–µ–¥–µ–Ω–∏–µ –∏ —Ü–µ–ª–∏](#–≤–≤–µ–¥–µ–Ω–∏–µ-–∏-—Ü–µ–ª–∏)
2. [–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏](#–∞–Ω–∞–ª–∏–∑-—Ç–µ–∫—É—â–µ–π-—Å–∏—Ç—É–∞—Ü–∏–∏)
3. [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ UTM-–º–µ—Ç–∫–∞–º –¥–ª—è —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º](#–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è-–ø–æ-utm-–º–µ—Ç–∫–∞–º)
4. [–í–∞–∂–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏](#–≤–∞–∂–Ω—ã–µ-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è-–∏-–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏)
5. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Ä–µ—à–µ–Ω–∏—è)
6. [–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö](#–º–æ–¥–µ–ª–∏-–¥–∞–Ω–Ω—ã—Ö)
7. [Middleware –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è UTM](#middleware-–¥–ª—è-–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è)
8. [–°–∏—Å—Ç–µ–º–∞ –±–∞–ª–ª–æ–≤ –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–π](#—Å–∏—Å—Ç–µ–º–∞-–±–∞–ª–ª–æ–≤)
9. [–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å](#–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è-–ø–∞–Ω–µ–ª—å)
10. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
11. [–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö](#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-–¥–∞–Ω–Ω—ã—Ö)
12. [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è](#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)
13. [–ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏](#–ø–ª–∞–Ω-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)

---

## üéØ –í–í–ï–î–ï–ù–ò–ï –ò –¶–ï–õ–ò

### –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π —á–µ—Ä–µ–∑ UTM-–º–µ—Ç–∫–∏ –≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏ Django, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª–∏—Ç:

- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞ (Meta/Facebook/Instagram, Google Ads, TikTok, —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏)
- ‚úÖ –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Å–∞–π—Ç–µ
- ‚úÖ –†–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π
- ‚úÖ –í–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ —É–¥–æ–±–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- ‚úÖ –ü—Ä–∏—Å–≤–∞–∏–≤–∞—Ç—å –±–∞–ª–ª—ã –∑–∞ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª—è—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ–∫–ª–∞–º–Ω—ã–µ –∫—Ä–µ–∞—Ç–∏–≤—ã –∏ –∫–∞–Ω–∞–ª—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö:**
   - UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL (utm_source, utm_medium, utm_campaign, utm_content, utm_term)
   - –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã (fbclid, gclid, ttclid, fbc, fbp)
   - –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–≤—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ, –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –∫–ª–∏–∫–∏, —Å–∫—Ä–æ–ª–ª—ã)
   - –î–µ–π—Å—Ç–≤–∏—è (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É, —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã, –ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞, –ø–æ–∫—É–ø–∫–∞)
   - –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (IP, User-Agent, —Å–µ—Å—Å–∏—è)
   - –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è (—Å—Ç—Ä–∞–Ω–∞, –≥–æ—Ä–æ–¥, —Ä–µ–≥–∏–æ–Ω, —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å)
   - –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏ –±—Ä–∞—É–∑–µ—Ä (—Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –û–°, –±—Ä–∞—É–∑–µ—Ä, –≤–µ—Ä—Å–∏–∏)
   - –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤–∏–∑–∏—Ç—ã (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∏–∑–∏—Ç–æ–≤, –ø–µ—Ä–≤—ã–π/–ø–æ–≤—Ç–æ—Ä–Ω—ã–π)
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–º–æ–º–µ–Ω—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, —Å–≤—è–∑—å —Å UTM)

2. **–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
   - –°–≤—è–∑—å UTM —Å —Å–µ—Å—Å–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –°–≤—è–∑—å UTM —Å –∑–∞–∫–∞–∑–∞–º–∏
   - –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–∞–∂–µ –ø–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏ Django

3. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞:**
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º —Ç—Ä–∞—Ñ–∏–∫–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, –∫–æ–Ω–≤–µ—Ä—Å–∏–∏, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫)
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–º–ø–∞–Ω–∏—è–º (utm_campaign)
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫—Ä–µ–∞—Ç–∏–≤–∞–º (utm_content)
   - –ö–æ–Ω–≤–µ—Ä—Å–∏–∏ –ø–æ –≤–æ—Ä–æ–Ω–∫–µ (–ø–µ—Ä–µ—Ö–æ–¥ ‚Üí –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–≤–∞—Ä–∞ ‚Üí –∫–æ—Ä–∑–∏–Ω–∞ ‚Üí –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ ‚Üí –ª–∏–¥ ‚Üí –ø–æ–∫—É–ø–∫–∞)
   - –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º, –∫–∞–º–ø–∞–Ω–∏—è–º, –∫—Ä–µ–∞—Ç–∏–≤–∞–º
   - –°–∏—Å—Ç–µ–º–∞ –±–∞–ª–ª–æ–≤ –∑–∞ –¥–µ–π—Å—Ç–≤–∏—è
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ (—Å—Ç—Ä–∞–Ω—ã, –≥–æ—Ä–æ–¥–∞)
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º (desktop, mobile, tablet)
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –±—Ä–∞—É–∑–µ—Ä–∞–º –∏ –û–°
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã–º –≤–∏–∑–∏—Ç–∞–º
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è–º
   - –í—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
   - –ì–ª—É–±–∏–Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü)
   - –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–∫–∞–∑–æ–≤

4. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**
   - –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –æ–ø–∏—Å–∞–Ω–∞, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–∏–∑–∞–π–Ω –Ω–∞ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑—É—é—â–µ–≥–æ –∞–≥–µ–Ω—Ç–∞)
   - –¢–∞–±–ª–∏—Ü—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π
   - –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–º–ø–∞–Ω–∏—è–º –∏ –∫—Ä–µ–∞—Ç–∏–≤–∞–º
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö (CSV/Excel)

---

## üìä –ê–ù–ê–õ–ò–ó –¢–ï–ö–£–©–ï–ô –°–ò–¢–£–ê–¶–ò–ò

### –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

#### 1. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

**SiteSession** (`twocomms/storefront/models.py:712-735`)
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–æ–ª—è: `session_key`, `user`, `ip_address`, `user_agent`, `first_seen`, `last_seen`, `pageviews`
- ‚ùå **–ù–µ—Ç –ø–æ–ª–µ–π –¥–ª—è UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**

**PageView** (`twocomms/storefront/models.py:738-754`)
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä—ã —Å—Ç—Ä–∞–Ω–∏—Ü
- –ü–æ–ª—è: `session`, `user`, `path`, `referrer`, `when`
- ‚ùå **–ù–µ—Ç —Å–≤—è–∑–∏ —Å UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏**

**Order** (`twocomms/orders/models.py:7-200`)
- –ú–æ–¥–µ–ª—å –∑–∞–∫–∞–∑–æ–≤
- –ü–æ–ª—è: `user`, `session_key`, `total_sum`, `payment_status`, `pay_type`
- ‚ùå **–ù–µ—Ç –ø–æ–ª–µ–π –¥–ª—è UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**

#### 2. Middleware

**SimpleAnalyticsMiddleware** (`twocomms/storefront/tracking.py:21-82`)
- –°–æ–∑–¥–∞–µ—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç SiteSession –∏ PageView
- ‚ùå **–ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã**

#### 3. –ö–æ—Ä–∑–∏–Ω–∞

- –•—Ä–∞–Ω–∏—Ç—Å—è –≤ —Å–µ—Å—Å–∏–∏ Django (`request.session['cart']`)
- –§—É–Ω–∫—Ü–∏–∏: `add_to_cart`, `view_cart` –≤ `twocomms/storefront/views/cart.py`
- ‚ùå **–ù–µ—Ç —Å–≤—è–∑–∏ —Å UTM –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É**

#### 4. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å

- –°—É—â–µ—Å—Ç–≤—É–µ—Ç –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Å —Å–µ–∫—Ü–∏—è–º–∏ (`twocomms/storefront/views/admin.py:530-573`)
- –°–µ–∫—Ü–∏–∏: `stats`, `orders`, `users`, `catalogs`, `promocodes`, `offline_stores`, `print_proposals`, `collaboration`
- ‚ùå **–ù–µ—Ç —Å–µ–∫—Ü–∏–∏ –¥–ª—è UTM-–∞–Ω–∞–ª–∏—Ç–∏–∫–∏**

#### 5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

- Meta Pixel: –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω (`twocomms/twocomms_django_theme/static/js/analytics-loader.js`)
- TikTok Pixel: –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
- Google Tag Manager: –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
- ‚ùå **–ù–µ—Ç —Å–≤—è–∑–∏ UTM —Å —Å–æ–±—ã—Ç–∏—è–º–∏ –ø–∏–∫—Å–µ–ª–µ–π**

### –í—ã–≤–æ–¥—ã

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
1. –ú–æ–¥–µ–ª–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
2. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–æ–¥–µ–ª–µ–π (SiteSession, Order) –¥–ª—è —Å–≤—è–∑–∏ —Å UTM
3. Middleware –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
4. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ UTM
5. –ù–æ–≤—É—é —Å–µ–∫—Ü–∏—é –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –¥–ª—è UTM-–∞–Ω–∞–ª–∏—Ç–∏–∫–∏
6. –°–∏—Å—Ç–µ–º—É –±–∞–ª–ª–æ–≤ –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–π
7. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö

---

## üìö –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø –ü–û UTM-–ú–ï–¢–ö–ê–ú

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã

UTM (Urchin Tracking Module) - —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Ç—Ä–∞—Ñ–∏–∫–∞.

#### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

1. **`utm_source`** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
   - –ò—Å—Ç–æ—á–Ω–∏–∫ —Ç—Ä–∞—Ñ–∏–∫–∞
   - –ü—Ä–∏–º–µ—Ä—ã: `google`, `facebook`, `instagram`, `tiktok`, `email`, `direct`

2. **`utm_medium`** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
   - –¢–∏–ø —Ç—Ä–∞—Ñ–∏–∫–∞/–∫–∞–Ω–∞–ª
   - –ü—Ä–∏–º–µ—Ä—ã: `cpc` (–ø–ª–∞—Ç–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞), `organic` (–æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–π), `social` (—Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏), `email`, `referral`

3. **`utm_campaign`** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
   - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏
   - –ü—Ä–∏–º–µ—Ä—ã: `summer_sale_2025`, `new_collection`, `black_friday`

4. **`utm_content`** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è/–∫—Ä–µ–∞—Ç–∏–≤–∞
   - –ü—Ä–∏–º–µ—Ä—ã: `ad_123`, `banner_top`, `video_creative_1`

5. **`utm_term`** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ (–¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–π —Ä–µ–∫–ª–∞–º—ã)
   - –ü—Ä–∏–º–µ—Ä—ã: `running_shoes`, `winter_jacket`

### UTM –¥–ª—è Meta (Facebook/Instagram)

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Meta

**Meta –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `fbclid` - Facebook Click ID (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∏–∫–∞)
- `_fbc` - Facebook Click ID cookie (—Ñ–æ—Ä–º–∞—Ç: `fb.<subdomain_index>.<creation_time>.<fbclid>`)
- `_fbp` - Facebook Browser ID cookie (—Ñ–æ—Ä–º–∞—Ç: `fb.<subdomain_index>.<creation_time>.<random_number>`)

**–í–∞–∂–Ω–æ:** –° –∞–ø—Ä–µ–ª—è 2025 Meta –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç UTM-–º–µ—Ç–∫–∏ –∫–æ –≤—Å–µ–º –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ —É–∫–∞–∑–∞–Ω—ã –≤—Ä—É—á–Ω—É—é. –û–¥–Ω–∞–∫–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ UTM –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è.

#### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ UTM:

```
https://example.com/?utm_source=facebook&utm_medium=cpc&utm_campaign=campaign_name&utm_content=ad_id&utm_term=audience_type&fbclid=xxx
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `utm_source`: `facebook` –∏–ª–∏ `instagram` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `utm_medium`: `cpc` (–ø–ª–∞—Ç–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞) –∏–ª–∏ `social` (–æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–π) (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `utm_campaign`: –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `summer_sale_2025`)
- `utm_content`: ID –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∏–ª–∏ –∫—Ä–µ–∞—Ç–∏–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `ad_123456` –∏–ª–∏ `creative_video_1`)
- `utm_term`: –¢–∏–ø –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –∏–ª–∏ —Ç–∞—Ä–≥–µ—Ç–∏–Ω–≥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `lookalike_1`, `interest_sports`)
- `fbclid`: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è Meta (–Ω–µ –Ω—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é)

**–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Meta (–¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Ä–µ–∫–ª–∞–º–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ):**
- `{{campaign.name}}` - –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏
- `{{campaign.id}}` - ID –∫–∞–º–ø–∞–Ω–∏–∏
- `{{adset.name}}` - –Ω–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- `{{adset.id}}` - ID –≥—Ä—É–ø–ø—ã –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- `{{ad.name}}` - –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- `{{ad.id}}` - ID –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- `{{site_source_name}}` - –∏—Å—Ç–æ—á–Ω–∏–∫ —Ç—Ä–∞—Ñ–∏–∫–∞ (facebook, instagram, messenger)
- `{{placement}}` - —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä—ã:**

```
# Facebook —Ä–µ–∫–ª–∞–º–∞ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
https://twocomms.com/?utm_source=facebook&utm_medium=cpc&utm_campaign={{campaign.name}}&utm_content={{ad.id}}

# Instagram Stories
https://twocomms.com/?utm_source=instagram&utm_medium=cpc&utm_campaign=new_collection&utm_content=story_ad_2

# –û—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–π –ø–æ—Å—Ç Facebook
https://twocomms.com/?utm_source=facebook&utm_medium=social&utm_campaign=organic_post
```

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ:**
- –í—Å–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã (`utm_source`, `utm_medium`, `utm_campaign`, `utm_content`, `utm_term`)
- `fbclid` - –¥–ª—è —Å–≤—è–∑–∏ —Å Meta Pixel
- `_fbc` –∏ `_fbp` –∏–∑ cookies - –¥–ª—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π

### UTM –¥–ª—è Google Ads

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Google

**Google –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç:**
- `gclid` - Google Click ID (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∏–∫–∞ –¥–ª—è —Å–≤—è–∑–∏ —Å Google Analytics)

**–í–∞–∂–Ω–æ:** Google Ads –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ValueTrack –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–Ω–∞—á–µ–Ω–∏–π. –≠—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –ø–æ–∫–∞–∑–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è.

#### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —Å ValueTrack:

```
{lpurl}?utm_source=google&utm_medium=cpc&utm_campaign={campaign}&utm_content={creative}&utm_term={keyword}&gclid={gclid}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `utm_source`: `google` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `utm_medium`: `cpc` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `utm_campaign`: –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `{campaign}` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏)
- `utm_content`: ID –æ–±—ä—è–≤–ª–µ–Ω–∏—è (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `{creative}` –∏–ª–∏ `{adgroupid}`)
- `utm_term`: –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `{keyword}`)
- `gclid`: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è Google (–Ω–µ –Ω—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é)

**–î–æ—Å—Ç—É–ø–Ω—ã–µ ValueTrack –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Google Ads:**
- `{lpurl}` - –∫–æ–Ω–µ—á–Ω—ã–π URL (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤ –Ω–∞—á–∞–ª–µ)
- `{campaignid}` - ID –∫–∞–º–ø–∞–Ω–∏–∏ (—á–∏—Å–ª–æ–≤–æ–π)
- `{campaign}` - –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏
- `{adgroupid}` - ID –≥—Ä—É–ø–ø—ã –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- `{adgroup}` - –Ω–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- `{creative}` - ID –æ–±—ä—è–≤–ª–µ–Ω–∏—è (—á–∏—Å–ª–æ–≤–æ–π)
- `{keyword}` - –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ (URL-encoded)
- `{matchtype}` - —Ç–∏–ø —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è (e, p, b –¥–ª—è exact, phrase, broad)
- `{device}` - —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (c, m, t –¥–ª—è desktop, mobile, tablet)
- `{network}` - —Å–µ—Ç—å (g, s –¥–ª—è Google search, Search partners)
- `{ifmobile:[value]}` - —É—Å–ª–æ–≤–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
- `{ifnotmobile:[value]}` - —É—Å–ª–æ–≤–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –Ω–µ-–º–æ–±–∏–ª—å–Ω—ã—Ö

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —à–∞–±–ª–æ–Ω –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:**

```
{lpurl}?utm_source=google&utm_medium=cpc&utm_campaign={campaign}&utm_content={creative}&utm_term={keyword}&device={device}
```

**–ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω—ã—Ö URL –ø–æ—Å–ª–µ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏:**

```
# –ü–æ–∏—Å–∫–æ–≤–∞—è —Ä–µ–∫–ª–∞–º–∞ (desktop)
https://twocomms.com/?utm_source=google&utm_medium=cpc&utm_campaign=search_campaign&utm_content=123456789&utm_term=running+shoes&device=c&gclid=CjwKCAjw...

# –†–µ–∫–ª–∞–º–∞ –≤ –ö–ú–° (mobile)
https://twocomms.com/?utm_source=google&utm_medium=cpc&utm_campaign=shopping_campaign&utm_content=987654321&device=m&gclid=CjwKCAjw...
```

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ:**
- –í—Å–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- `gclid` - –¥–ª—è —Å–≤—è–∑–∏ —Å Google Analytics
- `device` - —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è)

### UTM –¥–ª—è TikTok Ads

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã TikTok

**TikTok –º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—Ç—å:**
- `ttclid` - TikTok Click ID (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `gclid` –∏ `fbclid`)

**–í–∞–∂–Ω–æ:** TikTok –Ω–µ –≤—Å–µ–≥–¥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç UTM-–º–µ—Ç–∫–∏, –ø–æ—ç—Ç–æ–º—É —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∏—Ö –≤—Ä—É—á–Ω—É—é –≤ —Ä–µ–∫–ª–∞–º–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ.

#### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç:

```
https://example.com/?utm_source=tiktok&utm_medium=paid_social&utm_campaign=campaign_name&utm_content=ad_id&ttclid=xxx
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `utm_source`: `tiktok` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `utm_medium`: `paid_social` (–ø–ª–∞—Ç–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞ –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö) –∏–ª–∏ `cpc` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `utm_campaign`: –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏
- `utm_content`: ID –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∏–ª–∏ –∫—Ä–µ–∞—Ç–∏–≤–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
- `utm_term`: –¢–∏–ø –∞—É–¥–∏—Ç–æ—Ä–∏–∏, —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –∏–ª–∏ —Ç–∏–ø –∫—Ä–µ–∞—Ç–∏–≤–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `ttclid`: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è TikTok (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ TikTok:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ—Ä–æ—Ç–∫–∏–µ, –ø–æ–Ω—è—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞–º–ø–∞–Ω–∏–π (—Ç–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω–∏—Ü–∞, –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä)
- –í `utm_content` —É–∫–∞–∑—ã–≤–∞–π—Ç–µ ID –æ–±—ä—è–≤–ª–µ–Ω–∏—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫—Ä–µ–∞—Ç–∏–≤–æ–≤
- –†–∞–∑–¥–µ–ª—è–π—Ç–µ —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —Ä–µ–∫–ª–∞–º—ã —á–µ—Ä–µ–∑ `utm_campaign`:
  - `infeed` - In-Feed —Ä–µ–∫–ª–∞–º–∞
  - `spark` - Spark Ads
  - `topview` - TopView
  - `brand_takeover` - Brand Takeover

**–ü—Ä–∏–º–µ—Ä—ã:**

```
# In-Feed —Ä–µ–∫–ª–∞–º–∞
https://twocomms.com/?utm_source=tiktok&utm_medium=paid_social&utm_campaign=summer_sale&utm_content=infeed_ad_1

# Spark Ads
https://twocomms.com/?utm_source=tiktok&utm_medium=paid_social&utm_campaign=spark_campaign&utm_content=spark_ad_2

# TopView
https://twocomms.com/?utm_source=tiktok&utm_medium=paid_social&utm_campaign=topview_campaign&utm_content=topview_1
```

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ:**
- –í—Å–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- `ttclid` - –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è (–¥–ª—è —Å–≤—è–∑–∏ —Å TikTok Pixel)

### –î—Ä—É–≥–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞

#### –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏

```
https://twocomms.com/?utm_source=partner_name&utm_medium=referral&utm_campaign=affiliate_program
```

#### Email-—Ä–∞—Å—Å—ã–ª–∫–∏

```
https://twocomms.com/?utm_source=email&utm_medium=email&utm_campaign=newsletter_january&utm_content=cta_button
```

#### –ü—Ä—è–º–æ–π —Ç—Ä–∞—Ñ–∏–∫

- –ï—Å–ª–∏ –Ω–µ—Ç UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∏—Å—Ç–æ—á–Ω–∏–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ `direct`
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `utm_source=direct&utm_medium=direct`

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø –ò –û–°–û–ë–ï–ù–ù–û–°–¢–ò

### –ß—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

#### Meta (Facebook/Instagram)

**–ß—Ç–æ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- `fbclid` - –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Ä–µ–∫–ª–∞–º—É
- `_fbc` –∏ `_fbp` cookies - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±—Ä–∞—É–∑–µ—Ä–æ–º
- –° –∞–ø—Ä–µ–ª—è 2025: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ UTM-–º–µ—Ç–∫–∏ (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω—ã —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ)

**–ß—Ç–æ –ù–ï –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—Ä–µ–∞—Ç–∏–≤–µ (–Ω—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –≤ `utm_content` –≤—Ä—É—á–Ω—É—é)
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞—É–¥–∏—Ç–æ—Ä–∏–∏ (–Ω—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –≤ `utm_term` –≤—Ä—É—á–Ω—É—é)
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑–º–µ—â–µ–Ω–∏–∏ (–Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `{{placement}}`)

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –∏–∑ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Instagram/Facebook UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–≥—É—Ç –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è
- –í Stories –∏ Reels –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
- –û—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–µ –ø–æ—Å—Ç—ã –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç `fbclid`

#### Google Ads

**–ß—Ç–æ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- `gclid` - –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Ä–µ–∫–ª–∞–º—É
- ValueTrack –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

**–ß—Ç–æ –ù–ï –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ —à–∞–±–ª–æ–Ω—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –¥–æ—Å—Ç—É–ø–Ω–∞ —á–µ—Ä–µ–∑ `{device}`, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ —Ç–æ—á–Ω–∞

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –í –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö Google –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
- –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–≥—É—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å

#### TikTok Ads

**–ß—Ç–æ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- `ttclid` - –º–æ–∂–µ—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫)

**–ß—Ç–æ –ù–ï –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—Ä–µ–∞—Ç–∏–≤–µ –Ω—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –∏–∑ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è TikTok UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–≥—É—Ç –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è
- –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö —Ä–µ–∫–ª–∞–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, Spark Ads) –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

1. **–ï—Å–ª–∏ –Ω–µ—Ç UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `utm_source=direct` –∏ `utm_medium=direct`
   - –°–æ—Ö—Ä–∞–Ω—è—Ç—å referrer –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

2. **–ï—Å–ª–∏ –Ω–µ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã—Ö ID (fbclid, gclid, ttclid):**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏—é IP + User-Agent –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
   - –°–æ—Ö—Ä–∞–Ω—è—Ç—å cookies –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

3. **–ï—Å–ª–∏ –Ω–µ—Ç –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏:**
   - –ü—Ä–æ–ø—É—Å–∫–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ (–Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fallback –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ API (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

4. **–ï—Å–ª–∏ –Ω–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–∏–Ω–≥ User-Agent
   - –û–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–π —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (mobile/desktop/tablet)

### –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–µ—Ö–æ–¥ —Å —Ä–µ–∫–ª–∞–º—ã Meta –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

**–ß—Ç–æ –±—É–¥–µ—Ç –≤ URL:**
- `fbclid` - –±—É–¥–µ—Ç
- `utm_source`, `utm_medium` - –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ —Ä–µ–∫–ª–∞–º–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ
- `utm_campaign`, `utm_content` - –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤—Ä—É—á–Ω—É—é

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å:**
- –í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- `fbclid`
- IP-–∞–¥—Ä–µ—Å
- User-Agent (–¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞)
- Cookies `_fbc` –∏ `_fbp` (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã)

#### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–µ—Ä–µ—Ö–æ–¥ —Å Google Ads –Ω–∞ desktop

**–ß—Ç–æ –±—É–¥–µ—Ç –≤ URL:**
- `gclid` - –±—É–¥–µ—Ç
- `utm_source=google`, `utm_medium=cpc` - –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- `utm_campaign`, `utm_content`, `utm_term` - –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —á–µ—Ä–µ–∑ ValueTrack

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å:**
- –í—Å–µ UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- `gclid`
- IP-–∞–¥—Ä–µ—Å
- User-Agent
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –∏–∑ `{device}` (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è)

#### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –≤–∏–∑–∏—Ç –±–µ–∑ UTM –≤ URL

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ —Å–µ—Å—Å–∏–∏
- –û–±–Ω–æ–≤–ª—è—Ç—å `last_seen` –∏ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å `visit_count`
- –ù–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—É—é UTM-—Å–µ—Å—Å–∏—é

#### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
- –°–≤—è–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π UTM-—Å–µ—Å—Å–∏–µ–π –ø–æ `session_key`
- –ï—Å–ª–∏ `session_key` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–∫–∞—Ç—å –ø–æ IP + User-Agent –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
- –û—Ç–º–µ—Ç–∏—Ç—å `user_registered=True` –≤ UTM-—Å–µ—Å—Å–∏–∏

#### –°—Ü–µ–Ω–∞—Ä–∏–π 5: –ü–æ–∫—É–ø–∫–∞ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –≤–∏–∑–∏—Ç–∞

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é UTM-—Å–µ—Å—Å–∏—é (–¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∞ —Å—Ç–∞—Ä–∞—è)
- –°–≤—è–∑–∞—Ç—å –∑–∞–∫–∞–∑ —Å UTM-—Å–µ—Å—Å–∏–µ–π —á–µ—Ä–µ–∑ `session_key` –∏–ª–∏ —á–µ—Ä–µ–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û—Ç–º–µ—Ç–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Å–∏—é –≤ UTM-—Å–µ—Å—Å–∏–∏

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –†–ï–®–ï–ù–ò–Ø

### –û–±—â–∞—è —Å—Ö–µ–º–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨                             ‚îÇ
‚îÇ  –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ —Å UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              UTMTrackingMiddleware                           ‚îÇ
‚îÇ  - –ó–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç UTM –∏–∑ URL                                    ‚îÇ
‚îÇ  - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ —Å–µ—Å—Å–∏—é                                        ‚îÇ
‚îÇ  - –°–æ–∑–¥–∞–µ—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç UTMSession                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              SimpleAnalyticsMiddleware                       ‚îÇ
‚îÇ  - –°–æ–∑–¥–∞–µ—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç SiteSession                             ‚îÇ
‚îÇ  - –°–æ–∑–¥–∞–µ—Ç PageView                                          ‚îÇ
‚îÇ  - –°–≤—è–∑—ã–≤–∞–µ—Ç —Å UTMSession                                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              –î–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è                           ‚îÇ
‚îÇ  - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä–∞–Ω–∏—Ü ‚Üí UserAction                            ‚îÇ
‚îÇ  - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É ‚Üí CartAction                        ‚îÇ
‚îÇ  - –ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ ‚Üí Lead (Order —Å prepaid)                      ‚îÇ
‚îÇ  - –ü–æ–∫—É–ø–∫–∞ ‚Üí Purchase (Order —Å paid)                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å                         ‚îÇ
‚îÇ  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ UTM                                         ‚îÇ
‚îÇ  - –ö–æ–Ω–≤–µ—Ä—Å–∏–∏                                                 ‚îÇ
‚îÇ  - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

1. **–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö:**
   - `UTMSession` - —Ö—Ä–∞–Ω–µ–Ω–∏–µ UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è —Å–µ—Å—Å–∏–∏
   - `UserAction` - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ `SiteSession` - —Å–≤—è–∑—å —Å UTM
   - –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ `Order` - —Å–≤—è–∑—å —Å UTM

2. **Middleware:**
   - `UTMTrackingMiddleware` - –∑–∞—Ö–≤–∞—Ç –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ UTM

3. **–°–∏–≥–Ω–∞–ª—ã Django:**
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ - —Å–≤—è–∑—å —Å UTM
   - –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É - –∑–∞–ø–∏—Å—å –¥–µ–π—Å—Ç–≤–∏—è

4. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å:**
   - –ù–æ–≤–∞—è —Å–µ–∫—Ü–∏—è `utm_analytics`
   - Views –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
   - API endpoints –¥–ª—è –¥–∞–Ω–Ω—ã—Ö

5. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**
   - Chart.js –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
   - –¢–∞–±–ª–∏—Ü—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
   - –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

---

## üíæ –ú–û–î–ï–õ–ò –î–ê–ù–ù–´–•

### 1. UTMSession

–ú–æ–¥–µ–ª—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–µ—Å—Å–∏–∏.

```python
# twocomms/storefront/models.py

class UTMSession(models.Model):
    """
    –•—Ä–∞–Ω–∏—Ç UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    –°–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å SiteSession –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—Å–µ–≥–æ –ø—É—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    –í–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.
    """
    session = models.OneToOneField(
        SiteSession,
        on_delete=models.CASCADE,
        related_name='utm_data',
        null=True,
        blank=True
    )
    session_key = models.CharField(max_length=40, db_index=True, unique=True)
    
    # UTM –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ)
    utm_source = models.CharField(max_length=255, db_index=True, blank=True, null=True)
    utm_medium = models.CharField(max_length=255, db_index=True, blank=True, null=True)
    utm_campaign = models.CharField(max_length=255, db_index=True, blank=True, null=True)
    utm_content = models.CharField(max_length=255, db_index=True, blank=True, null=True)
    utm_term = models.CharField(max_length=255, db_index=True, blank=True, null=True)
    
    # –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
    fbclid = models.CharField(max_length=255, db_index=True, blank=True, null=True, verbose_name='Facebook Click ID')
    gclid = models.CharField(max_length=255, db_index=True, blank=True, null=True, verbose_name='Google Click ID')
    ttclid = models.CharField(max_length=255, db_index=True, blank=True, null=True, verbose_name='TikTok Click ID')
    fbc = models.CharField(max_length=255, blank=True, null=True, verbose_name='Facebook Click Cookie')
    fbp = models.CharField(max_length=255, blank=True, null=True, verbose_name='Facebook Browser Cookie')
    
    # –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ IP)
    ip_address = models.GenericIPAddressField(null=True, blank=True, db_index=True)
    country = models.CharField(max_length=2, blank=True, null=True, db_index=True, verbose_name='–ö–æ–¥ —Å—Ç—Ä–∞–Ω—ã (ISO 3166-1)')
    country_name = models.CharField(max_length=100, blank=True, null=True, verbose_name='–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã')
    city = models.CharField(max_length=100, blank=True, null=True, db_index=True, verbose_name='–ì–æ—Ä–æ–¥')
    region = models.CharField(max_length=100, blank=True, null=True, verbose_name='–†–µ–≥–∏–æ–Ω/–û–±–ª–∞—Å—Ç—å')
    timezone = models.CharField(max_length=50, blank=True, null=True, verbose_name='–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å')
    
    # –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏ –±—Ä–∞—É–∑–µ—Ä
    device_type = models.CharField(max_length=20, blank=True, null=True, db_index=True, choices=[
        ('desktop', 'Desktop'),
        ('mobile', 'Mobile'),
        ('tablet', 'Tablet'),
        ('unknown', 'Unknown'),
    ], verbose_name='–¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞')
    device_brand = models.CharField(max_length=50, blank=True, null=True, verbose_name='–ë—Ä–µ–Ω–¥ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞')
    device_model = models.CharField(max_length=100, blank=True, null=True, verbose_name='–ú–æ–¥–µ–ª—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞')
    os_name = models.CharField(max_length=50, blank=True, null=True, db_index=True, verbose_name='–û–°')
    os_version = models.CharField(max_length=50, blank=True, null=True, verbose_name='–í–µ—Ä—Å–∏—è –û–°')
    browser_name = models.CharField(max_length=50, blank=True, null=True, db_index=True, verbose_name='–ë—Ä–∞—É–∑–µ—Ä')
    browser_version = models.CharField(max_length=50, blank=True, null=True, verbose_name='–í–µ—Ä—Å–∏—è –±—Ä–∞—É–∑–µ—Ä–∞')
    user_agent = models.TextField(blank=True, null=True, verbose_name='User Agent')
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    referrer = models.URLField(max_length=512, blank=True, null=True)
    landing_page = models.CharField(max_length=512, blank=True, null=True)
    
    # –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤–∏–∑–∏—Ç–æ–≤
    visit_count = models.PositiveIntegerField(default=1, db_index=True, verbose_name='–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∏–∑–∏—Ç–æ–≤')
    is_first_visit = models.BooleanField(default=True, db_index=True, verbose_name='–ü–µ—Ä–≤—ã–π –≤–∏–∑–∏—Ç')
    is_returning_visitor = models.BooleanField(default=False, db_index=True, verbose_name='–í–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π—Å—è –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—å')
    
    # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    user_registered = models.BooleanField(default=False, db_index=True, verbose_name='–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è')
    user_registered_at = models.DateTimeField(null=True, blank=True, verbose_name='–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏')
    
    # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
    first_seen = models.DateTimeField(auto_now_add=True, db_index=True)
    last_seen = models.DateTimeField(auto_now=True, db_index=True)
    
    # –§–ª–∞–≥–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
    is_converted = models.BooleanField(default=False, db_index=True)
    converted_at = models.DateTimeField(null=True, blank=True)
    conversion_type = models.CharField(max_length=20, blank=True, null=True, choices=[
        ('lead', '–õ–∏–¥ (–ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞)'),
        ('purchase', '–ü–æ–∫—É–ø–∫–∞'),
    ], db_index=True, verbose_name='–¢–∏–ø –∫–æ–Ω–≤–µ—Ä—Å–∏–∏')
    
    class Meta:
        ordering = ['-first_seen']
        indexes = [
            models.Index(fields=['utm_source', 'utm_medium', 'utm_campaign']),
            models.Index(fields=['-first_seen']),
            models.Index(fields=['is_converted', '-converted_at']),
            models.Index(fields=['country', 'city']),
            models.Index(fields=['device_type', 'os_name']),
            models.Index(fields=['is_returning_visitor', '-first_seen']),
            models.Index(fields=['user_registered', '-first_seen']),
        ]
        verbose_name = 'UTM –°–µ—Å—Å–∏—è'
        verbose_name_plural = 'UTM –°–µ—Å—Å–∏–∏'
    
    def __str__(self):
        return f"UTM: {self.utm_source}/{self.utm_medium} - {self.utm_campaign or 'N/A'}"
    
    @property
    def utm_string(self):
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"""
        parts = []
        if self.utm_source:
            parts.append(f"source={self.utm_source}")
        if self.utm_medium:
            parts.append(f"medium={self.utm_medium}")
        if self.utm_campaign:
            parts.append(f"campaign={self.utm_campaign}")
        if self.utm_content:
            parts.append(f"content={self.utm_content}")
        if self.utm_term:
            parts.append(f"term={self.utm_term}")
        return "&".join(parts)
    
    def mark_as_converted(self, conversion_type='purchase'):
        """–û—Ç–º–µ—á–∞–µ—Ç —Å–µ—Å—Å–∏—é –∫–∞–∫ –∫–æ–Ω–≤–µ—Ä—Å–∏–æ–Ω–Ω—É—é"""
        if not self.is_converted:
            self.is_converted = True
            self.converted_at = timezone.now()
            self.conversion_type = conversion_type
            self.save(update_fields=['is_converted', 'converted_at', 'conversion_type'])
    
    def increment_visit(self):
        """–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫ –≤–∏–∑–∏—Ç–æ–≤"""
        self.visit_count += 1
        self.is_first_visit = False
        self.is_returning_visitor = True
        self.last_seen = timezone.now()
        self.save(update_fields=['visit_count', 'is_first_visit', 'is_returning_visitor', 'last_seen'])
    
    def mark_user_registered(self):
        """–û—Ç–º–µ—á–∞–µ—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è"""
        if not self.user_registered:
            self.user_registered = True
            self.user_registered_at = timezone.now()
            self.save(update_fields=['user_registered', 'user_registered_at'])
```

### 2. UserAction

–ú–æ–¥–µ–ª—å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

```python
# twocomms/storefront/models.py

class UserAction(models.Model):
    """
    –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Å–∞–π—Ç–µ.
    –°–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å UTMSession –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ä–µ–∫–ª–∞–º—ã.
    """
    ACTION_TYPES = [
        ('page_view', '–ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã'),
        ('product_view', '–ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–≤–∞—Ä–∞'),
        ('add_to_cart', '–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É'),
        ('remove_from_cart', '–£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã'),
        ('initiate_checkout', '–ù–∞—á–∞–ª–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞'),
        ('lead', '–õ–∏–¥ (–ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞)'),
        ('purchase', '–ü–æ–∫—É–ø–∫–∞'),
        ('search', '–ü–æ–∏—Å–∫'),
        ('click', '–ö–ª–∏–∫'),
        ('scroll', '–ü—Ä–æ–∫—Ä—É—Ç–∫–∞'),
        ('time_on_page', '–í—Ä–µ–º—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ'),
    ]
    
    utm_session = models.ForeignKey(
        UTMSession,
        on_delete=models.CASCADE,
        related_name='actions',
        null=True,
        blank=True
    )
    site_session = models.ForeignKey(
        SiteSession,
        on_delete=models.CASCADE,
        related_name='user_actions',
        null=True,
        blank=True
    )
    user = models.ForeignKey(
        User,
        on_delete=models.SET_NULL,
        null=True,
        blank=True
    )
    
    action_type = models.CharField(max_length=50, choices=ACTION_TYPES, db_index=True)
    
    # –î–∞–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
    page_path = models.CharField(max_length=512, blank=True, null=True)
    product_id = models.IntegerField(null=True, blank=True, db_index=True)
    product_name = models.CharField(max_length=255, blank=True, null=True)
    cart_value = models.DecimalField(max_digits=12, decimal_places=2, null=True, blank=True)
    order_id = models.IntegerField(null=True, blank=True, db_index=True)
    order_number = models.CharField(max_length=20, blank=True, null=True)
    
    # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
    metadata = models.JSONField(default=dict, blank=True)
    timestamp = models.DateTimeField(auto_now_add=True, db_index=True)
    
    # –ë–∞–ª–ª—ã –∑–∞ –¥–µ–π—Å—Ç–≤–∏–µ
    points_earned = models.IntegerField(default=0)
    
    class Meta:
        ordering = ['-timestamp']
        indexes = [
            models.Index(fields=['action_type', '-timestamp']),
            models.Index(fields=['utm_session', 'action_type']),
            models.Index(fields=['product_id', '-timestamp']),
        ]
        verbose_name = '–î–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è'
        verbose_name_plural = '–î–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π'
    
    def __str__(self):
        return f"{self.get_action_type_display()} - {self.timestamp}"
```

### 3. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ Order

–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –¥–ª—è —Å–≤—è–∑–∏ —Å UTM.

```python
# twocomms/orders/models.py

class Order(models.Model):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è ...
    
    # –ù–æ–≤—ã–µ –ø–æ–ª—è –¥–ª—è UTM
    utm_session = models.ForeignKey(
        'storefront.UTMSession',
        on_delete=models.SET_NULL,
        null=True,
        blank=True,
        related_name='orders',
        verbose_name='UTM –°–µ—Å—Å–∏—è'
    )
    
    # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞)
    utm_source = models.CharField(max_length=255, blank=True, null=True, db_index=True)
    utm_medium = models.CharField(max_length=255, blank=True, null=True, db_index=True)
    utm_campaign = models.CharField(max_length=255, blank=True, null=True, db_index=True)
    utm_content = models.CharField(max_length=255, blank=True, null=True, db_index=True)
    utm_term = models.CharField(max_length=255, blank=True, null=True, db_index=True)
    
    # ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è ...
```

### 4. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ SiteSession

–î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è UTM.

```python
# twocomms/storefront/models.py

class SiteSession(models.Model):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è ...
    
    def get_utm_session(self):
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—É—é UTM —Å–µ—Å—Å–∏—é"""
        return getattr(self, 'utm_data', None)
    
    def get_utm_source(self):
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç utm_source –∏–∑ —Å–≤—è–∑–∞–Ω–Ω–æ–π UTM —Å–µ—Å—Å–∏–∏"""
        utm = self.get_utm_session()
        return utm.utm_source if utm else None
```

---

## üîÑ MIDDLEWARE –î–õ–Ø –û–¢–°–õ–ï–ñ–ò–í–ê–ù–ò–Ø

### UTMTrackingMiddleware

```python
# twocomms/storefront/middleware.py

from django.utils.deprecation import MiddlewareMixin
from django.utils import timezone
from .models import UTMSession, SiteSession, UserAction
from django.db import transaction


class UTMTrackingMiddleware(MiddlewareMixin):
    """
    Middleware –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.
    –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–∑–º–µ—â–µ–Ω –ü–ï–†–ï–î SimpleAnalyticsMiddleware –≤ settings.MIDDLEWARE.
    
    –ó–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç:
    - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã (utm_source, utm_medium, utm_campaign, utm_content, utm_term)
    - –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã (fbclid, gclid, ttclid)
    - Cookies (_fbc, _fbp)
    - –ì–µ–æ–ª–æ–∫–∞—Ü–∏—é –ø–æ IP
    - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –∏ –±—Ä–∞—É–∑–µ—Ä–µ –∏–∑ User-Agent
    """
    
    UTM_PARAMS = ['utm_source', 'utm_medium', 'utm_campaign', 'utm_content', 'utm_term']
    PLATFORM_PARAMS = ['fbclid', 'gclid', 'ttclid']
    
    def process_request(self, request):
        """–ó–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ —Å–µ—Å—Å–∏—é"""
        # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–ª—É–∂–µ–±–Ω—ã–µ –ø—É—Ç–∏
        if request.path.startswith(('/admin', '/static', '/media', '/api')):
            return None
        
        # –ü–æ–ª—É—á–∞–µ–º UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ GET-–∑–∞–ø—Ä–æ—Å–∞
        utm_data = {}
        platform_data = {}
        has_utm = False
        
        # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        for param in self.UTM_PARAMS:
            value = request.GET.get(param, '').strip()
            if value:
                utm_data[param] = value
                has_utm = True
        
        # –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
        for param in self.PLATFORM_PARAMS:
            value = request.GET.get(param, '').strip()
            if value:
                platform_data[param] = value
        
        # Cookies –¥–ª—è Meta
        fbc = request.COOKIES.get('_fbc', '')
        fbp = request.COOKIES.get('_fbp', '')
        if fbc:
            platform_data['fbc'] = fbc
        if fbp:
            platform_data['fbp'] = fbp
        
        # –ï—Å–ª–∏ –µ—Å—Ç—å UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Ö
        if has_utm:
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Å–µ—Å—Å–∏—é –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
            request.session['utm_data'] = utm_data
            request.session['platform_data'] = platform_data
            request.session['utm_first_seen'] = timezone.now().isoformat()
            request.session.modified = True
            
            # –°–æ–∑–¥–∞–µ–º –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ–º UTMSession
            self._create_or_update_utm_session(request, utm_data, platform_data)
        
        # –ï—Å–ª–∏ –Ω–µ—Ç UTM, –Ω–æ –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –≤ —Å–µ—Å—Å–∏–∏ - –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö
        elif 'utm_data' in request.session:
            utm_data = request.session['utm_data']
            platform_data = request.session.get('platform_data', {})
        else:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è UTM-—Å–µ—Å—Å–∏—è –¥–ª—è —ç—Ç–æ–≥–æ session_key
            # (–¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤–∏–∑–∏—Ç–æ–≤ –±–µ–∑ UTM –≤ URL)
            session_key = request.session.session_key
            if session_key:
                try:
                    utm_session = UTMSession.objects.get(session_key=session_key)
                    # –û–±–Ω–æ–≤–ª—è–µ–º last_seen –∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –≤–∏–∑–∏—Ç–æ–≤
                    utm_session.increment_visit()
                except UTMSession.DoesNotExist:
                    pass
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ request –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ views
        request.utm_data = utm_data
        request.platform_data = platform_data
        
        return None
    
    def _create_or_update_utm_session(self, request, utm_data, platform_data):
        """–°–æ–∑–¥–∞–µ—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç UTMSession —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π"""
        try:
            session_key = request.session.session_key
            if not session_key:
                request.session.save()
                session_key = request.session.session_key
            
            if not session_key:
                return
            
            # –ü–æ–ª—É—á–∞–µ–º IP-–∞–¥—Ä–µ—Å
            ip_address = self._get_client_ip(request)
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é
            geo_data = self._get_geolocation(ip_address)
            
            # –ü–∞—Ä—Å–∏–º User-Agent
            user_agent_str = request.META.get('HTTP_USER_AGENT', '')
            device_data = self._parse_user_agent(user_agent_str)
            
            with transaction.atomic():
                utm_session, created = UTMSession.objects.get_or_create(
                    session_key=session_key,
                    defaults={
                        # UTM –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                        'utm_source': utm_data.get('utm_source'),
                        'utm_medium': utm_data.get('utm_medium'),
                        'utm_campaign': utm_data.get('utm_campaign'),
                        'utm_content': utm_data.get('utm_content'),
                        'utm_term': utm_data.get('utm_term'),
                        
                        # –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
                        'fbclid': platform_data.get('fbclid'),
                        'gclid': platform_data.get('gclid'),
                        'ttclid': platform_data.get('ttclid'),
                        'fbc': platform_data.get('fbc'),
                        'fbp': platform_data.get('fbp'),
                        
                        # –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è
                        'ip_address': ip_address,
                        'country': geo_data.get('country'),
                        'country_name': geo_data.get('country_name'),
                        'city': geo_data.get('city'),
                        'region': geo_data.get('region'),
                        'timezone': geo_data.get('timezone'),
                        
                        # –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏ –±—Ä–∞—É–∑–µ—Ä
                        'device_type': device_data.get('device_type'),
                        'device_brand': device_data.get('device_brand'),
                        'device_model': device_data.get('device_model'),
                        'os_name': device_data.get('os_name'),
                        'os_version': device_data.get('os_version'),
                        'browser_name': device_data.get('browser_name'),
                        'browser_version': device_data.get('browser_version'),
                        'user_agent': user_agent_str[:500] if user_agent_str else None,
                        
                        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                        'referrer': request.META.get('HTTP_REFERER', '')[:512] or None,
                        'landing_page': request.path,
                    }
                )
                
                if not created:
                    # –û–±–Ω–æ–≤–ª—è–µ–º last_seen –∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –≤–∏–∑–∏—Ç–æ–≤
                    utm_session.increment_visit()
                
                # –°–≤—è–∑—ã–≤–∞–µ–º —Å SiteSession, –µ—Å–ª–∏ –æ–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
                try:
                    site_session = SiteSession.objects.get(session_key=session_key)
                    if not utm_session.session_id:
                        utm_session.session = site_session
                        utm_session.save(update_fields=['session'])
                except SiteSession.DoesNotExist:
                    pass
                    
        except Exception as e:
            # –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É, –Ω–æ –Ω–µ –ª–æ–º–∞–µ–º –∑–∞–ø—Ä–æ—Å
            import logging
            logger = logging.getLogger('storefront.utm')
            logger.error(f"Error creating UTM session: {e}")
    
    def _get_client_ip(self, request):
        """–ü–æ–ª—É—á–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π IP-–∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞"""
        x_forwarded_for = request.META.get('HTTP_X_FORWARDED_FOR')
        if x_forwarded_for:
            ip = x_forwarded_for.split(',')[0]
        else:
            ip = request.META.get('REMOTE_ADDR')
        return ip
    
    def _get_geolocation(self, ip_address):
        """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é –ø–æ IP-–∞–¥—Ä–µ—Å—É"""
        # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è GeoIP2 (django.contrib.gis.geoip2)
        # –¢—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏: pip install geoip2
        # –ò –∑–∞–≥—Ä—É–∑–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö GeoLite2
        geo_data = {
            'country': None,
            'country_name': None,
            'city': None,
            'region': None,
            'timezone': None,
        }
        
        try:
            from django.contrib.gis.geoip2 import GeoIP2
            g = GeoIP2()
            if ip_address:
                try:
                    city_info = g.city(ip_address)
                    geo_data.update({
                        'country': city_info.get('country_code'),
                        'country_name': city_info.get('country_name'),
                        'city': city_info.get('city'),
                        'region': city_info.get('region'),
                        'timezone': city_info.get('time_zone'),
                    })
                except Exception:
                    # –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≥–æ—Ä–æ–¥, –ø—Ä–æ–±—É–µ–º —Å—Ç—Ä–∞–Ω—É
                    try:
                        country_info = g.country(ip_address)
                        geo_data.update({
                            'country': country_info.get('country_code'),
                            'country_name': country_info.get('country_name'),
                        })
                    except Exception:
                        pass
        except ImportError:
            # GeoIP2 –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é
            pass
        except Exception:
            # –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
            pass
        
        return geo_data
    
    def _parse_user_agent(self, user_agent_str):
        """–ü–∞—Ä—Å–∏—Ç User-Agent –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –±—Ä–∞—É–∑–µ—Ä–∞"""
        # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è user-agents –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
        # –¢—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏: pip install user-agents
        device_data = {
            'device_type': 'unknown',
            'device_brand': None,
            'device_model': None,
            'os_name': None,
            'os_version': None,
            'browser_name': None,
            'browser_version': None,
        }
        
        if not user_agent_str:
            return device_data
        
        try:
            from user_agents import parse
            ua = parse(user_agent_str)
            
            # –¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
            if ua.is_mobile:
                device_data['device_type'] = 'mobile'
            elif ua.is_tablet:
                device_data['device_type'] = 'tablet'
            elif ua.is_pc:
                device_data['device_type'] = 'desktop'
            
            # –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
            device_data['device_brand'] = ua.device.brand
            device_data['device_model'] = ua.device.model
            
            # –û–°
            device_data['os_name'] = ua.os.family
            device_data['os_version'] = '.'.join(filter(None, [ua.os.version_string]))
            
            # –ë—Ä–∞—É–∑–µ—Ä
            device_data['browser_name'] = ua.browser.family
            device_data['browser_version'] = '.'.join(filter(None, [ua.browser.version_string]))
            
        except ImportError:
            # user-agents –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω - –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–∏–Ω–≥
            ua_lower = user_agent_str.lower()
            if 'mobile' in ua_lower or 'android' in ua_lower or 'iphone' in ua_lower:
                device_data['device_type'] = 'mobile'
            elif 'tablet' in ua_lower or 'ipad' in ua_lower:
                device_data['device_type'] = 'tablet'
            elif 'windows' in ua_lower or 'mac' in ua_lower or 'linux' in ua_lower:
                device_data['device_type'] = 'desktop'
        except Exception:
            # –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ - –æ—Å—Ç–∞–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            pass
        
        return device_data
```

### –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è SimpleAnalyticsMiddleware

–î–æ–±–∞–≤–∏—Ç—å —Å–≤—è–∑—å —Å UTM –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ SiteSession.

```python
# twocomms/storefront/tracking.py

# –í –º–µ—Ç–æ–¥–µ process_request, –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è sess:

# –°–≤—è–∑—ã–≤–∞–µ–º —Å UTM, –µ—Å–ª–∏ –µ—Å—Ç—å
if hasattr(request, 'utm_data') and request.utm_data:
    try:
        utm_session = UTMSession.objects.filter(session_key=session_key).first()
        if utm_session and not utm_session.session_id:
            utm_session.session = sess
            utm_session.save(update_fields=['session'])
    except Exception:
        pass
```

### –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω—É–∂–Ω–æ —Å–≤—è–∑–∞—Ç—å –µ–≥–æ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π UTM-—Å–µ—Å—Å–∏–µ–π.

```python
# twocomms/storefront/signals.py –∏–ª–∏ –≤ views —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

from django.db.models.signals import post_save
from django.dispatch import receiver
from django.contrib.auth.models import User
from .models import UTMSession

@receiver(post_save, sender=User)
def link_user_to_utm_session(sender, instance, created, **kwargs):
    """–°–≤—è–∑—ã–≤–∞–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å UTM-—Å–µ—Å—Å–∏–µ–π"""
    if created:  # –¢–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        # –ò—â–µ–º UTM-—Å–µ—Å—Å–∏—é –ø–æ session_key –∏–∑ —Å–µ—Å—Å–∏–∏
        # –≠—Ç–æ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å –≤ view —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, —Ç–∞–∫ –∫–∞–∫ —Ç–∞–º –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ request
        
        # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥: –∏—Å–∫–∞—Ç—å –ø–æ IP –∏ User-Agent
        # (–µ—Å–ª–∏ session_key –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)
        pass

# –í view —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (twocomms/storefront/views/auth.py –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–º):

def register_view(request):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ ...
    
    if form.is_valid():
        user = form.save()
        
        # –°–≤—è–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å UTM-—Å–µ—Å—Å–∏–µ–π
        session_key = request.session.session_key
        if session_key:
            try:
                utm_session = UTMSession.objects.get(session_key=session_key)
                utm_session.mark_user_registered()
                
                # –¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ SiteSession
                if utm_session.session:
                    utm_session.session.user = user
                    utm_session.session.save(update_fields=['user'])
            except UTMSession.DoesNotExist:
                # –ï—Å–ª–∏ UTM-—Å–µ—Å—Å–∏–∏ –Ω–µ—Ç, –ø—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –ø–æ IP –∏ User-Agent
                ip_address = request.META.get('REMOTE_ADDR')
                user_agent = request.META.get('HTTP_USER_AGENT', '')
                
                if ip_address:
                    # –ò—â–µ–º –Ω–µ–¥–∞–≤–Ω–∏–µ UTM-—Å–µ—Å—Å–∏–∏ —Å —Ç–∞–∫–∏–º IP (–∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞)
                    from django.utils import timezone
                    from datetime import timedelta
                    
                    recent_utm = UTMSession.objects.filter(
                        ip_address=ip_address,
                        first_seen__gte=timezone.now() - timedelta(hours=24),
                        user_registered=False
                    ).order_by('-first_seen').first()
                    
                    if recent_utm:
                        recent_utm.mark_user_registered()
                        if recent_utm.session:
                            recent_utm.session.user = user
                            recent_utm.session.save(update_fields=['user'])
        
        # ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
```

---

## üéØ –°–ò–°–¢–ï–ú–ê –ë–ê–õ–õ–û–í

### –õ–æ–≥–∏–∫–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –±–∞–ª–ª–æ–≤

–ë–∞–ª–ª—ã –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è –∑–∞ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–æ–º–æ–≥–∞—é—Ç –æ—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–æ–Ω–≤–µ—Ä—Å–∏–∏.

#### –¢–∞–±–ª–∏—Ü–∞ –±–∞–ª–ª–æ–≤:

| –î–µ–π—Å—Ç–≤–∏–µ | –ë–∞–ª–ª—ã | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-------|----------|
| **–ü–æ—Å–µ—â–µ–Ω–∏–µ —Å–∞–π—Ç–∞** | 1 | –ü–µ—Ä–≤—ã–π –≤–∏–∑–∏—Ç –ø–æ UTM |
| **–ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã** | 0.5 | –ö–∞–∂–¥–∞—è –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–º–∞–∫—Å 10 –±–∞–ª–ª–æ–≤ –∑–∞ —Å–µ—Å—Å–∏—é) |
| **–ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–≤–∞—Ä–∞** | 2 | –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–∞ |
| **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É** | 10 | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É |
| **–£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã** | -5 | –®—Ç—Ä–∞—Ñ –∑–∞ —É–¥–∞–ª–µ–Ω–∏–µ |
| **–ù–∞—á–∞–ª–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è** | 15 | –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ |
| **–õ–∏–¥ (–ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞)** | 50 | –í–Ω–µ—Å–µ–Ω–∏–µ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—ã 200 –≥—Ä–Ω |
| **–ü–æ–∫—É–ø–∫–∞ (–ø–æ–ª–Ω–∞—è –æ–ø–ª–∞—Ç–∞)** | 100 | –ü–æ–ª–Ω–∞—è –æ–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ |

#### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã:

- **–í—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ:**
  - –ú–µ–Ω–µ–µ 10 —Å–µ–∫—É–Ω–¥: -5 –±–∞–ª–ª–æ–≤ (–æ—Ç–∫–∞–∑)
  - 10-30 —Å–µ–∫—É–Ω–¥: 0 –±–∞–ª–ª–æ–≤
  - 30-60 —Å–µ–∫—É–Ω–¥: +2 –±–∞–ª–ª–∞
  - 1-3 –º–∏–Ω—É—Ç—ã: +5 –±–∞–ª–ª–æ–≤
  - –ë–æ–ª–µ–µ 3 –º–∏–Ω—É—Ç: +10 –±–∞–ª–ª–æ–≤

- **–ì–ª—É–±–∏–Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞:**
  - 1-2 —Å—Ç—Ä–∞–Ω–∏—Ü—ã: 0 –±–∞–ª–ª–æ–≤
  - 3-5 —Å—Ç—Ä–∞–Ω–∏—Ü: +3 –±–∞–ª–ª–∞
  - 6-10 —Å—Ç—Ä–∞–Ω–∏—Ü: +7 –±–∞–ª–ª–æ–≤
  - –ë–æ–ª–µ–µ 10 —Å—Ç—Ä–∞–Ω–∏—Ü: +15 –±–∞–ª–ª–æ–≤

- **–í–æ–∑–≤—Ä–∞—Ç –Ω–∞ —Å–∞–π—Ç:**
  - –ü–µ—Ä–≤—ã–π –≤–∏–∑–∏—Ç: –±–∞–∑–æ–≤—ã–µ –±–∞–ª–ª—ã
  - –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –≤–∏–∑–∏—Ç: +5 –±–∞–ª–ª–æ–≤
  - –¢—Ä–µ—Ç–∏–π –∏ –±–æ–ª–µ–µ: +10 –±–∞–ª–ª–æ–≤

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –±–∞–ª–ª–æ–≤

```python
# twocomms/storefront/utils/utm_scoring.py

from decimal import Decimal
from django.utils import timezone
from datetime import timedelta
from ..models import UTMSession, UserAction, SiteSession


class UTMSessionScorer:
    """–ö–ª–∞—Å—Å –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –±–∞–ª–ª–æ–≤ UTM-—Å–µ—Å—Å–∏–∏"""
    
    ACTION_POINTS = {
        'page_view': 0.5,
        'product_view': 2,
        'add_to_cart': 10,
        'remove_from_cart': -5,
        'initiate_checkout': 15,
        'lead': 50,
        'purchase': 100,
    }
    
    @staticmethod
    def calculate_session_score(utm_session):
        """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ–±—â–∏–π –±–∞–ª–ª –¥–ª—è UTM-—Å–µ—Å—Å–∏–∏"""
        if not utm_session:
            return 0
        
        total_score = 0
        
        # –ë–∞–ª–ª—ã –∑–∞ –¥–µ–π—Å—Ç–≤–∏—è
        actions = UserAction.objects.filter(utm_session=utm_session)
        for action in actions:
            points = UTMSessionScorer.ACTION_POINTS.get(action.action_type, 0)
            total_score += points
        
        # –ë–æ–Ω—É—Å—ã –∑–∞ –≤—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ
        if utm_session.session:
            time_bonus = UTMSessionScorer._calculate_time_bonus(utm_session.session)
            total_score += time_bonus
        
        # –ë–æ–Ω—É—Å—ã –∑–∞ –≥–ª—É–±–∏–Ω—É –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
        depth_bonus = UTMSessionScorer._calculate_depth_bonus(utm_session)
        total_score += depth_bonus
        
        return int(total_score)
    
    @staticmethod
    def _calculate_time_bonus(site_session):
        """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –±–æ–Ω—É—Å –∑–∞ –≤—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ"""
        if not site_session.first_seen or not site_session.last_seen:
            return 0
        
        duration = site_session.last_seen - site_session.first_seen
        seconds = duration.total_seconds()
        
        if seconds < 10:
            return -5
        elif seconds < 30:
            return 0
        elif seconds < 60:
            return 2
        elif seconds < 180:
            return 5
        else:
            return 10
    
    @staticmethod
    def _calculate_depth_bonus(utm_session):
        """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –±–æ–Ω—É—Å –∑–∞ –≥–ª—É–±–∏–Ω—É –ø—Ä–æ—Å–º–æ—Ç—Ä–∞"""
        page_views = UserAction.objects.filter(
            utm_session=utm_session,
            action_type='page_view'
        ).count()
        
        if page_views <= 2:
            return 0
        elif page_views <= 5:
            return 3
        elif page_views <= 10:
            return 7
        else:
            return 15


def record_user_action(request, action_type, **kwargs):
    """–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ UTM"""
    from ..models import UserAction, UTMSession
    
    session_key = request.session.session_key
    if not session_key:
        return None
    
    # –ü–æ–ª—É—á–∞–µ–º UTM —Å–µ—Å—Å–∏—é
    utm_session = None
    try:
        utm_session = UTMSession.objects.get(session_key=session_key)
    except UTMSession.DoesNotExist:
        pass
    
    # –ü–æ–ª—É—á–∞–µ–º SiteSession
    site_session = None
    try:
        site_session = SiteSession.objects.get(session_key=session_key)
    except SiteSession.DoesNotExist:
        pass
    
    # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –±–∞–ª–ª—ã
    points = UTMSessionScorer.ACTION_POINTS.get(action_type, 0)
    
    # –°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å –¥–µ–π—Å—Ç–≤–∏—è
    action = UserAction.objects.create(
        utm_session=utm_session,
        site_session=site_session,
        user=request.user if request.user.is_authenticated else None,
        action_type=action_type,
        page_path=request.path,
        points_earned=points,
        **kwargs
    )
    
    return action
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ views

```python
# –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É
from storefront.utils.utm_scoring import record_user_action

def add_to_cart(request):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ...
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–µ–π—Å—Ç–≤–∏–µ
    record_user_action(
        request,
        'add_to_cart',
        product_id=product.id,
        product_name=product.title,
        cart_value=float(cart_total),
        metadata={'size': size, 'color_variant_id': color_variant_id}
    )
    
    return JsonResponse({...})
```

---

## üìä –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–ò–í–ù–ê–Ø –ü–ê–ù–ï–õ–¨

### –ù–æ–≤–∞—è —Å–µ–∫—Ü–∏—è: UTM Analytics

–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Å–µ–∫—Ü–∏—é –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å UTM-–∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π.

**–í–∞–∂–Ω–æ:** –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–∏–∑–∞–π–Ω –∏ –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑—É—é—â–µ–≥–æ –∞–≥–µ–Ω—Ç–∞. –ù–∏–∂–µ –æ–ø–∏—Å–∞–Ω–∞ —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã.

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–µ–∫—Ü–∏–∏:

1. **–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** (–¥–∞—à–±–æ—Ä–¥)
   - –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Å—Å–∏–π –∑–∞ –ø–µ—Ä–∏–æ–¥
   - –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω–≤–µ—Ä—Å–∏–π
   - –û–±—â–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
   - –û–±—â–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–æ–≤
   - –°—Ä–µ–¥–Ω–∏–π —á–µ–∫

2. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º** (utm_source)
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Å—Å–∏–π –ø–æ –∫–∞–∂–¥–æ–º—É –∏—Å—Ç–æ—á–Ω–∏–∫—É
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω–≤–µ—Ä—Å–∏–π –ø–æ –∫–∞–∂–¥–æ–º—É –∏—Å—Ç–æ—á–Ω–∏–∫—É
   - –ü—Ä–æ—Ü–µ–Ω—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –ø–æ –∫–∞–∂–¥–æ–º—É –∏—Å—Ç–æ—á–Ω–∏–∫—É
   - –°—É–º–º–∞ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É –∏—Å—Ç–æ—á–Ω–∏–∫—É
   - –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–æ –∫–∞–∂–¥–æ–º—É –∏—Å—Ç–æ—á–Ω–∏–∫—É
   - –°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª –ø–æ –∫–∞–∂–¥–æ–º—É –∏—Å—Ç–æ—á–Ω–∏–∫—É
   - –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ
   - –°—Ä–µ–¥–Ω—è—è –≥–ª—É–±–∏–Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü)

3. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–º–ø–∞–Ω–∏—è–º** (utm_campaign)
   - –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º, –Ω–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–∞–º–ø–∞–Ω–∏—è–º

4. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫—Ä–µ–∞—Ç–∏–≤–∞–º** (utm_content)
   - –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º, –Ω–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫—Ä–µ–∞—Ç–∏–≤–∞–º
   - –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ–∫–ª–∞–º–Ω—ã–µ –∫—Ä–µ–∞—Ç–∏–≤—ã

5. **–í–æ—Ä–æ–Ω–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–π**
   - –í—Å–µ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
   - –ü—Ä–æ—Å–º–æ—Ç—Ä—ã —Ç–æ–≤–∞—Ä–æ–≤
   - –î–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É
   - –ù–∞—á–∞–ª–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
   - –õ–∏–¥—ã (–ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞)
   - –ü–æ–∫—É–ø–∫–∏ (–ø–æ–ª–Ω–∞—è –æ–ø–ª–∞—Ç–∞)
   - –ü—Ä–æ—Ü–µ–Ω—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ

6. **–î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞**
   - –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è (—Å—Ç—Ä–∞–Ω—ã, –≥–æ—Ä–æ–¥–∞)
   - –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (desktop, mobile, tablet)
   - –ë—Ä–∞—É–∑–µ—Ä—ã –∏ –û–°
   - –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤–∏–∑–∏—Ç—ã
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –í—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ
   - –ì–ª—É–±–∏–Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
   - –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–∫–∞–∑–æ–≤

### View –¥–ª—è UTM Analytics

```python
# twocomms/storefront/views/admin.py

from django.db.models import Count, Sum, Avg, Q, F, ExpressionWrapper
from django.db import models
from django.utils import timezone
from datetime import timedelta
from ..models import UTMSession, UserAction, SiteSession
from orders.models import Order


def _build_utm_analytics_context(request, period='week'):
    """–°—Ç—Ä–æ–∏—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —Å–µ–∫—Ü–∏–∏ UTM Analytics"""
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–µ—Ä–∏–æ–¥
    now = timezone.now()
    if period == 'today':
        start_date = now.replace(hour=0, minute=0, second=0, microsecond=0)
    elif period == 'week':
        start_date = now - timedelta(days=7)
    elif period == 'month':
        start_date = now - timedelta(days=30)
    elif period == 'all_time':
        start_date = None
    else:
        start_date = now - timedelta(days=7)
    
    # –ë–∞–∑–æ–≤—ã–π queryset
    utm_sessions = UTMSession.objects.all()
    if start_date:
        utm_sessions = utm_sessions.filter(first_seen__gte=start_date)
    
    # –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    total_sessions = utm_sessions.count()
    total_conversions = utm_sessions.filter(is_converted=True).count()
    conversion_rate = (total_conversions / total_sessions * 100) if total_sessions > 0 else 0
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
    source_stats = utm_sessions.values('utm_source').annotate(
        sessions=Count('id'),
        conversions=Count('id', filter=Q(is_converted=True)),
        total_score=Sum('actions__points_earned'),
        avg_score=Avg('actions__points_earned'),
    ).annotate(
        conversion_rate=ExpressionWrapper(
            F('conversions') * 100.0 / F('sessions'),
            output_field=models.FloatField()
        )
    ).order_by('-sessions')
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–º–ø–∞–Ω–∏—è–º
    campaign_stats = utm_sessions.values('utm_campaign').annotate(
        sessions=Count('id'),
        conversions=Count('id', filter=Q(is_converted=True)),
        total_score=Sum('actions__points_earned'),
    ).order_by('-sessions')
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫—Ä–µ–∞—Ç–∏–≤–∞–º (utm_content)
    content_stats = utm_sessions.filter(utm_content__isnull=False).values('utm_content').annotate(
        sessions=Count('id'),
        conversions=Count('id', filter=Q(is_converted=True)),
        total_score=Sum('actions__points_earned'),
    ).order_by('-sessions')
    
    # –ö–æ–Ω–≤–µ—Ä—Å–∏–∏ –ø–æ —ç—Ç–∞–ø–∞–º –≤–æ—Ä–æ–Ω–∫–∏
    funnel_stats = _calculate_funnel_stats(utm_sessions)
    
    # –¢–æ–ø –∫–∞–º–ø–∞–Ω–∏–∏ –ø–æ –±–∞–ª–ª–∞–º
    top_campaigns_by_score = campaign_stats.order_by('-total_score')[:10]
    
    # –¢–æ–ø –∫—Ä–µ–∞—Ç–∏–≤—ã –ø–æ –∫–æ–Ω–≤–µ—Ä—Å–∏—è–º
    top_content_by_conversion = content_stats.order_by('-conversions')[:10]
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
    geo_stats = utm_sessions.values('country', 'country_name', 'city').annotate(
        sessions=Count('id'),
        conversions=Count('id', filter=Q(is_converted=True)),
    ).order_by('-sessions')[:20]
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º
    device_stats = utm_sessions.values('device_type').annotate(
        sessions=Count('id'),
        conversions=Count('id', filter=Q(is_converted=True)),
    ).order_by('-sessions')
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã–º –≤–∏–∑–∏—Ç–∞–º
    first_visits = utm_sessions.filter(is_first_visit=True).count()
    returning_visits = utm_sessions.filter(is_returning_visitor=True).count()
    total_visits = utm_sessions.aggregate(total=Sum('visit_count'))['total'] or 0
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è–º
    total_registrations = utm_sessions.filter(user_registered=True).count()
    registration_rate = (total_registrations / total_sessions * 100) if total_sessions > 0 else 0
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –±—Ä–∞—É–∑–µ—Ä–∞–º
    browser_stats = utm_sessions.values('browser_name').annotate(
        sessions=Count('id'),
        conversions=Count('id', filter=Q(is_converted=True)),
    ).order_by('-sessions')[:10]
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –û–°
    os_stats = utm_sessions.values('os_name').annotate(
        sessions=Count('id'),
        conversions=Count('id', filter=Q(is_converted=True)),
    ).order_by('-sessions')[:10]
    
    # –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º (–∏–∑ –∑–∞–∫–∞–∑–æ–≤)
    from orders.models import Order
    orders_with_utm = Order.objects.filter(
        utm_session__in=utm_sessions,
        payment_status__in=['paid', 'prepaid']
    )
    
    source_revenue = orders_with_utm.values('utm_source').annotate(
        total_revenue=Sum('total_sum'),
        order_count=Count('id'),
        avg_order_value=Avg('total_sum'),
    )
    
    return {
        'period': period,
        'start_date': start_date,
        'total_sessions': total_sessions,
        'total_conversions': total_conversions,
        'conversion_rate': round(conversion_rate, 2),
        'source_stats': source_stats,
        'campaign_stats': campaign_stats,
        'content_stats': content_stats,
        'funnel_stats': funnel_stats,
        'top_campaigns_by_score': top_campaigns_by_score,
        'top_content_by_conversion': top_content_by_conversion,
        'geo_stats': geo_stats,
        'device_stats': device_stats,
        'visit_stats': {
            'first_visits': first_visits,
            'returning_visits': returning_visits,
            'total_visits': total_visits,
            'returning_rate': round((returning_visits / total_sessions * 100) if total_sessions > 0 else 0, 2),
        },
        'registration_stats': {
            'total_registrations': total_registrations,
            'registration_rate': round(registration_rate, 2),
        },
        'browser_stats': browser_stats,
        'os_stats': os_stats,
        'source_revenue': source_revenue,
    }


def _calculate_funnel_stats(utm_sessions):
    """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≤–æ—Ä–æ–Ω–∫–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–π"""
    
    # –í—Å–µ —Å–µ—Å—Å–∏–∏
    total = utm_sessions.count()
    
    # –ü—Ä–æ—Å–º–æ—Ç—Ä—ã —Ç–æ–≤–∞—Ä–æ–≤
    product_views = UserAction.objects.filter(
        utm_session__in=utm_sessions,
        action_type='product_view'
    ).values('utm_session').distinct().count()
    
    # –î–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É
    add_to_cart = UserAction.objects.filter(
        utm_session__in=utm_sessions,
        action_type='add_to_cart'
    ).values('utm_session').distinct().count()
    
    # –ù–∞—á–∞–ª–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
    checkout = UserAction.objects.filter(
        utm_session__in=utm_sessions,
        action_type='initiate_checkout'
    ).values('utm_session').distinct().count()
    
    # –õ–∏–¥—ã (–ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞)
    leads = UserAction.objects.filter(
        utm_session__in=utm_sessions,
        action_type='lead'
    ).values('utm_session').distinct().count()
    
    # –ü–æ–∫—É–ø–∫–∏
    purchases = UserAction.objects.filter(
        utm_session__in=utm_sessions,
        action_type='purchase'
    ).values('utm_session').distinct().count()
    
    return {
        'total': total,
        'product_views': product_views,
        'add_to_cart': add_to_cart,
        'checkout': checkout,
        'leads': leads,
        'purchases': purchases,
        'product_view_rate': (product_views / total * 100) if total > 0 else 0,
        'cart_rate': (add_to_cart / total * 100) if total > 0 else 0,
        'checkout_rate': (checkout / total * 100) if total > 0 else 0,
        'lead_rate': (leads / total * 100) if total > 0 else 0,
        'purchase_rate': (purchases / total * 100) if total > 0 else 0,
    }


@login_required
def admin_panel(request):
    """–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è admin_panel —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π UTM Analytics"""
    if not request.user.is_staff:
        return redirect('home')
    
    section = request.GET.get('section', 'stats')
    period_param = request.GET.get('period', 'week')
    
    context = {
        'section': section,
        'stats': _build_stats(period_param),
    }
    
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ–∫—Ü–∏–∏ ...
    
    elif section == 'utm_analytics':
        context.update(_build_utm_analytics_context(request, period_param))
        context['section'] = 'utm_analytics'
    
    # ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —à–∞–±–ª–æ–Ω–∞

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑—É—é—â–µ–≥–æ –∞–≥–µ–Ω—Ç–∞. –ù–∏–∂–µ –æ–ø–∏—Å–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–µ—Ä–µ–¥–∞–Ω–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç —à–∞–±–ª–æ–Ω–∞.

#### –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —à–∞–±–ª–æ–Ω–∞:

```python
context = {
    'section': 'utm_analytics',
    'period': 'week',  # 'today', 'week', 'month', 'all_time'
    'start_date': datetime,  # –ù–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞
    
    # –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    'total_sessions': int,
    'total_conversions': int,
    'conversion_rate': float,  # –ü—Ä–æ—Ü–µ–Ω—Ç
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º (–º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤)
    'source_stats': [
        {
            'utm_source': str,
            'sessions': int,
            'conversions': int,
            'conversion_rate': float,
            'avg_score': float,
            'total_revenue': Decimal,  # –°—É–º–º–∞ –∑–∞–∫–∞–∑–æ–≤
            'avg_order_value': Decimal,  # –°—Ä–µ–¥–Ω–∏–π —á–µ–∫
        },
        ...
    ],
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–º–ø–∞–Ω–∏—è–º
    'campaign_stats': [...],
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫—Ä–µ–∞—Ç–∏–≤–∞–º
    'content_stats': [...],
    
    # –í–æ—Ä–æ–Ω–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–π
    'funnel_stats': {
        'total': int,
        'product_views': int,
        'add_to_cart': int,
        'checkout': int,
        'leads': int,
        'purchases': int,
        'product_view_rate': float,
        'cart_rate': float,
        'checkout_rate': float,
        'lead_rate': float,
        'purchase_rate': float,
    },
    
    # –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è
    'geo_stats': [
        {
            'country': str,
            'country_name': str,
            'city': str,
            'sessions': int,
            'conversions': int,
            'conversion_rate': float,
        },
        ...
    ],
    
    # –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
    'device_stats': [
        {
            'device_type': str,  # 'desktop', 'mobile', 'tablet'
            'sessions': int,
            'conversions': int,
            'conversion_rate': float,
        },
        ...
    ],
    
    # –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤–∏–∑–∏—Ç—ã
    'visit_stats': {
        'first_visits': int,
        'returning_visits': int,
        'total_visits': int,
        'returning_rate': float,
    },
    
    # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
    'registration_stats': {
        'total_registrations': int,
        'registration_rate': float,
    },
}
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—é:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –ø–µ—Ä–∏–æ–¥—É (—Å–µ–≥–æ–¥–Ω—è, –Ω–µ–¥–µ–ª—è, –º–µ—Å—è—Ü, –≤–µ—Å—å –ø–µ—Ä–∏–æ–¥)
- –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö (–∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏ –¥–∏–∑–∞–π–Ω –Ω–∞ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑—É—é—â–µ–≥–æ –∞–≥–µ–Ω—Ç–∞)
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ CSV/Excel
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏ (–≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

#### –ü—Ä–∏–º–µ—Ä 1: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

**–í–æ–ø—Ä–æ—Å:** –ö–∞–∫–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Ç—Ä–∞—Ñ–∏–∫–∞ (Meta, Google, TikTok) –ø—Ä–∏–Ω–æ—Å–∏—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–æ–∫—É–ø–æ–∫?

**–î–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–≤–µ—Ç–∞:**
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ –∫–æ–Ω–≤–µ—Ä—Å–∏—è–º —Ç–∏–ø–∞ "purchase"
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫—É–ø–æ–∫, —Å—É–º–º–∞ –∑–∞–∫–∞–∑–æ–≤, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫, –ø—Ä–æ—Ü–µ–Ω—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏–∏

#### –ü—Ä–∏–º–µ—Ä 2: –ê–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫—Ä–µ–∞—Ç–∏–≤–æ–≤

**–í–æ–ø—Ä–æ—Å:** –ö–∞–∫–æ–π —Ä–µ–∫–ª–∞–º–Ω—ã–π –∫—Ä–µ–∞—Ç–∏–≤ (utm_content) –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω?

**–î–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–≤–µ—Ç–∞:**
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫—Ä–µ–∞—Ç–∏–≤–∞–º (utm_content)
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤, –∫–æ–Ω–≤–µ—Ä—Å–∏–∏, —Å—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–ª—å–∫–æ Meta)

#### –ü—Ä–∏–º–µ—Ä 3: –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

**–í–æ–ø—Ä–æ—Å:** –ò–∑ –∫–∞–∫–∏—Ö –≥–æ—Ä–æ–¥–æ–≤ –ø—Ä–∏—Ö–æ–¥—è—Ç –Ω–∞–∏–±–æ–ª–µ–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–æ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏?

**–î–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–≤–µ—Ç–∞:**
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ (–≥–æ—Ä–æ–¥–∞)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º/–∫–∞–º–ø–∞–Ω–∏—è–º
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤, –∫–æ–Ω–≤–µ—Ä—Å–∏–∏, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–æ –≥–æ—Ä–æ–¥–∞–º

#### –ü—Ä–∏–º–µ—Ä 4: –ê–Ω–∞–ª–∏–∑ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

**–í–æ–ø—Ä–æ—Å:** –° –∫–∞–∫–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —á–∞—â–µ –≤—Å–µ–≥–æ —Å–æ–≤–µ—Ä—à–∞—é—Ç—Å—è –ø–æ–∫—É–ø–∫–∏?

**–î–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–≤–µ—Ç–∞:**
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º (desktop, mobile, tablet)
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–π –ø–æ —Ç–∏–ø–∞–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º

#### –ü—Ä–∏–º–µ—Ä 5: –ê–Ω–∞–ª–∏–∑ –≤–æ—Ä–æ–Ω–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–π

**–í–æ–ø—Ä–æ—Å:** –ù–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –≤–æ—Ä–æ–Ω–∫–∏ —Ç–µ—Ä—è–µ—Ç—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?

**–î–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–≤–µ—Ç–∞:**
- –í–æ—Ä–æ–Ω–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–π —Å –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É/–∫–∞–º–ø–∞–Ω–∏–∏/–∫—Ä–µ–∞—Ç–∏–≤—É
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–æ—Ä–æ–Ω–æ–∫ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

#### –ü—Ä–∏–º–µ—Ä 6: –ê–Ω–∞–ª–∏–∑ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤–∏–∑–∏—Ç–æ–≤

**–í–æ–ø—Ä–æ—Å:** –ö–∞–∫–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø—Ä–∏–≤–ª–µ–∫–∞—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –Ω–∞ —Å–∞–π—Ç?

**–î–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–≤–µ—Ç–∞:**
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã–º –≤–∏–∑–∏—Ç–∞–º –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
- –ü—Ä–æ—Ü–µ–Ω—Ç –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏—Ö—Å—è –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π
- –°–≤—è–∑—å –º–µ–∂–¥—É –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –≤–∏–∑–∏—Ç–∞–º–∏ –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—è–º–∏

---

## üîó –ò–ù–¢–ï–ì–†–ê–¶–ò–ò

### 1. –°–≤—è–∑—å —Å –∑–∞–∫–∞–∑–∞–º–∏

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ —Å–≤—è–∑—ã–≤–∞—Ç—å —Å UTM-—Å–µ—Å—Å–∏–µ–π.

```python
# twocomms/storefront/views/checkout.py

def create_order(request):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ ...
    
    # –°–≤—è–∑—ã–≤–∞–µ–º –∑–∞–∫–∞–∑ —Å UTM
    session_key = request.session.session_key
    if session_key:
        try:
            utm_session = UTMSession.objects.get(session_key=session_key)
            order.utm_session = utm_session
            
            # –ö—ç—à–∏—Ä—É–µ–º UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –∑–∞–∫–∞–∑–µ
            order.utm_source = utm_session.utm_source
            order.utm_medium = utm_session.utm_medium
            order.utm_campaign = utm_session.utm_campaign
            order.utm_content = utm_session.utm_content
            order.utm_term = utm_session.utm_term
            
            # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–µ–π—Å—Ç–≤–∏–µ
            if order.payment_status == 'prepaid':
                record_user_action(
                    request,
                    'lead',
                    order_id=order.id,
                    order_number=order.order_number,
                    cart_value=float(order.total_sum)
                )
                utm_session.mark_as_converted(conversion_type='lead')
            elif order.payment_status == 'paid':
                record_user_action(
                    request,
                    'purchase',
                    order_id=order.id,
                    order_number=order.order_number,
                    cart_value=float(order.total_sum)
                )
                utm_session.mark_as_converted(conversion_type='purchase')
        except UTMSession.DoesNotExist:
            pass
    
    order.save()
```

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Meta Pixel

–ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Å–æ–±—ã—Ç–∏—è Meta Pixel.

```javascript
// twocomms/twocomms_django_theme/static/js/analytics-loader.js

// –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–±—ã—Ç–∏—è Purchase
function trackPurchase(orderData) {
    // –ü–æ–ª—É—á–∞–µ–º UTM –∏–∑ data-–∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏–ª–∏ –∏–∑ dataLayer
    const utmParams = {
        utm_source: getUTMParam('utm_source'),
        utm_medium: getUTMParam('utm_medium'),
        utm_campaign: getUTMParam('utm_campaign'),
        utm_content: getUTMParam('utm_content'),
        utm_term: getUTMParam('utm_term'),
    };
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Meta Pixel
    if (typeof fbq !== 'undefined') {
        fbq('track', 'Purchase', {
            value: orderData.value,
            currency: orderData.currency,
            contents: orderData.contents,
            // –î–æ–±–∞–≤–ª—è–µ–º UTM –≤ custom –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
            utm_source: utmParams.utm_source,
            utm_campaign: utmParams.utm_campaign,
            utm_content: utmParams.utm_content,
        });
    }
}

function getUTMParam(name) {
    // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –∏–∑ URL
    const urlParams = new URLSearchParams(window.location.search);
    let value = urlParams.get(name);
    
    // –ï—Å–ª–∏ –Ω–µ—Ç –≤ URL, –ø—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –∏–∑ sessionStorage
    if (!value) {
        value = sessionStorage.getItem(`utm_${name}`);
    }
    
    return value || null;
}
```

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Analytics

```javascript
// –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–±—ã—Ç–∏—è –≤ GA4
gtag('event', 'purchase', {
    transaction_id: orderData.transaction_id,
    value: orderData.value,
    currency: orderData.currency,
    items: orderData.items,
    // UTM –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    campaign_source: getUTMParam('utm_source'),
    campaign_medium: getUTMParam('utm_medium'),
    campaign_name: getUTMParam('utm_campaign'),
    campaign_content: getUTMParam('utm_content'),
    campaign_term: getUTMParam('utm_term'),
});
```

---

## üìà –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø –î–ê–ù–ù–´–•

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Chart.js

#### 1. –í–æ—Ä–æ–Ω–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–π

```javascript
// twocomms/twocomms_django_theme/static/js/utm-analytics.js

function initFunnelChart(funnelData) {
    const ctx = document.getElementById('funnelChart');
    if (!ctx) return;
    
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['–í—Å–µ–≥–æ', '–ü—Ä–æ—Å–º–æ—Ç—Ä—ã —Ç–æ–≤–∞—Ä–æ–≤', '–í –∫–æ—Ä–∑–∏–Ω—É', '–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ', '–õ–∏–¥—ã', '–ü–æ–∫—É–ø–∫–∏'],
            datasets: [{
                label: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ',
                data: [
                    funnelData.total,
                    funnelData.product_views,
                    funnelData.add_to_cart,
                    funnelData.checkout,
                    funnelData.leads,
                    funnelData.purchases
                ],
                backgroundColor: [
                    'rgba(54, 162, 235, 0.8)',
                    'rgba(75, 192, 192, 0.8)',
                    'rgba(255, 206, 86, 0.8)',
                    'rgba(255, 159, 64, 0.8)',
                    'rgba(153, 102, 255, 0.8)',
                    'rgba(255, 99, 132, 0.8)'
                ]
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}
```

#### 2. –ì—Ä–∞—Ñ–∏–∫ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º

```javascript
function initSourceChart(sourceStats) {
    const ctx = document.getElementById('sourceChart');
    if (!ctx) return;
    
    const labels = sourceStats.map(s => s.utm_source || 'N/A');
    const sessions = sourceStats.map(s => s.sessions);
    const conversions = sourceStats.map(s => s.conversions);
    
    new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [
                {
                    label: '–°–µ—Å—Å–∏–∏',
                    data: sessions,
                    borderColor: 'rgb(75, 192, 192)',
                    tension: 0.1
                },
                {
                    label: '–ö–æ–Ω–≤–µ—Ä—Å–∏–∏',
                    data: conversions,
                    borderColor: 'rgb(255, 99, 132)',
                    tension: 0.1
                }
            ]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}
```

#### 3. –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ –∫–∞–º–ø–∞–Ω–∏—è–º

```javascript
function initCampaignChart(campaignStats) {
    const ctx = document.getElementById('campaignChart');
    if (!ctx) return;
    
    const labels = campaignStats.map(c => c.utm_campaign || 'N/A');
    const data = campaignStats.map(c => c.sessions);
    
    new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: labels,
            datasets: [{
                data: data,
                backgroundColor: [
                    'rgba(255, 99, 132, 0.8)',
                    'rgba(54, 162, 235, 0.8)',
                    'rgba(255, 206, 86, 0.8)',
                    'rgba(75, 192, 192, 0.8)',
                    'rgba(153, 102, 255, 0.8)',
                ]
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'right',
                }
            }
        }
    });
}
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–∏–∑–∞–π–Ω –∏ —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑—É—é—â–µ–≥–æ –∞–≥–µ–Ω—Ç–∞. –ù–∏–∂–µ –æ–ø–∏—Å–∞–Ω–∞ —Ç–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–µ—Ä–µ–¥–∞–Ω–∞ –≤ —à–∞–±–ª–æ–Ω.

#### –î–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤:

1. **–í–æ—Ä–æ–Ω–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–π:**
   - –ú–∞—Å—Å–∏–≤ –∑–Ω–∞—á–µ–Ω–∏–π: `[total, product_views, add_to_cart, checkout, leads, purchases]`
   - –ú–∞—Å—Å–∏–≤ –º–µ—Ç–æ–∫: `['–í—Å–µ–≥–æ', '–ü—Ä–æ—Å–º–æ—Ç—Ä—ã —Ç–æ–≤–∞—Ä–æ–≤', '–í –∫–æ—Ä–∑–∏–Ω—É', '–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ', '–õ–∏–¥—ã', '–ü–æ–∫—É–ø–∫–∏']`

2. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º:**
   - –ú–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –ø–æ–ª—è–º–∏: `utm_source`, `sessions`, `conversions`, `conversion_rate`, `avg_score`

3. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–º–ø–∞–Ω–∏—è–º:**
   - –ú–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –ø–æ–ª—è–º–∏: `utm_campaign`, `sessions`, `conversions`, `total_score`

4. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫—Ä–µ–∞—Ç–∏–≤–∞–º:**
   - –ú–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –ø–æ–ª—è–º–∏: `utm_content`, `sessions`, `conversions`, `total_score`

5. **–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è:**
   - –ú–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –ø–æ–ª—è–º–∏: `country`, `country_name`, `city`, `sessions`, `conversions`

6. **–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:**
   - –ú–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –ø–æ–ª—è–º–∏: `device_type`, `sessions`, `conversions`, `conversion_rate`

7. **–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤–∏–∑–∏—Ç—ã:**
   - –û–±—ä–µ–∫—Ç —Å –ø–æ–ª—è–º–∏: `first_visits`, `returning_visits`, `total_visits`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É Chart.js –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å JSON-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–π –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥.

---

## üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ò –£–õ–£–ß–®–ï–ù–ò–Ø

### 1. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

- **–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º:** –†–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É UTM-–∏—Å—Ç–æ—á–Ω–∏–∫—É, –∫–∞–º–ø–∞–Ω–∏–∏ –∏ –∫—Ä–µ–∞—Ç–∏–≤—É
- **LTV (Lifetime Value):** –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø—Ä–∏—à–µ–¥—à–∏—Ö –ø–æ UTM
- **–í—Ä–µ–º—è –¥–æ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏:** –ò–∑–º–µ—Ä—è—Ç—å –≤—Ä–µ–º—è –æ—Ç –ø–µ—Ä–≤–æ–≥–æ –≤–∏–∑–∏—Ç–∞ –¥–æ –ø–æ–∫—É–ø–∫–∏ (–≤ —á–∞—Å–∞—Ö/–¥–Ω—è—Ö)
- **–ì–ª—É–±–∏–Ω–∞ –≤–æ—Ä–æ–Ω–∫–∏:** –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –Ω–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- **–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è:** –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º –∏ –≥–æ—Ä–æ–¥–∞–º (–∫–∞–∫–∏–µ —Ä–µ–≥–∏–æ–Ω—ã –±–æ–ª–µ–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–æ–Ω–Ω—ã–µ)
- **–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:** –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ —Ç–∏–ø–∞–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (desktop vs mobile vs tablet)
- **–ë—Ä–∞—É–∑–µ—Ä—ã –∏ –û–°:** –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –±—Ä–∞—É–∑–µ—Ä–∞–º –∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º —Å–∏—Å—Ç–µ–º–∞–º
- **–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤–∏–∑–∏—Ç—ã:** –ü—Ä–æ—Ü–µ–Ω—Ç –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏—Ö—Å—è –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:** –ü—Ä–æ—Ü–µ–Ω—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –≤–∏–∑–∏—Ç–æ–≤ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
- **–í—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ:** –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º –∏ –∫–∞–º–ø–∞–Ω–∏—è–º
- **–ì–ª—É–±–∏–Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞:** –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- **–û—Ç–∫–∞–∑—ã:** –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–∫–∞–∑–æ–≤ (–≤–∏–∑–∏—Ç—ã —Å –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã)

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á–µ—Ç—ã:** –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ/–µ–∂–µ–º–µ—Å—è—á–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –ø–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–∞–º–ø–∞–Ω–∏–π
- **–ê–ª–µ—Ä—Ç—ã:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–π –∏–ª–∏ —Ä–æ—Å—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è
- **A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ä–∞–∑–Ω—ã—Ö –∫—Ä–µ–∞—Ç–∏–≤–æ–≤

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

- **Google Analytics API:** –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ GA4 –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- **Meta Ads API:** –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ —Ä–∞—Å—Ö–æ–¥–∞—Ö –Ω–∞ —Ä–µ–∫–ª–∞–º—É –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ ROI
- **Google Ads API:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è Google Ads

### 4. –£–ª—É—á—à–µ–Ω–∏–µ UX

- **–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ CSV/Excel
- **–§–∏–ª—å—Ç—Ä—ã:** –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –¥–∞—Ç–∞–º, –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º, –∫–∞–º–ø–∞–Ω–∏—è–º
- **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤:** –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º
- **–î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–µ—Å—Å–∏–∏

### 5. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫
- **–ò–Ω–¥–µ–∫—Å—ã –ë–î:** –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ –ø–æ–ª—è—Ö –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:** –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á–∞—Ö

### 6. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å

- **GDPR compliance:** –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º GDPR
- **–ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (IP-–∞–¥—Ä–µ—Å–∞, User-Agent)
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞:** –¢–æ–ª—å–∫–æ –¥–ª—è staff –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–•—Ä–∞–Ω–µ–Ω–∏–µ IP:** –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è IP-–∞–¥—Ä–µ—Å–æ–≤ –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
- **–°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:** –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 2 –≥–æ–¥–∞)

### 7. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤–∏–∑–∏—Ç–æ–≤ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π

- **–°–≤—è–∑—å —Å–µ—Å—Å–∏–π:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏—é IP + User-Agent + cookies –¥–ª—è —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤–∏–∑–∏—Ç–æ–≤
- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:** –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –º–æ–º–µ–Ω—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Å–≤—è–∑—ã–≤–∞—Ç—å —Å UTM-—Å–µ—Å—Å–∏–µ–π
- **–ú—É–ª—å—Ç–∏—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:** –£—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞—Ö–æ–¥–∏—Ç—å —Å —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **Cross-device tracking:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å email/—Ç–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤—è–∑—ã–≤–∞–Ω–∏—è —Å–µ—Å—Å–∏–π –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

### 8. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ Python-–ø–∞–∫–µ—Ç—ã:**
- `geoip2` - –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –ø–æ IP (—Ç—Ä–µ–±—É–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö GeoLite2)
- `user-agents` - –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ User-Agent
- `django-contrib-gis` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å GeoIP2 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è GeoIP2)

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö GeoLite2:**
- –°–∫–∞—á–∞—Ç—å —Å https://dev.maxmind.com/geoip/geoip2/geolite2/
- –†–∞–∑–º–µ—Å—Ç–∏—Ç—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—É—Ç—å –≤ settings.py

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–π API –¥–ª—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ipapi.co, ip-api.com)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–∏–Ω–≥ User-Agent –±–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ user-agents

---

## üìÖ –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ù–µ–¥–µ–ª—è 1)

- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `geoip2`, `user-agents`
- [ ] –°–∫–∞—á–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö GeoLite2 –¥–ª—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
- [ ] –°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª–∏ `UTMSession` –∏ `UserAction` —Å –ø–æ–ª–Ω—ã–º–∏ –ø–æ–ª—è–º–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è UTM –≤ –º–æ–¥–µ–ª—å `Order`
- [ ] –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `UTMTrackingMiddleware` —Å –ø–æ–ª–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ User-Agent –∏ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞—Ö–≤–∞—Ç UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã—Ö ID, –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏

### –≠—Ç–∞–ø 2: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π (–ù–µ–¥–µ–ª—è 2)

- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `record_user_action`
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤ `add_to_cart`
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤ `create_order`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –±–∞–ª–ª–æ–≤
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤–∏–∑–∏—Ç–æ–≤
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å—å –¥–µ–π—Å—Ç–≤–∏–π

### –≠—Ç–∞–ø 3: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å (–ù–µ–¥–µ–ª—è 3)

- [ ] –°–æ–∑–¥–∞—Ç—å view `_build_utm_analytics_context` —Å –ø–æ–ª–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é `utm_analytics` –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º, –∫–∞–º–ø–∞–Ω–∏—è–º, –∫—Ä–µ–∞—Ç–∏–≤–∞–º
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º, –±—Ä–∞—É–∑–µ—Ä–∞–º
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã–º –≤–∏–∑–∏—Ç–∞–º –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è–º
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–æ—Ä–æ–Ω–∫—É –∫–æ–Ω–≤–µ—Ä—Å–∏–π
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### –≠—Ç–∞–ø 4: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (–ù–µ–¥–µ–ª—è 4)

- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Chart.js –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É
- [ ] –°–æ–∑–¥–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ (–≤–æ—Ä–æ–Ω–∫–∞, –∏—Å—Ç–æ—á–Ω–∏–∫–∏, –∫–∞–º–ø–∞–Ω–∏–∏, –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞)
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ CSV/Excel
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –ø–µ—Ä–∏–æ–¥—É, –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º, –∫–∞–º–ø–∞–Ω–∏—è–º
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é

### –≠—Ç–∞–ø 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è (–ù–µ–¥–µ–ª—è 5)

- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å UTM —Å Meta Pixel
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å UTM —Å Google Analytics
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
- [ ] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –≠—Ç–∞–ø 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–ù–µ–¥–µ–ª—è 6)

- [ ] –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
- [ ] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–æ–≤
- [ ] –ù–∞–ø–∏—Å–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [ ] –û–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
- [ ] –î–µ–ø–ª–æ–π –Ω–∞ production

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ü–ï–†–ï–î –†–ï–ê–õ–ò–ó–ê–¶–ò–ï–ô

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- [ ] Django –≤–µ—Ä—Å–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º–∞
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–∏–ø—ã –ø–æ–ª–µ–π
- [ ] –ï—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ middleware
- [ ] –ï—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- [ ] –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤—Å–µ UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π
- [ ] –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –±–∞–ª–ª–æ–≤
- [ ] –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
- [ ] –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω –¥–∏–∑–∞–π–Ω –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- [ ] –û–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ—Å—Ç—É–ø –∫ UTM Analytics —Ç–æ–ª—å–∫–æ –¥–ª—è staff
- [ ] –ó–∞—â–∏—Ç–∞ –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–∂–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π

---

## üìù –ó–ê–ú–ï–¢–ö–ò

### –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **–ü–æ—Ä—è–¥–æ–∫ middleware:** `UTMTrackingMiddleware` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ü–ï–†–ï–î `SimpleAnalyticsMiddleware` –≤ `settings.MIDDLEWARE`
2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `select_related` –∏ `prefetch_related` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
3. **–ò–Ω–¥–µ–∫—Å—ã –ë–î:** –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª—è—Ö (—Å–º. –º–æ–¥–µ–ª—å UTMSession)
4. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
5. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** Middleware –Ω–µ –¥–æ–ª–∂–µ–Ω –ª–æ–º–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã - –≤—Å–µ –æ—à–∏–±–∫–∏ –¥–æ–ª–∂–Ω—ã –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è, –Ω–æ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
6. **–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è:** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∏–ª–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
7. **–ü–∞—Ä—Å–∏–Ω–≥ User-Agent:** –ú–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ—Å—É—Ä—Å–æ–µ–º–∫–∏–º - –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–µ–≥–∫–æ–≤–µ—Å–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É
8. **–°–µ—Å—Å–∏–∏ Django:** UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Å–µ—Å—Å–∏–∏ Django, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –∏—Å—Ç–µ—á—å - —É—á–∏—Ç—ã–≤–∞—Ç—å —ç—Ç–æ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ
9. **–ú—É–ª—å—Ç–∏—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞—Ö–æ–¥–∏—Ç—å —Å —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ - –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–≤—è–∑—ã–≤–∞—Ç—å –ø–æ email/—Ç–µ–ª–µ—Ñ–æ–Ω—É
10. **–í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –¥–∞–Ω–Ω—ã—Ö:** –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 2 –≥–æ–¥–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–µ–Ω–¥–æ–≤)

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

1. **–ü—Ä–æ–±–ª–µ–º–∞:** UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞—Ö
   - **–†–µ—à–µ–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω—è—Ç—å UTM –≤ —Å–µ—Å—Å–∏–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤–∏–∑–∏—Ç–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö

2. **–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏ –±–æ–ª—å—à–æ–º –æ–±—ä–µ–º–µ –¥–∞–Ω–Ω—ã—Ö
   - **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–≥—Ä–µ–≥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –ë–î

3. **–ü—Ä–æ–±–ª–µ–º–∞:** –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ UTM-—Å–µ—Å—Å–∏–π
   - **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `get_or_create` —Å `session_key` –∫–∞–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º

4. **–ü—Ä–æ–±–ª–µ–º–∞:** –†–∞–∑–Ω—ã–µ IP-–∞–¥—Ä–µ—Å–∞ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ VPN –∏–ª–∏ –ø—Ä–æ–∫—Å–∏
   - **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏—é IP + User-Agent + cookies –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

5. **–ü—Ä–æ–±–ª–µ–º–∞:** –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö IP
   - **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fallback –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ API –∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏

6. **–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ö–æ–¥–∏—Ç —Å —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
   - **–†–µ—à–µ–Ω–∏–µ:** –ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–≤—è–∑—ã–≤–∞—Ç—å —Å–µ—Å—Å–∏–∏ –ø–æ email/—Ç–µ–ª–µ—Ñ–æ–Ω—É

7. **–ü—Ä–æ–±–ª–µ–º–∞:** Meta –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç UTM, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏
   - **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ—Ç–¥–∞–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å –≤ URL

8. **–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ User-Agent –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
   - **–†–µ—à–µ–Ω–∏–µ:** –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É

9. **–ü—Ä–æ–±–ª–µ–º–∞:** –°–µ—Å—Å–∏—è Django –∏—Å—Ç–µ–∫–∞–µ—Ç, UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ—Ä—è—é—Ç—Å—è
   - **–†–µ—à–µ–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω—è—Ç—å UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –ë–î –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤–∏–∑–∏—Ç–µ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –¥–∞–∂–µ –ø–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏

10. **–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ö–æ–¥–∏—Ç —Å —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (–º–æ–±–∏–ª—å–Ω—ã–π ‚Üí desktop)
   - **–†–µ—à–µ–Ω–∏–µ:** –ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–≤—è–∑—ã–≤–∞—Ç—å –≤—Å–µ —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email/—Ç–µ–ª–µ—Ñ–æ–Ω—É, –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å cross-device –ø–æ–≤–µ–¥–µ–Ω–∏–µ

11. **–ü—Ä–æ–±–ª–µ–º–∞:** –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö IP (VPN, –ø—Ä–æ–∫—Å–∏, –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏)
   - **–†–µ—à–µ–Ω–∏–µ:** Graceful degradation - –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã

12. **–ü—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–≥–æ –∑–∞–ø–∏—Å–µ–π –≤ –ë–î, –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
   - **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–≥—Ä–µ–≥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö, —Å–æ–∑–¥–∞–≤–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

13. **–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–Ω—Ñ–ª–∏–∫—Ç –º–µ–∂–¥—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ UTM –æ—Ç Meta –∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏
   - **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ—Ç–¥–∞–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å –≤ URL

14. **–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—á–∏—â–∞–µ—Ç cookies, —Ç–µ—Ä—è–µ—Ç—Å—è —Å–≤—è–∑—å —Å UTM-—Å–µ—Å—Å–∏–µ–π
   - **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏—é IP + User-Agent –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ - –ø–æ email/—Ç–µ–ª–µ—Ñ–æ–Ω—É

---

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –†–ï–°–£–†–°–´

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [Django Models](https://docs.djangoproject.com/en/stable/topics/db/models/)
- [Django Middleware](https://docs.djangoproject.com/en/stable/topics/http/middleware/)
- [Chart.js Documentation](https://www.chartjs.org/docs/latest/)
- [UTM Parameters Guide](https://en.wikipedia.org/wiki/UTM_parameters)

### –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Google Analytics UTM Tracking](https://support.google.com/analytics/answer/1033863)
- [Meta Pixel Best Practices](https://www.facebook.com/business/help/952192354843755)
- [TikTok Pixel Documentation](https://ads.tiktok.com/help/article?aid=10028)

---

**–ö–æ–Ω–µ—Ü –¥–æ–∫—É–º–µ–Ω—Ç–∞**

