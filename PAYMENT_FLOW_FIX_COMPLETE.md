# ‚úÖ –ü–û–õ–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–û–¢–û–ö–ê –û–ü–õ–ê–¢–´

## üîç –ß–¢–û –ë–´–õ–û –ù–ï –¢–ê–ö:

### –ü–†–û–ë–õ–ï–ú–ê 1: –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞
**–°–∏–º–ø—Ç–æ–º:** –û—à–∏–±–∫–∞ 500 –Ω–∞ –≤—Å–µ–º —Å–∞–π—Ç–µ  
**–ü—Ä–∏—á–∏–Ω–∞:** –í `monobank.py` –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª—Å—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `Order` –∏–∑ `storefront.models`  
**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ –£–±—Ä–∞–Ω –∏–º–ø–æ—Ä—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `Order` –∏–∑ `orders.models`

### –ü–†–û–ë–õ–ï–ú–ê 2: –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–≤–∞–ª–∞ –∑–∞–∫–∞–∑ –±–µ–∑ –æ–ø–ª–∞—Ç—ã
**–°–∏–º–ø—Ç–æ–º:** –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "–û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è" –ø–µ—Ä–µ—Ö–æ–¥–∏–ª–æ —Å—Ä–∞–∑—É –Ω–∞ order_success –ë–ï–ó –æ–ø–ª–∞—Ç—ã  
**–ü—Ä–∏—á–∏–Ω–∞:** –ö–Ω–æ–ø–∫–∞ –¥–µ–ª–∞–ª–∞ `submit` —Ñ–æ—Ä–º—ã ‚Üí –≤—ã–∑—ã–≤–∞–ª–∞ `create_order` view ‚Üí —Å–æ–∑–¥–∞–≤–∞–ª–∞ –∑–∞–∫–∞–∑ –±–µ–∑ MonoPay  
**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∫–Ω–æ–ø–∫–∏

---

## ‚úÖ –ß–¢–û –ë–´–õ–û –ò–°–ü–†–ê–í–õ–ï–ù–û:

### 1. –ö–Ω–æ–ø–∫–∏ –æ–ø–ª–∞—Ç—ã (cart.html)

**–ë—ã–ª–æ:**
```html
<button type="submit" form="deliveryForm" id="placeOrderBtn">
```
- Submit –æ—Ç–ø—Ä–∞–≤–ª—è–ª —Ñ–æ—Ä–º—É –Ω–∞ create_order
- –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–≤–∞–ª—Å—è –ë–ï–ó –æ–ø–ª–∞—Ç—ã
- –°—Ä–∞–∑—É —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ success

**–°—Ç–∞–ª–æ:**
```html
<button type="button" id="placeOrderBtn">
```
- type="button" - –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ä–º—É
- JavaScript –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∏ –≤—ã–∑—ã–≤–∞–µ—Ç MonoPay

### 2. JavaScript –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

```javascript
placeOrderBtn.addEventListener('click', function(e) {
    e.preventDefault();
    
    // 1. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
    if (!deliveryForm.checkValidity()) {
        deliveryForm.reportValidity();
        return;
    }
    
    // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –≤—ã–±—Ä–∞–Ω —Ç–∏–ø –æ–ø–ª–∞—Ç—ã
    const payType = document.getElementById('pay_type_auth').value;
    if (!payType) {
        alert('–ë—É–¥—å –ª–∞—Å–∫–∞, –æ–±–µ—Ä—ñ—Ç—å —Ç–∏–ø –æ–ø–ª–∞—Ç–∏!');
        return;
    }
    
    // 3. –í—ã–∑–æ–≤ MonoPay (–¥–ª—è –û–ë–û–ò–• –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤)
    startMonobankPay(placeOrderBtn, statusEl);
});
```

### 3. –§—É–Ω–∫—Ü–∏—è monobank_create_invoice

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã (full_name, phone, city, np_office, pay_type)
2. –°–æ–∑–¥–∞–µ—Ç Order –≤ –ë–î
3. –°–æ–∑–¥–∞–µ—Ç OrderItem'—ã –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
4. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—É–º–º—É –¥–ª—è –æ–ø–ª–∞—Ç—ã:
   - `prepay_200` ‚Üí 200 –≥—Ä–Ω
   - `online_full` ‚Üí –ø–æ–ª–Ω–∞—è —Å—É–º–º–∞
5. –°–æ–∑–¥–∞–µ—Ç Monobank invoice —á–µ—Ä–µ–∑ API
6. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `invoice_url`
7. JavaScript –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ MonoPay

---

## üéØ –ü–†–ê–í–ò–õ–¨–ù–´–ô –ü–û–¢–û–ö –û–ü–õ–ê–¢–´:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ 200 –≥—Ä–Ω
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç "–ü–µ—Ä–µ–¥–ø–ª–∞—Ç–∞ 200 –≥—Ä–Ω"
2. –ù–∞–∂–∏–º–∞–µ—Ç "–í–Ω–µ—Å—Ç–∏ –ø–µ—Ä–µ–¥–ø–ª–∞—Ç—É 200 –≥—Ä–Ω"
3. JavaScript –≤—ã–∑—ã–≤–∞–µ—Ç startMonobankPay()
4. POST /cart/monobank/create-invoice/ —Å pay_type=prepay_200
5. Backend —Å–æ–∑–¥–∞–µ—Ç Order –∏ –∏–Ω–≤–æ–π—Å –Ω–∞ 200 –≥—Ä–Ω
6. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç invoice_url
7. –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ MonoPay
8. –û–ø–ª–∞—Ç–∞ 200 –≥—Ä–Ω
9. MonoPay webhook ‚Üí payment_status = 'prepaid'
10. Facebook Pixel ‚Üí Lead —Å–æ–±—ã—Ç–∏–µ
11. –¢–æ–≤–∞—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è
12. Nova Poshta ‚Üí —Å—Ç–∞—Ç—É—Å "delivered"
13. payment_status = 'paid'
14. Facebook Conversions API ‚Üí Purchase —Å–æ–±—ã—Ç–∏–µ
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ–ª–Ω–∞—è –æ–ø–ª–∞—Ç–∞
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç "–û–Ω–ª–∞–π–Ω –æ–ø–ª–∞—Ç–∞ (–ø–æ–≤–Ω–∞ —Å—É–º–∞)"
2. –ù–∞–∂–∏–º–∞–µ—Ç "–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –æ–ø–ª–∞—Ç–∏"
3. JavaScript –≤—ã–∑—ã–≤–∞–µ—Ç startMonobankPay()
4. POST /cart/monobank/create-invoice/ —Å pay_type=online_full
5. Backend —Å–æ–∑–¥–∞–µ—Ç Order –∏ –∏–Ω–≤–æ–π—Å –Ω–∞ –ø–æ–ª–Ω—É—é —Å—É–º–º—É
6. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç invoice_url
7. –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ MonoPay
8. –û–ø–ª–∞—Ç–∞ –ø–æ–ª–Ω–æ–π —Å—É–º–º—ã
9. MonoPay webhook ‚Üí payment_status = 'paid'
10. Facebook Pixel ‚Üí Purchase —Å–æ–±—ã—Ç–∏–µ
11. order_success –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è
```

---

## üìù –ß–¢–û –ù–£–ñ–ù–û –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–¢–¨:

### –¢–µ—Å—Ç 1: –ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://twocomms.shop/cart/
2. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã
3. –í—ã–±–µ—Ä–∏—Ç–µ "–ü–µ—Ä–µ–¥–ø–ª–∞—Ç–∞ 200 –≥—Ä–Ω"
4. **–û–ñ–ò–î–ê–ï–¢–°–Ø:** –ö–Ω–æ–ø–∫–∞ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ "–í–Ω–µ—Å—Ç–∏ –ø–µ—Ä–µ–¥–ø–ª–∞—Ç—É 200 –≥—Ä–Ω"
5. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É
6. **–û–ñ–ò–î–ê–ï–¢–°–Ø:** –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ MonoPay —Å —Å—É–º–º–æ–π 200 –≥—Ä–Ω
7. –û–ø–ª–∞—Ç–∏—Ç–µ
8. **–û–ñ–ò–î–ê–ï–¢–°–Ø:** –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ order_success

### –¢–µ—Å—Ç 2: –ü–æ–ª–Ω–∞—è –æ–ø–ª–∞—Ç–∞
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://twocomms.shop/cart/
2. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä –Ω–∞ 500 –≥—Ä–Ω)
3. –í—ã–±–µ—Ä–∏—Ç–µ "–û–Ω–ª–∞–π–Ω –æ–ø–ª–∞—Ç–∞ (–ø–æ–≤–Ω–∞ —Å—É–º–∞)"
4. **–û–ñ–ò–î–ê–ï–¢–°–Ø:** –ö–Ω–æ–ø–∫–∞ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ "–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –æ–ø–ª–∞—Ç–∏"
5. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É
6. **–û–ñ–ò–î–ê–ï–¢–°–Ø:** –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ MonoPay —Å –ø–æ–ª–Ω–æ–π —Å—É–º–º–æ–π (500 –≥—Ä–Ω)
7. –û–ø–ª–∞—Ç–∏—Ç–µ
8. **–û–ñ–ò–î–ê–ï–¢–°–Ø:** –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ order_success

### –¢–µ—Å—Ç 3: –ó–µ–ª–µ–Ω–∞—è –∫–Ω–æ–ø–∫–∞ MonoPay
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ—Ä–∑–∏–Ω—É
2. –ù–∞–∂–º–∏—Ç–µ –∑–µ–ª–µ–Ω—É—é –∫–Ω–æ–ø–∫—É "MonoPay" (–≤–Ω–∏–∑—É)
3. **–û–ñ–ò–î–ê–ï–¢–°–Ø:** –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ MonoPay —Å –ü–û–õ–ù–û–ô —Å—É–º–º–æ–π (–≤—Å–µ–≥–¥–∞)

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û - –û–ß–ò–°–¢–ò–¢–ï –ö–ï–® –ë–†–ê–£–ó–ï–†–ê!

–ï—Å–ª–∏ –≤—ã –≤—Å–µ –µ—â–µ –≤–∏–¥–∏—Ç–µ —Å—Ç–∞—Ä–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:

### Chrome/Edge:
1. –ù–∞–∂–º–∏—Ç–µ `Ctrl+Shift+Delete` (Windows) –∏–ª–∏ `Cmd+Shift+Delete` (Mac)
2. –í—ã–±–µ—Ä–∏—Ç–µ "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –¥—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –≤ –∫–µ—à–µ"
3. –ù–∞–∂–º–∏—Ç–µ "–£–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ"
4. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å `Ctrl+F5` (Windows) –∏–ª–∏ `Cmd+Shift+R` (Mac)

### Firefox:
1. –ù–∞–∂–º–∏—Ç–µ `Ctrl+Shift+Delete`
2. –í—ã–±–µ—Ä–∏—Ç–µ "–ö–µ—à"
3. –ù–∞–∂–º–∏—Ç–µ "–£–¥–∞–ª–∏—Ç—å —Å–µ–π—á–∞—Å"
4. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å `Ctrl+F5`

### Safari:
1. –ù–∞–∂–º–∏—Ç–µ `Cmd+Option+E`
2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É

---

## üîß –ï–°–õ–ò –ü–†–û–ë–õ–ï–ú–ê –û–°–¢–ê–ï–¢–°–Ø:

### –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12):

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Console"
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è"
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—ã–≤–æ–¥–∏—Ç—Å—è:

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
=== monobank_create_invoice called ===
Creating Monobank invoice, payload: {...}
‚úÖ Invoice created successfully: https://pay.mbnk.biz/...
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É:**
- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
- –û—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É "Network" –≤ DevTools (F12)
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è"
3. –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –∫ `/cart/monobank/create-invoice/`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - Status Code: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 200
   - Response: –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å `"success": true, "invoice_url": "..."`

**–ï—Å–ª–∏ Status Code = 500:**
- –ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `tail -100 /home/qlknpodo/logs/error_log`

---

## ‚úÖ –°–¢–ê–¢–£–°:

- ‚úÖ –ò–º–ø–æ—Ä—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- ‚úÖ monobank_create_invoice —Å–æ–∑–¥–∞–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ö–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–¥–µ–ª–∞–Ω—ã –Ω–∞ type="button"
- ‚úÖ JavaScript –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã
- ‚úÖ –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- ‚è≥ Webhook - —Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤
- ‚è≥ order_success - —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ–ø–ª–∞—Ç—ã** (—Å –æ—á–∏—Å—Ç–∫–æ–π –∫–µ—à–∞ –±—Ä–∞—É–∑–µ—Ä–∞!)
2. –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ webhook
3. –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞

**–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω, –∫–µ—à –æ—á–∏—â–µ–Ω. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–µ–π—á–∞—Å!** üéâ

