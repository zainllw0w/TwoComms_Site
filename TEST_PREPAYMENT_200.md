# üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ü–†–ï–î–û–ü–õ–ê–¢–´ 200 –ì–†–ù

## ‚úÖ –ß–¢–û –ë–´–õ–û –ò–°–ü–†–ê–í–õ–ï–ù–û:

### 1. JavaScript (main.js)
**–ò–∑–º–µ–Ω–µ–Ω–æ:** Default –∑–Ω–∞—á–µ–Ω–∏–µ —Å `'full'` –Ω–∞ `'online_full'` (3 –º–µ—Å—Ç–∞)
```javascript
// –ë–´–õ–û:
pay_type: getAnyVal('pay_type') || 'full'

// –°–¢–ê–õ–û:
pay_type: getAnyVal('pay_type') || 'online_full'
```

### 2. Backend (monobank.py)
**–î–æ–±–∞–≤–ª–µ–Ω–æ:** –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:
```python
monobank_logger.info(f'Request body: {body}')
monobank_logger.info(f'pay_type from body: {body.get("pay_type")}')
monobank_logger.info(f'Auth user: pay_type from body={body.get("pay_type")}, from profile={prof.pay_type}, final={pay_type}')
```

---

## üß™ –ö–ê–ö –¢–ï–°–¢–ò–†–û–í–ê–¢–¨:

### –®–∞–≥ 1: –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞
**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!** –ë–µ–∑ —ç—Ç–æ–≥–æ –±—É–¥–µ—Ç —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è JavaScript!

**Chrome/Edge:**
1. `Ctrl+Shift+Delete` (Windows) –∏–ª–∏ `Cmd+Shift+Delete` (Mac)
2. –í—ã–±–µ—Ä–∏—Ç–µ "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –¥—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –≤ –∫–µ—à–µ"
3. –ù–∞–∂–º–∏—Ç–µ "–£–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ"
4. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å `Ctrl+F5`

**Firefox:**
1. `Ctrl+Shift+Delete`
2. –í—ã–±–µ—Ä–∏—Ç–µ "–ö–µ—à"
3. –ù–∞–∂–º–∏—Ç–µ "–£–¥–∞–ª–∏—Ç—å —Å–µ–π—á–∞—Å"
4. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å `Ctrl+F5`

### –®–∞–≥ 2: –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Network" —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –∑–∞–ø—Ä–æ—Å—ã

### –®–∞–≥ 3: –¢–µ—Å—Ç –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—ã
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://twocomms.shop/cart/
2. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä –Ω–∞ 500 –≥—Ä–Ω)
3. –í—ã–±–µ—Ä–∏—Ç–µ –≤ —Å–µ–ª–µ–∫—Ç–µ **"–ü–µ—Ä–µ–¥–ø–ª–∞—Ç–∞ 200 –≥—Ä–Ω"**
4. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"–í–Ω–µ—Å—Ç–∏ –ø–µ—Ä–µ–¥–ø–ª–∞—Ç—É 200 –≥—Ä–Ω"**
5. –í Network –Ω–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –∫ `/cart/monobank/create-invoice/`
6. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ:
   - **Request Payload:** –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å `"pay_type": "prepay_200"`
   - **Response:** –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å `"invoice_url": "https://pay.mbnk.biz/..."`
7. **–û–ñ–ò–î–ê–ï–¢–°–Ø:** –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ MonoPay —Å —Å—É–º–º–æ–π **200 –≥—Ä–Ω**
8. **–û–ñ–ò–î–ê–ï–¢–°–Ø:** –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ **"–ü–µ—Ä–µ–¥–ø–ª–∞—Ç–∞ –∑–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è TWC..."**

### –®–∞–≥ 4: –¢–µ—Å—Ç –ø–æ–ª–Ω–æ–π –æ–ø–ª–∞—Ç—ã
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://twocomms.shop/cart/
2. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä –Ω–∞ 500 –≥—Ä–Ω)
3. –í—ã–±–µ—Ä–∏—Ç–µ –≤ —Å–µ–ª–µ–∫—Ç–µ **"–û–Ω–ª–∞–π–Ω –æ–ø–ª–∞—Ç–∞ (–ø–æ–≤–Ω–∞ —Å—É–º–∞)"**
4. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –æ–ø–ª–∞—Ç–∏"**
5. –í Network –Ω–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –∫ `/cart/monobank/create-invoice/`
6. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ:
   - **Request Payload:** –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å `"pay_type": "online_full"`
   - **Response:** –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å `"invoice_url": "..."`
7. **–û–ñ–ò–î–ê–ï–¢–°–Ø:** –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ MonoPay —Å —Å—É–º–º–æ–π **500 –≥—Ä–Ω (–ø–æ–ª–Ω–∞—è)**
8. **–û–ñ–ò–î–ê–ï–¢–°–Ø:** –ù–∞–∑–≤–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∏–Ω–≤–æ–π—Å–µ

---

## üìä –ü–†–û–í–ï–†–ö–ê –õ–û–ì–û–í –ù–ê –°–ï–†–í–ï–†–ï:

–ï—Å–ª–∏ MonoPay –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—É–º–º—É, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
sshpass -p 'trs5m4t1' ssh qlknpodo@195.191.24.169

# –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f ~/logs/django.log | grep -E "monobank_create_invoice|pay_type|Payment amount"

# –ò–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
tail -100 ~/logs/django.log | grep -E "pay_type|Payment amount"
```

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö:**

### –î–ª—è –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—ã 200 –≥—Ä–Ω:
```
Request body: {'full_name': '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤', 'phone': '+380...', 'pay_type': 'prepay_200', ...}
pay_type from body: prepay_200
Auth user: pay_type from body=prepay_200, from profile=online_full, final=prepay_200
Customer data: full_name=–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤, pay_type=prepay_200
Payment amount: 200 (pay_type=prepay_200)  ‚Üê –í–ê–ñ–ù–û! –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 200!
Order created: TWC30102025N01 (ID: 123)
‚úÖ Invoice created successfully: https://pay.mbnk.biz/...
```

### –î–ª—è –ø–æ–ª–Ω–æ–π –æ–ø–ª–∞—Ç—ã:
```
Request body: {'full_name': '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤', 'phone': '+380...', 'pay_type': 'online_full', ...}
pay_type from body: online_full
Auth user: pay_type from body=online_full, from profile=online_full, final=online_full
Customer data: full_name=–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤, pay_type=online_full
Payment amount: 500 (pay_type=online_full)  ‚Üê –ü–æ–ª–Ω–∞—è —Å—É–º–º–∞ —Ç–æ–≤–∞—Ä–æ–≤
Order created: TWC30102025N02 (ID: 124)
‚úÖ Invoice created successfully: https://pay.mbnk.biz/...
```

---

## ‚ùå –ï–°–õ–ò –ù–ï –†–ê–ë–û–¢–ê–ï–¢:

### –ü—Ä–æ–±–ª–µ–º–∞ 1: pay_type –≤ –ª–æ–≥–∞—Ö = `None` –∏–ª–∏ `online_full` –≤–º–µ—Å—Ç–æ `prepay_200`
**–ü—Ä–∏—á–∏–Ω–∞:** JavaScript –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π pay_type  
**–†–µ—à–µ–Ω–∏–µ:** 
1. –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤ —Å–µ–ª–µ–∫—Ç–µ –≤—ã–±—Ä–∞–Ω–æ –∏–º–µ–Ω–Ω–æ `prepay_200`
3. –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –ø—Ä–æ–≤–µ—Ä—å—Ç–µ Request Payload

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –°—É–º–º–∞ –≤ MonoPay –Ω–µ 200 –≥—Ä–Ω
**–ü—Ä–∏—á–∏–Ω–∞:** Backend –ø–æ–ª—É—á–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π pay_type  
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ (—Å–º. –≤—ã—à–µ)
2. –ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É `Payment amount: XXX (pay_type=YYY)`
3. –ï—Å–ª–∏ pay_type != `prepay_200` - –ø—Ä–æ–±–ª–µ–º–∞ –≤ JavaScript
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (Network tab)

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –û—à–∏–±–∫–∞ 500
**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ  
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `tail -100 ~/logs/django.log`
2. –ù–∞–π–¥–∏—Ç–µ traceback –æ—à–∏–±–∫–∏
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏

---

## ‚úÖ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢:

### –ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ 200 –≥—Ä–Ω:
- ‚úÖ –í—ã–±–∏—Ä–∞–µ—Ç–µ "–ü–µ—Ä–µ–¥–ø–ª–∞—Ç–∞ 200 –≥—Ä–Ω" –≤ —Å–µ–ª–µ–∫—Ç–µ
- ‚úÖ –ù–∞–∂–∏–º–∞–µ—Ç–µ "–í–Ω–µ—Å—Ç–∏ –ø–µ—Ä–µ–¥–ø–ª–∞—Ç—É 200 –≥—Ä–Ω"
- ‚úÖ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è MonoPay —Å **—Å—É–º–º–æ–π 200 –≥—Ä–Ω**
- ‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞: **"–ü–µ—Ä–µ–¥–ø–ª–∞—Ç–∞ –∑–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è TWC30102025N01"**
- ‚úÖ –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã: payment_status = 'prepaid'
- ‚úÖ Facebook Pixel ‚Üí Lead —Å–æ–±—ã—Ç–∏–µ

### –ü–æ–ª–Ω–∞—è –æ–ø–ª–∞—Ç–∞:
- ‚úÖ –í—ã–±–∏—Ä–∞–µ—Ç–µ "–û–Ω–ª–∞–π–Ω –æ–ø–ª–∞—Ç–∞ (–ø–æ–≤–Ω–∞ —Å—É–º–∞)" –≤ —Å–µ–ª–µ–∫—Ç–µ
- ‚úÖ –ù–∞–∂–∏–º–∞–µ—Ç–µ "–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –æ–ø–ª–∞—Ç–∏"
- ‚úÖ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è MonoPay —Å **–ø–æ–ª–Ω–æ–π —Å—É–º–º–æ–π** (–Ω–∞–ø—Ä–∏–º–µ—Ä 500 –≥—Ä–Ω)
- ‚úÖ –ù–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤: **"–§—É—Ç–±–æ–ª–∫–∞ S", "–®—Ç–∞–Ω–∏ M"** (—Ä–µ–∞–ª—å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã)
- ‚úÖ –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã: payment_status = 'paid'
- ‚úÖ Facebook Pixel ‚Üí Purchase —Å–æ–±—ã—Ç–∏–µ

---

## üìù –û–¢–ü–†–ê–í–¨–¢–ï –ú–ù–ï:

–ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –æ—Ç–ø—Ä–∞–≤—å—Ç–µ:
1. **–°–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞** (F12 ‚Üí Network ‚Üí –∑–∞–ø—Ä–æ—Å create-invoice)
2. **–õ–æ–≥–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞** (tail -100 ~/logs/django.log | grep pay_type)
3. **–ö–∞–∫—É—é —Å—É–º–º—É –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç MonoPay** (200 –∏–ª–∏ –¥—Ä—É–≥—É—é?)

---

**–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω, –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ!** üöÄ

