# Генерация оптового прайса TwoComms

## Описание
Django management команда для автоматической генерации XLSX-прайса оптовых цен для футболок и худи.

## Использование

### Активация виртуального окружения
```bash
cd /Users/zainllw0w/PycharmProjects/TwoComms
source .venv/bin/activate
cd twocomms
```

### Запуск команды
```bash
python manage.py generate_wholesale_prices --output "Оптові ціни TwoComms.xlsx"
```

## Параметры

- `--output` - путь к выходному XLSX файлу (по умолчанию: `wholesale_prices.xlsx`)

## Что делает команда

1. **Фильтрует товары по категориям:**
   - **Футболки**: категории содержащие "футболка", "tshirt", "t-shirt"
   - **Худи**: категории содержащие "худи", "hoodie", "hooded"

2. **Создает XLSX файл с:**
   - Заголовком с условиями опта
   - Таблицей с колонками: Категория, Товар (S–XL), Артикул, Цвет, Цены по диапазонам
   - Ценами по диапазонам количества:
     - **Футболки**: 750/700/650/600/550 грн
     - **Худи**: 1600/1500/1400/1300/1200 грн

3. **Обрабатывает цвета:**
   - Если у товара есть цветовые варианты, создает отдельную строку для каждого цвета
   - Если цветов нет, создает одну строку без указания цвета

4. **Генерирует артикулы:**
   - Использует поле `sku` если есть, иначе создает `TC-{product_id}`

## Структура файла

- **Строка 1**: Заголовок с условиями опта
- **Строка 2**: Заголовки колонок
- **Строки 3+**: Данные товаров

## Форматирование

- Заголовок: жирный, крупный шрифт, по центру
- Заголовки колонок: жирный шрифт, серая заливка, автофильтр
- Цены: числовой формат, по центру
- Автоширина колонок

## Результат

Создается профессиональный XLSX-прайс, готовый для отправки предпринимателям.
