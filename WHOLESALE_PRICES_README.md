# Генерация оптового прайса TwoComms v2

## Описание
Django management команда для автоматической генерации XLSX-прайса оптовых цен для футболок и худи с обновленными требованиями.

## Использование

### Активация виртуального окружения
```bash
cd /Users/zainllw0w/PycharmProjects/TwoComms
source .venv/bin/activate
cd twocomms
```

### Запуск команды
```bash
python manage.py generate_wholesale_prices --output "Оптові ціни TwoComms v2.xlsx"
```

## Параметры

- `--output` - путь к выходному XLSX файлу (по умолчанию: `wholesale_prices.xlsx`)

## Что делает команда

1. **Фильтрует товары по категориям:**
   - **Футболки**: категории содержащие "футболка", "tshirt", "t-shirt"
   - **Худі**: категории содержащие "худи", "hoodie", "hooded"

2. **Создает XLSX файл с:**
   - Заголовком с условиями опта
   - Таблицей с колонками: Категорія, Товар (S–XL), Артикул, Колір, Дроп (фікс. ціна), Цены по диапазонам, Посилання
   - Ценами по диапазонам количества:
     - **Футболки**: 800 (дроп) / 750/700/650/600/550 грн
     - **Худі**: 1500 (дроп) / 1400/1350/1300/1250/1200 грн

3. **Специальная обработка названий:**
   - **Худі**: добавляет "[фліс]" в конце названия
   - **Футболки**: без дополнительных суффиксов
   - **Изображения**: добавляет "[IMG]" перед названием товара, если есть изображение

4. **Обработка цветов:**
   - **Худі**: всегда "чорний" (независимо от реальных цветов)
   - **Футболки**: реальные цвета товара с автоматическим переводом на украинский
   - **Перевод цветов**: все цвета автоматически переводятся с русского на украинский (80+ вариантов)
   - **Пустые цвета**: если цвет не указан, автоматически ставится "чорний"

5. **Ссылки на товары:**
   - Добавляет прямые ссылки на страницы товаров на сайте

6. **Генерирует артикулы:**
   - Использует поле `sku` если есть, иначе создает `TC-{product_id}`

## Структура файла

- **Строка 1**: Заголовок с условиями опта
- **Строка 2**: Заголовки колонок (включая "Посилання")
- **Строки 3+**: Данные товаров с ссылками

## Форматирование

- Заголовок: жирный, крупный шрифт, по центру
- Заголовки колонок: жирный шрифт, серая заливка, автофильтр
- Цены: числовой формат, по центру
- Автоширина колонок

## Веб-доступ

Прайс доступен по ссылке: `https://twocomms.shop/media/pricelist_opt.xlsx`

## Результат

Создается профессиональный XLSX-прайс с обновленными требованиями, готовый для отправки предпринимателям.
