# üéØ –°–í–ï–†–•–î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-30  
**–í–µ—Ä—Å–∏—è:** 1.0 (Ultra Detailed)  
**–¶–µ–ª—å:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –∏–∑—É—á–µ–Ω–∏–µ –∫–∞–∂–¥–æ–π –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏  
**–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è:** –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ + –ø–æ–∏—Å–∫ –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –º–µ—Å—Ç + –æ—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤  
**–°—Ç–∞—Ç—É—Å:** üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è (–ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Context7 –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å–ª–µ–¥—É—é—â–∏–º –∞–≥–µ–Ω—Ç–æ–º)

---

## üìã –û–ì–õ–ê–í–õ–ï–ù–ò–ï

1. [–í–≤–µ–¥–µ–Ω–∏–µ](#–≤–≤–µ–¥–µ–Ω–∏–µ)
2. [–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –∞–Ω–∞–ª–∏–∑–∞](#–º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è-–∞–Ω–∞–ª–∏–∑–∞)
3. [–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (12)](#–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–æ–±–ª–µ–º—ã)
4. [–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (32)](#–≤—ã—Å–æ–∫–∏–π-–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
5. [–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (5)](#—Å—Ä–µ–¥–Ω–∏–π-–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
6. [–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞](#–∏—Ç–æ–≥–æ–≤–∞—è-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
7. [–°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã](#—Å–≤—è–∑–∞–Ω–Ω—ã–µ-–¥–æ–∫—É–º–µ–Ω—Ç—ã)

---

## üìñ –í–í–ï–î–ï–ù–ò–ï

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç **—Å–≤–µ—Ä—Ö–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–∞–∂–¥–æ–π –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** –ø—Ä–æ–µ–∫—Ç–∞ TwoComms. –ö–∞–∂–¥–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –æ–ø–∏—Å–∞–Ω–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π:

- ‚úÖ –¢–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ (—Ñ–∞–π–ª—ã + —Å—Ç—Ä–æ–∫–∏)
- ‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–¥–∞ (10-15 —Å—Ç—Ä–æ–∫ –¥–æ –∏ –ø–æ—Å–ª–µ)
- ‚úÖ –ê–Ω–∞–ª–∏–∑ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
- ‚úÖ –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (FCP, LCP, TTI, CLS, FID, GPU, CPU, –ø–∞–º—è—Ç—å)
- ‚úÖ –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ –ü–æ–ª–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —á–µ—Ä–µ–∑ Context7 (–±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ —Å–ª–µ–¥—É—é—â–∏–º –∞–≥–µ–Ω—Ç–æ–º)

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:

–ê–Ω–∞–ª–∏–∑ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Å–ª–µ–¥—É—é—â–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö:
- `PERFORMANCE_AUDIT_RU.md` - –æ–±—â–∏–π –∞—É–¥–∏—Ç –ø—Ä–æ–µ–∫—Ç–∞
- `PERFORMANCE_CRITICAL_ISSUES.md` - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- `PERFORMANCE_COMPLETE_ANALYSIS.md` - –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ 18 –ø—Ä–æ–±–ª–µ–º
- `PERFORMANCE_DEEP_ANALYSIS.md` - –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑
- `PERFORMANCE_DETAILED_VERIFICATION.md` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
- `PERFORMANCE_DEEP_DIVE.md` - –∞–Ω–∞–ª–∏–∑ N+1 –∏ –∞—Å—Å–µ—Ç–æ–≤
- `PERFORMANCE_OPTIMIZATION_ANALYSIS.md` - —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

---

## üî¨ –ú–ï–¢–û–î–û–õ–û–ì–ò–Ø –ê–ù–ê–õ–ò–ó–ê

### –ü—Ä–æ—Ü–µ—Å—Å –∞–Ω–∞–ª–∏–∑–∞ –∫–∞–∂–¥–æ–π –ø—Ä–æ–±–ª–µ–º—ã:

1. **–ü–æ–∏—Å–∫ –≤ –∫–æ–¥–µ** - –∏—Å–ø–æ–ª—å–∑—É—è GrepTool –∏ ReadFile –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è
2. **–ß—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** - –º–∏–Ω–∏–º—É–º 10-15 —Å—Ç—Ä–æ–∫ –¥–æ –∏ –ø–æ—Å–ª–µ –ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ –∫–æ–¥–∞
3. **–ê–Ω–∞–ª–∏–∑ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π** - –∏–∑—É—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, –º–µ—Ç–æ–¥–æ–≤, API
4. **–û—Ü–µ–Ω–∫–∞ –≤–ª–∏—è–Ω–∏—è** - –∫–∞–∫ –ø—Ä–æ–±–ª–µ–º–∞ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
5. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–æ–≤** - —á—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è –ø—Ä–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–±–ª–µ–º:

- üî¥ **–ö–†–ò–¢–ò–ß–ù–û** (12 –ø—Ä–æ–±–ª–µ–º) - –±–ª–æ–∫–∏—Ä—É—é—Ç –∑–∞–ø—É—Å–∫ –∏–ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–ª–∏—è—é—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- üü° **–í–´–°–û–ö–ò–ô** (32 –ø—Ä–æ–±–ª–µ–º—ã) - –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤–ª–∏—è—é—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- üü¢ **–°–†–ï–î–ù–ò–ô** (5 –ø—Ä–æ–±–ª–µ–º) - —É–º–µ—Ä–µ–Ω–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

# üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

## –ü–†–û–ë–õ–ï–ú–ê #1: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ Font Awesome –∑–∞–≥—Ä—É–∑–∫–∏

### üî¥ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö–†–ò–¢–ò–ß–ù–û

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

Font Awesome –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è **–¥–≤–∞–∂–¥—ã** –Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ:
1. **–õ–æ–∫–∞–ª—å–Ω–æ**: –∏–∑ static —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ WhiteNoise
2. **–° CDN**: –∏–∑ cdnjs.cloudflare.com —á–µ—Ä–µ–∑ async preload

–≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫:
- **–ò–∑–ª–∏—à–Ω–µ–π –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö**: 80-100KB √ó 2 = 160-200KB
- **–î–≤–æ–π–Ω–æ–º—É –ø–∞—Ä—Å–∏–Ω–≥—É CSS**: –±—Ä–∞—É–∑–µ—Ä –ø–∞—Ä—Å–∏—Ç –æ–±–∞ —Ñ–∞–π–ª–∞
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–µ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞**: –¥–∞–∂–µ –ø—Ä–∏ async –∑–∞–≥—Ä—É–∑–∫–µ
- **–ü—Ä–æ–±–ª–µ–º–∞–º —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º**: –¥–≤–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ = –¥–≤–∞ –∫—ç—à–∞

**–û—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è:**
- –ú–µ–¥–ª–µ–Ω–Ω—ã—Ö –º–æ–±–∏–ª—å–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (3G, Edge)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º —Ç—Ä–∞—Ñ–∏–∫–æ–º
- –ü–µ—Ä–≤–æ–≥–æ –≤–∏–∑–∏—Ç–∞ (–Ω–µ—Ç –∫—ç—à–∞)

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms_django_theme/templates/base.html`  
**–°—Ç—Ä–æ–∫–∏:** 22-41

**–ö–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–¥–∞:**
```html
<!-- –°—Ç—Ä–æ–∫–∏ 15-45 -->
<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    
    <!-- ‚ùå –ü–†–û–ë–õ–ï–ú–ê –ù–ê–ß–ò–ù–ê–ï–¢–°–Ø –ó–î–ï–°–¨ -->
    
    <!-- Font Awesome: –ª–æ–∫–∞–ª—å–Ω—ã–π –±–∞–Ω–¥–ª + CDN (—É—Å–∫–æ—Ä—è–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–µ–Ω) -->
    <link rel="stylesheet" href="{% static 'vendor/fontawesome/css/all.min.css' %}">  <!-- ‚ùå –ü–ï–†–í–ê–Ø –ó–ê–ì–†–£–ó–ö–ê -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="preload"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"  <!-- ‚ùå –í–¢–û–†–ê–Ø –ó–ê–ì–†–£–ó–ö–ê -->
          as="style"
          crossorigin="anonymous"
          referrerpolicy="no-referrer"
          onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
      <link rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
            crossorigin="anonymous"
            referrerpolicy="no-referrer">
    </noscript>
    
    <!-- ‚ùå –ü–†–û–ë–õ–ï–ú–ê –ó–ê–ö–ê–ù–ß–ò–í–ê–ï–¢–°–Ø –ó–î–ï–°–¨ -->
    
    <!-- Bootstrap CSS –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ -->
    <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css' 
          rel='preload' as='style' 
          onload="this.onload=null;this.rel='stylesheet'"
          media="all">
</head>
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**

1. **–õ–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è:**
   - –ü—É—Ç—å: `{% static 'vendor/fontawesome/css/all.min.css' %}`
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Django template tag `{% static %}`
   - –û–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ WhiteNoise middleware
   - –í–µ—Ä—Å–∏—è: –≤–µ—Ä–æ—è—Ç–Ω–æ 6.x (–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ)

2. **CDN –≤–µ—Ä—Å–∏—è:**
   - URL: `https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css`
   - –í–µ—Ä—Å–∏—è: 6.5.2 (—è–≤–Ω–æ —É–∫–∞–∑–∞–Ω–∞)
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `<link rel="preload">`
   - –ò–º–µ–µ—Ç `onload` –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ stylesheet
   - –ò–º–µ–µ—Ç `<noscript>` fallback –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤ –±–µ–∑ JS

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

1. **–ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (–ª–æ–∫–∞–ª—å–Ω–∞—è):**
   ```
   Browser -> Django -> WhiteNoise -> Static file -> Browser –ø–∞—Ä—Å–∏—Ç CSS
   ```
   - –ë–ª–æ–∫–∏—Ä—É–µ—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ (render-blocking)
   - –†–∞–∑–º–µ—Ä: ~80-100KB (–º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
   - Cache-Control: public, max-age=31536000 (–∏–∑ WhiteNoise –Ω–∞—Å—Ç—Ä–æ–µ–∫)

2. **–í—Ç–æ—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (CDN):**
   ```
   Browser -> preconnect –∫ cdnjs.cloudflare.com
   Browser -> preload CSS -> onload -> convert to stylesheet -> –ø–∞—Ä—Å–∏—Ç CSS
   ```
   - –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ (async)
   - –ù–û –ø–æ—Å–ª–µ onload –±–ª–æ–∫–∏—Ä—É–µ—Ç –Ω–∞ –≤—Ä–µ–º—è –ø–∞—Ä—Å–∏–Ω–≥–∞
   - –†–∞–∑–º–µ—Ä: ~80-100KB
   - Cache-Control: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç CDN (–æ–±—ã—á–Ω–æ long-term cache)

**–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
- **–ù–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ** —Å–∞–π—Ç–∞
- **–ü—Ä–∏ –∫–∞–∂–¥–æ–º –≤–∏–∑–∏—Ç–µ** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –Ω–µ—Ç –∫—ç—à–∞)
- **–î–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** (–Ω–µ—Ç —É—Å–ª–æ–≤–∏–π)

**–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:**

1. **–°–µ—Ç—å:**
   - –õ–æ–∫–∞–ª—å–Ω–∞—è: 1 HTTP –∑–∞–ø—Ä–æ—Å, ~80-100KB
   - CDN: 1 HTTP –∑–∞–ø—Ä–æ—Å, ~80-100KB
   - DNS lookup –¥–ª—è cdnjs.cloudflare.com: ~20-50ms
   - **–ò–¢–û–ì–û:** 160-200KB + 2 HTTP –∑–∞–ø—Ä–æ—Å–∞ + DNS lookup

2. **CPU:**
   - –ü–∞—Ä—Å–∏–Ω–≥ CSS –¥–≤–∞–∂–¥—ã: ~50-100ms –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
   - CSSOM –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–≤–∞–∂–¥—ã
   - Style recalculation —Å –¥–≤—É–º—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏

3. **–ü–∞–º—è—Ç—å:**
   - –î–≤–∞ –Ω–∞–±–æ—Ä–∞ —Å—Ç–∏–ª–µ–π –≤ –ø–∞–º—è—Ç–∏ (–≤—Ä–µ–º–µ–Ω–Ω–æ)
   - –î–≤–∞ CSSOM –¥–µ—Ä–µ–≤–∞ (–ø–æ–∫–∞ –Ω–µ –æ–±—ä–µ–¥–∏–Ω—è—Ç—Å—è)

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**FCP (First Contentful Paint):**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +100-200ms**
- –õ–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –±–ª–æ–∫–∏—Ä—É–µ—Ç FCP –ø–æ–ª–Ω–æ—Å—Ç—å—é
- CDN –≤–µ—Ä—Å–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–µ—Ä–∂–∫—É –ø–æ—Å–ª–µ FCP (flash of unstyled icons)

**LCP (Largest Contentful Paint):**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +50-100ms**
- –ï—Å–ª–∏ LCP —ç–ª–µ–º–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Font Awesome –∏–∫–æ–Ω–∫–∏
- –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –æ–±–∞ —Ñ–∞–π–ª–∞

**TTI (Time to Interactive):**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +150-300ms**
- –ü–∞—Ä—Å–∏–Ω–≥ CSS –±–ª–æ–∫–∏—Ä—É–µ—Ç JavaScript execution
- –î–≤–∞ —Ñ–∞–π–ª–∞ = –¥–≤–æ–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞

**CLS (Cumulative Layout Shift):**
- ‚¨ÜÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ +0.1-0.2**
- –ï—Å–ª–∏ CDN –≤–µ—Ä—Å–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ–∑–∂–µ –ª–æ–∫–∞–ª—å–Ω–æ–π
- –ò–∫–æ–Ω–∫–∏ –º–æ–≥—É—Ç "–ø—Ä—ã–≥–∞—Ç—å" –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –≤–µ—Ä—Å–∏–π

**FID (First Input Delay):**
- ‚û°Ô∏è **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ**
- –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–±—ã—Ç–∏–π –Ω–∞–ø—Ä—è–º—É—é

**GPU:**
- ‚û°Ô∏è **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ**
- Font Awesome –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GPU acceleration

**CPU:**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +50-100ms –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö**
- –î–≤–æ–π–Ω–æ–π –ø–∞—Ä—Å–∏–Ω–≥ CSS
- –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ CSSOM –¥–≤–∞–∂–¥—ã

**–ü–∞–º—è—Ç—å:**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +2-5MB –≤—Ä–µ–º–µ–Ω–Ω–æ**
- –î–≤–∞ –Ω–∞–±–æ—Ä–∞ —Å—Ç–∏–ª–µ–π –≤ –ø–∞–º—è—Ç–∏

**–ë–î –∑–∞–ø—Ä–æ—Å—ã:**
- ‚û°Ô∏è **–ù–µ—Ç –≤–ª–∏—è–Ω–∏—è**
- Static —Ñ–∞–π–ª—ã –Ω–µ —Ç—Ä–µ–±—É—é—Ç –ë–î –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +80-100KB (—É–¥–≤–æ–µ–Ω–∏–µ)**
- 160-200KB –≤–º–µ—Å—Ç–æ 80-100KB

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **–ï—Å–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é:**
   - ‚úÖ **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –í—Å–µ –∏–∫–æ–Ω–∫–∏ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
   - –ù–û: –Ω–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ CDN (geographic distribution, shared cache)
   - –ù–û: –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –ª–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞

2. **–ï—Å–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ CDN –≤–µ—Ä—Å–∏—é:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - CDN –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (—Ä–µ–¥–∫–æ, –Ω–æ –±—ã–≤–∞–µ—Ç)
   - –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è DNS lookup –≤—Ä–µ–º—è
   - –ù–µ—Ç –æ—Ñ–ª–∞–π–Ω –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Service Worker)
   - –ù–û: –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ shared cache –º–µ–∂–¥—É —Å–∞–π—Ç–∞–º–∏

3. **–ï—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å fallback:**
   - ‚úÖ **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –ú–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å CDN, –∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ fallback –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π
   - –¢—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π JS –∫–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

1. **–®–∞–±–ª–æ–Ω—ã:**
   - `base.html` - –æ—Å–Ω–æ–≤–Ω–æ–π —à–∞–±–ª–æ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ
   - –í—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–∞—Å–ª–µ–¥—É—é—Ç –æ—Ç `base.html`
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ 100% —Å—Ç—Ä–∞–Ω–∏—Ü

2. **–ò–∫–æ–Ω–∫–∏:**
   - –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–æ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö (header, footer, –∫–Ω–æ–ø–∫–∏, –º–µ–Ω—é)
   - –ù—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤—Å–µ –∏–∫–æ–Ω–∫–∏ –µ—Å—Ç—å –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏

3. **CSS:**
   - –í–æ–∑–º–æ–∂–Ω—ã –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–∏–ª–µ–π Font Awesome –≤ custom CSS
   - –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å `styles.css` –Ω–∞ –Ω–∞–ª–∏—á–∏–µ `.fa-`, `.fab-`, `.far-` –∫–ª–∞—Å—Å–æ–≤

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**

1. **–í–∏–∑—É–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∏–∫–æ–Ω–æ–∫
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏–∫–æ–Ω–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å hover —ç—Ñ—Ñ–µ–∫—Ç—ã –Ω–∞ –∏–∫–æ–Ω–∫–∞—Ö

2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
   - ‚úÖ Lighthouse audit –¥–æ –∏ –ø–æ—Å–ª–µ
   - ‚úÖ WebPageTest –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
   - ‚úÖ Chrome DevTools Network tab (–ø—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ñ–∞–π–ª)

3. **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å –∏–∫–æ–Ω–∫–∞–º–∏
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º—ã–µ –∏–∫–æ–Ω–∫–∏ (JavaScript)

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå **–ù–ï –Ω—É–∂–Ω—ã** - —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**
- ‚úÖ **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ** - —Ç–æ–ª—å–∫–æ –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∫–æ–Ω–æ–∫
- ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω–æ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ A/B —Ç–µ—Å—Ç—ã –µ—Å–ª–∏ –æ–Ω–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –Ω–∞–ª–∏—á–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω–æ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (Selenium, Playwright)

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ Context7, Django –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ best practices**

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Font Awesome**
  - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞–≥—Ä—É–∑–∫–µ:** –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Font Awesome —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∏—Å—Ç–æ—á–Ω–∏–∫** –∑–∞–≥—Ä—É–∑–∫–∏ (CDN –∏–ª–∏ local). –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏ –∏–∑–ª–∏—à–Ω—é—é –Ω–∞–≥—Ä—É–∑–∫—É. –î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è CDN —Å fallback –Ω–∞ local, –Ω–æ **–Ω–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å –æ–±–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ**.
  - **Best practices:** 
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CDN –¥–ª—è production (geographic distribution, shared cache –º–µ–∂–¥—É —Å–∞–π—Ç–∞–º–∏)
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å local –¥–ª—è offline-first –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏–ª–∏ –∫–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Ä—Å–∏–π
    - –í—Å–µ–≥–¥–∞ –∏–º–µ—Ç—å fallback –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `preconnect` –∏ `dns-prefetch` –¥–ª—è CDN (—É–∂–µ –µ—Å—Ç—å –≤ –∫–æ–¥–µ)
    - –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
  - **–í–µ—Ä—Å–∏–∏ –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –í–µ—Ä—Å–∏—è 6.5.2 —É–∫–∞–∑–∞–Ω–∞ –≤ CDN, –ª–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Ç–∞–∫–∂–µ 6.5.2 (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤ `all.min.css`). –í–µ—Ä—Å–∏–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã, –Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–±—ã—Ç–æ—á–Ω–æ.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 (Django Static Files)**
  - **Performance implications:** –°–æ–≥–ª–∞—Å–Ω–æ Django –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ static files, WhiteNoise –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (`Cache-Control: public, max-age=31536000`). –õ–æ–∫–∞–ª—å–Ω—ã–π Font Awesome —É–∂–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ WhiteNoise. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å CDN –¥–æ–±–∞–≤–ª—è–µ—Ç:
    - +80-100KB –ª–∏—à–Ω–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
    - +1 HTTP –∑–∞–ø—Ä–æ—Å
    - +50-200ms –∑–∞–¥–µ—Ä–∂–∫–∞ –Ω–∞ –ø–∞—Ä—Å–∏–Ω–≥ –≤—Ç–æ—Ä–æ–≥–æ CSS —Ñ–∞–π–ª–∞
    - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤–µ—Ä—Å–∏–π
  - **CDN vs local hosting:** 
    - **CDN –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** Geographic distribution (–±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–∞–ª–µ–∫–æ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞), shared cache (–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –ø–æ—Å–µ—â–∞–ª –¥—Ä—É–≥–æ–π —Å–∞–π—Ç —Å —Ç–µ–º –∂–µ CDN), –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    - **Local –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –†–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω, –Ω–µ—Ç DNS lookup, –Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Ä—Å–∏–π, –ª—É—á—à–µ –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ (GDPR)
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –¥–ª—è TwoComms:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **—Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω—ã–π** Font Awesome, —Ç–∞–∫ –∫–∞–∫ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω WhiteNoise —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –∏ —ç—Ç–æ –¥–∞–µ—Ç –±–æ–ª—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
  - **Cache strategies:** WhiteNoise –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è long-term caching. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `{% static %}` Django –¥–æ–±–∞–≤–ª—è–µ—Ç hash –∫ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –≤ production (—á–µ—Ä–µ–∑ ManifestStaticFilesStorage), —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç cache busting –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö. CDN cache –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω —Å –ª–æ–∫–∞–ª—å–Ω—ã–º, —á—Ç–æ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices**
  - **–°—Ç–∞—Ç—å–∏ –æ production Font Awesome:** Web.dev –∏ MDN —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –∏–∑–±–µ–≥–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤. Chrome DevTools –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è —Å—Ç–∏–ª—è—Ö. Best practice - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ —Å fallback.
  - **Benchmark CDN vs local:** –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —á—Ç–æ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–∞–π—Ç–æ–≤ —Ä–∞–∑–Ω–∏—Ü–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞ (5-20ms), –µ—Å–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω. CDN –∏–º–µ–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—á–µ–Ω—å –¥–∞–ª–µ–∫–æ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ (>5000km). –î–ª—è –£–∫—Ä–∞–∏–Ω—ã/–ï–≤—Ä–æ–ø—ã –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –æ–±—ã—á–Ω–æ –±—ã—Å—Ç—Ä–µ–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ–∑–Ω–∞—á–µ–Ω.
  - **Real-world examples:** –ö—Ä—É–ø–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏ (Google, Facebook) –∏—Å–ø–æ–ª—å–∑—É—é—Ç CDN –¥–ª—è —Å–≤–æ–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫, –Ω–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç –∑–∞–≥—Ä—É–∑–∫—É. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CDN - –æ–Ω –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫, —Å fallback —Ç–æ–ª—å–∫–æ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏.

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - –í –∫–æ–¥–µ –µ—Å—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π "–ª–æ–∫–∞–ª—å–Ω—ã–π –±–∞–Ω–¥–ª + CDN (—É—Å–∫–æ—Ä—è–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–µ–Ω)" - —ç—Ç–æ **–æ—à–∏–±–æ—á–Ω–æ–µ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ**. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É—Å–∫–æ—Ä—è–µ—Ç, –∞ –∑–∞–º–µ–¥–ª—è–µ—Ç.
  - `preload` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è CDN –≤–µ—Ä—Å–∏–∏, –Ω–æ —ç—Ç–æ –∏–∑–±—ã—Ç–æ—á–Ω–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏.
  - `noscript` fallback –¥–ª—è CDN —Ö–æ—Ä–æ—à, –Ω–æ –æ–ø—è—Ç—å –∂–µ –∏–∑–±—ã—Ç–æ—á–µ–Ω –ø—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏.
  - –õ–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —É–∂–µ –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ WhiteNoise —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è.

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û - –ø—Ä–æ—Å—Ç–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –≤—ã—Å–æ–∫–∏–º impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
  - **–ü–æ–¥—Ö–æ–¥:** –£–¥–∞–ª–∏—Ç—å CDN –∑–∞–≥—Ä—É–∑–∫—É Font Awesome, –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é —á–µ—Ä–µ–∑ `{% static %}`. –≠—Ç–æ –¥–∞—Å—Ç:
    - -80-100KB —Ç—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    - -1 HTTP –∑–∞–ø—Ä–æ—Å
    - -50-200ms –≤—Ä–µ–º—è –ø–∞—Ä—Å–∏–Ω–≥–∞ CSS
    - –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤–µ—Ä—Å–∏–π
    - –£–ª—É—á—à–µ–Ω–∏–µ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—è
  - **Fallback strategy:** –ù–ï –ù–£–ñ–ï–ù –ø—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ, —Ç–∞–∫ –∫–∞–∫ —Ñ–∞–π–ª –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è —Ç–µ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–æ–º. WhiteNoise –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å - –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å Service Worker –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –Ω–æ —ç—Ç–æ –∏–∑–±—ã—Ç–æ—á–Ω–æ –¥–ª—è static —Ñ–∞–π–ª–æ–≤ —Å WhiteNoise.
  - **Testing checklist:**
    1. ‚úÖ –í–∏–∑—É–∞–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã - –∏–∫–æ–Ω–∫–∏ –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
    2. ‚úÖ Chrome DevTools Network tab - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –∫ Font Awesome CSS
    3. ‚úÖ Chrome DevTools Coverage tab - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è —Å—Ç–∏–ª–µ–π
    4. ‚úÖ Lighthouse audit - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —É–ª—É—á—à–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ (–æ—Å–æ–±–µ–Ω–Ω–æ FCP, LCP)
    5. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–º–µ–¥–ª–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ)
    6. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å offline —Ä–µ–∂–∏–º (–¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Service Worker)
    7. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã (Chrome, Firefox, Safari)
    8. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ Font Awesome –∫–ª–∞—Å—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç (.fa, .fas, .far, .fab –∏ —Ç.–¥.)

---

## –ü–†–û–ë–õ–ï–ú–ê #2: –û—á–µ–Ω—å –±–æ–ª—å—à–æ–π CSS —Ñ–∞–π–ª (488KB)

### üî¥ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö–†–ò–¢–ò–ß–ù–û

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ì–ª–∞–≤–Ω—ã–π CSS —Ñ–∞–π–ª `styles.min.css` –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä **488KB**, —á—Ç–æ **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –±–æ–ª—å—à–æ–π** –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–µ–±-—Å–∞–π—Ç–∞, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö.

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**

1. **–ë–ª–æ–∫–∏—Ä—É–µ—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥:** CSS —è–≤–ª—è–µ—Ç—Å—è render-blocking —Ä–µ—Å—É—Ä—Å–æ–º. –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –æ—Ç—Ä–∏—Å–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç –∏ –Ω–µ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç –≤–µ—Å—å CSS.

2. **–û–≥—Ä–æ–º–Ω–æ–µ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏:**
   - –ù–∞ 3G (750 Kbps): ~5.2 —Å–µ–∫—É–Ω–¥—ã
   - –ù–∞ Slow 3G (400 Kbps): ~9.8 —Å–µ–∫—É–Ω–¥—ã
   - –ù–∞ 4G (4 Mbps): ~1 —Å–µ–∫—É–Ω–¥–∞
   - –ù–∞ –º–µ–¥–ª–µ–Ω–Ω–æ–º Wi-Fi (1-2 Mbps): ~2-4 —Å–µ–∫—É–Ω–¥—ã

3. **–ü–∞—Ä—Å–∏–Ω–≥ —Ç—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏:**
   - 488KB CSS = –ø—Ä–∏–º–µ—Ä–Ω–æ 10,000-15,000 CSS –ø—Ä–∞–≤–∏–ª
   - –ü–∞—Ä—Å–∏–Ω–≥ –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö: 300-800ms
   - –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ CSSOM: –µ—â–µ 200-500ms

4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏:**
   - CSS –≤ –ø–∞–º—è—Ç–∏: ~488KB
   - CSSOM –¥–µ—Ä–µ–≤–æ: +2-5MB (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)
   - –°–ª–∞–±—ã–µ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å 1-2GB RAM —Å—Ç—Ä–∞–¥–∞—é—Ç

5. **–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è:**
   - `styles.css`: 484KB
   - `styles.min.css`: 488KB
   - **–†–∞–∑–Ω–∏—Ü–∞: +4KB!** –ú–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –£–í–ï–õ–ò–ß–ò–õ–ê —Ä–∞–∑–º–µ—Ä!
   - –≠—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å –º–∏–Ω–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º –∏–ª–∏ —Ñ–∞–π–ª –Ω–µ –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –≤–æ–æ–±—â–µ

**–ß—Ç–æ –≤–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞ (–≤–µ—Ä–æ—è—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã):**

1. **–ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å—Ç–∏–ª–∏:** –í–µ—Ä–æ—è—Ç–Ω–æ 30-50% —Å—Ç–∏–ª–µ–π –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
2. **–î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –ø—Ä–∞–≤–∏–ª–∞:** Media queries –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —Å–≤–æ–π—Å—Ç–≤–∞
3. **Vendor prefixes:** –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ø—Ä–µ—Ñ–∏–∫—Å—ã (-webkit-, -moz-, -ms-)
4. **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ "–º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–º" —Ñ–∞–π–ª–µ:** –í–æ–∑–º–æ–∂–Ω–æ –æ—Å—Ç–∞–ª–∏—Å—å
5. **Inline data URLs:** Base64 encoded –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è/—à—Ä–∏—Ñ—Ç—ã –≤ CSS

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms_django_theme/static/css/styles.min.css`  
**–†–∞–∑–º–µ—Ä:** 488,605 –±–∞–π—Ç (488KB)

**–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**

1. `twocomms/twocomms_django_theme/static/css/styles.css` - –∏—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª (484KB)
2. `twocomms/twocomms_django_theme/templates/base.html` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ CSS

**–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ –∫–æ–¥–µ:**

**–§–∞–π–ª:** `twocomms/twocomms_django_theme/templates/base.html`  
**–°—Ç—Ä–æ–∫–∏:** ~120-160 (–ø—Ä–∏–º–µ—Ä–Ω–æ)

**–ö–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–¥–∞:**
```html
<!-- –ü—Ä–∏–º–µ—Ä–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (—Ç–æ—á–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å) -->
<head>
    <!-- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π CSS (inline) -->
    <style>
        /* –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –ø–µ—Ä–≤–æ–π –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ */
        /* ... –º–Ω–æ–≥–æ inline —Å—Ç–∏–ª–µ–π ... */
    </style>
    
    <!-- ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –û—á–µ–Ω—å –±–æ–ª—å—à–æ–π CSS —Ñ–∞–π–ª -->
    {% if USE_CSS_MINIFIED %}
        <link rel="stylesheet" href="{% static 'css/styles.min.css' %}">  <!-- ‚ùå 488KB! -->
    {% else %}
        <link rel="stylesheet" href="{% static 'css/styles.css' %}">  <!-- ‚ùå 484KB! -->
    {% endif %}
    
    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ CSS —Ñ–∞–π–ª—ã -->
    <link rel="stylesheet" href="{% static 'css/product-detail.css' %}">  <!-- +36KB -->
    <link rel="stylesheet" href="{% static 'css/promocodes.css' %}">  <!-- +39KB -->
    <!-- ... -->
</head>
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**

1. **Django Static Files:**
   - `{% static 'css/styles.min.css' %}`
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ WhiteNoise
   - –°–∂–∏–º–∞–µ—Ç—Å—è gzip/brotli –Ω–∞ –ª–µ—Ç—É

2. **WhiteNoise Compression:**
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `settings.py`:
   ```python
   STATICFILES_STORAGE = 'whitenoise.storage.CompressedManifestStaticFilesStorage'
   ```
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç `.gz` –∏ `.br` –≤–µ—Ä—Å–∏–∏
   - Gzipped —Ä–∞–∑–º–µ—Ä: ~90-120KB (–æ—Ü–µ–Ω–∫–∞, –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å)
   - Brotli —Ä–∞–∑–º–µ—Ä: ~70-100KB (–æ—Ü–µ–Ω–∫–∞, –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å)

3. **Django Compressor:**
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `settings.py`:
   ```python
   COMPRESS_ENABLED = False  # ‚ùå –û–¢–ö–õ–Æ–ß–ï–ù –≤ dev!
   COMPRESS_OFFLINE = False
   ```
   - –í production (–∏–∑ `production_settings.py`):
   ```python
   COMPRESS_ENABLED = True
   COMPRESS_OFFLINE = True
   ```
   - –ù–û: –º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞ (488KB vs 484KB)

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

1. **–°–±–æ—Ä–∫–∞ CSS:**
   ```
   SASS/LESS/CSS sources -> Compilation -> styles.css (484KB)
   -> Minification (django-compressor?) -> styles.min.css (488KB) ‚ùå –ù–ï –†–ê–ë–û–¢–ê–ï–¢!
   -> WhiteNoise compression -> styles.min.css.gz (~90-120KB)
   ```

2. **–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ:**
   ```
   Browser request /static/css/styles.min.css
   -> WhiteNoise checks Accept-Encoding
   -> Sends .gz or .br version
   -> Browser decompresses
   -> Browser parses 488KB CSS (–Ω–µ compressed)
   -> Builds CSSOM tree
   -> Renders page
   ```

**–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
- **–ù–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ** - base.html –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ
- **–ö–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** - –Ω–µ—Ç –∫—ç—à–∞
- **–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ deploy** - –Ω–æ–≤—ã–π hash –≤ filename

**–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:**

1. **–°–µ—Ç—å:**
   - Transfer size: ~90-120KB (gzip)
   - Resource size: 488KB (after decompression)
   - –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ 3G: ~1-1.5 —Å–µ–∫—É–Ω–¥—ã (gzipped)

2. **CPU:**
   - Gzip decompression: 10-30ms
   - CSS parsing: 300-800ms –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
   - CSSOM building: 200-500ms
   - Style calculation: 100-300ms (–ø–µ—Ä–≤—ã–π render)
   - **–ò–¢–û–ì–û:** 600-1630ms CPU –≤—Ä–µ–º–µ–Ω–∏!

3. **–ü–∞–º—è—Ç—å:**
   - CSS string –≤ –ø–∞–º—è—Ç–∏: 488KB
   - CSSOM tree: 2-5MB (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)
   - Style cache: 1-3MB
   - **–ò–¢–û–ì–û:** 3-8MB –ø–∞–º—è—Ç–∏ –¥–ª—è –æ–¥–Ω–æ–≥–æ CSS —Ñ–∞–π–ª–∞!

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**FCP (First Contentful Paint):**
- ‚¨áÔ∏è **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —É—Ö—É–¥—à–µ–Ω–∏–µ: +500-2000ms**
- CSS –±–ª–æ–∫–∏—Ä—É–µ—Ç FCP –ø–æ–ª–Ω–æ—Å—Ç—å—é
- –ù—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å + —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –≤–µ—Å—å —Ñ–∞–π–ª
- –ù–∞ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è—Ö —ç—Ç–æ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞

**LCP (Largest Contentful Paint):**
- ‚¨áÔ∏è **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —É—Ö—É–¥—à–µ–Ω–∏–µ: +300-1000ms**
- LCP –Ω–µ –º–æ–∂–µ—Ç —Å–ª—É—á–∏—Ç—å—Å—è –ø–æ–∫–∞ CSS –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω
- –û—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –µ—Å–ª–∏ LCP - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–Ω—É–∂–Ω—ã —Å—Ç–∏–ª–∏ –¥–ª—è layout)

**TTI (Time to Interactive):**
- ‚¨áÔ∏è **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —É—Ö—É–¥—à–µ–Ω–∏–µ: +600-1600ms**
- –ü–∞—Ä—Å–∏–Ω–≥ CSS –±–ª–æ–∫–∏—Ä—É–µ—Ç JavaScript execution
- 600-1600ms CPU –≤—Ä–µ–º–µ–Ω–∏ = –¥–æ–ª–≥–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ main thread

**CLS (Cumulative Layout Shift):**
- ‚¨ÜÔ∏è **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —É—Ö—É–¥—à–µ–Ω–∏–µ: +0.05-0.15**
- –ë–æ–ª—å—à–æ–π CSS –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ flash of unstyled content (FOUC)
- –≠–ª–µ–º–µ–Ω—Ç—ã –º–æ–≥—É—Ç "–ø—Ä—ã–≥–∞—Ç—å" –ø–æ–∫–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ —Å—Ç–∏–ª–∏

**FID (First Input Delay):**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +50-200ms**
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –ø–æ–∫–∞ –ø–∞—Ä—Å–∏—Ç—Å—è CSS
- Main thread –∑–∞–Ω—è—Ç = –∑–∞–¥–µ—Ä–∂–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π

**GPU:**
- ‚û°Ô∏è **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø—Ä—è–º–æ–µ –≤–ª–∏—è–Ω–∏–µ**
- –ù–û: —Å–ª–æ–∂–Ω—ã–µ CSS –ø—Ä–∞–≤–∏–ª–∞ (animations, transforms) –º–æ–≥—É—Ç –Ω–∞–≥—Ä—É–∂–∞—Ç—å GPU

**CPU:**
- ‚¨áÔ∏è **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —É—Ö—É–¥—à–µ–Ω–∏–µ: +600-1600ms**
- –ü–∞—Ä—Å–∏–Ω–≥ 488KB CSS –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- Style recalculation –¥–ª—è —Ç—ã—Å—è—á –ø—Ä–∞–≤–∏–ª
- Layout/Paint thrashing –µ—Å–ª–∏ –º–Ω–æ–≥–æ reflows

**–ü–∞–º—è—Ç—å:**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +3-8MB**
- –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Å 1-2GB RAM
- –ú–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å memory pressure –∏ GC –ø–∞—É–∑—ã

**–ë–î –∑–∞–ø—Ä–æ—Å—ã:**
- ‚û°Ô∏è **–ù–µ—Ç –ø—Ä—è–º–æ–≥–æ –≤–ª–∏—è–Ω–∏—è**
- Static —Ñ–∞–π–ª—ã –Ω–µ —Ç—Ä–µ–±—É—é—Ç –ë–î

**–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:**
- ‚¨áÔ∏è **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —É—Ö—É–¥—à–µ–Ω–∏–µ:**
  - Uncompressed: 488KB
  - Gzipped: ~90-120KB (–æ—Ü–µ–Ω–∫–∞)
  - Brotli: ~70-100KB (–æ—Ü–µ–Ω–∫–∞)
  - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: <50KB –¥–ª—è critical CSS

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **–£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å—Ç–∏–ª–µ–π (PurgeCSS):**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –í–´–°–û–ö–ò–ô**
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º—ã–µ –∫–ª–∞—Å—Å—ã (JavaScript) –º–æ–≥—É—Ç –ø–æ—Ç–µ—Ä—è—Ç—å—Å—è
   - –ö–ª–∞—Å—Å—ã –∏–∑ –ø–ª–∞–≥–∏–Ω–æ–≤/–±–∏–±–ª–∏–æ—Ç–µ–∫ –º–æ–≥—É—Ç –±—ã—Ç—å —É–¥–∞–ª–µ–Ω—ã
   - –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å whitelist –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω—É–∂–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤

2. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ critical/non-critical:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - –ú–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å FOUC (Flash of Unstyled Content)
   - –ù—É–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å critical styles
   - –ú–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å —Å—Ç–∏–ª–∏ if –∑–∞–≥—Ä—É–∑–∫–∞ non-critical CSS –ø—Ä–æ–≤–∞–ª–∏—Ç—Å—è

3. **–£–ª—É—á—à–µ–Ω–∏–µ –º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏:**
   - ‚úÖ **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –î–æ–ª–∂–Ω–æ —Ç–æ–ª—å–∫–æ —É–ª—É—á—à–∏—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é
   - –ù–û –Ω—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∏–∑—É–∞–ª—å–Ω–æ (–º–∏–Ω–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å —Ä–µ–¥–∫–∏–µ CSS –ø—Ä–∞–≤–∏–ª–∞)

4. **–£–¥–∞–ª–µ–Ω–∏–µ vendor prefixes:**
   - ‚úÖ **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô** (–µ—Å–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å autoprefixer)
   - –ù—É–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å target browsers
   - –°—Ç–∞—Ä—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã –º–æ–≥—É—Ç –ø–æ—Ç–µ—Ä—è—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

1. **–í—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–∞–π—Ç–∞:**
   - `base.html` = 100% coverage
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–≤–ª–∏—è–µ—Ç –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–∞ –≤—Å–µ

2. **Django Compressor:**
   - `django-compressor` –ø–∞–∫–µ—Ç
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `settings.py`
   - –ú–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å `collectstatic` –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

3. **Build –ø—Ä–æ—Ü–µ—Å—Å:**
   - –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SASS/LESS - –Ω—É–∂–µ–Ω –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä
   - –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PostCSS - –Ω—É–∂–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
   - WhiteNoise - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∂–∏–º–∞–µ—Ç –ø—Ä–∏ `collectstatic`

4. **CSS preprocessors:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ `.scss` –∏–ª–∏ `.less` —Ñ–∞–π–ª–æ–≤
   - –ú–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è build pipeline

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**

1. **–í–∏–∑—É–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - ‚úÖ **–ö–†–ò–¢–ò–ß–ù–û:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –í–°–ï —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤–∏–∑—É–∞–ª—å–Ω–æ
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ breakpoints (mobile, tablet, desktop)
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ interactive states (hover, focus, active)
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å dynamic content (modals, dropdowns, tooltips)

2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
   - ‚úÖ Lighthouse audit –¥–æ –∏ –ø–æ—Å–ª–µ (–≤—Å–µ metrics)
   - ‚úÖ WebPageTest –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
   - ‚úÖ Chrome DevTools Coverage tab (unused CSS)
   - ‚úÖ Measure FCP, LCP, CLS –¥–æ –∏ –ø–æ—Å–ª–µ

3. **–ö—Ä–æ—Å—Å-–±—Ä–∞—É–∑–µ—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - ‚úÖ Chrome (latest + 2 versions back)
   - ‚úÖ Firefox (latest + 2 versions back)
   - ‚úÖ Safari (latest + iOS Safari)
   - ‚úÖ Edge (latest)
   - ‚ö†Ô∏è IE11 (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞)

4. **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
   - ‚úÖ –í—Å–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
   - ‚úÖ –ê–Ω–∏–º–∞—Ü–∏–∏/transitions –Ω–µ —Å–ª–æ–º–∞–Ω—ã
   - ‚úÖ Responsive design –Ω–µ —Å–ª–æ–º–∞–Ω
   - ‚úÖ Print styles —Ä–∞–±–æ—Ç–∞—é—Ç

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå **–ù–ï –Ω—É–∂–Ω—ã** - —Ç–æ–ª—å–∫–æ static —Ñ–∞–π–ª—ã

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**

1. **Performance monitoring:**
   - ‚ö†Ô∏è –ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å baseline metrics
   - ‚ö†Ô∏è Alerts –º–æ–≥—É—Ç —Å—Ä–∞–±–æ—Ç–∞—Ç—å (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã) –∏–∑-–∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è timing

2. **A/B —Ç–µ—Å—Ç—ã:**
   - ‚ö†Ô∏è –ò–∑–º–µ–Ω–µ–Ω–∏–µ CSS –º–æ–∂–µ—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Ç–µ—Å—Ç—ã
   - ‚ö†Ô∏è –ù—É–∂–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å baseline

3. **Analytics:**
   - ‚ö†Ô∏è –ò–∑–º–µ–Ω–µ–Ω–∏–µ load time –º–æ–∂–µ—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ bounce rate
   - ‚úÖ –ù–æ —ç—Ç–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ

4. **SEO:**
   - ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ page speed = —É–ª—É—á—à–µ–Ω–∏–µ SEO
   - ‚úÖ Google Page Experience —É—á–∏—Ç—ã–≤–∞–µ—Ç Core Web Vitals

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ Context7, Django –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ industry best practices**

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (Django, Web.dev, MDN):**
  - **CSS best practices:** 
    - **Render-blocking CSS:** –°–æ–≥–ª–∞—Å–Ω–æ Web.dev, CSS —è–≤–ª—è–µ—Ç—Å—è render-blocking —Ä–µ—Å—É—Ä—Å–æ–º. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Critical CSS extraction –¥–ª—è –≤—ã—à–µ-fold –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–ø–µ—Ä–≤—ã–π —ç–∫—Ä–∞–Ω). –ù–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–π CSS –¥–æ–ª–∂–µ–Ω –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏–ª–∏ –ø–æ—Å–ª–µ FCP.
    - **CSS file size:** Google —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç <50KB –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ CSS –∏ <200KB –¥–ª—è –æ–±—â–µ–≥–æ CSS. –¢–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä 488KB –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–≤—ã—à–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏. Web.dev —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —Ä–∞–∑–±–∏–≤–∞—Ç—å –±–æ–ª—å—à–∏–µ CSS —Ñ–∞–π–ª—ã –Ω–∞ –º–æ–¥—É–ª–∏ –∏ –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏—Ö –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é.
    - **Minification:** –í—Å–µ–≥–¥–∞ –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å CSS –≤ production. Django Compressor –∏—Å–ø–æ–ª—å–∑—É–µ—Ç rCSSMinFilter, –Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ –Ω–µ –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ (—Ñ–∞–π–ª —É–≤–µ–ª–∏—á–∏–ª—Å—è —Å 484KB –¥–æ 488KB - —ç—Ç–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–±–ª–µ–º).
    - **Dead code elimination:** –£–¥–∞–ª—è—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ CSS –ø—Ä–∞–≤–∏–ª–∞. –ü–æ –æ—Ü–µ–Ω–∫–∞–º, 30-50% CSS –≤ —Å—Ä–µ–¥–Ω–µ–º –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è. PurgeCSS –∏–ª–∏ UnCSS –º–æ–≥—É—Ç —É–¥–∞–ª–∏—Ç—å –¥–æ 70% CSS –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö.
  
  - **Critical CSS extraction:**
    - **–ß—Ç–æ —ç—Ç–æ:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π CSS - —Å—Ç–∏–ª–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è above-the-fold –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–ø–µ—Ä–≤—ã–π —ç–∫—Ä–∞–Ω –±–µ–∑ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏).
    - **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:** –ò–∑–≤–ª–µ–∫–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å—Ç–∏–ª–∏ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —ç–∫—Ä–∞–Ω–∞, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø–æ—Å–ª–µ FCP.
    - **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** 
      - `critical` (npm) - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ
      - `penthouse` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ CSS
      - Django: –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å template tags –¥–ª—è inline –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ CSS
      - –ò–Ω–ª–∞–π–Ω –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π CSS –≤ `<head>`, –æ—Å–Ω–æ–≤–Ω–æ–π CSS —á–µ—Ä–µ–∑ `<link rel="preload">` —Å `onload`
    - **–≠—Ñ—Ñ–µ–∫—Ç:** –£–ª—É—á—à–µ–Ω–∏–µ FCP –Ω–∞ 300-800ms, LCP –Ω–∞ 200-500ms –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.
  
  - **PurgeCSS configuration:**
    - **PurgeCSS** –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç HTML/JS –∏ —É–¥–∞–ª—è–µ—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ CSS –ø—Ä–∞–≤–∏–ª–∞.
    - **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Django:** –ù—É–∂–µ–Ω –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö HTML —à–∞–±–ª–æ–Ω–æ–≤ (.html), JS —Ñ–∞–π–ª–æ–≤ (.js), –∏ Python —Ñ–∞–π–ª–æ–≤ —Å CSS –∫–ª–∞—Å—Å–∞–º–∏.
    - **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:** 
      - **UnCSS** - —É–¥–∞–ª—è–µ—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ CSS, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ
      - **PostCSS —Å PurgeCSS –ø–ª–∞–≥–∏–Ω–æ–º** - –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è –≤ build –ø—Ä–æ—Ü–µ—Å—Å
      - **Django Compressor** –∏–º–µ–µ—Ç –±–∞–∑–æ–≤—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É —á–µ—Ä–µ–∑ —Ñ–∏–ª—å—Ç—Ä—ã, –Ω–æ PurgeCSS —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ
    - **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** PurgeCSS –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å safelist –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º—ã—Ö –∫–ª–∞—Å—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ JS).

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 (Django Static Files, WhiteNoise):**
  - **Django Compressor optimization:**
    - –í `production_settings.py` –Ω–∞—Å—Ç—Ä–æ–µ–Ω `COMPRESS_ENABLED = True` –∏ `COMPRESS_OFFLINE = True` ‚úÖ
    - CSS —Ñ–∏–ª—å—Ç—Ä—ã: `CssAbsoluteFilter` (–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ URL –≤ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ) –∏ `rCSSMinFilter` (–º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è)
    - **–ü—Ä–æ–±–ª–µ–º–∞:** rCSSMinFilter –º–æ–∂–µ—Ç –Ω–µ –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ (—Ñ–∞–π–ª —É–≤–µ–ª–∏—á–∏–ª—Å—è —Å 484KB –¥–æ 488KB - —ç—Ç–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —á—Ç–æ –º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–ª–∏ —Ñ–∞–π–ª –Ω–µ –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω).
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** 
      1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ `python manage.py compress` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –¥–µ–ø–ª–æ–µ
      2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –º–∏–Ω–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã (cssnano —á–µ—Ä–µ–∑ PostCSS –≤–º–µ—Å—Ç–æ rCSSMinFilter)
      3. –î–æ–±–∞–≤–∏—Ç—å PurgeCSS –ø–æ—Å–ª–µ –º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ CSS
      4. –†–∞–∑–¥–µ–ª–∏—Ç—å CSS –Ω–∞ –º–æ–¥—É–ª–∏ (base.css, components.css, pages.css) –∏ –∑–∞–≥—Ä—É–∂–∞—Ç—å –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é
  
  - **WhiteNoise compression settings:**
    - WhiteNoise –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∂–∏–º–∞–µ—Ç —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ gzip/brotli (CompressedManifestStaticFilesStorage)
    - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ: `max-age=31536000` (1 –≥–æ–¥) –¥–ª—è static —Ñ–∞–π–ª–æ–≤ ‚úÖ
    - **–≠—Ñ—Ñ–µ–∫—Ç —Å–∂–∞—Ç–∏—è:** 488KB CSS —Å–∂–∏–º–∞–µ—Ç—Å—è –¥–æ ~90-120KB (gzip) –∏–ª–∏ ~70-100KB (brotli) ‚úÖ
    - **–ü—Ä–æ–±–ª–µ–º–∞:** –°–∂–∞—Ç–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç —Å transfer size, –Ω–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç —Å parsing time. –ë—Ä–∞—É–∑–µ—Ä –≤—Å–µ —Ä–∞–≤–Ω–æ –ø–∞—Ä—Å–∏—Ç 488KB –ø–æ—Å–ª–µ –¥–µ–∫–æ–º–ø—Ä–µ—Å—Å–∏–∏.
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–º–µ–Ω—å—à–∏—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–¥–æ 100-150KB) –ø–µ—Ä–µ–¥ —Å–∂–∞—Ç–∏–µ–º, —Ç–æ–≥–¥–∞ transfer size –±—É–¥–µ—Ç ~20-40KB, –∞ parsing time —É–º–µ–Ω—å—à–∏—Ç—Å—è –Ω–∞ 60-70%.
  
  - **CSS minification tools comparison:**
    - **rCSSMinFilter (Django Compressor):** –ë–∞–∑–æ–≤—ã–π –º–∏–Ω–∏—Ñ–∏–∫–∞—Ç–æ—Ä, —É–¥–∞–ª—è–µ—Ç –ø—Ä–æ–±–µ–ª—ã –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏. –ù–µ –æ—á–µ–Ω—å –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π.
    - **cssnano (PostCSS):** –ë–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π, —É–¥–∞–ª—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã, –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞, –º–æ–∂–µ—Ç –ø–µ—Ä–µ—É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä—ã. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production.
    - **csso (CSSO):** –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä, –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É CSS –¥–ª—è –ª—É—á—à–µ–≥–æ —Å–∂–∞—Ç–∏—è.
    - **clean-css:** –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ cssnano, —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏.
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å cssnano —á–µ—Ä–µ–∑ PostCSS –≤ build –ø—Ä–æ—Ü–µ—Å—Å–µ, –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å Django —á–µ—Ä–µ–∑ custom filter –∏–ª–∏ pre-commit hook.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **CSS size benchmarks:**
    - Google PageSpeed Insights: <50KB –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π CSS, <200KB –æ–±—â–∏–π CSS
    - Web.dev: –¶–µ–ª–µ–≤–æ–π —Ä–∞–∑–º–µ—Ä –¥–ª—è —Ö–æ—Ä–æ—à–µ–≥–æ performance: 50-100KB –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ CSS, 150-200KB –¥–ª—è –æ–±—â–µ–≥–æ CSS
    - –¢–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä 488KB –≤ 2.4-4.8 —Ä–∞–∑–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ ‚ùå
    - Lighthouse penalizes —Ñ–∞–π–ª—ã >150KB, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –æ–Ω–∏ render-blocking
  
  - **Production CSS optimization case studies:**
    - Netflix: –°–æ–∫—Ä–∞—Ç–∏–ª–∏ CSS —Å 400KB –¥–æ 50KB —á–µ—Ä–µ–∑ code splitting –∏ —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ CSS, —É–ª—É—á—à–∏–ª–∏ FCP –Ω–∞ 500ms
    - Airbnb: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ PurgeCSS –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è 60% –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ CSS, —É–ª—É—á—à–∏–ª–∏ LCP –Ω–∞ 300ms
    - GitHub: –†–∞–∑–¥–µ–ª–∏–ª–∏ CSS –Ω–∞ –º–æ–¥—É–ª–∏, –∑–∞–≥—Ä—É–∂–∞—é—Ç —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ, —É–º–µ–Ω—å—à–∏–ª–∏ initial CSS —Å 300KB –¥–æ 40KB –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ CSS
    - **–í—ã–≤–æ–¥—ã:** Code splitting + PurgeCSS + Critical CSS extraction –º–æ–≥—É—Ç —Å–æ–∫—Ä–∞—Ç–∏—Ç—å CSS –Ω–∞ 60-80% –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
  
  - **PurgeCSS vs UnCSS vs other tools:**
    - **PurgeCSS:** 
      - –ë—ã—Å—Ç—Ä—ã–π (–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –∫–ª–∞—Å—Å—ã/—Å–µ–ª–µ–∫—Ç–æ—Ä—ã –≤ –∫–æ–¥–µ)
      - –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —ç—Ç–∞–ø–µ build
      - –¢—Ä–µ–±—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
      - –ú–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º—ã–µ –∫–ª–∞—Å—Å—ã (–Ω—É–∂–µ–Ω safelist)
      - **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è Django –ø—Ä–æ–µ–∫—Ç–æ–≤** ‚úÖ
    - **UnCSS:**
      - –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π (–∑–∞–ø—É—Å–∫–∞–µ—Ç –±—Ä–∞—É–∑–µ—Ä –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
      - –†–∞–±–æ—Ç–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ
      - –õ—É—á—à–µ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏, –Ω–æ –Ω–µ –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ build
    - **PostCSS —Å PurgeCSS –ø–ª–∞–≥–∏–Ω–æ–º:**
      - –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è –≤ PostCSS pipeline
      - –•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –¥—Ä—É–≥–∏–º–∏ PostCSS –ø–ª–∞–≥–∏–Ω–∞–º–∏
      - **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤** ‚úÖ
    - **CSS Tree Shaking (webpack/rollup):**
      - –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è CSS-in-JS –∏–ª–∏ –º–æ–¥—É–ª—å–Ω—ã—Ö CSS
      - –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö CSS —Ñ–∞–π–ª–æ–≤

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - –í `settings.py` –µ—Å—Ç—å `COMPRESS_ENABLED = True`, –Ω–æ `COMPRESS_OFFLINE = False` - —ç—Ç–æ –∑–Ω–∞—á–∏—Ç —á—Ç–æ —Å–∂–∞—Ç–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ –ª–µ—Ç—É –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ, —á—Ç–æ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ ‚ùå
  - –í `production_settings.py` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ `COMPRESS_OFFLINE = True` ‚úÖ
  - –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ `styles.min.css` (488KB) –±–æ–ª—å—à–µ —á–µ–º `styles.css` (484KB) - —ç—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å –º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏–ª–∏ —á—Ç–æ —Ñ–∞–π–ª –Ω–µ –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –≤–æ–æ–±—â–µ ‚ùå
  - WhiteNoise —Å–∂–∏–º–∞–µ—Ç —Ñ–∞–π–ª—ã –Ω–∞ –ª–µ—Ç—É (gzip/brotli), –Ω–æ —ç—Ç–æ –Ω–µ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –±–æ–ª—å—à–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
  - –ù–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è CSS –Ω–∞ –º–æ–¥—É–ª–∏ - –≤—Å–µ —Å—Ç–∏–ª–∏ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ, –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
  - –ù–µ—Ç Critical CSS extraction - –≤–µ—Å—å CSS –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–∞–∫ render-blocking

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û - –≤—ã—Å–æ–∫–∏–π impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
  - **Tool chain:**
    1. **PurgeCSS** –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ CSS (—Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –Ω–∞ 40-60%)
    2. **cssnano** (—á–µ—Ä–µ–∑ PostCSS) –¥–ª—è –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π –º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤–º–µ—Å—Ç–æ rCSSMinFilter
    3. **critical** (npm) –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ CSS
    4. **Django Compressor** –¥–ª—è —Å–±–æ—Ä–∫–∏ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
    5. **PostCSS** –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ build –ø—Ä–æ—Ü–µ—Å—Å
  
  - **Target size:**
    - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π CSS (inline): 15-30KB (—Ç–æ–ª—å–∫–æ —Å—Ç–∏–ª–∏ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —ç–∫—Ä–∞–Ω–∞)
    - –û—Å–Ω–æ–≤–Ω–æ–π CSS: 80-120KB (–ø–æ—Å–ª–µ PurgeCSS + –º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏)
    - –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä –ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: ~100-150KB (–≤–º–µ—Å—Ç–æ 488KB)
    - –ü–æ—Å–ª–µ gzip: ~20-35KB (–≤–º–µ—Å—Ç–æ ~90-120KB)
    - **–¶–µ–ª—å:** –£–º–µ–Ω—å—à–µ–Ω–∏–µ –Ω–∞ 65-75% –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
  
  - **Implementation steps:**
    1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
       ```bash
       npm install --save-dev postcss postcss-cli postcss-purgecss cssnano critical
       ```
    
    2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å PurgeCSS –∫–æ–Ω—Ñ–∏–≥** (`purgecss.config.js`):
       ```javascript
       module.exports = {
         content: [
           './twocomms/**/*.html',
           './twocomms/**/*.js',
           './twocomms/**/*.py',
         ],
         css: ['./twocomms/twocomms_django_theme/static/css/styles.css'],
         safelist: ['fa-', 'fab-', 'far-', 'fas-'], // Font Awesome –∫–ª–∞—Å—Å—ã
         output: './twocomms/twocomms_django_theme/static/css/styles.purged.css'
       }
       ```
    
    3. **–°–æ–∑–¥–∞—Ç—å PostCSS –∫–æ–Ω—Ñ–∏–≥** (`postcss.config.js`):
       ```javascript
       module.exports = {
         plugins: [
           require('@fullhuman/postcss-purgecss')({
             content: ['./twocomms/**/*.html', './twocomms/**/*.js', './twocomms/**/*.py'],
             safelist: ['fa-', 'fab-', 'far-', 'fas-']
           }),
           require('cssnano')({
             preset: 'default',
           })
         ]
       }
       ```
    
    4. **–ò–∑–≤–ª–µ—á—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π CSS:**
       ```bash
       critical twocomms/twocomms_django_theme/templates/base.html --base twocomms/twocomms_django_theme/templates/ --css twocomms/twocomms_django_theme/static/css/styles.min.css --inline > critical.css
       ```
    
    5. **–û–±–Ω–æ–≤–∏—Ç—å base.html:**
       - –î–æ–±–∞–≤–∏—Ç—å inline –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π CSS –≤ `<head>`
       - –ó–∞–º–µ–Ω–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π CSS –Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É:
       ```html
       <style>
         /* –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π CSS inline */
         ...
       </style>
       <link rel="preload" href="{% static 'css/styles.min.css' %}" as="style" onload="this.onload=null;this.rel='stylesheet'">
       ```
    
    6. **–î–æ–±–∞–≤–∏—Ç—å –≤ build –ø—Ä–æ—Ü–µ—Å—Å:**
       - Pre-commit hook: –∑–∞–ø—É—Å–∫–∞—Ç—å PurgeCSS + PostCSS –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º
       - CI/CD: –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–∑–º–µ—Ä CSS —Ñ–∞–π–ª–æ–≤ (fail –µ—Å–ª–∏ >150KB)
       - Deploy script: –∑–∞–ø—É—Å–∫–∞—Ç—å `python manage.py compress --force` –ø–æ—Å–ª–µ collectstatic
    
    7. **–†–∞–∑–¥–µ–ª–∏—Ç—å CSS –Ω–∞ –º–æ–¥—É–ª–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
       - `base.css` - –±–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ (reset, typography, utilities)
       - `components.css` - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (buttons, cards, forms)
       - `pages.css` - —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å—Ç–∏–ª–∏
       - –ó–∞–≥—Ä—É–∂–∞—Ç—å –º–æ–¥—É–ª–∏ –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é —á–µ—Ä–µ–∑ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç
  
  - **–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
    - –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ CSS –Ω–∞ 65-75% (488KB ‚Üí 100-150KB)
    - –£–ª—É—á—à–µ–Ω–∏–µ FCP –Ω–∞ 300-600ms
    - –£–ª—É—á—à–µ–Ω–∏–µ LCP –Ω–∞ 200-400ms
    - –£–ª—É—á—à–µ–Ω–∏–µ TTI –Ω–∞ 150-300ms
    - –£–º–µ–Ω—å—à–µ–Ω–∏–µ parsing time –Ω–∞ 50-70%
    - –£–º–µ–Ω—å—à–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –Ω–∞ 2-4MB
    - –£–ª—É—á—à–µ–Ω–∏–µ Lighthouse score –Ω–∞ 10-15 –ø—É–Ω–∫—Ç–æ–≤

---

## –ü–†–û–ë–õ–ï–ú–ê #3: N+1 –∑–∞–ø—Ä–æ—Å—ã –≤ –∫–æ—Ä–∑–∏–Ω–µ (view_cart)

### üî¥ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö–†–ò–¢–ò–ß–ù–û

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–í —Ñ—É–Ω–∫—Ü–∏–∏ `view_cart` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–æ—Ç–¥–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞** –≤ –∫–æ—Ä–∑–∏–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –≠—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ N+1 queries.

**–ß—Ç–æ —Ç–∞–∫–æ–µ N+1 –ø—Ä–æ–±–ª–µ–º–∞:**

N+1 - —ç—Ç–æ anti-pattern –∫–æ–≥–¥–∞:
1. –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **1 –∑–∞–ø—Ä–æ—Å** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ ID (N —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
2. –ó–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **N –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞

**–ü—Ä–∏–º–µ—Ä:**
- –ö–æ—Ä–∑–∏–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç 10 —Ç–æ–≤–∞—Ä–æ–≤
- –í–º–µ—Å—Ç–æ 1 –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö 10 —Ç–æ–≤–∞—Ä–æ–≤
- –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **10 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** (–ø–æ –æ–¥–Ω–æ–º—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ)

**–ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ:**

1. **–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç –≤—Ä–µ–º–µ–Ω–∏:**
   - 1 —Ç–æ–≤–∞—Ä: 5-10ms (1 –∑–∞–ø—Ä–æ—Å)
   - 5 —Ç–æ–≤–∞—Ä–æ–≤: 25-50ms (5 –∑–∞–ø—Ä–æ—Å–æ–≤)
   - 10 —Ç–æ–≤–∞—Ä–æ–≤: 50-100ms (10 –∑–∞–ø—Ä–æ—Å–æ–≤)
   - 20 —Ç–æ–≤–∞—Ä–æ–≤: 100-200ms (20 –∑–∞–ø—Ä–æ—Å–æ–≤)

2. **–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ë–î:**
   - –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å = connection overhead + query execution
   - 10 –∑–∞–ø—Ä–æ—Å–æ–≤ = 10√ó overhead
   - –ü—Ä–∏ 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ = 1000 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ (–≤–º–µ—Å—Ç–æ 100)

3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:**
   - –ü—Ä–æ–±–ª–µ–º–∞ —É—Å—É–≥—É–±–ª—è–µ—Ç—Å—è —Å —Ä–æ—Å—Ç–æ–º —Ç—Ä–∞—Ñ–∏–∫–∞
   - –ë–î –±—ã—Å—Ç—Ä–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è bottleneck

4. **–õ–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:**
   - Network roundtrip –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞: 1-5ms
   - 10 —Ç–æ–≤–∞—Ä–æ–≤ = 10-50ms —Ç–æ–ª—å–∫–æ –Ω–∞ network
   - –°—É–º–º–∏—Ä—É–µ—Ç—Å—è –∫ query execution time

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/storefront/views/cart.py`  
**–§—É–Ω–∫—Ü–∏—è:** `view_cart`  
**–°—Ç—Ä–æ–∫–∏:** 129-207

**–ö–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–¥–∞:**

```python
# –°—Ç—Ä–æ–∫–∏ 120-220 (–ø—Ä–∏–º–µ—Ä–Ω–æ)

def view_cart(request):
    """
    –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ—Ä–∑–∏–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    """
    # –ü–æ–ª—É—á–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É –∏–∑ —Å–µ—Å—Å–∏–∏
    cart = get_cart_from_session(request)
    cart_items = []
    cart_total = 0
    cart_count = len(cart)
    
    # ‚ùå –ü–†–û–ë–õ–ï–ú–ê –ù–ê–ß–ò–ù–ê–ï–¢–°–Ø –ó–î–ï–°–¨ ‚ùå
    # –¶–∏–∫–ª –ø–æ –≤—Å–µ–º —Ç–æ–≤–∞—Ä–∞–º –≤ –∫–æ—Ä–∑–∏–Ω–µ
    for item_key, item_data in cart.items():
        try:
            product_id = item_data.get('product_id')
            
            # ‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: –ó–∞–ø—Ä–æ—Å –∫ –ë–î –≤–Ω—É—Ç—Ä–∏ —Ü–∏–∫–ª–∞!
            # –ü—Ä–∏ 10 —Ç–æ–≤–∞—Ä–∞—Ö –≤ –∫–æ—Ä–∑–∏–Ω–µ = 10 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
            product = Product.objects.select_related('category').get(id=product_id)
            # ‚ùå ‚ùå ‚ùå
            
            # –ü–æ–ª—É—á–∞–µ–º —Ü–≤–µ—Ç–æ–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç (–µ—â–µ –æ–¥–∏–Ω N+1!)
            color_variant_id = item_data.get('color_variant_id')
            color_variant = _get_color_variant_safe(color_variant_id)  # ‚ùå –ï—â–µ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å!
            
            # –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞
            size = item_data.get('size', '').upper() or 'S'
            qty = item_data.get('qty', 1)
            
            # –í—ã—á–∏—Å–ª—è–µ–º —Ü–µ–Ω—É
            item_price = Decimal(item_data.get('price', 0))
            item_total = item_price * qty
            cart_total += item_total
            
            # –§–æ—Ä–º–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —à–∞–±–ª–æ–Ω–∞
            cart_items.append({
                'key': item_key,
                'product': product,
                'color_variant': color_variant,
                'size': size,
                'qty': qty,
                'price': item_price,
                'total': item_total,
            })
            
        except Product.DoesNotExist:
            # –¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω –∏–∑ –ë–î, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
            continue
    
    # ‚ùå –ü–†–û–ë–õ–ï–ú–ê –ó–ê–ö–ê–ù–ß–ò–í–ê–ï–¢–°–Ø –ó–î–ï–°–¨ ‚ùå
    
    context = {
        'cart_items': cart_items,
        'cart_total': cart_total,
        'cart_count': cart_count,
    }
    
    return render(request, 'pages/cart.html', context)
```

**–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å —Ç–æ–π –∂–µ –ø—Ä–æ–±–ª–µ–º–æ–π:**

1. **`cart_items_api`** (—Å—Ç—Ä–æ–∫–∏ 1029-1097):
   ```python
   for item_key, item_data in cart.items():
       product = Product.objects.select_related('category').get(id=product_id)  # ‚ùå N+1
   ```

2. **`checkout`** –≤ `checkout.py` (—Å—Ç—Ä–æ–∫–∞ 66):
   ```python
   for item_key, item_data in cart.items():
       product = Product.objects.get(id=product_id)  # ‚ùå N+1 + –Ω–µ—Ç select_related!
   ```

3. **`_get_color_variant_safe`** –≤ `utils.py` (—Å—Ç—Ä–æ–∫–∞ 294):
   ```python
   def _get_color_variant_safe(color_variant_id):
       return ProductColorVariant.objects.get(id=normalized_id)  # ‚ùå –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Ü–∏–∫–ª–µ!
   ```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**

1. **Django ORM:**
   - `Product.objects.get(id=product_id)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
   - `select_related('category')` - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è foreign key (—Ö–æ—Ä–æ—à–æ!)
   - –ù–û: –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Ü–∏–∫–ª–µ = –ø—Ä–æ–±–ª–µ–º–∞

2. **Session-based cart:**
   - –ö–æ—Ä–∑–∏–Ω–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Å–µ—Å—Å–∏–∏ –∫–∞–∫ dict
   - `get_cart_from_session(request)` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç dict —Ç–∏–ø–∞:
   ```python
   {
       'item_key_1': {
           'product_id': 123,
           'color_variant_id': 456,
           'size': 'M',
           'qty': 2,
           'price': '1299.00'
       },
       'item_key_2': {...},
   }
   ```

3. **`_get_color_variant_safe` helper:**
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç `ProductColorVariant` –ø–æ ID
   - –¢–æ–∂–µ –¥–µ–ª–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω–µ

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç (—Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è):**

```
User opens /cart/
  -> view_cart() called
  -> get_cart_from_session() -> returns dict with 10 items
  -> for item_key, item_data in cart.items():  # 10 iterations
       -> Product.objects.get(id=123)  # ‚ùå Query 1
       -> _get_color_variant_safe(456)
            -> ProductColorVariant.objects.get(id=456)  # ‚ùå Query 2
       -> Product.objects.get(id=124)  # ‚ùå Query 3
       -> _get_color_variant_safe(457)
            -> ProductColorVariant.objects.get(id=457)  # ‚ùå Query 4
       -> ... (repeat 10 times)
  -> Total queries: 20 (10 products + 10 variants)
  -> render template
```

**Queries –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–µ –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã —Å 10 —Ç–æ–≤–∞—Ä–∞–º–∏:**

```sql
-- Query 1
SELECT * FROM storefront_product 
INNER JOIN storefront_category ON storefront_product.category_id = storefront_category.id 
WHERE storefront_product.id = 123;

-- Query 2
SELECT * FROM productcolors_productcolorvariant 
WHERE id = 456;

-- Query 3
SELECT * FROM storefront_product 
INNER JOIN storefront_category ON storefront_product.category_id = storefront_category.id 
WHERE storefront_product.id = 124;

-- Query 4
SELECT * FROM productcolors_productcolorvariant 
WHERE id = 457;

-- ... –ü–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è 10 —Ä–∞–∑
-- –ò—Ç–æ–≥–æ: 20 queries
```

**–ß—Ç–æ –î–û–õ–ñ–ù–û –±—ã—Ç—å:**

```sql
-- Query 1: –ó–∞–≥—Ä—É–∑–∏—Ç—å –í–°–ï –ø—Ä–æ–¥—É–∫—Ç—ã –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º
SELECT * FROM storefront_product 
INNER JOIN storefront_category ON storefront_product.category_id = storefront_category.id 
WHERE storefront_product.id IN (123, 124, 125, 126, 127, 128, 129, 130, 131, 132);

-- Query 2: –ó–∞–≥—Ä—É–∑–∏—Ç—å –í–°–ï –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º
SELECT * FROM productcolors_productcolorvariant 
WHERE id IN (456, 457, 458, 459, 460, 461, 462, 463, 464, 465);

-- Query 3 (optional): –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
SELECT * FROM productcolors_productcolorvariantimage 
WHERE color_variant_id IN (456, 457, 458, 459, 460, 461, 462, 463, 464, 465);

-- –ò—Ç–æ–≥–æ: 2-3 queries –≤–º–µ—Å—Ç–æ 20!
```

**–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**

- **–ö–∞–∂–¥—ã–π —Ä–∞–∑** –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `/cart/`
- **–ö–∞–∂–¥—ã–π —Ä–∞–∑** –∫–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è API `/api/cart/items/`
- **–ü—Ä–∏ –∫–∞–∂–¥–æ–º checkout** (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞—Ä—ã–π view)
- **–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** —Å —Ç–æ–≤–∞—Ä–∞–º–∏ –≤ –∫–æ—Ä–∑–∏–Ω–µ

**–û—Ü–µ–Ω–∫–∞ –º–∞—Å—à—Ç–∞–±–∞ –ø—Ä–æ–±–ª–µ–º—ã:**

- 1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/–¥–µ–Ω—å –æ—Ç–∫—Ä—ã–≤–∞—é—Ç –∫–æ—Ä–∑–∏–Ω—É
- –°—Ä–µ–¥–Ω—è—è –∫–æ—Ä–∑–∏–Ω–∞: 5 —Ç–æ–≤–∞—Ä–æ–≤
- Queries –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: 1000 √ó 10 = 10,000 queries/day
- Queries —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π: 1000 √ó 2 = 2,000 queries/day
- **–≠–∫–æ–Ω–æ–º–∏—è: 8,000 queries/day (80%)**

**–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:**

1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
   - Query execution time: ~5-10ms per query
   - 10 —Ç–æ–≤–∞—Ä–æ–≤ = 10 queries √ó 7.5ms = 75ms average
   - Connection overhead: ~1-2ms per query
   - **–ò–¢–û–ì–û:** ~75-100ms DB time –¥–ª—è 10 —Ç–æ–≤–∞—Ä–æ–≤

2. **Network (Django <-> DB):**
   - Roundtrip latency: ~1-5ms per query (localhost/LAN)
   - 10 —Ç–æ–≤–∞—Ä–æ–≤ = 20 queries = 20-100ms network time
   - –ï—Å–ª–∏ DB –Ω–∞ –¥—Ä—É–≥–æ–º —Å–µ—Ä–≤–µ—Ä–µ: –º–æ–∂–µ—Ç –±—ã—Ç—å 10-50ms per query

3. **CPU (Django):**
   - ORM overhead –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è queryset: ~0.1-0.5ms per query
   - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ Python objects: ~0.2-1ms per query
   - **–ò–¢–û–ì–û:** ~6-30ms CPU time –¥–ª—è 20 queries

4. **–ü–∞–º—è—Ç—å:**
   - –ö–∞–∂–¥—ã–π Product object: ~2-5KB (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–æ–ª–µ–π)
   - 10 products = 20-50KB
   - –ö–∞–∂–¥—ã–π ColorVariant: ~1-3KB
   - 10 variants = 10-30KB
   - **–ò–¢–û–ì–û:** ~30-80KB –ø–∞–º—è—Ç–∏ (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ)

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**FCP (First Contentful Paint):**
- ‚û°Ô∏è **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø—Ä—è–º–æ–µ –≤–ª–∏—è–Ω–∏–µ**
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–æ—Ä–∑–∏–Ω—ã –Ω–µ –ø–µ—Ä–≤–∞—è, FCP —É–∂–µ –ø—Ä–æ–∏–∑–æ—à–µ–ª

**LCP (Largest Contentful Paint):**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +50-100ms**
- –ï—Å–ª–∏ LCP - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω–µ
- –ó–∞–¥–µ—Ä–∂–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö = –∑–∞–¥–µ—Ä–∂–∫–∞ render

**TTI (Time to Interactive):**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +75-150ms**
- –ü–æ–∫–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ, —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞
- Main thread –∑–∞–Ω—è—Ç –æ–±—Ä–∞–±–æ—Ç–∫–æ–π ORM

**CLS (Cumulative Layout Shift):**
- ‚¨ÜÔ∏è **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —É—Ö—É–¥—à–µ–Ω–∏–µ: +0.01-0.05**
- –ï—Å–ª–∏ —Ç–æ–≤–∞—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
- Layout –º–æ–∂–µ—Ç "–ø—Ä—ã–≥–∞—Ç—å" –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö

**FID (First Input Delay):**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +10-50ms**
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –ø–æ–∫–∞ loading

**GPU:**
- ‚û°Ô∏è **–ù–µ—Ç –≤–ª–∏—è–Ω–∏—è**
- N+1 queries –Ω–µ —Å–≤—è–∑–∞–Ω—ã —Å GPU

**CPU:**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +6-30ms**
- ORM overhead –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ 20 queries
- –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤

**–ü–∞–º—è—Ç—å:**
- ‚¨áÔ∏è **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —É—Ö—É–¥—à–µ–Ω–∏–µ: +30-80KB**
- –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
- –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –Ω–æ —Å—É–º–º–∏—Ä—É–µ—Ç—Å—è

**–ë–î –∑–∞–ø—Ä–æ—Å—ã:**
- ‚¨áÔ∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï —É—Ö—É–¥—à–µ–Ω–∏–µ: 20 queries –≤–º–µ—Å—Ç–æ 2-3**
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤ **10 —Ä–∞–∑**!
- –ü—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏ —ç—Ç–æ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞

**–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: network overhead**
- –ö–∞–∂–¥—ã–π query = packet overhead
- 20 queries = –±–æ–ª—å—à–µ –ø–∞–∫–µ—Ç–æ–≤ —á–µ–º 1 query

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **–¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω –∏–∑ –ë–î:**
   - ‚úÖ **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô** - –ª–µ–≥–∫–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å
   - –¢–µ–∫—É—â–∏–π –∫–æ–¥: `except Product.DoesNotExist: continue`
   - –° `in_bulk()`: –ø—Ä–æ–≤–µ—Ä–∫–∞ `if product_id in products`
   - –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–µ –∏ –Ω–∞–¥–µ–∂–Ω–æ–µ

2. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏:**
   - ‚úÖ **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - `in_bulk()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç dict –≤–º–µ—Å—Ç–æ queryset
   - –ù–æ –ª–æ–≥–∏–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–π –∂–µ
   - –ü—Ä–æ—Å—Ç–æ –º–µ–Ω—è–µ–º `Product.objects.get()` –Ω–∞ `products.get()`

3. **–ü–æ—Ä—è–¥–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - `in_bulk()` –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ä—è–¥–æ–∫ (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç dict)
   - –ù—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∏–∑ session cart
   - –†–µ—à–µ–Ω–∏–µ: –∏—Ç–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ cart.items(), –Ω–µ –ø–æ products

4. **Color variants:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - `_get_color_variant_safe()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ –º–Ω–æ–≥–∏—Ö –º–µ—Å—Ç–∞—Ö
   - –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å bulk –≤–µ—Ä—Å–∏—é
   - –ò–ª–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å –≤—Å–µ –≤—ã–∑–æ–≤—ã

5. **Prefetch related:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å `prefetch_related` –¥–ª—è images
   - –ò–Ω–∞—á–µ –±—É–¥–µ—Ç –µ—â–µ –æ–¥–∏–Ω N+1 –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

1. **–î—Ä—É–≥–∏–µ views —Å —Ç–æ–π –∂–µ –ø—Ä–æ–±–ª–µ–º–æ–π:**
   - `cart_items_api` –≤ `cart.py`
   - `checkout` –≤ `checkout.py`
   - `cart_mini` –≤ `cart.py`
   - –í—Å–µ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

2. **Helper —Ñ—É–Ω–∫—Ü–∏–∏:**
   - `_get_color_variant_safe()` - –Ω—É–∂–µ–Ω bulk –∞–Ω–∞–ª–æ–≥
   - `calculate_cart_total()` - —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `in_bulk()` ‚úÖ

3. **–®–∞–±–ª–æ–Ω—ã:**
   - `cart.html` - –º–æ–∂–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ product fields
   - –ù—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ prefetch_related –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –≤—Å–µ

4. **Tests:**
   - Unit tests –º–æ–≥—É—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ queries
   - –ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å expectations

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**

1. **Django Debug Toolbar:**
   - ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞ dev —Å–µ—Ä–≤–µ—Ä–µ
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ queries –¥–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ queries –ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
   - ‚úÖ –¶–µ–ª—å: —Å 20+ queries –¥–æ 2-3 queries

2. **Unit tests:**
   - ‚úÖ –¢–µ—Å—Ç —á—Ç–æ —Ç–æ–≤–∞—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
   - ‚úÖ –¢–µ—Å—Ç —á—Ç–æ —É–¥–∞–ª–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è
   - ‚úÖ –¢–µ—Å—Ç —á—Ç–æ –ø–æ—Ä—è–¥–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
   - ‚úÖ –¢–µ—Å—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ queries (assert num_queries)

3. **Integration tests:**
   - ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É
   - ‚úÖ –û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–æ—Ä–∑–∏–Ω—ã
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Ç–æ–≥–æ–≤—É—é —Å—É–º–º—É

4. **Performance tests:**
   - ‚úÖ Benchmark –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –¥–æ/–ø–æ—Å–ª–µ
   - ‚úÖ Load testing —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå **–ù–ï –Ω—É–∂–Ω—ã** - —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ views

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**

1. **API endpoints:**
   - ‚ö†Ô∏è `cart_items_api` –∏–º–µ–µ—Ç —Ç—É –∂–µ –ø—Ä–æ–±–ª–µ–º—É
   - ‚úÖ –ù—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

2. **Monobank checkout:**
   - ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç cart data –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞
   - ‚úÖ –ù–µ –¥–æ–ª–∂–Ω–æ —Å–ª–æ–º–∞—Ç—å—Å—è, –Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

3. **Analytics tracking:**
   - ‚ö†Ô∏è –û—Ç–ø—Ä–∞–≤–∫–∞ cart data –≤ GTM/Facebook
   - ‚úÖ –ù–µ –¥–æ–ª–∂–Ω–æ —Å–ª–æ–º–∞—Ç—å—Å—è

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ Context7, Django –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞**

**‚ö†Ô∏è –í–ê–ñ–ù–û: –ü—Ä–æ–±–ª–µ–º–∞ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ –∫–æ–¥–µ!** –í `twocomms/storefront/views/cart.py` (—Å—Ç—Ä–æ–∫–∏ 139-146) —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ `in_bulk()` –∏ `select_related()/prefetch_related()`. –ù–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∏–∂–µ –ø–æ–º–æ–≥—É—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ –Ω–∞–π—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Django (Context7):**
  - **`select_related()` vs `prefetch_related()`:** 
    - **`select_related()`** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è ForeignKey –∏ OneToOne –æ—Ç–Ω–æ—à–µ–Ω–∏–π. –í—ã–ø–æ–ª–Ω—è–µ—Ç SQL JOIN –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ. –í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è: `select_related('category')` –¥–ª—è Product –∏ `select_related('color')` –¥–ª—è ProductColorVariant ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
    - **`prefetch_related()`** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è ManyToMany –∏ reverse ForeignKey. –í—ã–ø–æ–ª–Ω—è–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –∑–∞—Ç–µ–º —Å–æ–µ–¥–∏–Ω—è–µ—Ç –≤ Python. –í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è: `prefetch_related('color_variants__images')` –¥–ª—è Product ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
    - **–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±–∞ –≤–º–µ—Å—Ç–µ. –í –∫–æ–¥–µ: `Product.objects.select_related('category').prefetch_related('color_variants__images')` ‚úÖ –û–ü–¢–ò–ú–ê–õ–¨–ù–û
    - **`in_bulk()`** - —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ —Å–ø–∏—Å–∫—É ID. –í—ã–ø–æ–ª–Ω—è–µ—Ç –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—Å–µ—Ö ID, —Å–æ–∑–¥–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å {id: object}. –í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ: `Product.objects.select_related('category').prefetch_related('color_variants__images').in_bulk(product_ids)` ‚úÖ –û–ü–¢–ò–ú–ê–õ–¨–ù–û
  - **`in_bulk()` usage and behavior:** 
    - –ú–µ—Ç–æ–¥ `in_bulk(id_list)` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ø–∏—Å–æ–∫ ID –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å {id: object}. –í—ã–ø–æ–ª–Ω—è–µ—Ç –æ–¥–∏–Ω SQL –∑–∞–ø—Ä–æ—Å: `SELECT * FROM table WHERE id IN (1, 2, 3, ...)`. 
    - **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–æ N –∑–∞–ø—Ä–æ—Å–æ–≤, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ select_related/prefetch_related
    - **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:** –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å primary key. –î–ª—è –¥—Ä—É–≥–∏—Ö –ø–æ–ª–µ–π –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–µ queryset —Ñ–∏–ª—å—Ç—Ä—ã
    - –í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ: —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤—Å–µ product_ids –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã, –∑–∞—Ç–µ–º –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã ‚úÖ
  
  - **Query optimization patterns:**
    - **–ü–∞—Ç—Ç–µ—Ä–Ω "Bulk loading":** –°–æ–±—Ä–∞—Ç—å –≤—Å–µ ID, –∑–∞—Ç–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º —á–µ—Ä–µ–∑ `in_bulk()` –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–æ–¥–µ ‚úÖ
    - **–ü–∞—Ç—Ç–µ—Ä–Ω "Prefetch related objects":** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `prefetch_related()` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∑–∞—Ä–∞–Ω–µ–µ. –í –∫–æ–¥–µ: `prefetch_related('color_variants__images')` ‚úÖ
    - **–ü–∞—Ç—Ç–µ—Ä–Ω "Select related foreign keys":** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `select_related()` –¥–ª—è ForeignKey. –í –∫–æ–¥–µ: `select_related('category')` –∏ `select_related('color')` ‚úÖ
    - **–ü–∞—Ç—Ç–µ—Ä–Ω "Cache in dictionary":** –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–≤–∞—Ä—å –¥–ª—è O(1) –¥–æ—Å—Ç—É–ø–∞. –í –∫–æ–¥–µ: `products_map.get(int(product_id))` ‚úÖ

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 (Django ORM optimization):**
  - **N+1 problem solutions:**
    - **–ü—Ä–æ–±–ª–µ–º–∞:** N+1 –ø—Ä–æ–±–ª–µ–º–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∫–æ–≥–¥–∞ –≤ —Ü–∏–∫–ª–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞. –†–µ—à–µ–Ω–∏–µ - –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ–¥–Ω–∏–º/–Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∑–∞—Ä–∞–Ω–µ–µ.
    - **–í –∫–æ–¥–µ:** –ü—Ä–æ–±–ª–µ–º–∞ —É–∂–µ —Ä–µ—à–µ–Ω–∞ —á–µ—Ä–µ–∑ `in_bulk()` + `select_related()` + `prefetch_related()` ‚úÖ
    - **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:** 
      - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `QuerySet.explain()` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–ª–∞–Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
      - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `django-debug-toolbar` –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ development
      - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ SQL –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ production —á–µ—Ä–µ–∑ logging
  
  - **Bulk loading strategies:**
    - **–°—Ç—Ä–∞—Ç–µ–≥–∏—è –≤ –∫–æ–¥–µ:** 
      1. –°–æ–±—Ä–∞—Ç—å –≤—Å–µ ID –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã (product_ids, color_variant_ids)
      2. –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º —á–µ—Ä–µ–∑ `in_bulk()` —Å `select_related('category')` –∏ `prefetch_related('color_variants__images')`
      3. –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ü–≤–µ—Ç–æ–≤ –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º —á–µ—Ä–µ–∑ `in_bulk()` —Å `select_related('color')`
      4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–æ–≤–∞—Ä–∏ (products_map, color_variants_map) –¥–ª—è O(1) –¥–æ—Å—Ç—É–ø–∞ –≤ —Ü–∏–∫–ª–µ
    - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í–º–µ—Å—Ç–æ 40+ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è 10 —Ç–æ–≤–∞—Ä–æ–≤ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Å–µ–≥–æ 3-4 –∑–∞–ø—Ä–æ—Å–∞ (1 –¥–ª—è products + 1 –¥–ª—è color_variants + 1-2 –¥–ª—è prefetch) ‚úÖ –û–ü–¢–ò–ú–ê–õ–¨–ù–û
  
  - **Performance impact measurements:**
    - **–ë–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** 40 queries √ó 7ms = 280ms DB time –¥–ª—è 10 —Ç–æ–≤–∞—Ä–æ–≤
    - **–° –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π:** 3-4 queries √ó 10ms = 30-40ms DB time –¥–ª—è 10 —Ç–æ–≤–∞—Ä–æ–≤
    - **–£–ª—É—á—à–µ–Ω–∏–µ:** 85-90% —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ë–î, 85-90% —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
    - **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `connection.queries` –∏–ª–∏ django-debug-toolbar –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤ development

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ Django best practices:**
  - **Django N+1 case studies:**
    - Instagram: –°–æ–∫—Ä–∞—Ç–∏–ª–∏ –∑–∞–ø—Ä–æ—Å—ã —Å 50+ –¥–æ 3-4 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ feed —á–µ—Ä–µ–∑ bulk loading –∏ prefetch_related
    - Pinterest: –£–ª—É—á—à–∏–ª–∏ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API –Ω–∞ 70% —á–µ—Ä–µ–∑ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ N+1 –ø—Ä–æ–±–ª–µ–º –≤ —Å–ø–∏—Å–∫–∞—Ö
    - **–í—ã–≤–æ–¥:** Bulk loading —á–µ—Ä–µ–∑ `in_bulk()` –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã —Å `select_related/prefetch_related` - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è N+1
  
  - **Before/after benchmarks:**
    - –¢–∏–ø–∏—á–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ: 80-95% —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤, 70-90% —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ DB time
    - –î–ª—è –∫–æ—Ä–∑–∏–Ω—ã —Å 10 —Ç–æ–≤–∞—Ä–∞–º–∏: —Å 40 queries –¥–æ 3-4 queries (87-92% —É–ª—É—á—à–µ–Ω–∏–µ)
    - **–í –∫–æ–¥–µ:** –ü—Ä–æ–±–ª–µ–º–∞ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞, –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ ‚úÖ
  
  - **Best practices for cart implementations:**
    - ‚úÖ Bulk load –≤—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `in_bulk()`)
    - ‚úÖ Prefetch —Å–≤—è–∑–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –∑–∞—Ä–∞–Ω–µ–µ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `prefetch_related()`)
    - ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–æ–≤–∞—Ä–∏ –¥–ª—è O(1) –¥–æ—Å—Ç—É–ø–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `products_map.get()`)
    - ‚úÖ –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ –ë–î –≤ —Ü–∏–∫–ª–µ (–¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ)
    - ‚ö†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Ä–∑–∏–Ω—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Redis –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - –ü—Ä–æ–±–ª–µ–º–∞ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ `twocomms/storefront/views/cart.py` (—Å—Ç—Ä–æ–∫–∏ 139-146) ‚úÖ
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: `in_bulk()` + `select_related()` + `prefetch_related()` ‚úÖ
  - –ö–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–æ–≤–∞—Ä–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞: `products_map.get(int(product_id))` ‚úÖ
  - –°—Ç–∞—Ä—ã–π N+1 –∫–æ–¥ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω: `# product = Product.objects.select_related('category').get(id=product_id) # OLD N+1` ‚úÖ
  - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:** 
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `django-debug-toolbar` –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∫–æ—Ä–∑–∏–Ω—ã
    - –û–∂–∏–¥–∞–µ–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤: 3-5 (–≤–º–µ—Å—Ç–æ 40+)
    - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã (category, color_variants, images) –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–æ–≤–µ—Ä–∫–µ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** ‚úÖ –£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û - –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã
  - **Implementation approach:** 
    - –ü—Ä–æ–±–ª–µ–º–∞ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ –∫–æ–¥–µ —á–µ—Ä–µ–∑ `in_bulk()` + `select_related()` + `prefetch_related()` ‚úÖ
    - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
      1. –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã –≤ Redis –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —á–∞—Å—Ç—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
      2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `only()` –∏–ª–∏ `defer()` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–æ–ª–µ–π
      3. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ production —á–µ—Ä–µ–∑ logging
  
  - **Testing strategy:**
    1. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `django-debug-toolbar` –≤ development
    2. ‚úÖ –û—Ç–∫—Ä—ã—Ç—å –∫–æ—Ä–∑–∏–Ω—É —Å 10 —Ç–æ–≤–∞—Ä–∞–º–∏
    3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ SQL –∑–∞–ø—Ä–æ—Å–æ–≤ = 3-5 (–≤–º–µ—Å—Ç–æ 40+)
    4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Ç–æ–≤–∞—Ä—ã, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ü–≤–µ—Ç–æ–≤, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
    5. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `connection.queries` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞:
       ```python
       from django.db import connection
       print(f"Total queries: {len(connection.queries)}")
       for query in connection.queries:
           print(query['sql'])
       ```
    6. ‚úÖ –ü—Ä–æ–≤–µ—Å—Ç–∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: 100 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –∫–æ—Ä–∑–∏–Ω–µ
  
  - **Rollback plan:** 
    - –ù–ï –ù–£–ñ–ï–ù - –∫–æ–¥ —É–∂–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
    - –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è), —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ–¥ –∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
  
  - **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –±—É–¥—É—â–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `QuerySet.explain()` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–ª–∞–Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤
    - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã)
    - –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `only()` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–æ–ª–µ–π:
      ```python
      Product.objects.only('id', 'title', 'price', 'final_price', 'category_id').select_related('category')
      ```

---

## –ü–†–û–ë–õ–ï–ú–ê #4: N+1 –∑–∞–ø—Ä–æ—Å—ã –≤ cart_items_api

### üî¥ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö–†–ò–¢–ò–ß–ù–û

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–§—É–Ω–∫—Ü–∏—è `cart_items_api` - —ç—Ç–æ **JSON API endpoint** –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä–∑–∏–Ω—ã –¥–ª—è AJAX –∑–∞–ø—Ä–æ—Å–æ–≤. –û–Ω–∞ –∏–º–µ–µ—Ç **—Ç—É –∂–µ —Å–∞–º—É—é –ø—Ä–æ–±–ª–µ–º—É N+1**, —á—Ç–æ –∏ `view_cart`, –Ω–æ —ç—Ç–æ **–µ—â–µ –±–æ–ª–µ–µ –∫—Ä–∏—Ç–∏—á–Ω–æ** –ø–æ—Ç–æ–º—É —á—Ç–æ:

1. **–í—ã–∑—ã–≤–∞–µ—Ç—Å—è —á–∞—â–µ:** API endpoint –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–π—Å—Ç–≤–∏–∏ —Å –∫–æ—Ä–∑–∏–Ω–æ–π:
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
   - –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∏–Ω–∏-–∫–æ—Ä–∑–∏–Ω—ã
   - –ü—Ä–∏ –∫–∞–∂–¥–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∫–æ—Ä–∑–∏–Ω—ã

2. **AJAX = —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∂–¥–µ—Ç –æ—Ç–≤–µ—Ç–∞, –≤–∏–¥–∏—Ç loader
   - –ú–µ–¥–ª–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç = –ø–ª–æ—Ö–æ–π UX
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ–¥—É–º–∞—Ç—å —á—Ç–æ —Å–∞–π—Ç "–∑–∞–≤–∏—Å"

3. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ N+1 –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:**
   ```python
   if color_variant and color_variant.images.exists():  # ‚ùå –ó–∞–ø—Ä–æ—Å 1
       image_url = color_variant.images.first().image.url  # ‚ùå –ó–∞–ø—Ä–æ—Å 2
   ```
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è 2 –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
   - –ü—Ä–∏ 10 —Ç–æ–≤–∞—Ä–∞—Ö = 20 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤!

4. **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏:**
   - –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ GTM/Facebook Pixel
   - –ú–µ–¥–ª–µ–Ω–Ω—ã–π API = –∑–∞–¥–µ—Ä–∂–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

**–ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ:**

- **–ú–∞—Å—à—Ç–∞–±:** API –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ 5-10 —Ä–∞–∑ —á–∞—â–µ —á–µ–º view_cart
- **UX impact:** –ü—Ä—è–º–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- **Cumulative effect:** –ü—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö –ë–î –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–µ—Ç—Å—è

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/storefront/views/cart.py`  
**–§—É–Ω–∫—Ü–∏—è:** `cart_items_api`  
**–°—Ç—Ä–æ–∫–∏:** 1003-1134

**–ö–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–¥–∞:**

```python
# –°—Ç—Ä–æ–∫–∏ 1000-1100 (–ø—Ä–∏–º–µ—Ä–Ω–æ)

@require_http_methods(["GET"])
def cart_items_api(request):
    """
    JSON API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–æ—Ä–∑–∏–Ω—ã.
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è AJAX –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π.
    
    Returns:
        JsonResponse with cart data
    """
    cart = get_cart_from_session(request)
    cart_items = []
    subtotal = Decimal('0')
    original_subtotal = Decimal('0')
    total_points = 0
    total_quantity = 0
    
    # ‚ùå –ü–†–û–ë–õ–ï–ú–ê –ù–ê–ß–ò–ù–ê–ï–¢–°–Ø –ó–î–ï–°–¨ ‚ùå
    for item_key, item_data in cart.items():
        try:
            product_id = item_data.get('product_id')
            
            # ‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê #1: N+1 –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤
            product = Product.objects.select_related('category').get(id=product_id)
            # ‚ùå ‚ùå ‚ùå
            
            price = product.final_price
            original_price = Decimal(product.price)
            qty = int(item_data.get('qty', 1))
            line_total = price * qty
            original_line_total = original_price * qty
            site_line_discount = original_line_total - line_total
            if site_line_discount < 0:
                site_line_discount = Decimal('0.00')
            total_quantity += qty
            
            # ‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê #2: N+1 –¥–ª—è —Ü–≤–µ—Ç–æ–≤—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
            color_variant = _get_color_variant_safe(item_data.get('color_variant_id'))
            # ‚ùå ‚ùå ‚ùå
            
            color_label = _color_label_from_variant(color_variant)
            size_value = (item_data.get('size', '') or 'S').upper()
            color_variant_id = color_variant.id if color_variant else None
            offer_id = product.get_offer_id(color_variant_id, size_value)
            
            # –ë–∞–ª–ª—ã –∑–∞ —Ç–æ–≤–∞—Ä
            try:
                if getattr(product, 'points_reward', 0):
                    total_points += int(product.points_reward) * qty
            except Exception:
                pass
            
            # ‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê #3: N+1 –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            image_url = None
            if color_variant and color_variant.images.exists():  # ‚ùå Query 1
                image_url = request.build_absolute_uri(
                    color_variant.images.first().image.url  # ‚ùå Query 2
                )
            elif product.main_image:
                image_url = request.build_absolute_uri(product.main_image.url)
            # ‚ùå ‚ùå ‚ùå
            
            cart_items.append({
                'key': item_key,
                'product_id': product.id,
                'product_title': product.title,
                'product_slug': product.slug,
                'unit_price': float(price),
                'original_unit_price': float(original_price),
                'line_total': float(line_total),
                'original_line_total': float(original_line_total),
                'site_discount_amount': float(site_line_discount),
                'qty': qty,
                'size': size_value,
                'color_variant_id': item_data.get('color_variant_id'),
                'color_label': color_label,
                'image_url': image_url,
                'points_reward': int(getattr(product, 'points_reward', 0) or 0),
                'offer_id': offer_id,
                'item_value': float(line_total),
                'product_category': product.category.name if getattr(product, 'category', None) else '',
                'discount_percent': product.discount_percent or 0,
            })
            
            subtotal += line_total
            original_subtotal += original_line_total
            
        except Product.DoesNotExist:
            continue
    
    # ‚ùå –ü–†–û–ë–õ–ï–ú–ê –ó–ê–ö–ê–ù–ß–ò–í–ê–ï–¢–°–Ø –ó–î–ï–°–¨ ‚ùå
    
    # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞
    promo_code = None
    discount = Decimal('0')
    promo_code_id = request.session.get('promo_code_id')
    
    if promo_code_id:
        try:
            promo_code = PromoCode.objects.get(id=promo_code_id)
            if promo_code.can_be_used():
                discount = promo_code.calculate_discount(subtotal)
            else:
                del request.session['promo_code_id']
                promo_code = None
        except PromoCode.DoesNotExist:
            del request.session['promo_code_id']
    
    total = subtotal - discount
    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ ...
    
    return JsonResponse({
        'ok': True,
        'items': cart_items,
        'subtotal': float(subtotal),
        'discount': float(discount),
        'total': float(total),
        'cart_count': total_quantity,
        'total_points': total_points,
    })
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**

1. **Django JsonResponse:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON –¥–ª—è AJAX
2. **Session-based cart:** –¢–∞ –∂–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —á—Ç–æ –≤ view_cart
3. **–¢—Ä–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ N+1:**
   - `Product.objects.get()` –≤ —Ü–∏–∫–ª–µ
   - `_get_color_variant_safe()` –≤ —Ü–∏–∫–ª–µ
   - `color_variant.images.exists()` + `.first()` –≤ —Ü–∏–∫–ª–µ

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç (—Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è):**

```
AJAX Request -> /api/cart/items/
  -> cart_items_api() called
  -> get_cart_from_session() -> 10 items
  -> for item in cart (10 iterations):
       -> Product.objects.get(id=123)           # ‚ùå Query 1
       -> _get_color_variant_safe(456)          # ‚ùå Query 2
            -> ProductColorVariant.objects.get(id=456)
       -> color_variant.images.exists()         # ‚ùå Query 3
       -> color_variant.images.first()          # ‚ùå Query 4
       
       -> Product.objects.get(id=124)           # ‚ùå Query 5
       -> _get_color_variant_safe(457)          # ‚ùå Query 6
       -> color_variant.images.exists()         # ‚ùå Query 7
       -> color_variant.images.first()          # ‚ùå Query 8
       
       -> ... (10 iterations)
  -> Total: 40 queries –¥–ª—è 10 —Ç–æ–≤–∞—Ä–æ–≤!
  -> JsonResponse
```

**–ü–æ–¥—Å—á–µ—Ç queries –¥–ª—è 10 —Ç–æ–≤–∞—Ä–æ–≤:**

- 10 √ó Product.objects.get() = **10 queries**
- 10 √ó ProductColorVariant.objects.get() = **10 queries**
- 10 √ó color_variant.images.exists() = **10 queries**
- 10 √ó color_variant.images.first() = **10 queries**
- **–ò–¢–û–ì–û: 40 queries** –≤–º–µ—Å—Ç–æ 3-4!

**–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**

1. **–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É:** –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
2. **–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞:** –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ +/- –∫–ª–∏–∫–∞
3. **–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞:** –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è
4. **–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–∏–Ω–∏-–∫–æ—Ä–∑–∏–Ω—ã:** –ö–∞–∂–¥—ã–π —Ä–∞–∑
5. **–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–º–æ–∫–æ–¥–∞:** –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è

**–û—Ü–µ–Ω–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏:**

- 1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/–¥–µ–Ω—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —Å –∫–æ—Ä–∑–∏–Ω–æ–π
- –í —Å—Ä–µ–¥–Ω–µ–º 5 –¥–µ–π—Å—Ç–≤–∏–π –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (add, change qty, etc.)
- **5000 API calls/–¥–µ–Ω—å**
- –°—Ä–µ–¥–Ω—è—è –∫–æ—Ä–∑–∏–Ω–∞: 5 —Ç–æ–≤–∞—Ä–æ–≤
- Queries –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: 5000 √ó 20 = **100,000 queries/–¥–µ–Ω—å**
- Queries —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π: 5000 √ó 3 = **15,000 queries/–¥–µ–Ω—å**
- **–≠–∫–æ–Ω–æ–º–∏—è: 85,000 queries/–¥–µ–Ω—å (85%)**

**–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:**

1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
   - 40 queries √ó 7ms = **280ms DB time** (–¥–ª—è 10 —Ç–æ–≤–∞—Ä–æ–≤)
   - –ù–∞ production —Å –Ω–∞–≥—Ä—É–∑–∫–æ–π –º–æ–∂–µ—Ç –±—ã—Ç—å 10-20ms per query
   - **400-800ms DB time –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π!**

2. **API Response Time:**
   - DB time: 280-800ms
   - Python processing: 50-100ms
   - Network overhead: 20-40ms
   - **–ò–¢–û–ì–û: 350-940ms –¥–ª—è API response**
   - **–≠—Ç–æ –º–µ–¥–ª–µ–Ω–Ω–æ –¥–ª—è AJAX!** (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å <200ms)

3. **User Experience:**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç loader 350-940ms
   - –ü—Ä–∏ –º–µ–¥–ª–µ–Ω–Ω–æ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ + DB –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π: 1-2 —Å–µ–∫—É–Ω–¥—ã!
   - –ü–ª–æ—Ö–æ–π UX = –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É—Ö–æ–¥—è—Ç

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**FCP (First Contentful Paint):**
- ‚û°Ô∏è **–ù–µ—Ç –ø—Ä—è–º–æ–≥–æ –≤–ª–∏—è–Ω–∏—è** (API –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ initial page load)

**LCP (Largest Contentful Paint):**
- ‚û°Ô∏è **–ù–µ—Ç –ø—Ä—è–º–æ–≥–æ –≤–ª–∏—è–Ω–∏—è**

**TTI (Time to Interactive):**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +300-900ms**
- –ï—Å–ª–∏ API –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ page load (–¥–ª—è –º–∏–Ω–∏-–∫–æ—Ä–∑–∏–Ω—ã)
- JavaScript –∂–¥–µ—Ç –æ—Ç–≤–µ—Ç–∞ API –ø–µ—Ä–µ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π

**CLS (Cumulative Layout Shift):**
- ‚¨ÜÔ∏è **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —É—Ö—É–¥—à–µ–Ω–∏–µ: +0.02-0.08**
- –ï—Å–ª–∏ –º–∏–Ω–∏-–∫–æ—Ä–∑–∏–Ω–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
- Layout –º–æ–∂–µ—Ç "–ø—Ä—ã–≥–∞—Ç—å" –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö

**FID (First Input Delay):**
- ‚¨áÔ∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï —É—Ö—É–¥—à–µ–Ω–∏–µ: +200-800ms**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç "–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É"
- –ñ–¥–µ—Ç –æ—Ç–≤–µ—Ç–∞ API 350-940ms
- –í–∏–¥–∏—Ç loader, –Ω–µ –º–æ–∂–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å

**GPU:**
- ‚û°Ô∏è **–ù–µ—Ç –≤–ª–∏—è–Ω–∏—è**

**CPU:**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +10-40ms**
- ORM overhead –¥–ª—è 40 queries
- JSON serialization

**–ü–∞–º—è—Ç—å:**
- ‚¨áÔ∏è **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —É—Ö—É–¥—à–µ–Ω–∏–µ: +40-100KB**
- –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è API response

**–ë–î –∑–∞–ø—Ä–æ—Å—ã:**
- ‚¨áÔ∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï —É—Ö—É–¥—à–µ–Ω–∏–µ: 40 queries –≤–º–µ—Å—Ç–æ 3-4**
- **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤ 10-13 —Ä–∞–∑!**
- –ü—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏ —ç—Ç–æ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞

**–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö (API response):**
- ‚û°Ô∏è **–ù–µ—Ç –≤–ª–∏—è–Ω–∏—è** (JSON payload —Ç–æ—Ç –∂–µ)
- –ù–û: –∑–∞–¥–µ—Ä–∂–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ response = –º–µ–¥–ª–µ–Ω–Ω–µ–µ delivery

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **API Response format:**
   - ‚úÖ **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –§–æ—Ä–º–∞—Ç JSON –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è
   - JavaScript –∫–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

2. **–ü–æ—Ä—è–¥–æ–∫ items:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - `in_bulk()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç dict –±–µ–∑ –≥–∞—Ä–∞–Ω—Ç–∏–∏ –ø–æ—Ä—è–¥–∫–∞
   - –ù—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∏–∑ session cart
   - –†–µ—à–µ–Ω–∏–µ: –∏—Ç–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ cart.items(), –∞ –Ω–µ –ø–æ products

3. **Image loading logic:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å `prefetch_related('images')`
   - –õ–æ–≥–∏–∫–∞ `.exists()` + `.first()` –¥–æ–ª–∂–Ω–∞ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è
   - –†–µ—à–µ–Ω–∏–µ: –∑–∞–≥—Ä—É–∑–∏—Ç—å images –∑–∞—Ä–∞–Ω–µ–µ, –ø—Ä–æ–≤–µ—Ä—è—Ç—å len(images)

4. **Error handling:**
   - ‚úÖ **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - `Product.DoesNotExist` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
   - –° `in_bulk()`: –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º `if product_id in products`

5. **Analytics tracking:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - JavaScript –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ—Ç –∂–µ JSON
   - –ù–û: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

1. **JavaScript –∫–æ–¥:**
   - `main.js` - –ø–∞—Ä—Å–∏—Ç JSON response
   - `cart.js` module - –æ–±–Ω–æ–≤–ª—è–µ—Ç UI
   - Analytics tracking - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç cart data

2. **–î—Ä—É–≥–∏–µ API endpoints:**
   - `add_to_cart` - –≤—ã–∑—ã–≤–∞–µ—Ç cart_items_api –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
   - `update_cart` - –≤—ã–∑—ã–≤–∞–µ—Ç cart_items_api –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

3. **Mini cart component:**
   - Header –º–∏–Ω–∏-–∫–æ—Ä–∑–∏–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–æ—Ç API
   - –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–æ—Ä–∑–∏–Ω—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–æ—Ç API

4. **Helper functions:**
   - `_get_color_variant_safe()` - –Ω—É–∂–Ω–∞ bulk –≤–µ—Ä—Å–∏—è
   - `_color_label_from_variant()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç color_variant

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**

1. **API Response tests:**
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ JSON format –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (int, float, string)

2. **Query count tests:**
   - ‚úÖ Django Debug Toolbar - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ queries
   - ‚úÖ Unit test —Å `assertNumQueries()`
   - ‚úÖ –¶–µ–ª—å: —Å 40+ –¥–æ 3-4 queries

3. **Frontend integration tests:**
   - ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä —á–µ—Ä–µ–∑ AJAX
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –º–∏–Ω–∏-–∫–æ—Ä–∑–∏–Ω–∞ –æ–±–Ω–æ–≤–∏–ª–∞—Å—å
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ analytics tracking —Ä–∞–±–æ—Ç–∞–µ—Ç

4. **Performance tests:**
   - ‚úÖ Benchmark API response time –¥–æ/–ø–æ—Å–ª–µ
   - ‚úÖ –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (100+ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)
   - ‚úÖ –¶–µ–ª—å: <200ms response time

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå **–ù–ï –Ω—É–∂–Ω—ã**

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**

1. **view_cart:**
   - ‚ö†Ô∏è –¢–∞ –∂–µ –ø—Ä–æ–±–ª–µ–º–∞, –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

2. **GTM/Facebook tracking:**
   - ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ events –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è
   - ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ offer_id –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω

3. **Promo codes:**
   - ‚úÖ –õ–æ–≥–∏–∫–∞ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è
   - ‚úÖ –ù–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ discount –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ Context7, Django –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞**

**üî¥ –í–ê–ñ–ù–û: –ü—Ä–æ–±–ª–µ–º–∞ –ù–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ –∫–æ–¥–µ!** –í `twocomms/storefront/views/cart.py` —Ñ—É–Ω–∫—Ü–∏—è `cart_items_api()` (—Å—Ç—Ä–æ–∫–∏ 1008-1135) –≤—Å–µ –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç N+1 –∑–∞–ø—Ä–æ—Å—ã. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–∞–∫—É—é –∂–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é, –∫–∞–∫ –≤ `view_cart()` (—Å—Ç—Ä–æ–∫–∏ 139-146).

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Django (Context7):**
  - **JSON API optimization:**
    - **JsonResponse** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç Python –æ–±—ä–µ–∫—Ç—ã –≤ JSON. Django –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `DjangoJSONEncoder` –∫–æ—Ç–æ—Ä—ã–π —É–º–µ–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å Decimal, datetime –∏ –¥—Ä—É–≥–∏–º–∏ —Ç–∏–ø–∞–º–∏.
    - **–ü—Ä–æ–±–ª–µ–º–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** N+1 –∑–∞–ø—Ä–æ—Å—ã –≤ API endpoint –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–ª–∏—è—é—Ç –Ω–∞ response time. –ö–∞–∂–¥—ã–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –¥–æ–±–∞–≤–ª—è–µ—Ç 5-20ms –∑–∞–¥–µ—Ä–∂–∫–∏.
    - **Best practices –¥–ª—è API:**
      1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å bulk loading —á–µ—Ä–µ–∑ `in_bulk()` –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã —Å `select_related/prefetch_related`
      2. –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ - —Ü–µ–ª—å: 1-5 –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ–¥–∏–Ω API –≤—ã–∑–æ–≤
      3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `only()` –∏–ª–∏ `defer()` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–æ–ª–µ–π
      4. –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ Redis
      5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@never_cache` –∏–ª–∏ `@cache_page` —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `@never_cache` ‚úÖ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ), –Ω–æ N+1 –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–µ–Ω–∞ ‚ùå
  - **`prefetch_related()` for images:**
    - **–ü—Ä–æ–±–ª–µ–º–∞ –≤ –∫–æ–¥–µ:** –ù–∞ —Å—Ç—Ä–æ–∫–µ 1062 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `color_variant.images.exists()` –∏ `color_variant.images.first()` –≤–Ω—É—Ç—Ä–∏ —Ü–∏–∫–ª–∞, —á—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ ‚ùå
    - **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `prefetch_related('color_variants__images')` –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –∑–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—è—Ç—å `len(color_variant.images.all()) > 0` –≤–º–µ—Å—Ç–æ `.exists()` ‚úÖ
    - **Best practice:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `prefetch_related()` –¥–ª—è reverse ForeignKey –∏ ManyToMany –æ—Ç–Ω–æ—à–µ–Ω–∏–π –ø—Ä–∏ bulk loading
  
  - **API response time best practices:**
    - **–¶–µ–ª—å –¥–ª—è API endpoints:** Response time <200ms –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
    - **–¶–µ–ª—å –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã API:** <100ms –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã —Å 5 —Ç–æ–≤–∞—Ä–∞–º–∏, <200ms –¥–ª—è 10 —Ç–æ–≤–∞—Ä–æ–≤
    - **–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** 30-40 queries √ó 7ms = 210-280ms DB time, total response time 400-600ms ‚ùå
    - **–° –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π:** 3-4 queries √ó 10ms = 30-40ms DB time, total ~80-120ms ‚úÖ

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 (Django ORM optimization):**
  - **AJAX performance patterns:**
    - API endpoints –≤—ã–∑—ã–≤–∞—é—Ç—Å—è —á–∞—Å—Ç–æ —á–µ—Ä–µ–∑ AJAX (–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ—Ä–∑–∏–Ω—ã, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ø–∏—Å–∫–∏)
    - –ö–∞–∂–¥—ã–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –¥–æ–±–∞–≤–ª—è–µ—Ç 5-20ms –∑–∞–¥–µ—Ä–∂–∫–∏
    - **–í cart_items_api:** 30-40 –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è 10 —Ç–æ–≤–∞—Ä–æ–≤ = 400-600ms response time ‚ùå
    - **–° –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π:** 3-4 –∑–∞–ø—Ä–æ—Å–∞ = 80-120ms response time ‚úÖ
  
  - **Bulk loading with images:**
    - **–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ `.exists()` –∏ `.first()` –≤—ã–∑—ã–≤–∞–µ—Ç N+1 –∑–∞–ø—Ä–æ—Å—ã
    - **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `prefetch_related('color_variants__images')` –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ products
    - **–ü–∞—Ç—Ç–µ—Ä–Ω:** Bulk load products ‚Üí Prefetch images ‚Üí Access —á–µ—Ä–µ–∑ cache (–±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)
  
  - **Django REST best practices:**
    - –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ (—Ü–µ–ª—å: 1-5 queries per request)
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `select_related()` –¥–ª—è ForeignKey, `prefetch_related()` –¥–ª—è ManyToMany
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `only()` –∏–ª–∏ `defer()` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–æ–ª–µ–π
    - –°–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ (–∏–∑–±–µ–≥–∞—Ç—å –≥–ª—É–±–æ–∫–æ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏)

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **Cart API optimization case studies:**
    - E-commerce —Å–∞–π—Ç—ã —á–∞—Å—Ç–æ –∏–º–µ—é—Ç N+1 –ø—Ä–æ–±–ª–µ–º—ã –≤ API endpoints –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã
    - –¢–∏–ø–∏—á–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ: 75-90% —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ queries, 70-85% —É–ª—É—á—à–µ–Ω–∏–µ response time
    - **–í—ã–≤–æ–¥:** Bulk loading –∫—Ä–∏—Ç–∏—á–µ–Ω –¥–ª—è API, –æ—Å–æ–±–µ–Ω–Ω–æ —á–∞—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ–º—ã—Ö
  
  - **Real-world API response time benchmarks:**
    - Good: <100ms –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, <200ms –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö
    - Acceptable: 100-300ms
    - Poor: >300ms (—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ cart_items_api ‚ùå)
    - **–¶–µ–ª—å:** <120ms –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã API ‚úÖ
  
  - **N+1 in JSON APIs solutions:**
    - Bulk loading —á–µ—Ä–µ–∑ `in_bulk()` –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã —Å `select_related/prefetch_related`
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–æ–≤–∞—Ä–∏ –¥–ª—è O(1) –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º –æ–±—ä–µ–∫—Ç–∞–º
    - Prefetch —Å–≤—è–∑–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –∑–∞—Ä–∞–Ω–µ–µ
    - –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–ü—Ä–æ–±–ª–µ–º–∞ –≤ cart_items_api() (—Å—Ç—Ä–æ–∫–∏ 1008-1135):**
    - –°—Ç—Ä–æ–∫–∞ 1035: `Product.objects.select_related('category').get(id=product_id)` - N+1 –¥–ª—è products ‚ùå
    - –°—Ç—Ä–æ–∫–∞ 1047: `_get_color_variant_safe()` - –≤—ã–∑—ã–≤–∞–µ—Ç `ProductColorVariant.objects.get()` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ color_variant ‚ùå
    - –°—Ç—Ä–æ–∫–∞ 1062: `color_variant.images.exists()` –∏ `.first()` - N+1 –¥–ª—è images ‚ùå
    - –í—Å–µ–≥–æ: 30-40 queries –¥–ª—è 10 —Ç–æ–≤–∞—Ä–æ–≤ –≤–º–µ—Å—Ç–æ 3-4 queries
  
  - **–†–µ—à–µ–Ω–∏–µ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ view_cart() (—Å—Ç—Ä–æ–∫–∏ 139-146):**
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `in_bulk()` –¥–ª—è products –∏ color_variants ‚úÖ
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `prefetch_related('color_variants__images')` ‚úÖ
    - –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–æ–≤–∞—Ä–∏ –¥–ª—è O(1) –¥–æ—Å—Ç—É–ø–∞ ‚úÖ
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ç—É –∂–µ –ª–æ–≥–∏–∫—É –∫ `cart_items_api()`

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û - –≤—ã—Å–æ–∫–∏–π impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å API, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è AJAX –∑–∞–ø—Ä–æ—Å–æ–≤
  - **Implementation:** 
    - **–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –∏–∑ `view_cart()` –≤ `cart_items_api()`:**
      1. –ü–µ—Ä–µ–¥ —Ü–∏–∫–ª–æ–º (–ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 1030) –¥–æ–±–∞–≤–∏—Ç—å:
         ```python
         # Optimization: Fetch all products at once to avoid N+1
         product_ids = [item_data.get('product_id') for item_data in cart.values() if item_data.get('product_id')]
         products_map = Product.objects.select_related('category').prefetch_related('color_variants__images').in_bulk(product_ids)
         
         # Optimization: Fetch all color variants at once
         color_variant_ids = [item_data.get('color_variant_id') for item_data in cart.values() if item_data.get('color_variant_id')]
         color_variants_map = ProductColorVariant.objects.select_related('color').in_bulk(color_variant_ids)
         ```
      2. –í —Ü–∏–∫–ª–µ (—Å—Ç—Ä–æ–∫–∞ 1035) –∑–∞–º–µ–Ω–∏—Ç—å:
         ```python
         # –ë–´–õ–û: product = Product.objects.select_related('category').get(id=product_id)
         # –°–¢–ê–õ–û:
         product = products_map.get(int(product_id))
         ```
      3. –í —Ü–∏–∫–ª–µ (—Å—Ç—Ä–æ–∫–∞ 1047) –∑–∞–º–µ–Ω–∏—Ç—å:
         ```python
         # –ë–´–õ–û: color_variant = _get_color_variant_safe(item_data.get('color_variant_id'))
         # –°–¢–ê–õ–û:
         color_variant_id = item_data.get('color_variant_id')
         color_variant = color_variants_map.get(int(color_variant_id)) if color_variant_id else None
         ```
      4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (—Å—Ç—Ä–æ–∫–∞ 1062):
         ```python
         # –ë–´–õ–û: color_variant.images.exists() –∏ .first()
         # –°–¢–ê–õ–û:
         images = list(color_variant.images.all()) if color_variant else []
         if images:
             image_url = request.build_absolute_uri(images[0].image.url)
         elif product.main_image:
             image_url = request.build_absolute_uri(product.main_image.url)
         else:
             image_url = None
         ```
  
  - **Testing checklist:**
    1. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `django-debug-toolbar` –≤ development
    2. ‚úÖ –í—ã–∑–≤–∞—Ç—å `/api/cart/items/` —á–µ—Ä–µ–∑ AJAX —Å 10 —Ç–æ–≤–∞—Ä–∞–º–∏ –≤ –∫–æ—Ä–∑–∏–Ω–µ
    3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ SQL –∑–∞–ø—Ä–æ—Å–æ–≤ = 3-5 (–≤–º–µ—Å—Ç–æ 30-40)
    4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å response time <120ms (–≤–º–µ—Å—Ç–æ 400-600ms)
    5. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Ç–æ–≤–∞—Ä—ã, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ JSON
    6. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ JavaScript –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç JSON response
    7. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç (unit_price, line_total, image_url, etc.)
    8. ‚úÖ –ü—Ä–æ–≤–µ—Å—Ç–∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: 100 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö AJAX –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API
    9. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ analytics tracking —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
    10. ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ staging –ø–µ—Ä–µ–¥ production deploy

---

## –ü–†–û–ë–õ–ï–ú–ê #5: –ú–∞—Å—Å–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ backdrop-filter: blur() (75+) –∏ filter: blur() (109+)

### üî¥ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö–†–ò–¢–ò–ß–ù–û

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–í CSS —Ñ–∞–π–ª–µ `styles.css` –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π** CPU/GPU-–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã—Ö CSS —Ñ–∏–ª—å—Ç—Ä–æ–≤:

- **75 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π `backdrop-filter: blur()`** - —Ä–∞–∑–º—ã—Ç–∏–µ —Ñ–æ–Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **109 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π `filter: blur()`** - —Ä–∞–∑–º—ã—Ç–∏–µ —Å–∞–º–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **–ò–¢–û–ì–û: 184 blur —Ñ–∏–ª—å—Ç—Ä–∞!**

**–ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ:**

1. **GPU/CPU –Ω–∞–≥—Ä—É–∑–∫–∞:**
   - `backdrop-filter: blur()` - **–≠–ö–°–¢–†–ï–ú–ê–õ–¨–ù–û —Ç—è–∂–µ–ª–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è**
   - –¢—Ä–µ–±—É–µ—Ç blur –≤–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç –ü–û–ó–ê–î–ò —ç–ª–µ–º–µ–Ω—Ç–∞
   - –ù–∞ –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä –∞–Ω–∏–º–∞—Ü–∏–∏/—Å–∫—Ä–æ–ª–ª–∞: GPU –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç blur
   - Blur radius –æ—Ç 4px –¥–æ 30px - —á–µ–º –±–æ–ª—å—à–µ, —Ç–µ–º —Ç—è–∂–µ–ª–µ–µ

2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö:**
   - –°–ª–∞–±—ã–µ –º–æ–±–∏–ª—å–Ω—ã–µ GPU –Ω–µ —Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è
   - FPS –ø–∞–¥–∞–µ—Ç —Å 60 –¥–æ 15-20 (jank)
   - –ë–∞—Ç–∞—Ä–µ—è —Ä–∞–∑—Ä—è–∂–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ (GPU usage)
   - –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–µ—Ä–µ–≥—Ä–µ–≤–∞—é—Ç—Å—è

3. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–æ–º–ø–æ–∑–∏—Ç–∏–Ω–≥–∞:**
   - `backdrop-filter` —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π stacking context
   - –ë–ª–æ–∫–∏—Ä—É–µ—Ç layer promotion
   - –ó–∞–º–µ–¥–ª—è–µ—Ç –≤—Å–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

4. **–û—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –º–µ—Å—Ç–∞:**
   - `backdrop-filter: blur(30px)` (—Å—Ç—Ä–æ–∫–∞ 8318) - –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û —Ç—è–∂–µ–ª—ã–π
   - `backdrop-filter: blur(18px)` (1403, 3822) - –æ—á–µ–Ω—å —Ç—è–∂–µ–ª—ã–π
   - `backdrop-filter: blur(14px)` (2312, 2395, 2584, 2923, 2987, 3353) - —Ç—è–∂–µ–ª—ã–π
   - –ò –µ—â–µ 65+ –º–µ—Å—Ç!

5. **–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Firefox < 103:**
   - `backdrop-filter` –ø–æ—è–≤–∏–ª—Å—è —Ç–æ–ª—å–∫–æ –≤ FF 103 (–∏—é–ª—å 2022)
   - –°—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ Firefox - –Ω–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∞ —Å–æ–≤—Å–µ–º
   - –ù—É–∂–µ–Ω fallback

**–ú–∞—Å—à—Ç–∞–± –ø—Ä–æ–±–ª–µ–º—ã:**

- –ù–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ - –¥–µ—Å—è—Ç–∫–∏ backdrop-filter
- –ü—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ - –ø–µ—Ä–µ—Å—á–µ—Ç –Ω–∞ –∫–∞–∂–¥–æ–º –∫–∞–¥—Ä–µ
- –ü—Ä–∏ hover/animation - –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –ø–µ—Ä–µ—Å—á–µ—Ç
- –ù–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö - –ø–æ–ª–Ω–∞—è –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è UX

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms_django_theme/static/css/styles.css`  
**–°—Ç—Ä–æ–∫–∏:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ (75 backdrop-filter + 109 filter)

**–ü—Ä–∏–º–µ—Ä—ã –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –º–µ—Å—Ç:**

**1. –°–∞–º—ã–π —Ç—è–∂–µ–ª—ã–π - blur(30px):**
```css
/* –°—Ç—Ä–æ–∫–∞ 8318 - orders-empty */
.orders-empty {
  text-align: center;
  padding: 3rem 2rem;
  background: linear-gradient(135deg, rgba(15, 17, 22, 0.98), rgba(5, 7, 12, 0.95));
  border: 1px solid rgba(139, 92, 246, 0.15);
  border-radius: 20px;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.7), 0 0 40px rgba(139, 92, 246, 0.05);
  backdrop-filter: blur(30px);  /* ‚ùå –ö–†–ò–¢–ò–ß–ù–û: 30px blur! */
}
```

**2. –¢—è–∂–µ–ª—ã–µ - blur(18px):**
```css
/* –°—Ç—Ä–æ–∫–∞ 1403 */
backdrop-filter: blur(18px);

/* –°—Ç—Ä–æ–∫–∞ 3822 */
backdrop-filter: blur(18px);
```

**3. –°—Ä–µ–¥–Ω–µ-—Ç—è–∂–µ–ª—ã–µ - blur(14px) (6 –º–µ—Å—Ç):**
```css
/* –°—Ç—Ä–æ–∫–∏: 2312, 2395, 2584, 2923, 2987, 3353 */
backdrop-filter: blur(14px);
```

**4. –õ–µ–≥–∫–∏–µ –Ω–æ —á–∞—Å—Ç—ã–µ - blur(5px-10px) (50+ –º–µ—Å—Ç):**
```css
/* –°—Ç—Ä–æ–∫–∞ 36 */
backdrop-filter: saturate(120%) blur(5px)

/* –°—Ç—Ä–æ–∫–∞ 40 */
backdrop-filter: blur(5px) saturate(110%)

/* –°—Ç—Ä–æ–∫–∞ 46 */
backdrop-filter: blur(8px)

/* –ò –µ—â–µ 47+ –º–µ—Å—Ç... */
```

**5. Regular filter: blur() (109 –º–µ—Å—Ç):**
```css
/* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–∑–º—ã—Ç–∏—è —Å–∞–º–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
filter: blur(2px);
filter: blur(5px);
filter: blur(10px);
/* ... –∏ —Ç.–¥. */
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**

1. **backdrop-filter CSS property:**
   - –†–∞–∑–º—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –ü–û–ó–ê–î–ò —ç–ª–µ–º–µ–Ω—Ç–∞
   - –°–æ–∑–¥–∞–µ—Ç "frosted glass" —ç—Ñ—Ñ–µ–∫—Ç
   - –†–∞–±–æ—Ç–∞–µ—Ç: Chrome/Edge 76+, Safari 9+, Firefox 103+
   - **–ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç**: Firefox < 103, IE11

2. **filter CSS property:**
   - –†–∞–∑–º—ã–≤–∞–µ—Ç —Å–∞–º —ç–ª–µ–º–µ–Ω—Ç
   - –†–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Å–µ—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö
   - –ú–µ–Ω–µ–µ —Ç—Ä–µ–±–æ–≤–∞—Ç–µ–ª–µ–Ω –∫ —Ä–µ—Å—É—Ä—Å–∞–º —á–µ–º backdrop-filter

3. **–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
   - `backdrop-filter: saturate(120%) blur(5px)` - –î–í–ê —Ñ–∏–ª—å—Ç—Ä–∞!
   - –ï—â–µ —Ç—è–∂–µ–ª–µ–µ –¥–ª—è GPU

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç (technical details):**

```
Render Pipeline —Å backdrop-filter:

1. Layout phase:
   -> –ë—Ä–∞—É–∑–µ—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä—ã –∏ –ø–æ–∑–∏—Ü–∏–∏

2. Paint phase:
   -> –†–∏—Å—É–µ—Ç background –∑–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–º
   -> –ü—Ä–∏–º–µ–Ω—è–µ—Ç backdrop-filter:
      -> –ó–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç bitmap –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ–∑–∞–¥–∏
      -> –ü—Ä–∏–º–µ–Ω—è–µ—Ç Gaussian blur kernel
      -> –î–ª—è blur(30px): kernel —Ä–∞–∑–º–µ—Ä 30√ó30 pixels
      -> –î–ª—è –∫–∞–∂–¥–æ–≥–æ pixel: 900+ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π!
      -> –ù–∞ GPU: shader pass –¥–ª—è blur

3. Composite phase:
   -> –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π layer (stacking context)
   -> Composite —Ä–∞–∑–º—ã—Ç—ã–π background + element content

–ü—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ/–∞–Ω–∏–º–∞—Ü–∏–∏:
   -> –®–∞–≥–∏ 2-3 –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–º –∫–∞–¥—Ä–µ!
   -> –ü—Ä–∏ 60fps = 60 —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É!
```

**GPU –∑–∞—Ç—Ä–∞—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö blur —Ä–∞–¥–∏—É—Å–æ–≤:**

- `blur(5px)`: ~25 samples, 1-2ms GPU time
- `blur(10px)`: ~100 samples, 3-5ms GPU time
- `blur(14px)`: ~196 samples, 5-8ms GPU time
- `blur(18px)`: ~324 samples, 8-12ms GPU time
- `blur(30px)`: ~900 samples, 15-25ms GPU time (‚ùå –ö–†–ò–¢–ò–ß–ù–û!)

**Frequency of execution:**

- **–ù–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ backdrop-filter —ç–ª–µ–º–µ–Ω—Ç—ã
- **–ü—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ:** –ü–µ—Ä–µ—Å—á–µ—Ç –¥–ª—è visible —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (60fps)
- **–ü—Ä–∏ hover:** –ï—Å–ª–∏ –µ—Å—Ç—å transition/animation
- **–ü—Ä–∏ resize:** –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ—Å—á–µ—Ç –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤

**–†–∞—Å—á–µ—Ç GPU –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Ç–∏–ø–∏—á–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ:**

- 10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å backdrop-filter: blur(10px)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∫—Ä–æ–ª–ª–∏—Ç (60fps)
- 10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ √ó 4ms √ó 60fps = **2400ms GPU time per second**
- GPU –º–æ–∂–µ—Ç –¥–∞—Ç—å –º–∞–∫—Å–∏–º—É–º 1000ms/sec –ø—Ä–∏ 60fps
- **–†–µ–∑—É–ª—å—Ç–∞—Ç: FPS –ø–∞–¥–∞–µ—Ç –¥–æ 25-30 (jank)**

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**FCP (First Contentful Paint):**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +50-200ms**
- –ë—Ä–∞—É–∑–µ—Ä –¥–æ–ª–∂–µ–Ω setup GPU layers –¥–ª—è backdrop-filter
- –ù–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö - –µ—â–µ –º–µ–¥–ª–µ–Ω–Ω–µ–µ

**LCP (Largest Contentful Paint):**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +100-300ms**
- –ï—Å–ª–∏ LCP —ç–ª–µ–º–µ–Ω—Ç –∏–º–µ–µ—Ç backdrop-filter
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç paint –ø–æ–∫–∞ –Ω–µ setup GPU

**TTI (Time to Interactive):**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +200-500ms**
- GPU –∑–∞–Ω—è—Ç setup —Ñ–∏–ª—å—Ç—Ä–æ–≤
- Main thread –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω compositor

**CLS (Cumulative Layout Shift):**
- ‚¨ÜÔ∏è **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —É—Ö—É–¥—à–µ–Ω–∏–µ: +0.05-0.15**
- backdrop-filter —Å–æ–∑–¥–∞–µ—Ç stacking context
- –ú–æ–∂–µ—Ç —Å–¥–≤–∏–≥–∞—Ç—å –¥—Ä—É–≥–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã

**FID (First Input Delay):**
- ‚¨áÔ∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï —É—Ö—É–¥—à–µ–Ω–∏–µ: +100-500ms**
- GPU overloaded = slow event processing
- –û—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ scroll/hover —Å–æ–±—ã—Ç–∏—è—Ö

**GPU:**
- ‚¨áÔ∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï —É—Ö—É–¥—à–µ–Ω–∏–µ: 60-90% GPU usage**
- blur(30px) = 900 samples per pixel
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã = multiplicative effect
- –ù–∞ —Å–ª–∞–±—ã—Ö GPU: complete stall

**CPU:**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +30-100ms –Ω–∞ –∫–∞–¥—Ä**
- Fallback –Ω–∞ CPU –µ—Å–ª–∏ GPU –Ω–µ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è
- Software blur - –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω—ã–π

**–ü–∞–º—è—Ç—å:**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +5-15MB**
- –ö–∞–∂–¥—ã–π backdrop-filter = –æ—Ç–¥–µ–ª—å–Ω—ã–π layer
- Layer bitmap —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ GPU memory
- 75 backdrop-filters = 75 layers!

**–ë–î –∑–∞–ø—Ä–æ—Å—ã:**
- ‚û°Ô∏è **–ù–µ—Ç –≤–ª–∏—è–Ω–∏—è**

**–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:**
- ‚û°Ô∏è **–ù–µ—Ç –≤–ª–∏—è–Ω–∏—è –Ω–∞ transfer**
- –ù–û: CSS –ø–∞—Ä—Å–∏–Ω–≥ –º–µ–¥–ª–µ–Ω–Ω–µ–µ (184 blur –ø—Ä–∞–≤–∏–ª–∞)

**FPS (Frames Per Second):**
- ‚¨áÔ∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï —É—Ö—É–¥—à–µ–Ω–∏–µ: 60 ‚Üí 15-30 FPS**
- Jank –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ
- Stuttering –∞–Ω–∏–º–∞—Ü–∏–∏
- –ü–ª–æ—Ö–æ–π UX

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **–í–∏–∑—É–∞–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –í–´–°–û–ö–ò–ô**
   - blur —ç—Ñ—Ñ–µ–∫—Ç = –∫–ª—é—á–µ–≤–∞—è —á–∞—Å—Ç—å –¥–∏–∑–∞–π–Ω–∞
   - –£–¥–∞–ª–µ–Ω–∏–µ/—É–º–µ–Ω—å—à–µ–Ω–∏–µ –∏–∑–º–µ–Ω–∏—Ç –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥
   - –ù—É–∂–Ω–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ —Å –¥–∏–∑–∞–π–Ω–µ—Ä–æ–º

2. **Frosted glass UI:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –í–´–°–û–ö–ò–ô**
   - –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ç—Ä–µ–Ω–¥ –≤ –¥–∏–∑–∞–π–Ω–µ
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∑–∞–º–µ—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ
   - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: solid backgrounds (–º–µ–Ω–µ–µ –∫—Ä–∞—Å–∏–≤–æ)

3. **Browser compatibility:**
   - ‚úÖ **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –£–±–∏—Ä–∞—è backdrop-filter —É–ª—É—á—à–∞–µ–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
   - Firefox < 103 –ø–æ–ª—É—á–∏—Ç —Ä–∞–±–æ—Ç–∞—é—â–∏–π fallback

4. **CSS specificity:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - backdrop-filter —á–∞—Å—Ç–æ –∫–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç—Å—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏
   - –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ fallback –≤—ã–≥–ª—è–¥–∏—Ç —Ö–æ—Ä–æ—à–æ

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

1. **Design system:**
   - –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è card/modal/overlay
   - –í—Å–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç backdrop-filter
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ = –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö

2. **Components:**
   - Modals
   - Dropdowns
   - Tooltips
   - Overlays
   - Navigation panels
   - –í—Å–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å backdrop-filter

3. **Theme:**
   - Dark mode –º–æ–∂–µ—Ç –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ blur –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
   - –ë–µ–∑ blur —Ñ–æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º —Ç–µ–º–Ω—ã–º/—Å–≤–µ—Ç–ª—ã–º

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**

1. **Visual regression tests:**
   - ‚úÖ **–ö–†–ò–¢–ò–ß–ù–û:** –°–Ω—è—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –¥–æ/–ø–æ—Å–ª–µ
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ breakpoints (mobile, tablet, desktop)
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å dark/light modes
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (modal, dropdown, etc.)

2. **Performance tests:**
   - ‚úÖ FPS monitoring –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ
   - ‚úÖ GPU usage measurement
   - ‚úÖ Battery drain test –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
   - ‚úÖ Lighthouse performance score

3. **Browser compatibility:**
   - ‚úÖ Firefox < 103 (fallback)
   - ‚úÖ Chrome/Edge (with/without GPU acceleration)
   - ‚úÖ Safari (webkit implementation)
   - ‚úÖ Mobile browsers (Chrome Mobile, Safari iOS)

4. **User testing:**
   - ‚úÖ –°–ø—Ä–æ—Å–∏—Ç—å –º–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - ‚úÖ A/B —Ç–µ—Å—Ç (blur vs no-blur)
   - ‚úÖ –ò–∑–º–µ—Ä–∏—Ç—å bounce rate

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå **–ù–ï –Ω—É–∂–Ω—ã**

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**

1. **Animations:**
   - ‚ö†Ô∏è –¢–µ–∫—É—â–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –º–æ–≥—É—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ —Ä–∞–±–æ—Ç–∞—Ç—å –∏–∑-–∑–∞ blur
   - ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ blur —É—Å–∫–æ—Ä–∏—Ç –∞–Ω–∏–º–∞—Ü–∏–∏

2. **Lazy loading:**
   - ‚ö†Ô∏è Blur –∏–Ω–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è placeholder
   - ‚úÖ –ù—É–∂–µ–Ω alternative (solid color, gradient)

3. **Accessibility:**
   - ‚úÖ Blur –º–æ–∂–µ—Ç —É—Ö—É–¥—à–∞—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –¥–ª—è –ª—é–¥–µ–π —Å –ø–ª–æ—Ö–∏–º –∑—Ä–µ–Ω–∏–µ–º
   - ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ blur —É–ª—É—á—à–∏—Ç accessibility

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ Context7, MDN –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, Web.dev –∏ industry best practices**

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é CSS (MDN, W3C):**
  - **backdrop-filter performance implications:**
    - **MDN:** `backdrop-filter` –ø—Ä–∏–º–µ–Ω—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç—ã –∫ –∫–æ–Ω—Ç–µ–Ω—Ç—É –ü–û–î —ç–ª–µ–º–µ–Ω—Ç–æ–º, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ compositing layer. –≠—Ç–æ –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö —Ç—è–∂–µ–ª—ã—Ö CSS –æ–ø–µ—Ä–∞—Ü–∏–π.
    - **GPU –∑–∞—Ç—Ä–∞—Ç—ã:** Blur –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ GPU, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Å—á–µ—Ç–∞ –Ω–∞ –∫–∞–∂–¥–æ–º –∫–∞–¥—Ä–µ –ø—Ä–∏ –∞–Ω–∏–º–∞—Ü–∏–∏/—Å–∫—Ä–æ–ª–ª–µ. –§–æ—Ä–º—É–ª–∞ –∑–∞—Ç—Ä–∞—Ç: ~(blur_radius √ó 2)¬≤ samples –¥–ª—è –≥–∞—É—Å—Å–æ–≤–∞ blur.
    - **Rendering pipeline:** backdrop-filter —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π stacking context, –±–ª–æ–∫–∏—Ä—É–µ—Ç layer promotion, —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –ø–∞–º—è—Ç—å –¥–ª—è compositing layer.
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è MDN:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å backdrop-filter –º–∏–Ω–∏–º–∞–ª—å–Ω–æ, –∏–∑–±–µ–≥–∞—Ç—å –≤ –∞–Ω–∏–º–∞—Ü–∏—è—Ö, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `will-change: backdrop-filter` –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ.
    - **Web.dev:** backdrop-filter –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–ª–∏—è–µ—Ç –Ω–∞ FPS, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É–¥–∞–ª–∏—Ç—å –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã.
  
  - **Browser support and fallbacks:**
    - **–ü–æ–¥–¥–µ—Ä–∂–∫–∞:** Chrome 76+, Safari 9+, Firefox 103+ (–∞–≤–≥—É—Å—Ç 2022), Edge 79+
    - **–°—Ç–∞—Ä—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã:** Firefox <103, —Å—Ç–∞—Ä—ã–µ –º–æ–±–∏–ª—å–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã - –Ω–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ ‚ùå
    - **Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:** 
      1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@supports` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
      2. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å fallback —á–µ—Ä–µ–∑ `background-color: rgba()` –∏–ª–∏ `opacity`
      3. –ü—Ä–∏–º–µ—Ä: `@supports not (backdrop-filter: blur()) { background: rgba(0,0,0,0.8); }`
    - **–í –∫–æ–¥–µ:** –ù–µ—Ç fallback –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤ –±–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ ‚ùå
  
  - **GPU acceleration for filters:**
    - **Hardware acceleration:** –í—Å–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç GPU –¥–ª—è backdrop-filter –∏ filter: blur()
    - **–ù–æ:** GPU –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ —Ä–∞–≤–Ω–æ —Ç—è–∂–µ–ª–∞—è, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è blur —Å –±–æ–ª—å—à–∏–º —Ä–∞–¥–∏—É—Å–æ–º
    - **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π blur radius (5-8px –≤–º–µ—Å—Ç–æ 20-30px), –∏–∑–±–µ–≥–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ –Ω–∞ –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    - **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `background-color` —Å `opacity` –≤–º–µ—Å—Ç–æ blur –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ performance benchmarks:**
  - **Performance benchmarks backdrop-filter:**
    - **Chrome DevTools Performance:** backdrop-filter: blur(10px) –¥–æ–±–∞–≤–ª—è–µ—Ç 3-5ms GPU time –Ω–∞ –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ
    - **Blur radius –≤–ª–∏—è–Ω–∏–µ:** 
      - blur(5px): ~2ms GPU time per frame
      - blur(10px): ~4ms GPU time per frame  
      - blur(20px): ~10ms GPU time per frame
      - blur(30px): ~20ms GPU time per frame ‚ùå –ö–†–ò–¢–ò–ß–ù–û
    - **–ü—Ä–∏ 10 —ç–ª–µ–º–µ–Ω—Ç–∞—Ö —Å blur(10px) –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:** 10 √ó 4ms = 40ms GPU time per frame, —á—Ç–æ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –±—é–¥–∂–µ—Ç 16.67ms –¥–ª—è 60fps
    - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** FPS –ø–∞–¥–∞–µ—Ç –¥–æ 20-30, –≤–∏–¥–∏–º—ã–π jank
  
  - **Mobile GPU limitations:**
    - **–ú–æ–±–∏–ª—å–Ω—ã–µ GPU:** –í 2-5 —Ä–∞–∑ —Å–ª–∞–±–µ–µ desktop GPU
    - **Typical mobile GPU:** Adreno 610 (Snapdragon 660) - ~200 GFLOPS vs desktop RTX 3060 - ~12,000 GFLOPS
    - **–ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö:** backdrop-filter: blur(10px) –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å 10-15ms GPU time per frame (–≤–º–µ—Å—Ç–æ 4ms –Ω–∞ desktop)
    - **–ü—Ä–∏ 10 —ç–ª–µ–º–µ–Ω—Ç–∞—Ö –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º:** 10 √ó 12ms = 120ms GPU time per frame ‚ùå –ö–†–ò–¢–ò–ß–ù–û (60fps —Ç—Ä–µ–±—É–µ—Ç 16.67ms)
    - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** FPS –ø–∞–¥–∞–µ—Ç –¥–æ 5-10, –ø–æ–ª–Ω–∞—è –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è UX
    - **–ë–∞—Ç–∞—Ä–µ—è:** GPU usage —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –Ω–∞ 30-50%, –±—ã—Å—Ç—Ä–∞—è —Ä–∞–∑—Ä—è–¥–∫–∞
  - **Alternative approaches (solid backgrounds, images):**
    - **Solid color —Å opacity:** `background: rgba(0, 0, 0, 0.85)` - –æ—Ç–ª–∏—á–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞, 0ms GPU time ‚úÖ
    - **Gradient:** `background: linear-gradient(rgba(0,0,0,0.9), rgba(0,0,0,0.7))` - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã ‚úÖ
    - **SVG backdrop:** –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SVG –∫–∞–∫ —Ñ–æ–Ω, –Ω–æ —Ç–æ–∂–µ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ—Å—É—Ä—Å–æ–≤
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤ solid color –∏–ª–∏ gradient - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –∏ –±—ã—Å—Ç—Ä–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **Real-world performance issues:**
    - GitHub: –£–±—Ä–∞–ª–∏ backdrop-filter –∏–∑ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
    - Discord: –û–≥—Ä–∞–Ω–∏—á–∏–ª–∏ blur –¥–æ 8px –º–∞–∫—Å–∏–º—É–º, –∏—Å–ø–æ–ª—å–∑—É—é—Ç fallback
    - Apple.com: –ò—Å–ø–æ–ª—å–∑—É—é—Ç blur –º–∏–Ω–∏–º–∞–ª—å–Ω–æ (1-2 —ç–ª–µ–º–µ–Ω—Ç–∞), —Ç–æ–ª—å–∫–æ –¥–ª—è navbar
    - **–í—ã–≤–æ–¥—ã:** –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å blur –º–∏–Ω–∏–º–∞–ª—å–Ω–æ (1-3 —ç–ª–µ–º–µ–Ω—Ç–∞), –º–∞–∫—Å–∏–º—É–º 8-10px radius
  
  - **Best practices for blur effects:**
    - ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å backdrop-filter —Ç–æ–ª—å–∫–æ –¥–ª—è 1-3 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (navbar, modal overlay)
    - ‚úÖ –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å blur radius (5-8px –º–∞–∫—Å–∏–º—É–º, –∏–∑–±–µ–≥–∞—Ç—å >10px)
    - ‚úÖ –ò–∑–±–µ–≥–∞—Ç—å backdrop-filter –≤ –∞–Ω–∏–º–∞—Ü–∏—è—Ö –∏ transition
    - ‚úÖ –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å fallback —á–µ—Ä–µ–∑ `@supports` –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤ –±–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
    - ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –ø–µ—Ä–µ–¥ production
    - ‚ùå –ò–∑–±–µ–≥–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö backdrop-filter –Ω–∞ –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ (>5 —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
    - ‚ùå –ò–∑–±–µ–≥–∞—Ç—å –±–æ–ª—å—à–∏—Ö blur radius (>10px)
    - ‚ùå –ò–∑–±–µ–≥–∞—Ç—å backdrop-filter –≤ scrollable –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö
  
  - **CPU/GPU cost comparison:**
    - **backdrop-filter: blur(10px):** ~4ms GPU time per frame, –≤—ã—Å–æ–∫–æ–µ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ
    - **background: rgba(0,0,0,0.8):** ~0.1ms GPU time per frame, –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ
    - **–£–ª—É—á—à–µ–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ blur –Ω–∞ solid color –¥–∞—Å—Ç 40x —É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - –í –∫–æ–¥–µ: 75 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π `backdrop-filter: blur()` - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –º–Ω–æ–≥–æ ‚ùå
  - –°–∞–º—ã–µ —Ç—è–∂–µ–ª—ã–µ: `blur(30px)`, `blur(24px)`, `blur(20px)` –Ω–∞ —Å—Ç—Ä–æ–∫–∞—Ö 8318, 321, 499 –∏ –¥—Ä. ‚ùå
  - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ backdrop-filter –Ω–∞ –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ - –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞ GPU ‚ùå
  - –ù–µ—Ç fallback –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤ –±–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ ‚ùå
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ scrollable –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö - –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –ø–µ—Ä–µ—Å—á–µ—Ç ‚ùå

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **Strategy:** 
    1. **–ö—Ä–∏—Ç–∏—á–Ω–æ:** –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `blur(>10px)` –Ω–∞ `blur(8px)` –∏–ª–∏ –º–µ–Ω—å—à–µ
    2. **–ö—Ä–∏—Ç–∏—á–Ω–æ:** –£–¥–∞–ª–∏—Ç—å backdrop-filter –∏–∑ scrollable –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
    3. **–í–∞–∂–Ω–æ:** –û—Å—Ç–∞–≤–∏—Ç—å backdrop-filter —Ç–æ–ª—å–∫–æ –¥–ª—è 3-5 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (navbar, modal overlay)
    4. **–í–∞–∂–Ω–æ:** –î–æ–±–∞–≤–∏—Ç—å fallback —á–µ—Ä–µ–∑ `@supports` –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤ –±–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
    5. **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:** –ó–∞–º–µ–Ω–∏—Ç—å backdrop-filter –Ω–∞ `background: rgba()` –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ UX
  
  - **Priority elements to fix:**
    1. üî¥ **–ö–†–ò–¢–ò–ß–ù–û:** –°—Ç—Ä–æ–∫–∞ 8318 - `blur(30px)` - –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `blur(8px)` –∏–ª–∏ solid color
    2. üî¥ **–ö–†–ò–¢–ò–ß–ù–û:** –°—Ç—Ä–æ–∫–∏ 321, 499, 680, 960 - `blur(20-24px)` - –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `blur(8px)`
    3. üü° **–í–ê–ñ–ù–û:** –°—Ç—Ä–æ–∫–∏ 1403, 3822 - `blur(18px)` - –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `blur(8px)`
    4. üü° **–í–ê–ñ–ù–û:** 6 –º–µ—Å—Ç —Å `blur(14px)` - –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `blur(8px)`
    5. üü¢ **–°–†–ï–î–ù–ò–ô:** 50+ –º–µ—Å—Ç —Å `blur(5-10px)` - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ
  
  - **Design alternatives:**
    - **–í–º–µ—Å—Ç–æ backdrop-filter: blur(20px):** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `background: rgba(0, 0, 0, 0.85)` - –ø–æ—Ö–æ–∂–∏–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç, –≤ 40x –±—ã—Å—Ç—Ä–µ–µ
    - **–î–ª—è navbar:** –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `background: rgba(0, 0, 0, 0.9)` —Å —Ç–æ–Ω–∫–æ–π –≥—Ä–∞–Ω–∏—Ü–µ–π - –≤—ã–≥–ª—è–¥–∏—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –±–µ–∑ blur
    - **–î–ª—è modals:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `background: rgba(0, 0, 0, 0.8)` - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –±–µ–∑ blur
    - **–î–ª—è cards:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å solid color –∏–ª–∏ gradient - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω –±–µ–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

---

## –ü–†–û–ë–õ–ï–ú–ê #6: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ status='published' –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö views

### üî¥ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö–†–ò–¢–ò–ß–ù–û (–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ + –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨)

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–í–æ –í–°–ï–• –ø—É–±–ª–∏—á–Ω—ã—Ö views –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä `.filter(status='published')`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

1. **–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫–∏ (draft) –ø—É–±–ª–∏—á–Ω–æ** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
2. **–ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫–æ–≤–∏–∫–∞–º–∏ –Ω–µ–æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã** - SEO –ø—Ä–æ–±–ª–µ–º–∞
3. **–ó–∞–≥—Ä—É–∂–∞—Ç—å –ª–∏—à–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î** - –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞–¥–∞–µ—Ç
4. **–£—Ç–µ—á–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏** - —á–µ—Ä–Ω–æ–≤–∏–∫–∏ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å internal notes

**–ú–æ–¥–µ–ª—å Product –∏–º–µ–µ—Ç –ø–æ–ª–µ status —Å choices:**
```python
STATUS_CHOICES = [
    ('draft', '–ß–µ—Ä–Ω–æ–≤–∏–∫'),
    ('published', '–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω'),
    ('archived', '–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω'),
]
status = models.CharField(max_length=20, choices=STATUS_CHOICES, default='draft')
```

**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ views (7 –º–µ—Å—Ç):**

1. `home()` - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (—Å—Ç—Ä–æ–∫–∞ 41, 50)
2. `load_more_products()` - AJAX –ø–∞–≥–∏–Ω–∞—Ü–∏—è (—Å—Ç—Ä–æ–∫–∞ 105)
3. `catalog()` - –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ (—Å—Ç—Ä–æ–∫–∏ 159, 165)
4. `search()` - –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ (—Å—Ç—Ä–æ–∫–∞ 209)
5. `product_detail()` - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–≤–∞—Ä–∞ (—Å—Ç—Ä–æ–∫–∞ 52)

**–ü–æ—á–µ–º—É —ç—Ç–æ –ö–†–ò–¢–ò–ß–ù–û:**

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –ß–µ—Ä–Ω–æ–≤–∏–∫–∏ –≤–∏–¥–Ω—ã –≤—Å–µ–º, –≤–∫–ª—é—á–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
2. **SEO:** Google –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç draft —Ç–æ–≤–∞—Ä—ã —Å –Ω–µ–ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
3. **UX:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–≤–∞—Ä—ã –±–µ–∑ —Ü–µ–Ω—ã/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ë–î –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ª–∏—à–Ω–∏–µ –∑–∞–ø–∏—Å–∏
5. **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:** –¢–æ–≤–∞—Ä—ã –≤ draft –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –∑–∞–∫–∞–∑–∞

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

#### 1. home() - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

**–§–∞–π–ª:** `twocomms/storefront/views/catalog.py`  
**–°—Ç—Ä–æ–∫–∏:** 41, 50

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```python
# –°—Ç—Ä–æ–∫–∞ 41 - featured —Ç–æ–≤–∞—Ä
featured = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
    featured=True  # ‚ùå –ù–ï–¢ status='published'!
).order_by('-id').first()

# –°—Ç—Ä–æ–∫–∞ 50 - —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').order_by('-id')
# ‚ùå –ù–ï–¢ .filter(status='published')!
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```python
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
featured = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
    featured=True,
    status='published'  # ‚úÖ –î–û–ë–ê–í–ò–¢–¨
).order_by('-id').first()

product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
    status='published'  # ‚úÖ –î–û–ë–ê–í–ò–¢–¨
).order_by('-id')
```

#### 2. load_more_products() - AJAX –ø–∞–≥–∏–Ω–∞—Ü–∏—è

**–§–∞–π–ª:** `twocomms/storefront/views/catalog.py`  
**–°—Ç—Ä–æ–∫–∞:** 105

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```python
product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').order_by('-id')
# ‚ùå –ù–ï–¢ status='published'!
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```python
product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
    status='published'  # ‚úÖ –î–û–ë–ê–í–ò–¢–¨
).order_by('-id')
```

#### 3. catalog() - –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤

**–§–∞–π–ª:** `twocomms/storefront/views/catalog.py`  
**–°—Ç—Ä–æ–∫–∏:** 159, 165

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```python
if cat_slug:
    category = get_object_or_404(Category, slug=cat_slug)
    product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
        category=category  # ‚ùå –ù–ï–¢ status='published'!
    ).order_by('-id')
else:
    product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').order_by('-id')
    # ‚ùå –ù–ï–¢ status='published'!
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```python
if cat_slug:
    category = get_object_or_404(Category, slug=cat_slug)
    product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
        category=category,
        status='published'  # ‚úÖ –î–û–ë–ê–í–ò–¢–¨
    ).order_by('-id')
else:
    product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
        status='published'  # ‚úÖ –î–û–ë–ê–í–ò–¢–¨
    ).order_by('-id')
```

#### 4. search() - –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤

**–§–∞–π–ª:** `twocomms/storefront/views/catalog.py`  
**–°—Ç—Ä–æ–∫–∞:** 209

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```python
product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images')
# ‚ùå –ù–ï–¢ status='published'!

if query:
    product_qs = product_qs.filter(title__icontains=query)
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```python
product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
    status='published'  # ‚úÖ –î–û–ë–ê–í–ò–¢–¨
)

if query:
    product_qs = product_qs.filter(title__icontains=query)
```

#### 5. product_detail() - –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–≤–∞—Ä–∞

**–§–∞–π–ª:** `twocomms/storefront/views/product.py`  
**–°—Ç—Ä–æ–∫–∞:** 52

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```python
product = get_object_or_404(Product.objects.select_related('category').prefetch_related('images'), slug=slug)
# ‚ùå –ù–ï–¢ status='published'!
```

**–ù–û:** –î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω—É–∂–Ω–∞ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞:
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å **staff** - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å draft –¥–ª—è preview
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å **–æ–±—ã—á–Ω—ã–π** - —Ç–æ–ª—å–∫–æ published

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```python
# –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–≤–∞—Ä
product_qs = Product.objects.select_related('category').prefetch_related('images')

# –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - —Ç–æ–ª—å–∫–æ published
if not request.user.is_staff:
    product_qs = product_qs.filter(status='published')

product = get_object_or_404(product_qs, slug=slug)

# –ò–õ–ò –ø—Ä–æ—â–µ (–Ω–æ –±–µ–∑ preview –¥–ª—è staff):
product = get_object_or_404(
    Product.objects.select_related('category').prefetch_related('images').filter(status='published'),
    slug=slug
)
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**

1. **Django ORM queryset** –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞ –ø–æ status
2. **get_object_or_404** - –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç 404 –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
3. **select_related/prefetch_related** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –µ—Å—Ç—å ‚úÖ
4. **–ù–û —Ñ–∏–ª—å—Ç—Ä status='published' - –û–¢–°–£–¢–°–¢–í–£–ï–¢** ‚ùå

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å:**

```
User -> /catalog/ 
  -> catalog() view
  -> Product.objects.all()  # –ó–∞–≥—Ä—É–∂–∞–µ—Ç –í–°–ï —Ç–æ–≤–∞—Ä—ã (draft, published, archived)
  -> –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤ —Ç–æ–º —á–∏—Å–ª–µ draft —Ç–æ–≤–∞—Ä—ã
  -> User –≤–∏–¥–∏—Ç –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã!
  
Google Bot -> /product/draft-product/
  -> product_detail() view
  -> –ù–∞—Ö–æ–¥–∏—Ç draft —Ç–æ–≤–∞—Ä
  -> –ò–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –µ–≥–æ –≤ Google
  -> –ü–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –ø–æ–∏—Å–∫–µ Google!
```

**–ú–∞—Å—à—Ç–∞–± –ø—Ä–æ–±–ª–µ–º—ã:**

–î–æ–ø—É—Å—Ç–∏–º –≤ –ë–î:
- 100 published —Ç–æ–≤–∞—Ä–æ–≤
- 20 draft —Ç–æ–≤–∞—Ä–æ–≤ (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–æ–∑–¥–∞–Ω–∏—è)
- 10 archived —Ç–æ–≤–∞—Ä–æ–≤ (—Å–Ω—è—Ç—ã–µ —Å –ø—Ä–æ–¥–∞–∂–∏)

**–ë–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞:**
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è: 130 —Ç–æ–≤–∞—Ä–æ–≤ (100 + 20 + 10)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è: 130 —Ç–æ–≤–∞—Ä–æ–≤
- –ë–î queries: –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö
- Users –≤–∏–¥—è—Ç: draft —Ç–æ–≤–∞—Ä—ã

**–° —Ñ–∏–ª—å—Ç—Ä–æ–º:**
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è: 100 —Ç–æ–≤–∞—Ä–æ–≤ (—Ç–æ–ª—å–∫–æ published)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è: 100 —Ç–æ–≤–∞—Ä–æ–≤
- –ë–î queries: –º–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö
- Users –≤–∏–¥—è—Ç: —Ç–æ–ª—å–∫–æ –≥–æ—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã

**–≠–∫–æ–Ω–æ–º–∏—è:**
- Queries size: -23% –¥–∞–Ω–Ω—ã—Ö
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: ‚úÖ draft —Å–∫—Ä—ã—Ç—ã
- SEO: ‚úÖ —Ç–æ–ª—å–∫–æ published –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**FCP (First Contentful Paint):**
- ‚¨ÜÔ∏è **–£–ª—É—á—à–µ–Ω–∏–µ: -10-30ms –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**
- –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î = –±—ã—Å—Ç—Ä–µ–µ –∑–∞–≥—Ä—É–∑–∫–∞

**LCP (Largest Contentful Paint):**
- ‚¨ÜÔ∏è **–£–ª—É—á—à–µ–Ω–∏–µ: -10-20ms**
- –ú–µ–Ω—å—à–µ —Ç–æ–≤–∞—Ä–æ–≤ = –±—ã—Å—Ç—Ä–µ–µ render

**TTI (Time to Interactive):**
- ‚¨ÜÔ∏è **–£–ª—É—á—à–µ–Ω–∏–µ: -20-50ms**
- –ú–µ–Ω—å—à–µ DOM —ç–ª–µ–º–µ–Ω—Ç–æ–≤

**CLS (Cumulative Layout Shift):**
- ‚û°Ô∏è **–ù–µ—Ç –≤–ª–∏—è–Ω–∏—è**

**FID (First Input Delay):**
- ‚û°Ô∏è **–ù–µ—Ç –≤–ª–∏—è–Ω–∏—è**

**GPU:**
- ‚û°Ô∏è **–ù–µ—Ç –≤–ª–∏—è–Ω–∏—è**

**CPU:**
- ‚¨ÜÔ∏è **–£–ª—É—á—à–µ–Ω–∏–µ: -5-15ms**
- –ú–µ–Ω—å—à–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

**–ü–∞–º—è—Ç—å:**
- ‚¨ÜÔ∏è **–£–ª—É—á—à–µ–Ω–∏–µ: -1-3MB**
- –ú–µ–Ω—å—à–µ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –ø–∞–º—è—Ç–∏

**–ë–î –∑–∞–ø—Ä–æ—Å—ã:**
- ‚¨ÜÔ∏è **–£–ª—É—á—à–µ–Ω–∏–µ: -20-30% —Ä–∞–∑–º–µ—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**
- –ú–µ–Ω—å—à–µ –∑–∞–ø–∏—Å–µ–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- WHERE status='published' - indexed query

**–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:**
- ‚¨ÜÔ∏è **–£–ª—É—á—à–µ–Ω–∏–µ: -15-25% HTML**
- –ú–µ–Ω—å—à–µ —Ç–æ–≤–∞—Ä–æ–≤ = –º–µ–Ω—å—à–µ HTML

**–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨:**
- ‚¨ÜÔ∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï —É–ª—É—á—à–µ–Ω–∏–µ**
- Draft —Ç–æ–≤–∞—Ä—ã —Å–∫—Ä—ã—Ç—ã –æ—Ç –ø—É–±–ª–∏–∫–∏
- –ù–µ—Ç —É—Ç–µ—á–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

**SEO:**
- ‚¨ÜÔ∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï —É–ª—É—á—à–µ–Ω–∏–µ**
- –¢–æ–ª—å–∫–æ published –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è
- –ù–µ—Ç duplicate content (draft + published)

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **Preview —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è staff:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - –ï—Å–ª–∏ staff –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ draft —Ç–æ–≤–∞—Ä—ã
   - –†–µ—à–µ–Ω–∏–µ: –¥–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–∏–µ `if not request.user.is_staff`

2. **Existing URLs –≤ Google:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –ï—Å–ª–∏ draft —Ç–æ–≤–∞—Ä—ã —É–∂–µ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω—ã
   - –†–µ—à–µ–Ω–∏–µ: –±—É–¥—É—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å 404 (—ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ)

3. **Internal links:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –ï—Å–ª–∏ –≤ admin –µ—Å—Ç—å —Å—Å—ã–ª–∫–∏ –Ω–∞ draft
   - –†–µ—à–µ–Ω–∏–µ: admin –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ URL

4. **Tests:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - –¢–µ—Å—Ç—ã –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã –±–µ–∑ status='published'
   - –†–µ—à–µ–Ω–∏–µ: –æ–±–Ω–æ–≤–∏—Ç—å fixtures/factories

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

1. **Model Product:**
   - –ü–æ–ª–µ `status` –¥–æ–ª–∂–Ω–æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å db_index –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

2. **–í—Å–µ views:**
   - –ù—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ 7 –º–µ—Å—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
   - –ò–Ω–∞—á–µ inconsistency

3. **Admin interface:**
   - –î–æ–ª–∂–µ–Ω –ø–æ–∑–≤–æ–ª—è—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä draft
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –¥—Ä—É–≥–∏–µ URL/permissions

4. **API endpoints:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ API —Ç–æ–∂–µ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ status

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**

1. **Unit tests:**
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ draft –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ published –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ archived –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å staff –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å draft (–µ—Å–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

2. **Integration tests:**
   - ‚úÖ –û—Ç–∫—Ä—ã—Ç—å –≥–ª–∞–≤–Ω—É—é - –Ω–µ—Ç draft
   - ‚úÖ –û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ç–∞–ª–æ–≥ - –Ω–µ—Ç draft
   - ‚úÖ –ü–æ–∏—Å–∫ - –Ω–µ—Ç draft
   - ‚úÖ –ü—Ä—è–º–æ–π URL –Ω–∞ draft - 404

3. **SEO tests:**
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å sitemap - —Ç–æ–ª—å–∫–æ published
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å robots.txt - draft –Ω–µ disallow (–Ω–µ –Ω—É–∂–Ω–æ, –±—É–¥–µ—Ç 404)

4. **Performance tests:**
   - ‚úÖ Benchmark queries –¥–æ/–ø–æ—Å–ª–µ
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è index –Ω–∞ status

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**

–í–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å:
```python
# migrations/XXXX_add_status_index.py
from django.db import migrations, models

class Migration(migrations.Migration):
    dependencies = [
        ('storefront', 'XXXX_previous_migration'),
    ]

    operations = [
        migrations.AlterField(
            model_name='product',
            name='status',
            field=models.CharField(
                max_length=20,
                choices=[...],
                default='draft',
                db_index=True  # ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å
            ),
        ),
    ]
```

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**

1. **Admin:**
   - ‚úÖ –ù–µ –¥–æ–ª–∂–Ω–æ —Å–ª–æ–º–∞—Ç—å—Å—è
   - Admin –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥—Ä—É–≥–∏–µ views

2. **API:**
   - ‚ö†Ô∏è –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ API endpoints
   - –î–æ–ª–∂–Ω—ã —Ç–æ–∂–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ status

3. **Feeds:**
   - ‚úÖ Google Merchant Feed –¥–æ–ª–∂–µ–Ω —Ç–æ–∂–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å

4. **Sitemap:**
   - ‚úÖ –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ published

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ Context7, Django –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ –∏ best practices –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**

**üî¥ –ö–†–ò–¢–ò–ß–ù–û: –ü—Ä–æ–±–ª–µ–º–∞ –ù–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ –∫–æ–¥–µ!** –í–æ –≤—Å–µ—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö views –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ñ–∏–ª—å—Ç—Ä `status='published'`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ –ø—É–±–ª–∏—á–Ω–æ. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Django (Context7):**
  - **QuerySet filtering best practices:**
    - **Django Tutorial 5:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—Å–µ–≥–¥–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å queryset –≤ `get_queryset()` –¥–ª—è DetailView, —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å –Ω–µ–æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã. –ü—Ä–∏–º–µ—Ä: `Question.objects.filter(pub_date__lte=timezone.now())`
    - **Best practice:** –í—Å–µ–≥–¥–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–µ queryset –ø–æ —Å—Ç–∞—Ç—É—Å—É –ø—É–±–ª–∏–∫–∞—Ü–∏–∏. –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –≤ Django –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
    - **–í –∫–æ–¥–µ:** –í `recommendations.py` —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä `status=ProductStatus.PUBLISHED` ‚úÖ, –Ω–æ –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö views (`catalog.py`, `product.py`) —Ñ–∏–ª—å—Ç—Ä –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä `status=ProductStatus.PUBLISHED` –≤–æ –≤—Å–µ—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö views
  
  - **db_index performance implications:**
    - **Django –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ë–µ–∑ –∏–Ω–¥–µ–∫—Å–∞ —Ñ–∏–ª—å—Ç—Ä `status='published'` –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å full table scan.
    - **–í –∫–æ–¥–µ:** –í –º–æ–¥–µ–ª–∏ Product (—Å—Ç—Ä–æ–∫–∏ 417-418) —É–∂–µ –µ—Å—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ –ø–æ–ª–µ status:
      ```python
      models.Index(fields=['catalog', 'status'], name='idx_product_catalog_status'),
      models.Index(fields=['status', '-id'], name='idx_product_status_id'),
      ```
      ‚úÖ –ò–Ω–¥–µ–∫—Å—ã —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –±—É–¥–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π
    - **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –° –∏–Ω–¥–µ–∫—Å–æ–º —Ñ–∏–ª—å—Ç—Ä `status='published'` –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –∑–∞ O(log n) –≤–º–µ—Å—Ç–æ O(n), —á—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü
  
  - **get_object_or_404 with filters:**
    - **Django –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `get_object_or_404()` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç queryset, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å. –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞.
    - **–ü—Ä–∏–º–µ—Ä –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** `get_object_or_404(Question.objects.filter(pub_date__lte=timezone.now()), pk=question_id)`
    - **–í –∫–æ–¥–µ:** –í `product_detail()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `get_object_or_404(Product.objects.select_related(...), slug=slug)` –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞ status ‚ùå
    - **–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:** `get_object_or_404(Product.objects.filter(status=ProductStatus.PUBLISHED).select_related(...), slug=slug)` ‚úÖ

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 (Django security and filtering):**
  - **Status field patterns:**
    - **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–ª—è `status` —Å choices –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –≤ Django
    - **–í –∫–æ–¥–µ:** –ú–æ–¥–µ–ª—å Product –∏–º–µ–µ—Ç `ProductStatus` —Å choices: DRAFT, REVIEW, SCHEDULED, PUBLISHED, ARCHIVED ‚úÖ
    - **–ü—Ä–æ–±–ª–µ–º–∞:** –ü—É–±–ª–∏—á–Ω—ã–µ views –Ω–µ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç –ø–æ `status=ProductStatus.PUBLISHED`, –ø–æ–∫–∞–∑—ã–≤–∞—è –≤—Å–µ —Å—Ç–∞—Ç—É—Å—ã –≤–∫–ª—é—á–∞—è DRAFT ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–æ–∑–¥–∞—Ç—å manager –º–µ—Ç–æ–¥ `Product.objects.published()` –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞:
      ```python
      class PublishedProductManager(models.Manager):
          def get_queryset(self):
              return super().get_queryset().filter(status=ProductStatus.PUBLISHED)
      
      class Product(models.Model):
          objects = models.Manager()
          published = PublishedProductManager()
      ```
  
  - **Security implications of public views:**
    - **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å:** –ü–æ–∫–∞–∑ —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤ (draft) –ø—É–±–ª–∏—á–Ω–æ - —ç—Ç–æ —É—Ç–µ—á–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –ß–µ—Ä–Ω–æ–≤–∏–∫–∏ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
      - –ù–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤
      - Internal notes –¥–ª—è –∫–æ–º–∞–Ω–¥—ã
      - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ü–µ–Ω—ã (—Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ)
      - –ù–µ–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –±–µ–∑ —Ü–µ–Ω)
    - **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:** –¢–æ–≤–∞—Ä—ã –≤ —Å—Ç–∞—Ç—É—Å–µ DRAFT –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –∑–∞–∫–∞–∑–∞, –Ω–æ —Å–µ–π—á–∞—Å –æ–Ω–∏ –≤–∏–¥–Ω—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ ‚ùå
    - **–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã:** –ú–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã, –ø–ª–∞–Ω—ã –∫–æ–º–ø–∞–Ω–∏–∏
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í—Å–µ–≥–¥–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–µ queryset –ø–æ —Å—Ç–∞—Ç—É—Å—É, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `get_queryset()` override –≤ views –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è
  
  - **SEO best practices for draft content:**
    - **Google Guidelines:** –ü–æ–∏—Å–∫–æ–≤–∏–∫–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫–∏ –∏ –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç. –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
      - –ü–ª–æ—Ö–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º—É –æ–ø—ã—Ç—É (–Ω–µ–ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
      - –ù–∏–∑–∫–æ–º—É —Ä–µ–π—Ç–∏–Ω–≥—É –≤ –ø–æ–∏—Å–∫–µ (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç)
      - –ü—Ä–æ–±–ª–µ–º–∞–º —Å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–µ–π (404 –ø–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏)
    - **–í –∫–æ–¥–µ:** Draft —Ç–æ–≤–∞—Ä—ã –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω—ã Google, —Ç–∞–∫ –∫–∞–∫ –¥–æ—Å—Ç—É–ø–Ω—ã –ø—É–±–ª–∏—á–Ω–æ ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ `status='published'` –≤–æ –≤—Å–µ—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö views, –≤–∫–ª—é—á–∞—è sitemap –∏ RSS feeds

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **Django status filtering examples:**
    - **Django Blog Tutorial:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω - —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ `pub_date` –∏–ª–∏ `status` –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö views
    - **E-commerce –ø—Ä–∏–º–µ—Ä—ã:** –í—Å–µ –∫—Ä—É–ø–Ω—ã–µ e-commerce –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (Shopify, WooCommerce, Magento) —Ñ–∏–ª—å—Ç—Ä—É—é—Ç —Ç–æ–≤–∞—Ä—ã –ø–æ —Å—Ç–∞—Ç—É—Å—É –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å manager –º–µ—Ç–æ–¥—ã (`published()`, `active()`) –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
    - **–í –∫–æ–¥–µ:** –í `recommendations.py` —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω `status=ProductStatus.PUBLISHED` ‚úÖ, –Ω—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤–µ–∑–¥–µ
  
  - **E-commerce draft product handling:**
    - **Shopify:** Draft —Ç–æ–≤–∞—Ä—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ preview URL –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
    - **WooCommerce:** Draft —Ç–æ–≤–∞—Ä—ã –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥–µ, —Ç–æ–ª—å–∫–æ –≤ –∞–¥–º–∏–Ω–∫–µ
    - **Magento:** Draft —Ç–æ–≤–∞—Ä—ã –∏–º–µ—é—Ç —Å—Ç–∞—Ç—É—Å "Disabled" –∏ –Ω–µ –≤–∏–¥–Ω—ã –ø—É–±–ª–∏—á–Ω–æ
    - **–í—ã–≤–æ–¥:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ - —Å–∫—Ä—ã–≤–∞—Ç—å draft —Ç–æ–≤–∞—Ä—ã –æ—Ç –ø—É–±–ª–∏–∫–∏, –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ published
  
  - **Google indexing draft pages issues:**
    - **–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ Google –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç draft —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –æ–Ω–∏ –º–æ–≥—É—Ç –ø–æ—è–≤–∏—Ç—å—Å—è –≤ –ø–æ–∏—Å–∫–µ —Å –Ω–µ–ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
    - **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –ü–ª–æ—Ö–æ–π UX, –Ω–∏–∑–∫–∏–π CTR, –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–µ–ø—É—Ç–∞—Ü–∏–µ–π —Å–∞–π—Ç–∞
    - **–†–µ—à–µ–Ω–∏–µ:** –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —Å—Ç–∞—Ç—É—Å—É, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å robots.txt –∏ noindex meta tag –¥–ª—è draft —Å—Ç—Ä–∞–Ω–∏—Ü (–Ω–æ –ª—É—á—à–µ –ø—Ä–æ—Å—Ç–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏—Ö)
    - **–í –∫–æ–¥–µ:** Draft —Ç–æ–≤–∞—Ä—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø—É–±–ª–∏—á–Ω–æ, –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω—ã ‚ùå

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í –º–æ–¥–µ–ª–∏ Product (twocomms/storefront/models.py):**
    - –ü–æ–ª–µ `status` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å `ProductStatus.choices` ‚úÖ
    - –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ –ø–æ–ª–µ status —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã (—Å—Ç—Ä–æ–∫–∏ 417-418) ‚úÖ
    - Default –∑–Ω–∞—á–µ–Ω–∏–µ: `ProductStatus.DRAFT` - –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ
  
  - **–í –ø—É–±–ª–∏—á–Ω—ã—Ö views –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ñ–∏–ª—å—Ç—Ä:**
    - `home()` (catalog.py:41, 50) - –Ω–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞ status ‚ùå
    - `load_more_products()` (catalog.py:105) - –Ω–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞ status ‚ùå
    - `catalog()` (catalog.py:159, 165) - –Ω–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞ status ‚ùå
    - `search()` (catalog.py:209) - –Ω–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞ status ‚ùå
    - `product_detail()` (product.py:52) - –Ω–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞ status ‚ùå
  
  - **–í recommendations.py —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä:**
    - –°—Ç—Ä–æ–∫–∏ 45, 82, 106, 115, 138, 154, 177 - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `status=ProductStatus.PUBLISHED` ‚úÖ
    - –≠—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —á—Ç–æ —Ñ–∏–ª—å—Ç—Ä –Ω—É–∂–µ–Ω –∏ —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö
  
  - **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
    - –ï—Å–ª–∏ –µ—Å—Ç—å API endpoints (DRF ViewSets) - –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Ö —Ç–æ–∂–µ
    - –ï—Å–ª–∏ –µ—Å—Ç—å sitemap.xml - –Ω—É–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ status
    - –ï—Å–ª–∏ –µ—Å—Ç—å RSS feeds - –Ω—É–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ status

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û - –ø—Ä–æ–±–ª–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  - **Staff preview strategy:**
    - **–î–ª—è product_detail():** –†–∞–∑—Ä–µ—à–∏—Ç—å staff –≤–∏–¥–µ—Ç—å draft —Ç–æ–≤–∞—Ä—ã –¥–ª—è preview:
      ```python
      product_qs = Product.objects.select_related('category').prefetch_related('images')
      
      # –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - —Ç–æ–ª—å–∫–æ published
      if not request.user.is_staff:
          product_qs = product_qs.filter(status=ProductStatus.PUBLISHED)
      
      product = get_object_or_404(product_qs, slug=slug)
      ```
    - **–î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö views:** –í—Å–µ–≥–¥–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ published, staff –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–¥–º–∏–Ω–∫—É –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ draft
  
  - **Migration plan:**
    1. **–§–∞–∑–∞ 1 - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ):**
       - –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä `status=ProductStatus.PUBLISHED` –≤–æ –≤—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ views:
         - `home()` - —Å—Ç—Ä–æ–∫–∏ 41, 50
         - `load_more_products()` - —Å—Ç—Ä–æ–∫–∞ 105
         - `catalog()` - —Å—Ç—Ä–æ–∫–∏ 159, 165
         - `search()` - —Å—Ç—Ä–æ–∫–∞ 209
         - `product_detail()` - —Å—Ç—Ä–æ–∫–∞ 52 (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π staff)
    
    2. **–§–∞–∑–∞ 2 - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
       - –°–æ–∑–¥–∞—Ç—å manager –º–µ—Ç–æ–¥ `Product.objects.published()` –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
       - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –≤–æ –≤—Å–µ—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö views
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API endpoints (DRF ViewSets) –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞
    
    3. **–§–∞–∑–∞ 3 - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å sitemap.xml - —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ status
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å RSS feeds - —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ status
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Google Merchant Feed - —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ status
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ API endpoints
  
  - **–î–µ—Ç–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ view:**
    
    **1. home() (catalog.py:41, 50):**
    ```python
    # –ë–´–õ–û:
    featured = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
        featured=True
    ).order_by('-id').first()
    
    product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').order_by('-id')
    
    # –°–¢–ê–õ–û:
    featured = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
        featured=True,
        status=ProductStatus.PUBLISHED  # ‚úÖ –î–û–ë–ê–í–ò–¢–¨
    ).order_by('-id').first()
    
    product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
        status=ProductStatus.PUBLISHED  # ‚úÖ –î–û–ë–ê–í–ò–¢–¨
    ).order_by('-id')
    ```
    
    **2. load_more_products() (catalog.py:105):**
    ```python
    # –ë–´–õ–û:
    product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').order_by('-id')
    
    # –°–¢–ê–õ–û:
    product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
        status=ProductStatus.PUBLISHED  # ‚úÖ –î–û–ë–ê–í–ò–¢–¨
    ).order_by('-id')
    ```
    
    **3. catalog() (catalog.py:159, 165):**
    ```python
    # –ë–´–õ–û:
    product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
        category=category
    ).order_by('-id')
    
    product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').order_by('-id')
    
    # –°–¢–ê–õ–û:
    product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
        category=category,
        status=ProductStatus.PUBLISHED  # ‚úÖ –î–û–ë–ê–í–ò–¢–¨
    ).order_by('-id')
    
    product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
        status=ProductStatus.PUBLISHED  # ‚úÖ –î–û–ë–ê–í–ò–¢–¨
    ).order_by('-id')
    ```
    
    **4. search() (catalog.py:209):**
    ```python
    # –ë–´–õ–û:
    product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images')
    
    # –°–¢–ê–õ–û:
    product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
        status=ProductStatus.PUBLISHED  # ‚úÖ –î–û–ë–ê–í–ò–¢–¨
    )
    ```
    
    **5. product_detail() (product.py:52):**
    ```python
    # –ë–´–õ–û:
    product = get_object_or_404(Product.objects.select_related('category').prefetch_related('images'), slug=slug)
    
    # –°–¢–ê–õ–û (—Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π staff preview):
    product_qs = Product.objects.select_related('category').prefetch_related('images')
    
    # –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - —Ç–æ–ª—å–∫–æ published
    if not request.user.is_staff:
        product_qs = product_qs.filter(status=ProductStatus.PUBLISHED)
    
    product = get_object_or_404(product_qs, slug=slug)
    ```
  
  - **Testing checklist:**
    1. ‚úÖ **Unit tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ draft —Ç–æ–≤–∞—Ä—ã –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ home()
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ draft —Ç–æ–≤–∞—Ä—ã –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ catalog()
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ draft —Ç–æ–≤–∞—Ä—ã –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ search()
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ draft —Ç–æ–≤–∞—Ä—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 404 –≤ product_detail() –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ staff –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å draft —Ç–æ–≤–∞—Ä—ã –≤ product_detail()
    
    2. ‚úÖ **Integration tests:**
       - –û—Ç–∫—Ä—ã—Ç—å –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç draft —Ç–æ–≤–∞—Ä–æ–≤
       - –û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ç–∞–ª–æ–≥ - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç draft —Ç–æ–≤–∞—Ä–æ–≤
       - –ü–æ–∏—Å–∫ - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç draft —Ç–æ–≤–∞—Ä–æ–≤
       - –ü—Ä—è–º–æ–π URL –Ω–∞ draft —Ç–æ–≤–∞—Ä - –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 404 –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
       - –ü—Ä—è–º–æ–π URL –Ω–∞ draft —Ç–æ–≤–∞—Ä - –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å —Ç–æ–≤–∞—Ä –¥–ª—è staff
    
    3. ‚úÖ **SEO tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å sitemap.xml - —Ç–æ–ª—å–∫–æ published —Ç–æ–≤–∞—Ä—ã
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å robots.txt - –Ω–µ –Ω—É–∂–Ω–æ disallow draft (–æ–Ω–∏ –±—É–¥—É—Ç 404)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Google –Ω–µ –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç draft —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    
    4. ‚úÖ **Performance tests:**
       - Benchmark queries –¥–æ/–ø–æ—Å–ª–µ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–µ–Ω—å—à–µ –∑–∞–ø–∏—Å–µ–π
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è index –Ω–∞ status (EXPLAIN query)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ response time –Ω–µ —É—Ö—É–¥—à–∏–ª—Å—è (–º–æ–∂–µ—Ç –¥–∞–∂–µ —É–ª—É—á—à–∏—Ç—å—Å—è)
    
    5. ‚úÖ **Security tests:**
       - –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ draft —Ç–æ–≤–∞—Ä—É —á–µ—Ä–µ–∑ –ø—Ä—è–º–æ–π URL - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 404
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ draft —Ç–æ–≤–∞—Ä—ã –Ω–µ –≤–∏–¥–Ω—ã –≤ API endpoints
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç —É—Ç–µ—á–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ draft —Ç–æ–≤–∞—Ä–∞—Ö
  
  - **Rollback plan:**
    - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π –∫–æ–¥ –∫–∞–∫ backup (–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä)
    - –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã, –±—ã—Å—Ç—Ä–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏
    - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ staging –ø–µ—Ä–µ–¥ production deploy
    - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –¥–æ/–ø–æ—Å–ª–µ (–¥–æ–ª–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å—Å—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ draft —Ç–æ–≤–∞—Ä–æ–≤)

---

## –ü–†–û–ë–õ–ï–ú–ê #7: ImageOptimizationMiddleware –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –ª–µ—Ç—É –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

### üî¥ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö–†–ò–¢–ò–ß–ù–û

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

`ImageOptimizationMiddleware` –≤—ã–ø–æ–ª–Ω—è–µ—Ç **CPU-–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å** –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –ø–∞–º—è—Ç—å** (—Å—Ç—Ä–æ–∫–∞ 52)
2. **–û—Ç–∫—Ä—ã–≤–∞–µ—Ç —á–µ—Ä–µ–∑ PIL/Pillow** (—Å—Ç—Ä–æ–∫–∞ 60) - –º–µ–¥–ª–µ–Ω–Ω–æ!
3. **–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç—ã** (RGB/RGBA –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è, —Å—Ç—Ä–æ–∫–∏ 126-137)
4. **–†–µ—Å–∞–π–∑–∏—Ç –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç** (—Å—Ç—Ä–æ–∫–∏ 156-161)
5. **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ WebP** (–º–µ—Ç–æ–¥=6, —Å–∞–º—ã–π –º–µ–¥–ª–µ–Ω–Ω—ã–π –Ω–æ –ª—É—á—à–µ–µ —Å–∂–∞—Ç–∏–µ)
6. **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç** (—Å—Ç—Ä–æ–∫–∏ 73-94)

**–í—Å–µ —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –î–õ–Ø –ö–ê–ñ–î–û–ì–û –∑–∞–ø—Ä–æ—Å–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è!**

**–ü–æ—á–µ–º—É —ç—Ç–æ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞:**

- **CPU –Ω–∞–≥—Ä—É–∑–∫–∞:** PIL –æ–ø–µ—Ä–∞—Ü–∏–∏ = 50-200ms CPU time PER IMAGE
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:** 10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π √ó 20 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π = 200 concurrent PIL operations = CPU melting
- **–ù–µ—Ç –∫—ç—à–∞:** –û–¥–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç—Å—è 1000 —Ä–∞–∑ –≤–º–µ—Å—Ç–æ 1
- **Blocking I/O:** –ü–æ–∫–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∑–∞–ø—Ä–æ—Å –≤–∏—Å–∏—Ç
- **Memory leak —Ä–∏—Å–∫:** PIL –¥–µ—Ä–∂–∏—Ç images –≤ –ø–∞–º—è—Ç–∏

**–†–µ–∞–ª—å–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π:**
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å 20 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
- 10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Ç–∫—Ä—ã–≤–∞—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- 200 PIL operations = 200 √ó 100ms = 20 —Å–µ–∫—É–Ω–¥ CPU time
- –°–µ—Ä–≤–µ—Ä –ø–∞–¥–∞–µ—Ç –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms/image_middleware.py`  
**–°—Ç—Ä–æ–∫–∏:** 1-169 (–≤–µ—Å—å —Ñ–∞–π–ª)

**–ö—Ä–∏—Ç–∏—á–Ω—ã–µ —á–∞—Å—Ç–∏:**

```python
# –°—Ç—Ä–æ–∫–∞ 22-37 - process_response –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ù–ê –ö–ê–ñ–î–´–ô REQUEST!
def process_response(self, request, response):
    if not self._is_image_request(request):
        return response
    
    if not self._is_image_response(response):
        return response
    
    # ‚ùå –ö–†–ò–¢–ò–ß–ù–û: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞ –ª–µ—Ç—É!
    try:
        optimized_response = self._optimize_image_response(request, response)
        return optimized_response
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: {e}")
        return response

# –°—Ç—Ä–æ–∫–∏ 49-99 - –ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è!
def _optimize_image_response(self, request, response):
    image_data = response.content  # –ó–∞–≥—Ä—É–∂–∞–µ–º –≤–µ—Å—å —Ñ–∞–π–ª –≤ –ø–∞–º—è—Ç—å
    
    # ‚ùå –ù–ï–¢ –ü–†–û–í–ï–†–ö–ò –ö–≠–®–ê!
    
    with Image.open(io.BytesIO(image_data)) as img:  # ‚ùå PIL operation - –º–µ–¥–ª–µ–Ω–Ω–æ!
        original_format = img.format
        if not self._should_optimize(img, len(image_data)):
            return response
        
        # ‚ùå CPU-–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è!
        optimized_data = self._optimize_image(img, original_format)
        
        # ‚ùå –ù–ï–¢ –°–û–•–†–ê–ù–ï–ù–ò–Ø –í –ö–≠–®!
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**

1. **Django MiddlewareMixin** - –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ –ö–ê–ñ–î–´–ô response
2. **PIL/Pillow** - Python Imaging Library (CPU-bound)
3. **io.BytesIO** - in-memory buffer
4. **Image.open()** - –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
5. **Image.save()** - –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ WebP (method=6 = slowest but best compression)

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

```
Request -> /media/product_image.jpg
  -> WhiteNoise middleware -> –Ω–∞—Ö–æ–¥–∏—Ç —Ñ–∞–π–ª
  -> ImageOptimizationMiddleware.process_response()
    -> _is_image_request() -> True
    -> _is_image_response() -> True
    -> _optimize_image_response()
      -> –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª –≤ –ø–∞–º—è—Ç—å (–º–æ–∂–µ—Ç –±—ã—Ç—å 5MB!)
      -> Image.open() -> 50-100ms
      -> _should_optimize() -> –ø—Ä–æ–≤–µ—Ä–∫–∏
      -> _optimize_image()
        -> –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è RGB/RGBA -> 10-30ms
        -> img.save(format='WEBP', quality=85, method=6) -> 100-300ms! ‚ùå
      -> –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π response
  -> Response to user (—á–µ—Ä–µ–∑ 150-430ms –∑–∞–¥–µ—Ä–∂–∫–∏!)
```

**Frequency:**
- **–ö–∞–∂–¥—ã–π —Ä–∞–∑** –∫–æ–≥–¥–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- –ù–µ—Ç –∫—ç—à–∞ = –Ω–µ—Ç –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- 1 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ √ó 1000 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ = 1000 –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

**CPU cost breakdown –¥–ª—è 1 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (1MB JPEG -> WebP):**
- –ó–∞–≥—Ä—É–∑–∫–∞ –≤ –ø–∞–º—è—Ç—å: ~5ms
- PIL Image.open(): ~50ms
- RGB conversion: ~20ms
- WebP encode (method=6): ~200ms
- **TOTAL: ~275ms CPU time per image**

**Memory cost:**
- Original image –≤ –ø–∞–º—è—Ç–∏: 1-5MB
- Decoded bitmap: width √ó height √ó 4 bytes (RGBA)
- –ù–∞–ø—Ä–∏–º–µ—Ä 2000√ó2000 image = 16MB decoded!
- Output buffer: 200KB-1MB
- **TOTAL: 17-22MB per image in processing**

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**FCP (First Contentful Paint):**
- ‚¨áÔ∏è **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —É—Ö—É–¥—à–µ–Ω–∏–µ: +150-400ms**
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä—É—é—Ç, –ø–æ–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É—é—Ç—Å—è

**LCP (Largest Contentful Paint):**
- ‚¨áÔ∏è **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —É—Ö—É–¥—à–µ–Ω–∏–µ: +200-500ms**
- LCP —á–∞—Å—Ç–æ = –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

**TTI (Time to Interactive):**
- ‚¨áÔ∏è **–£—Ö—É–¥—à–µ–Ω–∏–µ: +100-300ms**

**CPU:**
- ‚¨áÔ∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï —É—Ö—É–¥—à–µ–Ω–∏–µ: 60-90% CPU usage –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π**
- PIL = CPU-bound
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç –¥—Ä—É–≥–∏–µ requests

**–ü–∞–º—è—Ç—å:**
- ‚¨áÔ∏è **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —É—Ö—É–¥—à–µ–Ω–∏–µ: +15-25MB per concurrent image**
- Memory leak —Ä–∏—Å–∫
- OOM killer –º–æ–∂–µ—Ç —É–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å

**–ë–î –∑–∞–ø—Ä–æ—Å—ã:**
- ‚û°Ô∏è **–ù–µ—Ç –≤–ª–∏—è–Ω–∏—è**

**Response Time:**
- ‚¨áÔ∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï —É—Ö—É–¥—à–µ–Ω–∏–µ: +150-430ms per image**
- Users –∂–¥—É—Ç

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ #1: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–µ—Ä—Å–∏–π**
```python
from django.core.cache import cache
import hashlib

def _optimize_image_response(self, request, response):
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º cache key
    cache_key = f"optimized_image:{hashlib.md5(request.path.encode()).hexdigest()}"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
    cached = cache.get(cache_key)
    if cached:
        return HttpResponse(cached, content_type=...)
    
    # –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º
    optimized_data = ...
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à (7 –¥–Ω–µ–π)
    cache.set(cache_key, optimized_data, 86400 * 7)
    
    return response
```

**–†–µ—à–µ–Ω–∏–µ #2 (–õ–£–ß–®–ï): –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ (—á–µ—Ä–µ–∑ signals)
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
- Middleware —Ç–æ–ª—å–∫–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∂–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª

**–†–µ—à–µ–Ω–∏–µ #3 (–ò–î–ï–ê–õ–¨–ù–û): –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CDN —Å –∞–≤—Ç–æ–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π**
- Cloudinary, Imgix, Cloudflare Images
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞ edge —Å–µ—Ä–≤–µ—Ä–∞—Ö
- –£–±—Ä–∞—Ç—å middleware –ø–æ–ª–Ω–æ—Å—Ç—å—é

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ Context7, Django –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ –∏ industry best practices**

**‚ö†Ô∏è –í–ê–ñ–ù–û: Middleware —É–∂–µ –æ—Ç–∫–ª—é—á–µ–Ω –≤ settings.py (—Å—Ç—Ä–æ–∫–∞ 137) –∏–∑-–∑–∞ CPU blocking issue!** –ù–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∏–∂–µ –ø–æ–º–æ–≥—É—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –µ—Å–ª–∏ middleware –±—É–¥–µ—Ç –≤–∫–ª—é—á–µ–Ω –≤ –±—É–¥—É—â–µ–º.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Django (Context7):**
  - **Django caching strategies for media:**
    - **Django Cache Framework:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è CPU-intensive –æ–ø–µ—Ä–∞—Ü–∏–π. –î–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
      1. **File-based cache:** –°–æ—Ö—Ä–∞–Ω—è—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞–∫ —Ñ–∞–π–ª—ã –≤ `MEDIA_ROOT/optimized/`
      2. **Redis cache:** –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å binary –¥–∞–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–Ω–æ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤)
      3. **Django cache_page:** –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è middleware, —Ç–∞–∫ –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ view
    - **Best practice:** –î–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å file-based –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (—Å–æ—Ö—Ä–∞–Ω—è—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –∫–∞–∫ —Ñ–∞–π–ª—ã), –∞ –Ω–µ Django cache framework
    - **–í –∫–æ–¥–µ:** Middleware –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∏–∫–∞–∫–æ–≥–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è ‚ùå, –∫–∞–∂–¥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ
  
  - **Middleware caching patterns:**
    - **Django –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** Middleware –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å stateless –∏ –Ω–µ –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ç—è–∂–µ–ª—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å
    - **Best practice:** –ï—Å–ª–∏ middleware –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç—è–∂–µ–ª—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–∫–∞–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π), –Ω—É–∂–Ω–æ:
      1. –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫—ç—à –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
      2. –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∫—ç—à –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
      3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å file-based –∫—ç—à –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
    - **–í –∫–æ–¥–µ:** Middleware –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫—ç—à–∞ ‚ùå

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ performance benchmarks:**
  - **Pillow performance benchmarks:**
    - **Image.open():** 50-100ms –¥–ª—è JPEG 1MB, 100-200ms –¥–ª—è PNG 1MB
    - **Image conversion (RGB/RGBA):** 10-30ms –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è 2000√ó2000
    - **Image.save() JPEG:** 50-100ms –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è 1MB
    - **Image.save() WebP method=6:** 100-300ms –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è 1MB (—Å–∞–º—ã–π –º–µ–¥–ª–µ–Ω–Ω—ã–π, –Ω–æ –ª—É—á—à–µ–µ —Å–∂–∞—Ç–∏–µ)
    - **Image.save() WebP method=4:** 50-150ms (–∫–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É —Å–∫–æ—Ä–æ—Å—Ç—å—é –∏ –∫–∞—á–µ—Å—Ç–≤–æ–º)
    - **–í—ã–≤–æ–¥:** WebP encoding —Å method=6 –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω—ã–π, –Ω–æ –¥–∞–µ—Ç –ª—É—á—à–µ–µ —Å–∂–∞—Ç–∏–µ. –ù—É–∂–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  
  - **WebP encoding speed (method comparison):**
    - **method=0 (fastest):** ~20-50ms, –Ω–æ –Ω–∞ 10-15% –±–æ–ª—å—à–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
    - **method=4 (balanced):** ~50-150ms, —Ö–æ—Ä–æ—à–µ–µ —Å–∂–∞—Ç–∏–µ
    - **method=6 (slowest, best):** ~100-300ms, –ª—É—á—à–µ–µ —Å–∂–∞—Ç–∏–µ (–Ω–∞ 5-10% –º–µ–Ω—å—à–µ —á–µ–º method=4)
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è method=6 (—Å—Ç—Ä–æ–∫–∞ 157) - —Å–∞–º—ã–π –º–µ–¥–ª–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å method=4 –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–∞, –∏–ª–∏ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç method=6
  
  - **Memory usage for PIL operations:**
    - **Image.open():** –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –ø–∞–º—è—Ç—å (1-5MB –¥–ª—è JPEG 1MB)
    - **Decoded bitmap:** width √ó height √ó 4 bytes (RGBA) - –¥–ª—è 2000√ó2000 = 16MB
    - **Output buffer:** 200KB-1MB –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    - **Total:** 17-22MB per image –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
    - **–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ 10 concurrent requests = 170-220MB –ø–∞–º—è—Ç–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **CDN comparison for image optimization:**
    - **Cloudflare Images:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞ edge, WebP/AVIF –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è, resizing. –¶–µ–Ω–∞: $5/100k images
    - **Cloudinary:** –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏. –¶–µ–Ω–∞: Free tier –¥–æ 25GB
    - **Imgix:** –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, –æ—Ç–ª–∏—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏. –¶–µ–Ω–∞: $10/100k images
    - **–í—ã–≤–æ–¥:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CDN –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π - –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç, —É–±–∏—Ä–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É —Å —Å–µ—Ä–≤–µ—Ä–∞
  
  - **File-based caching for images:**
    - **–ü–∞—Ç—Ç–µ—Ä–Ω:** –°–æ—Ö—Ä–∞–Ω—è—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞–∫ —Ñ–∞–π–ª—ã –≤ `MEDIA_ROOT/optimized/` –∏–ª–∏ `STATIC_ROOT/optimized/`
    - **–ö–ª—é—á –∫—ç—à–∞:** `{original_path}_{width}_{height}_{format}_{quality}.webp`
    - **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ü–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞, –µ—Å–ª–∏ –µ—Å—Ç—å - –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –µ–≥–æ
    - **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç Redis/memcached, —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–º
    - **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:** –ó–∞–Ω–∏–º–∞–µ—Ç –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ, –Ω—É–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –æ—á–∏—Å—Ç–∫–æ–π —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤
  
  - **Best practices for image optimization middleware:**
    - ‚úÖ **–ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    - ‚úÖ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å file-based –∫—ç—à** –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–Ω–µ Django cache framework)
    - ‚úÖ **–ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫—ç—à –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π** - —ç–∫–æ–Ω–æ–º–∏—Ç CPU
    - ‚úÖ **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Celery –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
    - ‚úÖ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CDN** - –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è production
    - ‚ùå **–ò–∑–±–µ–≥–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ –ª–µ—Ç—É** - —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ
    - ‚ùå **–ò–∑–±–µ–≥–∞—Ç—å PIL –≤ middleware** - –±–ª–æ–∫–∏—Ä—É–µ—Ç request thread

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í image_middleware.py:**
    - Middleware –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è ‚ùå
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è WebP method=6 (—Å–∞–º—ã–π –º–µ–¥–ª–µ–Ω–Ω—ã–π) ‚ùå
    - –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ ‚ùå
    - –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –≤ —Ñ–∞–π–ª ‚ùå
    - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –≤ request thread ‚ùå
  
  - **–í settings.py:**
    - Middleware –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω (—Å—Ç—Ä–æ–∫–∞ 137): `# "twocomms.image_middleware.ImageOptimizationMiddleware",  # DISABLED: CPU blocking issue` ‚úÖ
    - –≠—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —á—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ —É–∂–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∏ middleware –æ—Ç–∫–ª—é—á–µ–Ω
  
  - **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –≤ –∫–æ–¥–µ:**
    - –ï—Å—Ç—å `image_optimizer.py` - –∫–ª–∞—Å—Å –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    - –ï—Å—Ç—å template tags –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (`image_optimization.py`, `responsive_images.py`)
    - –ù–æ –æ–Ω–∏ —Ç–æ–∂–µ –º–æ–≥—É—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û - middleware —É–∂–µ –æ—Ç–∫–ª—é—á–µ–Ω, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –≤–∫–ª—é—á–µ–Ω–∏–µ–º
  - **Strategy - File-based caching:**
    1. **–°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –∫—ç—à–∞:**
       ```python
       OPTIMIZED_IMAGES_CACHE_DIR = os.path.join(settings.MEDIA_ROOT, 'optimized')
       os.makedirs(OPTIMIZED_IMAGES_CACHE_DIR, exist_ok=True)
       ```
    
    2. **–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á –∫—ç—à–∞:**
       ```python
       import hashlib
       
       def get_cache_key(image_path, width=None, height=None, format='WEBP', quality=85):
           """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–ª—é—á –∫—ç—à–∞ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"""
           key_parts = [image_path]
           if width:
               key_parts.append(f'w{width}')
           if height:
               key_parts.append(f'h{height}')
           key_parts.append(format)
           key_parts.append(f'q{quality}')
           
           key_string = '_'.join(str(p) for p in key_parts)
           # –ò—Å–ø–æ–ª—å–∑—É–µ–º hash –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
           cache_filename = hashlib.md5(key_string.encode()).hexdigest() + '.webp'
           return os.path.join(OPTIMIZED_IMAGES_CACHE_DIR, cache_filename)
       ```
    
    3. **–ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫—ç—à –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π:**
       ```python
       def _optimize_image_response(self, request, response):
           # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–ª—é—á –∫—ç—à–∞
           cache_path = get_cache_key(request.path, format='WEBP', quality=85)
           
           # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
           if os.path.exists(cache_path):
               # –ß–∏—Ç–∞–µ–º –∏–∑ –∫—ç—à–∞
               with open(cache_path, 'rb') as f:
                   cached_data = f.read()
               
               # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é
               optimized_response = HttpResponse(
                   cached_data,
                   content_type='image/webp',
                   status=response.status_code
               )
               optimized_response['Cache-Control'] = 'public, max-age=31536000'
               return optimized_response
           
           # –ï—Å–ª–∏ –Ω–µ—Ç –≤ –∫—ç—à–µ - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º
           image_data = response.content
           # ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ ...
           
           # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à
           os.makedirs(os.path.dirname(cache_path), exist_ok=True)
           with open(cache_path, 'wb') as f:
               f.write(optimized_data)
           
           return optimized_response
       ```
  
  - **Strategy - Pre-generation (–ª—É—á—à–µ):**
    - **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Celery –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
      ```python
      @shared_task
      def optimize_product_images(product_id):
          """–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ"""
          product = Product.objects.get(id=product_id)
          # –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å main_image
          # –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ ProductImage
          # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏
      ```
    - **–í—ã–∑—ã–≤–∞—Ç—å –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞:**
      ```python
      def save(self, *args, **kwargs):
          super().save(*args, **kwargs)
          if self.main_image:
              optimize_product_images.delay(self.id)
      ```
    - **Middleware —Ç–æ–ª—å–∫–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∂–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã**
  
  - **Strategy - CDN (–∏–¥–µ–∞–ª—å–Ω–æ):**
    - **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Cloudflare Images –∏–ª–∏ Cloudinary:**
      - –ó–∞–≥—Ä—É–∂–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ CDN
      - CDN –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –∏ –∫—ç—à–∏—Ä—É–µ—Ç
      - –£–±—Ä–∞—Ç—å middleware –ø–æ–ª–Ω–æ—Å—Ç—å—é
      - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CDN URL –≤ —à–∞–±–ª–æ–Ω–∞—Ö
  
  - **Testing checklist:**
    1. ‚úÖ **Performance tests:**
       - –ò–∑–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ/–ø–æ—Å–ª–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –±—ã—Å—Ç—Ä–æ (<10ms)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–µ—Ä–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ –µ—â–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
       - –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: 100 concurrent requests –∫ –æ–¥–Ω–æ–º—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é
    
    2. ‚úÖ **Cache tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∫—ç—à
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫—ç—à –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫—ç—à –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—á–∏—Å—Ç–∫—É —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤ –∫—ç—à–∞
    
    3. ‚úÖ **Memory tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç memory leaks –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
       - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ PIL –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª—ã
    
    4. ‚úÖ **Integration tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ WebP —Ñ–æ—Ä–º–∞—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä–∞–º–∏
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
  
  - **Migration plan:**
    1. **–§–∞–∑–∞ 1 - –î–æ–±–∞–≤–∏—Ç—å file-based –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
       - –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –∫—ç—à–∞
       - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∫—ç—à–∞ –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
       - –°–æ—Ö—Ä–∞–Ω—è—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∫—ç—à
       - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ staging
    
    2. **–§–∞–∑–∞ 2 - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
       - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å WebP method=4 –≤–º–µ—Å—Ç–æ method=6 (–±—ã—Å—Ç—Ä–µ–µ)
       - –î–æ–±–∞–≤–∏—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ Celery
       - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ—á–∏—Å—Ç–∫—É —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤ –∫—ç—à–∞
    
    3. **–§–∞–∑–∞ 3 - CDN (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
       - –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ Cloudflare Images –∏–ª–∏ Cloudinary
       - –£–±—Ä–∞—Ç—å middleware –ø–æ–ª–Ω–æ—Å—Ç—å—é
       - –û–±–Ω–æ–≤–∏—Ç—å —à–∞–±–ª–æ–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è CDN URL

---

## üìù –û–°–¢–ê–í–®–ò–ï–°–Ø –ü–†–û–ë–õ–ï–ú–´ (–ö–†–ê–¢–ö–ò–ô –°–ü–ò–°–û–ö)

–ò–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π —Ä–∞–∑–º–µ—Ä–∞, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –∫—Ä–∞—Ç–∫–æ. –ö–∞–∂–¥–∞—è —Ç—Ä–µ–±—É–µ—Ç —Ç–∞–∫–æ–≥–æ –∂–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.

### üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï (–æ—Å—Ç–∞–ª–æ—Å—å 5):

**#8: –ù–µ—Ç WebP/AVIF —Ñ–æ—Ä–º–∞—Ç–æ–≤**
- –§–∞–π–ª: –í—Å—è media –ø–∞–ø–∫–∞
- –ü—Ä–æ–±–ª–µ–º–∞: –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ JPEG/PNG
- –í–ª–∏—è–Ω–∏–µ: +40-60% —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –†–µ—à–µ–Ω–∏–µ: –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ WebP/AVIF, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `<picture>` —Å fallback

**#9: .style.left/top –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ (reflows)**
- –§–∞–π–ª: `main.js`, –∞–Ω–∏–º–∞—Ü–∏–∏
- –ü—Ä–æ–±–ª–µ–º–∞: –ò–∑–º–µ–Ω–µ–Ω–∏–µ position –≤—ã–∑—ã–≤–∞–µ—Ç reflow
- –í–ª–∏—è–Ω–∏–µ: Jank –ø—Ä–∏ –∞–Ω–∏–º–∞—Ü–∏—è—Ö, FPS –ø–∞–¥–∞–µ—Ç
- –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å transform: translate –≤–º–µ—Å—Ç–æ left/top

**#10: N+1 –≤ build_color_preview_map**
- –§–∞–π–ª: `storefront/services/catalog_helpers.py` (—Å—Ç—Ä–æ–∫–∞ 73)
- –ü—Ä–æ–±–ª–µ–º–∞: `variant.images.all()` –≤ —Ü–∏–∫–ª–µ
- –í–ª–∏—è–Ω–∏–µ: +50-100ms –Ω–∞ –∫–∞—Ç–∞–ª–æ–≥
- –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å prefetch_related –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**#11: filter: drop-shadow –≤ –∞–Ω–∏–º–∞—Ü–∏—è—Ö**
- –§–∞–π–ª: `styles.css`
- –ü—Ä–æ–±–ª–µ–º–∞: drop-shadow –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –∞–Ω–∏–º–∏—Ä—É–µ–º—ã–º —ç–ª–µ–º–µ–Ω—Ç–∞–º
- –í–ª–∏—è–Ω–∏–µ: GPU overload, FPS drop
- –†–µ—à–µ–Ω–∏–µ: –£–±—Ä–∞—Ç—å –∏–∑ –∞–Ω–∏–º–∞—Ü–∏–π –∏–ª–∏ —É–ø—Ä–æ—Å—Ç–∏—Ç—å

**#12: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ N+1 –≤ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö**
- API endpoints
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤
- Related products
- –†–µ—à–µ–Ω–∏–µ: –í–µ–∑–¥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å in_bulk() –∏ prefetch_related

### üü° –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (32 –ø—Ä–æ–±–ª–µ–º—ã):

**#13-15: JavaScript –ø—Ä–æ–±–ª–µ–º—ã**
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ DOM –∑–∞–ø—Ä–æ—Å—ã (–∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä—ã)
- innerHTML –±–µ–∑ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ (XSS —Ä–∏—Å–∫)
- –ù–µ—Ç debounce –Ω–∞ resize/scroll events

**#16-20: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**
- COMPRESS_ENABLED = False –≤ dev
- –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π cache_page_for_anon
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ fragment –∫—ç—à–∞ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö
- os.path.exists() –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã
- os.path.getmtime() –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ –¥–ª—è ETag

**#21-25: Middleware**
- –ü–æ—Ä—è–¥–æ–∫ middleware –Ω–µ –æ–ø—Ç–∏–º–∞–ª–µ–Ω
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ middleware –º–æ–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å
- Rate limiting –±–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –¥–ª—è static
- UTM tracking –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å (–º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å)

**#26-30: CSS**
- Animations —Å —Ç—è–∂–µ–ª—ã–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏
- !important overuse (22,000+ —Å—Ç—Ä–æ–∫ CSS)
- –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å—Ç–∏–ª–∏
- –ù–µ—Ç critical CSS extraction
- Bootstrap –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å CDN (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å)

**#31-35: Database**
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ .only()/.defer() –¥–ª—è –±–æ–ª—å—à–∏—Ö –ø–æ–ª–µ–π
- –ù–µ—Ç –∏–Ω–¥–µ–∫—Å–æ–≤ –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª—è—Ö (phone, email)
- N+1 –≤ @property –º–µ—Ç–æ–¥–∞—Ö –º–æ–¥–µ–ª–µ–π
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ database connection pooling config
- –ù–µ—Ç read replicas –¥–ª—è read-heavy operations

**#36-40: Analytics**
- GTM –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –≤ <head>
- TikTok Pixel –∏—Å–ø–æ–ª—å–∑—É–µ—Ç setInterval (polling)
- Facebook Pixel events –±–µ–∑ debounce
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ tracking calls –Ω–∞ –æ–¥–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ analytics error handling

**#41-44: –î—Ä—É–≥–æ–µ**
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Service Worker –¥–ª—è offline
- –ù–µ—Ç HTTP/2 Server Push hints
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è preload/prefetch –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
- Font loading –±–µ–∑ font-display: swap

### üü¢ –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (5 –ø—Ä–æ–±–ª–µ–º):

**#45-49:**
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ—á–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ lazy loading –¥–ª—è offscreen images
- –ù–µ—Ç response compression –¥–ª—è JSON API
- Static files –Ω–µ –∏–º–µ—é—Ç immutable cache headers
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ monitoring/alerting –¥–ª—è performance regressions

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ê–ù–ê–õ–ò–ó–ê

**–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –ø—Ä–æ–±–ª–µ–º:** 49
- **–î–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å–∞–Ω–æ:** 7 (—Å –ø–æ–ª–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º ~10,000 —Å–ª–æ–≤ –∫–∞–∂–¥–∞—è)
- **–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—Å–∞–Ω–æ:** 42 (—Ç—Ä–µ–±—É—é—Ç —Ç–∞–∫–æ–≥–æ –∂–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞)

**–ü–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º:**
- üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ: 12
- üü° –í—ã—Å–æ–∫–∏–π: 32
- üü¢ –°—Ä–µ–¥–Ω–∏–π: 5

**–ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:**
- Database/ORM: 15 –ø—Ä–æ–±–ª–µ–º
- CSS/Styling: 12 –ø—Ä–æ–±–ª–µ–º
- JavaScript: 8 –ø—Ä–æ–±–ª–µ–º
- Middleware: 5 –ø—Ä–æ–±–ª–µ–º
- Images/Media: 4 –ø—Ä–æ–±–ª–µ–º
- Caching: 3 –ø—Ä–æ–±–ª–µ–º—ã
- Security: 2 –ø—Ä–æ–±–ª–µ–º—ã

**–û–∂–∏–¥–∞–µ–º–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–æ–±–ª–µ–º:**
- FCP: -40-60% (2-4 —Å–µ–∫—É–Ω–¥—ã -> 0.8-1.6 —Å–µ–∫—É–Ω–¥—ã)
- LCP: -50-70%
- TTI: -60-80%
- Database queries: -70-85%
- Page weight: -30-50%
- Server CPU: -50-70%
- Memory usage: -40-60%

---

## üìù –ò–ù–°–¢–†–£–ö–¶–ò–ò –î–õ–Ø –°–õ–ï–î–£–Æ–©–ï–ì–û –ê–ì–ï–ù–¢–ê

1. **–ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ä–∞–∑–¥–µ–ª—ã "–ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó CONTEXT7"** –¥–ª—è –≤—Å–µ—Ö –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å–∞–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º (#1-#7)
2. **–î–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã #8-#49** –∏—Å–ø–æ–ª—å–∑—É—è —Ç–æ—Ç –∂–µ —Ñ–æ—Ä–º–∞—Ç –∏ —É—Ä–æ–≤–µ–Ω—å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏
3. **–î–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–±–ª–µ–º—ã –≤–∫–ª—é—á–∏—Ç—å:**
   - –û–ø–∏—Å–∞–Ω–∏–µ (–ø–æ—á–µ–º—É –∫—Ä–∏—Ç–∏—á–Ω–æ)
   - –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ (—Ñ–∞–π–ª—ã + —Å—Ç—Ä–æ–∫–∏ + –∫–æ–Ω—Ç–µ–∫—Å—Ç)
   - –ê–Ω–∞–ª–∏–∑ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
   - –í–ª–∏—è–Ω–∏–µ –Ω–∞ –í–°–ï –º–µ—Ç—Ä–∏–∫–∏
   - –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
   - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Ç–µ—Å—Ç—ã
   - –ü–æ–ª–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ Context7

**–§–æ—Ä–º–∞—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≥–æ—Ç–æ–≤ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω –¥–æ 10,000+ —Å—Ç—Ä–æ–∫ —Å –ø–æ–ª–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º –≤—Å–µ—Ö 49 –ø—Ä–æ–±–ª–µ–º.**

---

## –ü–†–û–ë–õ–ï–ú–ê #8: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (WebP/AVIF)

### üî¥ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö–†–ò–¢–ò–ß–ù–û

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** (JPEG, PNG), —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫:

1. **–ù–∞ 40-60% –±–æ–ª—å—à–∏–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤** –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å WebP
2. **–ù–∞ 50-70% –±–æ–ª—å—à–∏–π —Ä–∞–∑–º–µ—Ä** –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å AVIF
3. **–ú–µ–¥–ª–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü** –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
4. **–ü–æ–≤—ã—à–µ–Ω–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
5. **–•—É–¥—à–∏–µ Core Web Vitals** (LCP —Å—Ç—Ä–∞–¥–∞–µ—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ)

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤ (—Ç–∏–ø–∏—á–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ 2000√ó2000px):**

| –§–æ—Ä–º–∞—Ç | –†–∞–∑–º–µ—Ä | –ö–∞—á–µ—Å—Ç–≤–æ | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±—Ä–∞—É–∑–µ—Ä–æ–≤ |
|--------|--------|----------|---------------------|
| JPEG (quality=85) | 450KB | –•–æ—Ä–æ—à–µ–µ | 100% |
| PNG | 2.5MB | –û—Ç–ª–∏—á–Ω–æ–µ | 100% |
| **WebP (quality=85)** | **180KB (-60%)** | –û—Ç–ª–∏—á–Ω–æ–µ | 97%+ (–≤—Å–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ) |
| **AVIF (quality=85)** | **120KB (-73%)** | –û—Ç–ª–∏—á–Ω–æ–µ | 85%+ (Chrome, Firefox, Safari 16+) |

**–≠–∫–æ–Ω–æ–º–∏—è –¥–ª—è —Ç–∏–ø–∏—á–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–æ–≤–∞—Ä–∞:**
- 1 –≥–ª–∞–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ + 4 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö + 6 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ü–≤–µ—Ç–∞
- JPEG: 450KB √ó 11 = **4.95MB**
- WebP: 180KB √ó 11 = **1.98MB** (—ç–∫–æ–Ω–æ–º–∏—è 2.97MB = **60%**)
- AVIF: 120KB √ó 11 = **1.32MB** (—ç–∫–æ–Ω–æ–º–∏—è 3.63MB = **73%**)

**–ü–æ—á–µ–º—É —ç—Ç–æ –ö–†–ò–¢–ò–ß–ù–û:**

- **Mobile-first** - –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
- **Slow connections** - 3G/4G –≤ –£–∫—Ä–∞–∏–Ω–µ –Ω–µ –≤–µ–∑–¥–µ –±—ã—Å—Ç—Ä—ã–π
- **Google Page Experience** - —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ö–æ–Ω–≤–µ—Ä—Å–∏—è** - –º–µ–¥–ª–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã = –º–µ–Ω—å—à–µ –ø—Ä–æ–¥–∞–∂

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –º–µ—Å—Ç–∞:**

1. **–®–∞–±–ª–æ–Ω—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ JPEG/PNG:**

**–§–∞–π–ª:** `twocomms/twocomms_django_theme/templates/partials/product_card.html`  
**–°—Ç—Ä–æ–∫–∏:** 25-40

```html
<!-- ‚ùå –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ JPEG/PNG -->
<img src="{{ p.display_image.url }}" 
     alt="{{ p.title }}" 
     class="product-image"
     loading="lazy">

<!-- ‚úÖ –î–û–õ–ñ–ù–û –ë–´–¢–¨: -->
<picture>
  <source srcset="{{ p.display_image_avif }}" type="image/avif">
  <source srcset="{{ p.display_image_webp }}" type="image/webp">
  <img src="{{ p.display_image.url }}" 
       alt="{{ p.title }}" 
       class="product-image"
       loading="lazy">
</picture>
```

2. **Template tag `optimized_image` –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç WebP/AVIF:**

**–§–∞–π–ª:** `twocomms/storefront/templatetags/image_tags.py`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–æ–ª—å–∫–æ —Ä–µ—Å–∞–π–∑, –±–µ–∑ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ñ–æ—Ä–º–∞—Ç–æ–≤

3. **ImageOptimizationMiddleware –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤ WebP, –Ω–æ:**
   - –¢–æ–ª—å–∫–æ –Ω–∞ –ª–µ—Ç—É (–º–µ–¥–ª–µ–Ω–Ω–æ)
   - –ù–µ—Ç AVIF –ø–æ–¥–¥–µ—Ä–∂–∫–∏
   - –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

4. **–í—Å–µ placeholder images - JPEG:**
```
twocomms/twocomms_django_theme/static/img/placeholder.jpg  # ‚ùå JPEG
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–µ–π—á–∞—Å:**

1. **JPEG** –¥–ª—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Ç–æ–≤–∞—Ä–æ–≤ (90% –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
2. **PNG** –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å—é (–ª–æ–≥–æ—Ç–∏–ø—ã, –∏–∫–æ–Ω–∫–∏)
3. **ImageOptimizationMiddleware** –ø—ã—Ç–∞–µ—Ç—Å—è –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ WebP –Ω–∞ –ª–µ—Ç—É (–Ω–æ –º–µ–¥–ª–µ–Ω–Ω–æ)

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å:**

```
User -> /product/hoodie/
  -> Django renders template
  -> <img src="/media/products/hoodie.jpg">  # ‚ùå JPEG 450KB
  -> ImageOptimizationMiddleware –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç
  -> –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤ WebP –Ω–∞ –ª–µ—Ç—É (200ms –∑–∞–¥–µ—Ä–∂–∫–∞)
  -> –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç WebP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (180KB)
  
–ù–û:
- –ó–∞–¥–µ—Ä–∂–∫–∞ 200ms –Ω–∞ –∫–∞–∂–¥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- –ù–µ—Ç –∫—ç—à–∞ = –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è
- –ù–µ—Ç AVIF –≤–∞—Ä–∏–∞–Ω—Ç–∞
- –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —á–µ—Ä–µ–∑ <picture>
```

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:**

```
Upload -> Admin –ø–∞–Ω–µ–ª—å -> –ó–∞–≥—Ä—É–∑–∫–∞ hoodie.jpg
  -> Signal post_save
  -> –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –≤–µ—Ä—Å–∏–∏:
     - hoodie.jpg (–æ—Ä–∏–≥–∏–Ω–∞–ª, 450KB)
     - hoodie.webp (180KB)
     - hoodie.avif (120KB)
  -> –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ media/products/

User -> /product/hoodie/
  -> Template –∏—Å–ø–æ–ª—å–∑—É–µ—Ç <picture>:
     <source srcset="hoodie.avif" type="image/avif">
     <source srcset="hoodie.webp" type="image/webp">
     <img src="hoodie.jpg">
  -> –ë—Ä–∞—É–∑–µ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–π —Ñ–æ—Ä–º–∞—Ç:
     - Safari 16+/Chrome/Firefox: AVIF (120KB)
     - –°—Ç–∞—Ä—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã: WebP (180KB)
     - IE11/—Å–æ–≤—Å–µ–º —Å—Ç–∞—Ä—ã–µ: JPEG (450KB)
```

**Frequency:**
- **–ö–∞–∂–¥–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–≤–∞—Ä–∞:** 5-15 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **–ö–∞—Ç–∞–ª–æ–≥:** 20-40 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **–ì–ª–∞–≤–Ω–∞—è:** 10-30 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **–ò–¢–û–ì–û:** –°–æ—Ç–Ω–∏ MB –ª–∏—à–Ω–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ

**–†–∞–∑–º–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã:**

–î–ª—è —Å–∞–π—Ç–∞ —Å 1000 —Ç–æ–≤–∞—Ä–æ–≤:
- 1000 —Ç–æ–≤–∞—Ä–æ–≤ √ó 5 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π = 5000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- JPEG: 5000 √ó 450KB = **2.25GB**
- WebP: 5000 √ó 180KB = **900MB** (—ç–∫–æ–Ω–æ–º–∏—è 1.35GB)
- AVIF: 5000 √ó 120KB = **600MB** (—ç–∫–æ–Ω–æ–º–∏—è 1.65GB)

–î–ª—è 1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/–¥–µ–Ω—å:
- –°—Ä–µ–¥–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: 10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- JPEG: 10 √ó 450KB = 4.5MB per user √ó 1000 = **4.5GB/day**
- WebP: 10 √ó 180KB = 1.8MB per user √ó 1000 = **1.8GB/day** 
- **–≠–∫–æ–Ω–æ–º–∏—è: 2.7GB —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ –¥–µ–Ω—å!**

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**FCP (First Contentful Paint):**
- ‚¨ÜÔ∏è **–£–ª—É—á—à–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: -30-50%**
- –ú–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π = –±—ã—Å—Ç—Ä–µ–µ –∑–∞–≥—Ä—É–∑–∫–∞

**LCP (Largest Contentful Paint):**
- ‚¨ÜÔ∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï —É–ª—É—á—à–µ–Ω–∏–µ: -40-70%**
- LCP —á–∞—Å—Ç–æ = –≥–ª–∞–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
- 450KB JPEG -> 120KB AVIF = **73% –±—ã—Å—Ç—Ä–µ–µ**

**TTI (Time to Interactive):**
- ‚¨ÜÔ∏è **–£–ª—É—á—à–µ–Ω–∏–µ: -20-40%**
- –ú–µ–Ω—å—à–µ network activity = –±—ã—Å—Ç—Ä–µ–µ TTI

**CLS (Cumulative Layout Shift):**
- ‚û°Ô∏è **–ù–µ—Ç –≤–ª–∏—è–Ω–∏—è** (–µ—Å–ª–∏ width/height —É–∫–∞–∑–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ)

**FID (First Input Delay):**
- ‚û°Ô∏è **–ù–µ—Ç –ø—Ä—è–º–æ–≥–æ –≤–ª–∏—è–Ω–∏—è**

**GPU/CPU:**
- ‚û°Ô∏è **–ù–µ—Ç –≤–ª–∏—è–Ω–∏—è** (–¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ WebP/AVIF —Ç–∞–∫–æ–µ –∂–µ –∫–∞–∫ JPEG)

**–ü–∞–º—è—Ç—å:**
- ‚¨ÜÔ∏è **–£–ª—É—á—à–µ–Ω–∏–µ: -40-60%**
- –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ø–∞–º—è—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞

**–ë–î –∑–∞–ø—Ä–æ—Å—ã:**
- ‚û°Ô∏è **–ù–µ—Ç –≤–ª–∏—è–Ω–∏—è**

**–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:**
- ‚¨ÜÔ∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï —É–ª—É—á—à–µ–Ω–∏–µ: -60-73%**
- WebP: -60%
- AVIF: -73%

**Bandwidth usage:**
- ‚¨ÜÔ∏è **–≠–∫–æ–Ω–æ–º–∏—è: 2.7GB/day** –¥–ª—è 1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**SEO/Page Experience:**
- ‚¨ÜÔ∏è **–ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ**
- Google —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –õ—É—á—à–µ scores = –≤—ã—à–µ –≤ –ø–æ–∏—Å–∫–µ

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **Browser compatibility:**
   - ‚úÖ **–†–∏—Å–∫: –ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ô** (–∏—Å–ø–æ–ª—å–∑—É–µ–º `<picture>` —Å fallback)
   - WebP: 97%+ –±—Ä–∞—É–∑–µ—Ä–æ–≤ (IE11 –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç, –Ω–æ fallback –Ω–∞ JPEG)
   - AVIF: 85%+ (Safari < 16 –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç, fallback –Ω–∞ WebP/JPEG)

2. **Storage increase:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - –ù—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å 3 –≤–µ—Ä—Å–∏–∏ –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
   - 5000 images √ó (450KB + 180KB + 120KB) = **3.75GB storage**
   - –†–µ—à–µ–Ω–∏–µ: —Å—Ç–∞—Ä—ã–µ/–Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —É–¥–∞–ª—è—Ç—å

3. **Upload time:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è WebP/AVIF –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–æ–±–∞–≤–ª—è–µ—Ç 2-5 —Å–µ–∫—É–Ω–¥
   - –†–µ—à–µ–Ω–∏–µ: –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ Celery

4. **Template changes:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - –ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ —à–∞–±–ª–æ–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `<picture>`
   - –ú–Ω–æ–≥–æ –º–µ—Å—Ç –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
   - –†–µ—à–µ–Ω–∏–µ: —Å–æ–∑–¥–∞—Ç—å template tag `{% responsive_image %}`

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

1. **Pillow library:**
   - –ù—É–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ WebP (pillow-simd –∏–ª–∏ pillow >= 8.0)
   - –î–ª—è AVIF: pillow-avif-plugin –∏–ª–∏ pillow >= 10.0

2. **–í—Å–µ —à–∞–±–ª–æ–Ω—ã:**
   - product_card.html
   - product_detail.html
   - catalog.html
   - index.html
   - –ò –¥—Ä—É–≥–∏–µ

3. **Admin/Upload flow:**
   - –ù—É–∂–µ–Ω signal –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–µ—Ä—Å–∏–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

4. **–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
   - –ù—É–∂–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è: —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å WebP/AVIF –¥–ª—è –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**

1. **Browser compatibility:**
   - ‚úÖ Chrome (WebP, AVIF)
   - ‚úÖ Firefox (WebP, AVIF)
   - ‚úÖ Safari 16+ (WebP, AVIF)
   - ‚úÖ Safari < 16 (WebP fallback)
   - ‚úÖ Edge (WebP, AVIF)
   - ‚ö†Ô∏è IE11 (JPEG fallback)

2. **Visual quality:**
   - ‚úÖ –°—Ä–∞–≤–Ω–∏—Ç—å JPEG vs WebP vs AVIF –≤–∏–∑—É–∞–ª—å–Ω–æ
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å quality settings (80-85 –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

3. **Performance:**
   - ‚úÖ Lighthouse score –¥–æ/–ø–æ—Å–ª–µ
   - ‚úÖ –†–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–æ/–ø–æ—Å–ª–µ
   - ‚úÖ LCP timing –¥–æ/–ø–æ—Å–ª–µ

4. **Upload flow:**
   - ‚úÖ –ó–∞–≥—Ä—É–∑–∏—Ç—å —á–µ—Ä–µ–∑ admin -> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –≤—Å–µ –≤–µ—Ä—Å–∏–∏
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ –ª–æ–º–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

**–†–µ—à–µ–Ω–∏–µ (–ø–æ—à–∞–≥–æ–≤–æ):**

**–®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏**
```bash
pip install pillow>=10.0  # –ü–æ–¥–¥–µ—Ä–∂–∫–∞ AVIF built-in
# –ò–õ–ò
pip install pillow-avif-plugin  # –ï—Å–ª–∏ pillow < 10.0
```

**–®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–µ—Ä—Å–∏–π**
```python
# storefront/utils/image_converter.py
from PIL import Image
import os

def generate_modern_formats(image_path):
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç WebP –∏ AVIF –≤–µ—Ä—Å–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"""
    img = Image.open(image_path)
    base_path = os.path.splitext(image_path)[0]
    
    # WebP
    webp_path = f"{base_path}.webp"
    img.save(webp_path, 'WEBP', quality=85, method=6)
    
    # AVIF
    avif_path = f"{base_path}.avif"
    img.save(avif_path, 'AVIF', quality=85)
    
    return webp_path, avif_path
```

**–®–∞–≥ 3: Signal –¥–ª—è –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ**
```python
# storefront/signals.py
from django.db.models.signals import post_save
from django.dispatch import receiver
from .models import Product, ProductImage

@receiver(post_save, sender=ProductImage)
def generate_image_formats(sender, instance, created, **kwargs):
    if created and instance.image:
        from .utils.image_converter import generate_modern_formats
        generate_modern_formats(instance.image.path)
```

**–®–∞–≥ 4: Template tag –¥–ª—è responsive images**
```python
# storefront/templatetags/image_tags.py
@register.inclusion_tag('partials/responsive_image.html')
def responsive_image(image, alt="", css_class="", loading="lazy"):
    """Renders <picture> with WebP/AVIF support"""
    base_url = os.path.splitext(image.url)[0]
    return {
        'avif_url': f"{base_url}.avif",
        'webp_url': f"{base_url}.webp",
        'jpeg_url': image.url,
        'alt': alt,
        'css_class': css_class,
        'loading': loading,
    }
```

**–®–∞–≥ 5: Template**
```html
<!-- partials/responsive_image.html -->
<picture>
  <source srcset="{{ avif_url }}" type="image/avif">
  <source srcset="{{ webp_url }}" type="image/webp">
  <img src="{{ jpeg_url }}" 
       alt="{{ alt }}" 
       class="{{ css_class }}"
       loading="{{ loading }}">
</picture>
```

**–®–∞–≥ 6: Management command –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö**
```python
# management/commands/convert_images_to_modern.py
from django.core.management.base import BaseCommand

class Command(BaseCommand):
    def handle(self, *args, **options):
        from storefront.utils.image_converter import generate_modern_formats
        from storefront.models import ProductImage
        
        for img in ProductImage.objects.all():
            generate_modern_formats(img.image.path)
            print(f"Converted: {img.image.name}")
```

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå **–ë–î –º–∏–≥—Ä–∞—Ü–∏–∏ –ù–ï –Ω—É–∂–Ω—ã** (—Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã)
- ‚úÖ **–ù—É–∂–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤** (command –≤—ã—à–µ)

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**

1. **CDN/Caching:**
   - ‚úÖ –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å cache –¥–ª—è .webp/.avif
   - ‚úÖ CloudFlare/CDN –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

2. **Nginx/Apache config:**
   - ‚úÖ –î–æ–±–∞–≤–∏—Ç—å MIME types –¥–ª—è .webp/.avif
   ```nginx
   types {
       image/webp webp;
       image/avif avif;
   }
   ```

3. **WhiteNoise:**
   - ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç .webp/.avif

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ Context7, Pillow –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, MDN, Web.dev –∏ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞**

**‚ö†Ô∏è –í–ê–ñ–ù–û: –í –∫–æ–¥–µ —É–∂–µ –µ—Å—Ç—å —á–∞—Å—Ç–∏—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ WebP/AVIF!** –ï—Å—Ç—å template tags `optimized_image` –∏ `responsive_image`, —à–∞–±–ª–æ–Ω—ã —Å `<picture>`, –∫–ª–∞—Å—Å `ImageOptimizer`. –ù–æ –æ–Ω–∏ –º–æ–≥—É—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤–µ–∑–¥–µ, –∏ WebP/AVIF –≤–µ—Ä—Å–∏–∏ –º–æ–≥—É—Ç –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (Pillow, MDN, Web.dev):**
  - **Pillow WebP/AVIF documentation:**
    - **Pillow >= 8.0:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ WebP –≤—Å—Ç—Ä–æ–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `img.save('output.webp', format='WEBP', quality=85, method=6)`
    - **Pillow >= 10.0:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ AVIF –≤—Å—Ç—Ä–æ–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `img.save('output.avif', format='AVIF', quality=85)`
    - **Pillow < 10.0:** –î–ª—è AVIF –Ω—É–∂–µ–Ω `pillow-avif-plugin` –∏–ª–∏ `pillow-avif-plugin`
    - **–í –∫–æ–¥–µ:** `ImageOptimizer` (image_optimizer.py:78-81) —É–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç WebP –∏ AVIF ‚úÖ
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é Pillow, –æ–±–Ω–æ–≤–∏—Ç—å –¥–æ >= 10.0 –¥–ª—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ AVIF
  
  - **Browser support stats (caniuse.com, MDN):**
    - **WebP:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 97%+ –±—Ä–∞—É–∑–µ—Ä–æ–≤ (Chrome 23+, Firefox 65+, Safari 14+, Edge 18+). IE11 –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç, –Ω—É–∂–µ–Ω fallback ‚úÖ
    - **AVIF:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 85%+ –±—Ä–∞—É–∑–µ—Ä–æ–≤ (Chrome 85+, Firefox 93+, Safari 16+, Edge 121+). –°—Ç–∞—Ä—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç, –Ω—É–∂–µ–Ω fallback ‚úÖ
    - **Fallback strategy:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `<picture>` —ç–ª–µ–º–µ–Ω—Ç —Å `<source>` –¥–ª—è AVIF/WebP –∏ `<img>` –¥–ª—è JPEG/PNG fallback
    - **–í –∫–æ–¥–µ:** Template tags `optimized_image` –∏ `responsive_image` —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `<picture>` ‚úÖ
  
  - **Quality settings recommendations:**
    - **WebP quality=80-85:** –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ä–∞–∑–º–µ—Ä–æ–º –∏ –∫–∞—á–µ—Å—Ç–≤–æ–º. Quality=85 –¥–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º —Å–∂–∞—Ç–∏–∏
    - **AVIF quality=75-85:** AVIF –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω, quality=80-85 –¥–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –ø—Ä–∏ –µ—â–µ –ª—É—á—à–µ–º —Å–∂–∞—Ç–∏–∏
    - **JPEG quality=85:** –°—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π, —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å
    - **–í –∫–æ–¥–µ:** `ImageOptimizer` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç quality=85 –¥–ª—è WebP –∏ quality=75-85 –¥–ª—è AVIF ‚úÖ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å quality=85 –¥–ª—è WebP –∏ quality=80 –¥–ª—è AVIF –∫–∞–∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å
  
  - **Performance benchmarks WebP vs AVIF:**
    - **WebP vs JPEG:** WebP –Ω–∞ 25-35% –º–µ–Ω—å—à–µ –ø—Ä–∏ —Ç–æ–º –∂–µ –∫–∞—á–µ—Å—Ç–≤–µ, –Ω–∞ 50-60% –º–µ–Ω—å—à–µ –ø—Ä–∏ quality=85
    - **AVIF vs JPEG:** AVIF –Ω–∞ 50-70% –º–µ–Ω—å—à–µ –ø—Ä–∏ —Ç–æ–º –∂–µ –∫–∞—á–µ—Å—Ç–≤–µ, –ª—É—á—à–µ–µ —Å–∂–∞—Ç–∏–µ —á–µ–º WebP
    - **AVIF vs WebP:** AVIF –Ω–∞ 20-30% –º–µ–Ω—å—à–µ —á–µ–º WebP –ø—Ä–∏ —Ç–æ–º –∂–µ –∫–∞—á–µ—Å—Ç–≤–µ
    - **Encoding speed:** WebP –±—ã—Å—Ç—Ä–µ–µ –∫–æ–¥–∏—Ä—É–µ—Ç—Å—è —á–µ–º AVIF, –Ω–æ –æ–±–∞ –º–µ–¥–ª–µ–Ω–Ω–µ–µ —á–µ–º JPEG
    - **Decoding speed:** WebP –∏ AVIF –¥–µ–∫–æ–¥–∏—Ä—É—é—Ç—Å—è –±—ã—Å—Ç—Ä–æ –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö
    - **–í—ã–≤–æ–¥:** AVIF - –ª—É—á—à–∏–π —Ñ–æ—Ä–º–∞—Ç –ø–æ —Å–∂–∞—Ç–∏—é, WebP - —Ö–æ—Ä–æ—à–∏–π –∫–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É —Å–∂–∞—Ç–∏–µ–º –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ industry best practices:**
  - **Picture element best practices (MDN):**
    - **–ü–æ—Ä—è–¥–æ–∫ `<source>`:** –ë—Ä–∞—É–∑–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–≤—ã–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç, –ø–æ—ç—Ç–æ–º—É AVIF –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–µ—Ä–≤—ã–º (–ª—É—á—à–µ–µ —Å–∂–∞—Ç–∏–µ), –∑–∞—Ç–µ–º WebP, –∑–∞—Ç–µ–º fallback
    - **Type attribute:** –í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞—Ç—å `type="image/avif"` –∏ `type="image/webp"` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã
    - **Fallback:** `<img>` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–º –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å URL –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É (JPEG/PNG)
    - **–í –∫–æ–¥–µ:** Template tags –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ (AVIF ‚Üí WebP ‚Üí JPEG) ‚úÖ
  
  - **Responsive images with srcset:**
    - **MDN:** –ú–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å `<picture>` —Å `srcset` –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤
    - **–ü—Ä–∏–º–µ—Ä:** `<source srcset="image-320w.avif 320w, image-640w.avif 640w" sizes="(max-width: 320px) 320px, 640px" type="image/avif">`
    - **–í –∫–æ–¥–µ:** `responsive_image` template tag –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç srcset ‚úÖ
  
  - **Pre-generation vs on-demand:**
    - **Pre-generation (–ª—É—á—à–µ):** –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å WebP/AVIF –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ signals
    - **On-demand (–º–µ–¥–ª–µ–Ω–Ω–µ–µ):** –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ (–∫–∞–∫ –≤ ImageOptimizationMiddleware)
    - **–í –∫–æ–¥–µ:** –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ ‚ùå, –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å signals

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ real-world benchmarks:**
  - **Real-world performance improvements:**
    - **Netflix:** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ AVIF –¥–∞–ª 50% —É–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —É–ª—É—á—à–∏–ª LCP –Ω–∞ 200-300ms
    - **eBay:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ WebP –¥–∞–ª–æ 30-40% —É–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞, —É–ª—É—á—à–∏–ª–æ page load time –Ω–∞ 15-20%
    - **Google:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç WebP/AVIF –¥–ª—è –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
    - **–í—ã–≤–æ–¥:** WebP/AVIF –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
  
  - **Storage and bandwidth savings:**
    - **–î–ª—è 1000 —Ç–æ–≤–∞—Ä–æ–≤ —Å 5 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏:** –≠–∫–æ–Ω–æ–º–∏—è 1.35GB (WebP) –∏–ª–∏ 1.65GB (AVIF) storage
    - **–î–ª—è 1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/–¥–µ–Ω—å:** –≠–∫–æ–Ω–æ–º–∏—è 2.7GB (WebP) –∏–ª–∏ 3.3GB (AVIF) bandwidth –≤ –¥–µ–Ω—å
    - **–ì–æ–¥–æ–≤–∞—è —ç–∫–æ–Ω–æ–º–∏—è:** ~1TB bandwidth –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ e-commerce —Å–∞–π—Ç–∞
    - **CDN costs:** –ú–µ–Ω—å—à–µ bandwidth = –º–µ–Ω—å—à–µ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ CDN

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í –∫–æ–¥–µ —É–∂–µ –µ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∞:**
    - `ImageOptimizer` –∫–ª–∞—Å—Å (image_optimizer.py) - –º–æ–∂–µ—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ WebP –∏ AVIF ‚úÖ
    - Template tags `optimized_image` –∏ `responsive_image` - –∏—Å–ø–æ–ª—å–∑—É—é—Ç `<picture>` —Å WebP/AVIF ‚úÖ
    - –®–∞–±–ª–æ–Ω—ã `optimized_image.html` –∏ `responsive_image.html` - –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `<picture>` ‚úÖ
  
  - **–ü—Ä–æ–±–ª–µ–º—ã:**
    - Template tags –º–æ–≥—É—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤–µ–∑–¥–µ - –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —à–∞–±–ª–æ–Ω—ã ‚ùå
    - –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ WebP/AVIF –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚ùå
    - –ù–µ—Ç signals –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–µ—Ä—Å–∏–π –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ Product/ProductImage ‚ùå
    - –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –∏–º–µ—é—Ç WebP/AVIF –≤–µ—Ä—Å–∏–π ‚ùå
    - –ù–µ—Ç management command –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚ùå
  
  - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
    - –î–æ–±–∞–≤–∏—Ç—å signals –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    - –°–æ–∑–¥–∞—Ç—å management command –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    - –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ —à–∞–±–ª–æ–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è template tags —Å WebP/AVIF
    - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Pillow >= 10.0 –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ AVIF

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û - –≤—ã—Å–æ–∫–∏–π impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –æ—Å–æ–±–µ–Ω–Ω–æ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
  - **Implementation strategy:**
    1. **–§–∞–∑–∞ 1 - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:**
       - –î–æ–±–∞–≤–∏—Ç—å signals –¥–ª—è Product –∏ ProductImage
       - –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å WebP –∏ AVIF –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
       - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Celery –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (—á—Ç–æ–±—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å upload)
    
    2. **–§–∞–∑–∞ 2 - –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:**
       - –°–æ–∑–¥–∞—Ç—å management command –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ WebP/AVIF –¥–ª—è –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
       - –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ —Ñ–æ–Ω–µ —á–µ—Ä–µ–∑ Celery –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤
       - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
    
    3. **–§–∞–∑–∞ 3 - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤:**
       - –ù–∞–π—Ç–∏ –≤—Å–µ –º–µ—Å—Ç–∞ –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä—è–º—ã–µ `<img src="{{ image.url }}">`
       - –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ template tags `{% optimized_image %}` –∏–ª–∏ `{% responsive_image %}`
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç `<picture>` —ç–ª–µ–º–µ–Ω—Ç
  
  - **–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
    
    **1. Signals –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:**
    ```python
    # storefront/signals.py
    from django.db.models.signals import post_save
    from django.dispatch import receiver
    from .models import Product, ProductImage
    from celery import shared_task
    
    @shared_task
    def generate_image_formats_async(image_path):
        """–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è WebP/AVIF –≤–µ—Ä—Å–∏–π"""
        from twocomms.image_optimizer import ImageOptimizer
        optimizer = ImageOptimizer()
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º WebP
        webp_data = optimizer.optimize_image(image_path, 'WEBP', quality=85)
        if webp_data:
            webp_path = os.path.splitext(image_path)[0] + '.webp'
            with open(webp_path, 'wb') as f:
                f.write(webp_data)
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º AVIF
        try:
            avif_data = optimizer.optimize_image(image_path, 'AVIF', quality=80)
            if avif_data:
                avif_path = os.path.splitext(image_path)[0] + '.avif'
                with open(avif_path, 'wb') as f:
                    f.write(avif_data)
        except Exception as e:
            logger.warning(f"AVIF generation failed: {e}")
    
    @receiver(post_save, sender=Product)
    def generate_product_image_formats(sender, instance, created, **kwargs):
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç WebP/AVIF –¥–ª—è –≥–ª–∞–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞"""
        if instance.main_image:
            image_path = instance.main_image.path
            generate_image_formats_async.delay(image_path)
    
    @receiver(post_save, sender=ProductImage)
    def generate_product_image_image_formats(sender, instance, created, **kwargs):
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç WebP/AVIF –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"""
        if created and instance.image:
            image_path = instance.image.path
            generate_image_formats_async.delay(image_path)
    ```
    
    **2. Management command –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏:**
    ```python
    # storefront/management/commands/convert_images_to_modern.py
    from django.core.management.base import BaseCommand
    from storefront.models import Product, ProductImage
    from twocomms.image_optimizer import ImageOptimizer
    from celery import group
    
    class Command(BaseCommand):
        help = '–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ WebP/AVIF'
        
        def handle(self, *args, **options):
            optimizer = ImageOptimizer()
            tasks = []
            
            # –ì–ª–∞–≤–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤
            for product in Product.objects.exclude(main_image=''):
                if product.main_image:
                    tasks.append(generate_image_formats_async.s(product.main_image.path))
            
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            for img in ProductImage.objects.exclude(image=''):
                if img.image:
                    tasks.append(generate_image_formats_async.s(img.image.path))
            
            # –ó–∞–ø—É—Å–∫–∞–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
            job = group(tasks)
            result = job.apply_async()
            self.stdout.write(f"–ó–∞–ø—É—â–µ–Ω–æ {len(tasks)} –∑–∞–¥–∞—á –Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é")
    ```
    
    **3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤:**
    ```html
    <!-- –ë–´–õ–û: -->
    <img src="{{ product.main_image.url }}" alt="{{ product.title }}">
    
    <!-- –°–¢–ê–õ–û: -->
    {% optimized_image product.main_image.url product.title %}
    <!-- –ò–ª–∏: -->
    {% responsive_image product.main_image.url product.title %}
    ```
  
  - **Testing checklist:**
    1. ‚úÖ **Browser compatibility:**
       - Chrome (WebP, AVIF) - –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AVIF
       - Firefox (WebP, AVIF) - –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AVIF
       - Safari 16+ (WebP, AVIF) - –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AVIF
       - Safari < 16 (WebP) - –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å WebP
       - Edge (WebP, AVIF) - –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AVIF
       - IE11 (fallback) - –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JPEG
    
    2. ‚úÖ **Visual quality:**
       - –°—Ä–∞–≤–Ω–∏—Ç—å JPEG vs WebP vs AVIF –≤–∏–∑—É–∞–ª—å–Ω–æ - –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–º–µ—Ç–Ω–æ–π —Ä–∞–∑–Ω–∏—Ü—ã
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å quality settings (80-85 –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ —Å–∂–∞—Ç–∏—è
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å (–¥–ª—è PNG ‚Üí WebP/AVIF)
    
    3. ‚úÖ **Performance:**
       - Lighthouse score –¥–æ/–ø–æ—Å–ª–µ - –¥–æ–ª–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å—Å—è –Ω–∞ 5-10 –ø—É–Ω–∫—Ç–æ–≤
       - –†–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–æ/–ø–æ—Å–ª–µ - –¥–æ–ª–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å—Å—è –Ω–∞ 40-60%
       - LCP timing –¥–æ/–ø–æ—Å–ª–µ - –¥–æ–ª–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å—Å—è –Ω–∞ 200-500ms
       - Network tab - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
    
    4. ‚úÖ **Upload flow:**
       - –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ admin ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è WebP –∏ AVIF –≤–µ—Ä—Å–∏–∏
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ –ª–æ–º–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Celery –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
    
    5. ‚úÖ **Migration:**
       - –ó–∞–ø—É—Å—Ç–∏—Ç—å management command –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å –±–∏—Ç—ã—Ö —Å—Å—ã–ª–æ–∫
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –¥–∏—Å–∫–∞ (WebP/AVIF –≤–µ—Ä—Å–∏–∏ –∑–∞–Ω–∏–º–∞—é—Ç –º–µ—Å—Ç–æ)

---

## –ü–†–û–ë–õ–ï–ú–ê #9: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ .style.left/top –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π (–≤—ã–∑—ã–≤–∞–µ—Ç reflows)

### üî¥ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö–†–ò–¢–ò–ß–ù–û

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

JavaScript –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–ø—Ä—è–º—ã–µ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ `.style.left` –∏ `.style.top`** –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π, —á—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç **–¥–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–∏–µ reflows (layout recalculations)** –≤ –±—Ä–∞—É–∑–µ—Ä–µ.

**–ù–∞–π–¥–µ–Ω–æ 8 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –º–µ—Å—Ç –≤ `product-detail.js`:**

1. **–°—Ç—Ä–æ–∫–∞ 100:** `tempImg.style.left = '100%'` - –Ω–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
2. **–°—Ç—Ä–æ–∫–∞ 113:** `mainImage.style.left = '-100%'` - –∞–Ω–∏–º–∞—Ü–∏—è —Å–º–µ–Ω—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
3. **–°—Ç—Ä–æ–∫–∞ 115:** `tempImg.style.left = '0'` - –∞–Ω–∏–º–∞—Ü–∏—è —Å–º–µ–Ω—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
4. **–°—Ç—Ä–æ–∫–∞ 123:** `mainImage.style.left = 'auto'` - —Å–±—Ä–æ—Å –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
5. **–°—Ç—Ä–æ–∫–∞ 573:** `flyElement.style.left = startRect.left + 'px'` - fly-to-cart –∞–Ω–∏–º–∞—Ü–∏—è
6. **–°—Ç—Ä–æ–∫–∞ 577:** `flyElement.style.left = cartRect.left + ...` - fly-to-cart —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
7. **–°—Ç—Ä–æ–∫–∞ 615:** `flyElement.style.left = startRect.left + 'px'` - desktop fly-to-cart
8. **–°—Ç—Ä–æ–∫–∞ 619:** `flyElement.style.left = cartRect.left + ...` - desktop fly-to-cart —Ñ–∏–Ω–∞–ª

**–ü–æ—á–µ–º—É —ç—Ç–æ –ö–†–ò–¢–ò–ß–ù–û:**

### Rendering Pipeline –≤ –±—Ä–∞—É–∑–µ—Ä–µ:

```
1. JavaScript –∏–∑–º–µ–Ω—è–µ—Ç left/top
   ‚Üì
2. Style Recalculation (–Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å computed styles)
   ‚Üì
3. Layout/Reflow (–î–û–†–û–ì–û! - –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –ø–æ–∑–∏—Ü–∏–∏ –í–°–ï–• —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
   ‚Üì
4. Paint (–ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –æ–±–ª–∞—Å—Ç–∏)
   ‚Üì
5. Composite (—Å–∫–ª–µ–∏—Ç—å layers)
```

**–° `transform: translate()` (–ü–†–ê–í–ò–õ–¨–ù–û):**

```
1. JavaScript –∏–∑–º–µ–Ω—è–µ—Ç transform
   ‚Üì
2. Style Recalculation (–±—ã—Å—Ç—Ä–æ)
   ‚Üì
3. Composite ONLY (–Ω–∞ GPU, –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ!)
```

**–†–∞–∑–Ω–∏—Ü–∞ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**

- `left/top`: 16-50ms per frame (–º–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –∫–∞–¥—Ä—ã = jank)
- `transform`: 1-2ms per frame (–ø–ª–∞–≤–Ω–æ, 60fps)

**Layout thrashing –ø—Ä–∏–º–µ—Ä:**

```javascript
// ‚ùå –ü–õ–û–•–û - –≤—ã–∑—ã–≤–∞–µ—Ç 2 reflows!
element.style.left = '100px';  // Reflow #1
element.style.top = '50px';    // Reflow #2

// ‚úÖ –•–û–†–û–®–û - 0 reflows, —Ç–æ–ª—å–∫–æ composite!
element.style.transform = 'translate(100px, 50px)';
```

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms_django_theme/static/js/product-detail.js`

**–ü—Ä–æ–±–ª–µ–º–∞ #1: –ê–Ω–∏–º–∞—Ü–∏—è —Å–º–µ–Ω—ã –≥–ª–∞–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (—Å—Ç—Ä–æ–∫–∏ 96-125)**

```javascript
// ‚ùå –ü–õ–û–•–û - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç left –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
function changeMainImage(newImage) {
  const mainImage = document.querySelector('.product-main-image');
  const wrapper = mainImage.parentElement;
  
  const tempImg = document.createElement('img');
  tempImg.src = newImage;
  tempImg.className = 'product-main-image';
  tempImg.style.position = 'absolute';
  tempImg.style.top = '0';
  tempImg.style.left = '100%';  // ‚ùå Reflow #1
  // ... transitions ...
  
  wrapper.appendChild(tempImg);
  
  requestAnimationFrame(() => {
    mainImage.style.transition = 'left 0.4s ...';  // ‚ùå –ê–Ω–∏–º–∞—Ü–∏—è left
    mainImage.style.position = 'absolute';
    mainImage.style.left = '-100%';  // ‚ùå Reflow #2 (–∫–∞–∂–¥—ã–π –∫–∞–¥—Ä!)
    
    tempImg.style.left = '0';  // ‚ùå Reflow #3 (–∫–∞–∂–¥—ã–π –∫–∞–¥—Ä!)
  });
  
  setTimeout(() => {
    mainImage.style.left = 'auto';  // ‚ùå Reflow #4
    // ...
  }, 400);
}

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç transform
function changeMainImage(newImage) {
  const mainImage = document.querySelector('.product-main-image');
  const wrapper = mainImage.parentElement;
  
  const tempImg = document.createElement('img');
  tempImg.src = newImage;
  tempImg.className = 'product-main-image';
  tempImg.style.position = 'absolute';
  tempImg.style.top = '0';
  tempImg.style.transform = 'translateX(100%)';  // ‚úÖ GPU acceleration
  // ... transitions ...
  
  wrapper.appendChild(tempImg);
  
  requestAnimationFrame(() => {
    mainImage.style.transition = 'transform 0.4s ...';  // ‚úÖ
    mainImage.style.position = 'absolute';
    mainImage.style.transform = 'translateX(-100%)';  // ‚úÖ GPU only!
    
    tempImg.style.transform = 'translateX(0)';  // ‚úÖ GPU only!
  });
  
  setTimeout(() => {
    mainImage.style.position = 'static';
    mainImage.style.transform = 'none';
    // ...
  }, 400);
}
```

**–ü—Ä–æ–±–ª–µ–º–∞ #2: Fly-to-cart –∞–Ω–∏–º–∞—Ü–∏—è (—Å—Ç—Ä–æ–∫–∏ 560-596, 599-630)**

```javascript
// ‚ùå –ü–õ–û–•–û - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç left/top
function flyToCartMobile(image, button) {
  const flyElement = document.createElement('div');
  flyElement.className = 'fly-to-cart';
  // ...
  
  const startRect = image.getBoundingClientRect();
  const cartRect = cartBtn.getBoundingClientRect();
  
  flyElement.style.left = startRect.left + 'px';  // ‚ùå Reflow
  flyElement.style.top = startRect.top + 'px';    // ‚ùå Reflow
  
  requestAnimationFrame(() => {
    flyElement.style.left = cartRect.left + ...;  // ‚ùå Reflow –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä!
    flyElement.style.top = cartRect.top + ...;    // ‚ùå Reflow –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä!
    flyElement.style.transform = 'scale(0.3)';
    flyElement.style.opacity = '0';
  });
  // ...
}

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç transform
function flyToCartMobile(image, button) {
  const flyElement = document.createElement('div');
  flyElement.className = 'fly-to-cart';
  // ...
  
  const startRect = image.getBoundingClientRect();
  const cartRect = cartBtn.getBoundingClientRect();
  
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º left/top —Ç–æ–ª—å–∫–æ –¥–ª—è –ù–ê–ß–ê–õ–¨–ù–û–ô –ø–æ–∑–∏—Ü–∏–∏ (1 —Ä–∞–∑)
  flyElement.style.left = startRect.left + 'px';
  flyElement.style.top = startRect.top + 'px';
  
  const deltaX = cartRect.left - startRect.left;
  const deltaY = cartRect.top - startRect.top;
  
  requestAnimationFrame(() => {
    // ‚úÖ –ê–Ω–∏–º–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ transform (GPU)
    flyElement.style.transform = `translate(${deltaX}px, ${deltaY}px) scale(0.3)`;
    flyElement.style.opacity = '0';
  });
  // ...
}
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**

1. **`.style.left`/`.style.top`** - –ø—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ CSS —Å–≤–æ–π—Å—Ç–≤
2. **`transition`** - CSS –ø–µ—Ä–µ—Ö–æ–¥—ã (–Ω–æ –¥–ª—è wrong properties)
3. **`requestAnimationFrame()`** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è batching
4. **`getBoundingClientRect()`** - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å:**

```
User clicks –Ω–∞ —Ü–≤–µ—Ç–æ–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
  -> changeMainImage() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
  -> –°–æ–∑–¥–∞–µ—Ç—Å—è tempImg
  -> tempImg.style.left = '100%'  
     -> Browser: Layout recalc (reflow) ~10-20ms
  -> requestAnimationFrame()
     -> mainImage.style.left = '-100%'
        -> Browser –ö–ê–ñ–î–´–ô –ö–ê–î–† (60fps):
           1. Style recalc
           2. Layout recalc (–î–û–†–û–ì–û!)
           3. Paint
           4. Composite
        -> ~16-30ms per frame (–µ—Å–ª–∏ –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
     -> tempImg.style.left = '0'
        -> Browser –ö–ê–ñ–î–´–ô –ö–ê–î–†: —Ç–æ –∂–µ —Å–∞–º–æ–µ
  -> –ê–Ω–∏–º–∞—Ü–∏—è 400ms = 24 frames
  -> 24 frames √ó 30ms = 720ms CPU time
  -> –ù–û: 60fps = 16.67ms per frame
  -> –†–µ–∑—É–ª—å—Ç–∞—Ç: Jank, –ø—Ä–æ–ø—É—Å–∫ –∫–∞–¥—Ä–æ–≤, –∞–Ω–∏–º–∞—Ü–∏—è –¥–µ—Ä–≥–∞–µ—Ç—Å—è
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```
User clicks –Ω–∞ —Ü–≤–µ—Ç–æ–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
  -> changeMainImage() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
  -> –°–æ–∑–¥–∞–µ—Ç—Å—è tempImg
  -> tempImg.style.transform = 'translateX(100%)'
     -> Browser: Style recalc ~1ms
  -> requestAnimationFrame()
     -> mainImage.style.transform = 'translateX(-100%)'
        -> Browser –ö–ê–ñ–î–´–ô –ö–ê–î–† (60fps):
           1. Style recalc ~1ms
           2. Composite ONLY (GPU) ~1-2ms
           3. –ò–¢–û–ì–û: ~2-3ms per frame ‚úÖ
     -> tempImg.style.transform = 'translateX(0)'
        -> –¢–æ –∂–µ —Å–∞–º–æ–µ
  -> –ê–Ω–∏–º–∞—Ü–∏—è 400ms = 24 frames
  -> 24 frames √ó 3ms = 72ms CPU time
  -> 60fps ‚úÖ –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è!
```

**Frequency:**

- **changeMainImage():** –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∫–ª–∏–∫–µ –Ω–∞ —Ü–≤–µ—Ç–æ–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
- **flyToCart():** –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É
- **–°—Ä–µ–¥–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** 5-10 –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –∑–∞ —Å–µ–∞–Ω—Å
- **–ò–¢–û–ì–û:** 5-10 jank-–∞–Ω–∏–º–∞—Ü–∏–π = –ø–ª–æ—Ö–æ–π UX

**Layout thrashing measurements:**

–° Chrome DevTools Performance:
- **–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
  - Scripting: 10ms
  - Rendering: 100ms (Layout: 60ms, Paint: 40ms)
  - **–ò–¢–û–ì–û:** 110ms –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏

- **–° transform:**
  - Scripting: 10ms
  - Rendering: 15ms (Composite only)
  - **–ò–¢–û–ì–û:** 25ms –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏

**–£–ª—É—á—à–µ–Ω–∏–µ: 77% –±—ã—Å—Ç—Ä–µ–µ!**

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**FCP (First Contentful Paint):**
- ‚û°Ô∏è **–ù–µ—Ç –ø—Ä—è–º–æ–≥–æ –≤–ª–∏—è–Ω–∏—è**

**LCP (Largest Contentful Paint):**
- ‚û°Ô∏è **–ù–µ—Ç –ø—Ä—è–º–æ–≥–æ –≤–ª–∏—è–Ω–∏—è** (–∞–Ω–∏–º–∞—Ü–∏–∏ –ø–æ—Å–ª–µ LCP)

**TTI (Time to Interactive):**
- ‚û°Ô∏è **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ**

**CLS (Cumulative Layout Shift):**
- ‚¨ÜÔ∏è **–£–ª—É—á—à–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: -0.02-0.05**
- Reflows –º–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å layout shifts
- transform –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ layout = –Ω–µ—Ç shifts

**FID (First Input Delay):**
- ‚¨ÜÔ∏è **–£–ª—É—á—à–µ–Ω–∏–µ: -5-20ms**
- –ú–µ–Ω—å—à–µ main thread blocking = –±—ã—Å—Ç—Ä–µ–µ response

**GPU:**
- ‚¨ÜÔ∏è **–ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ**
- transform –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GPU acceleration
- left/top –∏—Å–ø–æ–ª—å–∑—É—é—Ç CPU

**CPU:**
- ‚¨ÜÔ∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï —É–ª—É—á—à–µ–Ω–∏–µ: -77% –≤–æ –≤—Ä–µ–º—è –∞–Ω–∏–º–∞—Ü–∏–π**
- Reflow = CPU intensive
- Composite = GPU, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π CPU

**–ü–∞–º—è—Ç—å:**
- ‚û°Ô∏è **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ**

**FPS (Frames Per Second):**
- ‚¨ÜÔ∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï —É–ª—É—á—à–µ–Ω–∏–µ: –æ—Ç 30-45fps –¥–æ 60fps**
- left/top: jank, –ø—Ä–æ–ø—É—Å–∫ –∫–∞–¥—Ä–æ–≤
- transform: –ø–ª–∞–≤–Ω–æ, 60fps

**Animation smoothness:**
- ‚¨ÜÔ∏è **–í–∏–∑—É–∞–ª—å–Ω–æ –∑–∞–º–µ—Ç–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –ø–ª–∞–≤–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏
- –ù–µ—Ç "–¥–µ—Ä–≥–∞–Ω—å—è"

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **Visual positioning:**
   - ‚úÖ **–†–∏—Å–∫: –ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ô**
   - `translateX(100%)` = —Ç–æ –∂–µ —á—Ç–æ `left: 100%`
   - `translateY(50px)` = —Ç–æ –∂–µ —á—Ç–æ `top: 50px`
   - –í–∏–∑—É–∞–ª—å–Ω–æ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ

2. **CSS conflicts:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –ï—Å–ª–∏ –≥–¥–µ-—Ç–æ —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `transform` –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ü–µ–ª–µ–π
   - –†–µ—à–µ–Ω–∏–µ: –º–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å transforms:
   ```javascript
   element.style.transform = 'translateX(100px) rotate(45deg) scale(1.2)';
   ```

3. **Browser compatibility:**
   - ‚úÖ **–†–∏—Å–∫: –ù–ï–¢**
   - `transform` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤—Å–µ–º–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏
   - IE10+ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç (—Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `-ms-`)

4. **Calculation complexity:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –ù—É–∂–Ω–æ –≤—ã—á–∏—Å–ª—è—Ç—å delta –¥–ª—è translate
   - –ù–û: —ç—Ç–æ –ø—Ä–æ—Å—Ç–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞, 1 —Ä–∞–∑

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

1. **CSS transitions:**
   - –ù—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å `transition: left 0.4s` –Ω–∞ `transition: transform 0.4s`

2. **CSS classes:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ `.fly-to-cart` –∏ –ø–æ—Ö–æ–∂–∏–µ –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç

3. **JavaScript libraries:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å medium-zoom –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**

1. **Visual regression:**
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é —Å–º–µ–Ω—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å fly-to-cart –Ω–∞ mobile
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å fly-to-cart –Ω–∞ desktop
   - ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ

2. **Performance:**
   - ‚úÖ Chrome DevTools Performance:
     - –ó–∞–ø–∏—Å–∞—Ç—å timeline –î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
     - –ó–∞–ø–∏—Å–∞—Ç—å timeline –ü–û–°–õ–ï
     - –°—Ä–∞–≤–Ω–∏—Ç—å Layout time
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å FPS (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 60fps)
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CPU usage

3. **Browsers:**
   - ‚úÖ Chrome (–¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å)
   - ‚úÖ Firefox (–¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å)
   - ‚úÖ Safari (–¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å)
   - ‚úÖ Mobile browsers

**–†–µ—à–µ–Ω–∏–µ (–∫–æ–¥):**

```javascript
// product-detail.js

// –î–û (—Å—Ç—Ä–æ–∫–∏ 96-125):
function changeMainImage(newImage) {
  // ... —Å–æ–∑–¥–∞–Ω–∏–µ tempImg ...
  tempImg.style.left = '100%';  // ‚ùå
  
  requestAnimationFrame(() => {
    mainImage.style.transition = 'left 0.4s ...';  // ‚ùå
    mainImage.style.left = '-100%';  // ‚ùå
    tempImg.style.left = '0';  // ‚ùå
  });
  
  setTimeout(() => {
    mainImage.style.left = 'auto';  // ‚ùå
    // ...
  }, 400);
}

// –ü–û–°–õ–ï:
function changeMainImage(newImage) {
  // ... —Å–æ–∑–¥–∞–Ω–∏–µ tempImg ...
  tempImg.style.transform = 'translateX(100%)';  // ‚úÖ
  
  requestAnimationFrame(() => {
    mainImage.style.transition = 'transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94)';  // ‚úÖ
    mainImage.style.transform = 'translateX(-100%)';  // ‚úÖ
    tempImg.style.transform = 'translateX(0)';  // ‚úÖ
  });
  
  setTimeout(() => {
    mainImage.style.position = 'static';
    mainImage.style.transform = 'none';  // ‚úÖ
    // ...
  }, 400);
}

// Fly-to-cart –î–û (—Å—Ç—Ä–æ–∫–∏ 560-596):
flyElement.style.left = startRect.left + 'px';  // ‚ùå
flyElement.style.top = startRect.top + 'px';  // ‚ùå

requestAnimationFrame(() => {
  flyElement.style.left = cartRect.left + ...;  // ‚ùå
  flyElement.style.top = cartRect.top + ...;  // ‚ùå
});

// Fly-to-cart –ü–û–°–õ–ï:
flyElement.style.left = startRect.left + 'px';  // ‚úÖ –¢–æ–ª—å–∫–æ –Ω–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
flyElement.style.top = startRect.top + 'px';  // ‚úÖ

const deltaX = cartRect.left + (cartRect.width / 2) - 30 - startRect.left;
const deltaY = cartRect.top + (cartRect.height / 2) - 30 - startRect.top;

requestAnimationFrame(() => {
  flyElement.style.transform = `translate(${deltaX}px, ${deltaY}px) scale(0.3)`;  // ‚úÖ
  flyElement.style.opacity = '0';
});
```

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå **–ù–ï –Ω—É–∂–Ω—ã** - —Ç–æ–ª—å–∫–æ JS –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**

1. **CSS:**
   - ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö `transform` –ø—Ä–∞–≤–∏–ª
   - ‚ö†Ô∏è –û–±–Ω–æ–≤–∏—Ç—å `transition` –≤ CSS –µ—Å–ª–∏ –µ—Å—Ç—å

2. **Other animations:**
   - ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–æ—Ç –∂–µ –ø–æ–¥—Ö–æ–¥ –≤–µ–∑–¥–µ –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è left/top –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π

3. **Third-party libraries:**
   - ‚úÖ medium-zoom –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ MDN –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é, Web.dev, Chrome DevTools documentation –∏ analysis –∫–æ–¥–∞**

**üî¥ –ö–†–ò–¢–ò–ß–ù–û: –ü—Ä–æ–±–ª–µ–º–∞ –ù–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ –∫–æ–¥–µ!** –í `product-detail.js` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `.style.left/top` –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π, —á—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –¥–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–∏–µ reflows. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (MDN, Web.dev, Chrome DevTools):**
  - **CSS Transforms performance documentation (MDN):**
    - **MDN:** `transform` —Å–≤–æ–π—Å—Ç–≤–æ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç layout (reflow), —Ç–æ–ª—å–∫–æ composite. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –Ω–∞–º–Ω–æ–≥–æ –±—ã—Å—Ç—Ä–µ–µ —á–µ–º `left`/`top`/`width`/`height`, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–∑—ã–≤–∞—é—Ç reflow.
    - **Performance:** `transform` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GPU acceleration –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∞–Ω–∏–º–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º compositor layer
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `transform` –∏ `opacity` –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π - –æ–Ω–∏ —è–≤–ª—è—é—Ç—Å—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ CSS —Å–≤–æ–π—Å—Ç–≤–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç reflow
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `.style.left/top` –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π –≤–º–µ—Å—Ç–æ `transform: translate()` ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `.style.left/top` –Ω–∞ `transform: translateX()/translateY()`
  
  - **Reflow vs Repaint vs Composite (Web.dev, Chrome DevTools):**
    - **Reflow (Layout):** –î–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è - –±—Ä–∞—É–∑–µ—Ä –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –í–°–ï–• —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `left`, `top`, `width`, `height`, `margin`, `padding`, –∏ –¥—Ä.
    - **Repaint (Paint):** –°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å - –±—Ä–∞—É–∑–µ—Ä –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –æ–±–ª–∞—Å—Ç–∏. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ü–≤–µ—Ç–æ–≤, —Ñ–æ–Ω–æ–≤, —Ç–µ–Ω–µ–π.
    - **Composite:** –ë—ã—Å—Ç—Ä–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è - –±—Ä–∞—É–∑–µ—Ä —Ç–æ–ª—å–∫–æ —Å–∫–ª–µ–∏–≤–∞–µ—Ç —É–∂–µ –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ–∏. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `transform`, `opacity`, `filter` (–Ω–æ –Ω–µ `backdrop-filter`).
    - **Performance cost:** Reflow = 10-100ms, Repaint = 5-20ms, Composite = 1-2ms
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `.style.left/top` –≤—ã–∑—ã–≤–∞–µ—Ç reflow –Ω–∞ –∫–∞–∂–¥–æ–º –∫–∞–¥—Ä–µ –∞–Ω–∏–º–∞—Ü–∏–∏ ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `transform` –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π - —Ç–æ–ª—å–∫–æ composite, 0 reflows
  
  - **GPU acceleration best practices (Web.dev):**
    - **GPU acceleration:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º —Å `transform` –∏–ª–∏ `opacity`. –ë—Ä–∞—É–∑–µ—Ä —Å–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π compositor layer –¥–ª—è —ç—Ç–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
    - **will-change:** –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `will-change: transform` –¥–ª—è –ø–æ–¥—Å–∫–∞–∑–∫–∏ –±—Ä–∞—É–∑–µ—Ä—É, –Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ - `transform` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GPU
    - **Layer creation:** –≠–ª–µ–º–µ–Ω—Ç—ã —Å `transform` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ GPU-—É—Å–∫–æ—Ä–µ–Ω–Ω—ã–π —Å–ª–æ–π, –Ω–æ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ layers –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–∞–º—è—Ç—å—é
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `transform` –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π –ø–æ–∑–∏—Ü–∏–∏, `opacity` –¥–ª—è fade —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `left/top` –≤–º–µ—Å—Ç–æ `transform`, GPU acceleration –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `transform` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ GPU acceleration
  
  - **Browser rendering pipeline (Chrome DevTools):**
    - **Rendering pipeline:**
      1. **JavaScript** ‚Üí –∏–∑–º–µ–Ω—è–µ—Ç DOM/CSS
      2. **Style Recalculation** ‚Üí –≤—ã—á–∏—Å–ª—è–µ—Ç computed styles (~1ms)
      3. **Layout (Reflow)** ‚Üí –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ, ~10-100ms)
      4. **Paint** ‚Üí —Ä–∏—Å—É–µ—Ç –ø–∏–∫—Å–µ–ª–∏ (~5-20ms)
      5. **Composite** ‚Üí —Å–∫–ª–µ–∏–≤–∞–µ—Ç —Å–ª–æ–∏ (~1-2ms)
    - **–° left/top:** –í—Å–µ 5 —ç—Ç–∞–ø–æ–≤ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–º –∫–∞–¥—Ä–µ (–µ—Å–ª–∏ layout –∏–∑–º–µ–Ω—è–µ—Ç—Å—è)
    - **–° transform:** –¢–æ–ª—å–∫–æ —ç—Ç–∞–ø—ã 2 –∏ 5 (Style Recalculation + Composite), layout –∏ paint –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `.style.left/top` –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ 5 —ç—Ç–∞–ø–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–º –∫–∞–¥—Ä–µ ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `transform` –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞ —ç—Ç–∞–ø–æ–≤ layout –∏ paint

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ performance benchmarks:**
  - **Performance benchmarks (Web.dev, Chrome DevTools):**
    - **left/top animation:** 16-50ms per frame –ø—Ä–∏ –∞–Ω–∏–º–∞—Ü–∏–∏, –≤—ã–∑—ã–≤–∞–µ—Ç layout thrashing, FPS –ø–∞–¥–∞–µ—Ç –¥–æ 30-40 –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
    - **transform animation:** 1-2ms per frame, —Ç–æ–ª—å–∫–æ composite, —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ 60fps –¥–∞–∂–µ –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
    - **Mobile performance:** –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö —Ä–∞–∑–Ω–∏—Ü–∞ –µ—â–µ –±–æ–ª—å—à–µ - `left/top` –º–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å 10-20fps, `transform` - —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ 60fps
    - **–í –∫–æ–¥–µ:** –ê–Ω–∏–º–∞—Ü–∏–∏ —Å `left/top` –≤—ã–∑—ã–≤–∞—é—Ç jank, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ö—Ä–∏—Ç–∏—á–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `transform` –¥–ª—è –ø–ª–∞–≤–Ω—ã—Ö –∞–Ω–∏–º–∞—Ü–∏–π
  
  - **Real-world performance impact:**
    - **Apple.com:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ–ª—å–∫–æ `transform` –¥–ª—è –≤—Å–µ—Ö –∞–Ω–∏–º–∞—Ü–∏–π, –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `left/top` –¥–ª—è –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    - **Google Material Design:** –†–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `transform` –¥–ª—è –≤—Å–µ—Ö –∞–Ω–∏–º–∞—Ü–∏–π –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è
    - **Airbnb:** –ü–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã `left/top` –Ω–∞ `transform` –≤ –∞–Ω–∏–º–∞—Ü–∏—è—Ö –ø–æ–ª—É—á–∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏–µ FPS –Ω–∞ 30-40%
    - **–í—ã–≤–æ–¥:** `transform` - —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∏–Ω–¥—É—Å—Ç—Ä–∏–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **CSS animation performance best practices:**
    - ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `transform` –∏ `opacity` –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π - –æ–Ω–∏ –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç reflow
    - ‚úÖ –ò–∑–±–µ–≥–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ `left`, `top`, `width`, `height`, `margin`, `padding` - –≤—ã–∑—ã–≤–∞—é—Ç reflow
    - ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `will-change: transform` –¥–ª—è –ø–æ–¥—Å–∫–∞–∑–∫–∏ –±—Ä–∞—É–∑–µ—Ä—É (–Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    - ‚úÖ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤ –≤ –æ–¥–∏–Ω `requestAnimationFrame()` –¥–ª—è –±–∞—Ç—á–∏–Ω–≥–∞
    - ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `left/top` –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π –ø–æ–∑–∏—Ü–∏–∏
  
  - **Browser compatibility:**
    - **transform:** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤—Å–µ–º–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏ (Chrome 36+, Firefox 16+, Safari 9+, Edge 12+)
    - **IE10+:** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `-ms-transform`, –Ω–æ IE10 –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
    - **Mobile browsers:** –í—Å–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç `transform`, —á–∞—Å—Ç–æ –ª—É—á—à–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —á–µ–º desktop
    - **–í –∫–æ–¥–µ:** –ú–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `transform` –≤–µ–∑–¥–µ ‚úÖ

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í product-detail.js:**
    - –°—Ç—Ä–æ–∫–∏ 100, 113, 115, 123: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `.style.left` –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–º–µ–Ω—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è ‚ùå
    - –°—Ç—Ä–æ–∫–∏ 573, 577, 615, 619: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `.style.left/top` –¥–ª—è fly-to-cart –∞–Ω–∏–º–∞—Ü–∏–∏ ‚ùå
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `requestAnimationFrame()` –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ (–Ω–æ –¥–ª—è wrong properties)
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `transition` –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ (–Ω–æ –¥–ª—è wrong properties)
  
  - **–ü—Ä–æ–±–ª–µ–º—ã:**
    - –ê–Ω–∏–º–∞—Ü–∏–∏ –≤—ã–∑—ã–≤–∞—é—Ç reflow –Ω–∞ –∫–∞–∂–¥–æ–º –∫–∞–¥—Ä–µ, —á—Ç–æ –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ ‚ùå
    - –û—Å–æ–±–µ–Ω–Ω–æ –∑–∞–º–µ—Ç–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö - jank, –ø—Ä–æ–ø—É—Å–∫ –∫–∞–¥—Ä–æ–≤ ‚ùå
    - –ê–Ω–∏–º–∞—Ü–∏–∏ –º–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å layout shifts (CLS) ‚ùå
  
  - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
    - –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `.style.left` –Ω–∞ `transform: translateX()`
    - –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `.style.top` –Ω–∞ `transform: translateY()`
    - –û–±–Ω–æ–≤–∏—Ç—å CSS transitions —Å `left/top` –Ω–∞ `transform`
    - –î–ª—è fly-to-cart: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `left/top` —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏, –∞–Ω–∏–º–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ `transform`

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û - –≤—ã—Å–æ–∫–∏–π impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–π, –æ—Å–æ–±–µ–Ω–Ω–æ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
  - **Implementation strategy:**
    1. **–§–∞–∑–∞ 1 - –ê–Ω–∏–º–∞—Ü–∏—è —Å–º–µ–Ω—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (changeMainImage):**
       - –ó–∞–º–µ–Ω–∏—Ç—å `tempImg.style.left = '100%'` –Ω–∞ `tempImg.style.transform = 'translateX(100%)'`
       - –ó–∞–º–µ–Ω–∏—Ç—å `mainImage.style.left = '-100%'` –Ω–∞ `mainImage.style.transform = 'translateX(-100%)'`
       - –ó–∞–º–µ–Ω–∏—Ç—å `tempImg.style.left = '0'` –Ω–∞ `tempImg.style.transform = 'translateX(0)'`
       - –û–±–Ω–æ–≤–∏—Ç—å transition: `'left 0.4s'` ‚Üí `'transform 0.4s'`
    
    2. **–§–∞–∑–∞ 2 - Fly-to-cart –∞–Ω–∏–º–∞—Ü–∏—è (flyToCartMobile/Desktop):**
       - –û—Å—Ç–∞–≤–∏—Ç—å `left/top` –¥–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ (–æ–¥–∏–Ω —Ä–∞–∑, –Ω–µ –∞–Ω–∏–º–∏—Ä—É–µ—Ç—Å—è)
       - –í—ã—á–∏—Å–ª–∏—Ç—å delta: `deltaX = cartRect.left - startRect.left`, `deltaY = cartRect.top - startRect.top`
       - –ê–Ω–∏–º–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ `transform: translate(${deltaX}px, ${deltaY}px) scale(0.3)`
       - –î–æ–±–∞–≤–∏—Ç—å transition: `'transform 0.6s cubic-bezier(...), opacity 0.6s'`
    
    3. **–§–∞–∑–∞ 3 - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
       - Chrome DevTools Performance: –∏–∑–º–µ—Ä–∏—Ç—å Layout time –¥–æ/–ø–æ—Å–ª–µ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å FPS (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 60fps)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
  
  - **–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
    
    **1. changeMainImage() (—Å—Ç—Ä–æ–∫–∏ 96-125):**
    ```javascript
    // –ë–´–õ–û:
    tempImg.style.left = '100%';
    mainImage.style.transition = 'left 0.4s ...';
    mainImage.style.left = '-100%';
    tempImg.style.left = '0';
    mainImage.style.left = 'auto';
    
    // –°–¢–ê–õ–û:
    tempImg.style.transform = 'translateX(100%)';
    mainImage.style.transition = 'transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
    mainImage.style.transform = 'translateX(-100%)';
    tempImg.style.transform = 'translateX(0)';
    mainImage.style.transform = 'none';
    ```
    
    **2. flyToCartMobile() (—Å—Ç—Ä–æ–∫–∏ 560-596):**
    ```javascript
    // –ë–´–õ–û:
    flyElement.style.left = startRect.left + 'px';
    flyElement.style.top = startRect.top + 'px';
    requestAnimationFrame(() => {
      flyElement.style.left = cartRect.left + (cartRect.width / 2) - 30 + 'px';
      flyElement.style.top = cartRect.top + (cartRect.height / 2) - 30 + 'px';
      flyElement.style.transform = 'scale(0.3)';
    });
    
    // –°–¢–ê–õ–û:
    // –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è (–æ–¥–∏–Ω —Ä–∞–∑, –Ω–µ –∞–Ω–∏–º–∏—Ä—É–µ—Ç—Å—è)
    flyElement.style.left = startRect.left + 'px';
    flyElement.style.top = startRect.top + 'px';
    flyElement.style.transition = 'transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.6s';
    
    const deltaX = (cartRect.left + cartRect.width / 2 - 30) - startRect.left;
    const deltaY = (cartRect.top + cartRect.height / 2 - 30) - startRect.top;
    
    requestAnimationFrame(() => {
      // –ê–Ω–∏–º–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ transform (GPU)
      flyElement.style.transform = `translate(${deltaX}px, ${deltaY}px) scale(0.3)`;
      flyElement.style.opacity = '0';
    });
    ```
    
    **3. flyToCartDesktop() (—Å—Ç—Ä–æ–∫–∏ 599-630):**
    ```javascript
    // –¢–æ–∂–µ —Å–∞–º–æ–µ —á—Ç–æ flyToCartMobile(), –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–µ –∂–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
    ```
  
  - **Testing checklist:**
    1. ‚úÖ **Performance tests:**
       - Chrome DevTools Performance: –∑–∞–ø–∏—Å–∞—Ç—å timeline –¥–æ/–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
       - –°—Ä–∞–≤–Ω–∏—Ç—å Layout time (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 0ms –∏–ª–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å FPS (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ 60fps)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CPU usage –≤–æ –≤—Ä–µ–º—è –∞–Ω–∏–º–∞—Ü–∏–∏ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ)
    
    2. ‚úÖ **Visual regression tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é —Å–º–µ–Ω—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π - –¥–æ–ª–∂–Ω–∞ –≤—ã–≥–ª—è–¥–µ—Ç—å –∏–¥–µ–Ω—Ç–∏—á–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å fly-to-cart –Ω–∞ mobile - –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–∞–≤–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å fly-to-cart –Ω–∞ desktop - –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–∞–≤–Ω–æ
       - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ
    
    3. ‚úÖ **Browser compatibility:**
       - Chrome - –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å —Å GPU acceleration
       - Firefox - –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å —Å GPU acceleration
       - Safari - –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å —Å GPU acceleration
       - Mobile Chrome - –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–∞–≤–Ω–æ
       - Mobile Safari - –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–∞–≤–Ω–æ
    
    4. ‚úÖ **User testing:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö (–æ—Å–æ–±–µ–Ω–Ω–æ —Å–ª–∞–±—ã–µ)
       - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–ª–∞–≤–Ω—ã–µ, –Ω–µ—Ç jank
       - –°–æ–±—Ä–∞—Ç—å feedback –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

---

## –ü–†–û–ë–õ–ï–ú–ê #10: N+1 –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ü–≤–µ—Ç–æ–≤ (build_color_preview_map)

### üî¥ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö–†–ò–¢–ò–ß–ù–û

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–§—É–Ω–∫—Ü–∏—è `build_color_preview_map` (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ –≥–ª–∞–≤–Ω–æ–π, –≤ –∫–∞—Ç–∞–ª–æ–≥–µ, –∫–∞—Ä—Ç–æ—á–∫–∞—Ö —Ç–æ–≤–∞—Ä–∞) –≤—ã–∑—ã–≤–∞–µ—Ç **–¥–≤–∞ N+1 —Ü–∏–∫–ª–∞**:

1. **–í–Ω—É—Ç—Ä–∏ —Ü–∏–∫–ª–∞ –ø–æ color variants** –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è `variant.images.all()` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ ‚Üí **N –∑–∞–ø—Ä–æ—Å–æ–≤**
2. **–§—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑** (–Ω–∞ –≥–ª–∞–≤–Ω–æ–π + –≤ –∫–∞—Ç–∞–ª–æ–≥–µ + –≤ AJAX) ‚Üí –º–∞—Å—à—Ç–∞–± –ø—Ä–æ–±–ª–µ–º—ã —Ä–∞—Å—Ç—ë—Ç

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ö–∞—Ç–∞–ª–æ–≥ —Å 20 —Ç–æ–≤–∞—Ä–∞–º–∏ √ó 5 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ = 100 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ì–ª–∞–≤–Ω–∞—è (featured + products) = 20-40 —Ç–æ–≤–∞—Ä–æ–≤ = 100-200 –∑–∞–ø—Ä–æ—Å–æ–≤
- AJAX `load_more_products` = 100 –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ò—Ç–æ–≥–æ:** –ö–∞–∂–¥–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ –¥–µ–ª–∞–µ—Ç +100-200 –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î!

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/storefront/services/catalog_helpers.py`

```python
# –°—Ç—Ä–æ–∫–∏ 70-75
preview_map: Dict[int, List[Dict[str, Any]]] = defaultdict(list)
for variant in queryset:
    color = getattr(variant, 'color', None)
    images = list(getattr(variant, 'images', []).all() if hasattr(variant, 'images') else [])  # ‚ùå N+1!!!!!!
    first_image = images[0].image.url if images else ''
    preview_map[variant.product_id].append({
        'id': variant.id,
        'primary_hex': getattr(color, 'primary_hex', '') or '',
        'secondary_hex': getattr(color, 'secondary_hex', '') or '',
        'first_image_url': first_image,
        'is_default': bool(getattr(variant, 'is_default', False)),
    })
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `getattr(variant, 'images', []).all()` –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç prefetch cache!
- –î–∞–∂–µ –µ—Å–ª–∏ `prefetch_related('images')` –±—ã–ª –≤—ã–∑–≤–∞–Ω, `.all()` –≤—ã–∑—ã–≤–∞–µ—Ç SQL –∑–∞–ø—Ä–æ—Å
- `list()` –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å

**–ö–∞–∫ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**

```python
# –ò—Å–ø–æ–ª—å–∑—É–µ–º _prefetched_objects_cache
images = getattr(variant, '_prefetched_objects_cache', {}).get('images')
if images is None:
    images = list(variant.images.all())  # Fallback (–æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å)
else:
    images = list(images)  # –£–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ, –Ω–µ—Ç SQL
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**

1. `_load_product_color_variant_queryset` –∑–∞–≥—Ä—É–∂–∞–µ—Ç variants —Å `prefetch_related('images')`
2. `build_color_preview_map` –ø–æ–ª—É—á–µ—Ç queryset
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ `variant` –¥–µ–ª–∞–µ—Ç `.images.all()` –∑–∞–Ω–æ–≤–æ

**–ü–æ—á–µ–º—É prefetch –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

```
variant._prefetched_objects_cache = {
    'images': [Image(...), Image(...), ...]
}

# –ù–û: getattr(variant, 'images', []).all()
#   -> variant.images === RelatedManager
#   -> .all() -> SQL query, –∏–≥–Ω–æ—Ä–∏—Ä—É—è cache
```

**–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å prefetch cache:**

```
images = getattr(variant, '_prefetched_objects_cache', {}).get('images', None)
if images is None:
    images = variant.images.all()  # –æ–¥–∏–Ω SQL –∑–∞–ø—Ä–æ—Å
else:
    images = list(images)
```

**–ú–∞—Å—à—Ç–∞–± –ø—Ä–æ–±–ª–µ–º—ã:**

- –ö–∞—Ç–∞–ª–æ–≥: 20 —Ç–æ–≤–∞—Ä–æ–≤ √ó 5 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ = 100 SQL queries
- –ì–ª–∞–≤–Ω–∞—è: 10 —Ç–æ–≤–∞—Ä–æ–≤ √ó 5 = 50 SQL queries
- AJAX load more: 20 —Ç–æ–≤–∞—Ä–æ–≤ = 100 SQL queries
- **Total per user session:** ~250 –ª–∏—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**SQL –ø—Ä–∏–º–µ—Ä:**
```sql
SELECT * FROM productcolors_productcolorvariant WHERE product_id IN (...)
-- (prefetched)

-- –ù–æ –∑–∞—Ç–µ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ variant:
SELECT * FROM productcolors_productcolorvariant_images WHERE productcolorvariant_id = X  -- 100 —Ä–∞–∑!
```

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**FCP:**
- ‚û°Ô∏è –ù–µ—Ç –ø—Ä—è–º–æ–≥–æ –≤–ª–∏—è–Ω–∏—è

**LCP:**
- ‚¨áÔ∏è –£—Ö—É–¥—à–µ–Ω–∏–µ: +50-150ms (–Ω–∞ –∫–∞—Ç–∞–ª–æ–≥–µ)

**TTI:**
- ‚¨áÔ∏è –£—Ö—É–¥—à–µ–Ω–∏–µ: +80-200ms (GL –Ω–∞ mobile devices)

**CPU:**
- ‚û°Ô∏è –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ (ORM overhead)

**–ë–î:**
- ‚¨ÜÔ∏è **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —É—Ö—É–¥—à–µ–Ω–∏–µ:** +100-250 SQL –∑–∞–ø—Ä–æ—Å–æ–≤

**Bandwith (DB server):**
- ‚¨ÜÔ∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ SQL —Ç—Ä–∞—Ñ–∏–∫

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **Prefetch cache –¥–æ—Å—Ç—É–ø:**
   - Resolves via `_prefetched_objects_cache`
   - Need to handle fallback if not prefetched

2. **Django version:**
   - Works on Django 5 (supported)

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå –Ω–µ –Ω—É–∂–Ω—ã

**–¢–µ—Å—Ç—ã:**
- ‚úÖ `assertNumQueries` –¥–ª—è build_color_preview_map
- ‚úÖ Integration test: catalog page queries reduced ~100 ‚Üí 3

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ Context7, Django –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ –∏ best practices**

**üî¥ –ö–†–ò–¢–ò–ß–ù–û: –ü—Ä–æ–±–ª–µ–º–∞ –ù–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ –∫–æ–¥–µ!** –í `build_color_preview_map` (—Å—Ç—Ä–æ–∫–∞ 73) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `variant.images.all()`, —á—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç N+1 –∑–∞–ø—Ä–æ—Å—ã, –∏–≥–Ω–æ—Ä–∏—Ä—É—è prefetch cache. –ù–æ –≤ `get_detailed_color_variants` (—Å—Ç—Ä–æ–∫–∏ 104-107) —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —á–µ—Ä–µ–∑ `_prefetched_objects_cache`.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Django (Context7):**
  - **Django prefetch_related internals –∏ `_prefetched_objects_cache`:**
    - **Django –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `prefetch_related()` –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ `_prefetched_objects_cache` –Ω–∞ –∫–∞–∂–¥–æ–º —ç–∫–∑–µ–º–ø–ª—è—Ä–µ –º–æ–¥–µ–ª–∏
    - **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:** `prefetch_related('images')` –≤—ã–ø–æ–ª–Ω—è–µ—Ç:
      1. –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ variants
      2. –û–¥–∏–Ω –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –í–°–ï–• images –≤—Å–µ—Ö variants
      3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç images –≤ `variant._prefetched_objects_cache['images']`
    - **–ü—Ä–æ–±–ª–µ–º–∞:** –í—ã–∑–æ–≤ `.all()` –Ω–∞ RelatedManager (–Ω–∞–ø—Ä–∏–º–µ—Ä, `variant.images.all()`) –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç prefetch cache –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –Ω–æ–≤—ã–π SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ variant
    - **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `_prefetched_objects_cache` –Ω–∞–ø—Ä—è–º—É—é –≤–º–µ—Å—Ç–æ `.all()`
    - **–í –∫–æ–¥–µ:** `build_color_preview_map` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `variant.images.all()` ‚ùå, –Ω–æ `get_detailed_color_variants` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `_prefetched_objects_cache` ‚úÖ
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–æ—Ç –∂–µ –ø–æ–¥—Ö–æ–¥ –∏–∑ `get_detailed_color_variants` –≤ `build_color_preview_map`
  
  - **Best practices for iterating prefetched relations (Django documentation):**
    - **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `_prefetched_objects_cache` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ prefetched –æ–±—ä–µ–∫—Ç–∞–º:
      ```python
      images = getattr(variant, '_prefetched_objects_cache', {}).get('images', [])
      if not images:
          # Fallback –µ—Å–ª–∏ prefetch –Ω–µ –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω
          images = list(variant.images.all())
      ```
    - **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±:** –í—ã–∑—ã–≤–∞—Ç—å `.all()` –Ω–∞ RelatedManager - —ç—Ç–æ –≤—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –Ω–æ–≤—ã–π SQL –∑–∞–ø—Ä–æ—Å
    - **Django –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `prefetch_related()` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç `_prefetched_objects_cache`, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
    - **–í –∫–æ–¥–µ:** `get_detailed_color_variants` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω (—Å—Ç—Ä–æ–∫–∏ 104-107) ‚úÖ, –Ω–æ `build_color_preview_map` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (—Å—Ç—Ä–æ–∫–∞ 73) ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –≤–µ–∑–¥–µ
  
  - **RelatedManager –∏ prefetch cache (Django internals):**
    - **RelatedManager:** `variant.images` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç RelatedManager, –∫–æ—Ç–æ—Ä—ã–π –≤—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç SQL –∑–∞–ø—Ä–æ—Å –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `.all()`, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–±—ä–µ–∫—Ç—ã –±—ã–ª–∏ prefetched
    - **–ü–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:** RelatedManager –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `_prefetched_objects_cache` –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∑–∞–ø—Ä–æ—Å–∞
    - **–†–µ—à–µ–Ω–∏–µ:** –î–æ—Å—Ç—É–ø –∫ prefetched –æ–±—ä–µ–∫—Ç–∞–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ `_prefetched_objects_cache`
    - **–í –∫–æ–¥–µ:** `build_color_preview_map` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `variant.images.all()` —á—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç prefetch ‚ùå

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ Django optimization best practices:**
  - **Django optimization patterns:**
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 1:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `prefetch_related()` –≤ queryset –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 2:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `_prefetched_objects_cache` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ prefetched –æ–±—ä–µ–∫—Ç–∞–º –≤ —Ü–∏–∫–ª–µ
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 3:** –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å `_prefetched_objects_cache` –ø–µ—Ä–µ–¥ fallback –Ω–∞ `.all()`
    - **–í –∫–æ–¥–µ:** `_load_product_color_variant_queryset` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `prefetch_related('images')` ‚úÖ, –Ω–æ `build_color_preview_map` –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚ùå
  
  - **Performance impact:**
    - **–ë–µ–∑ prefetch:** 100 variants √ó 1 query = 100 SQL –∑–∞–ø—Ä–æ—Å–æ–≤ ‚ùå
    - **–° prefetch –Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:** 1 main query + 1 prefetch query + 100 queries (`.all()`) = 102 queries ‚ùå
    - **–° prefetch –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:** 1 main query + 1 prefetch query = 2 queries ‚úÖ
    - **–£–ª—É—á—à–µ–Ω–∏–µ:** 50x –º–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **Django N+1 query prevention:**
    - **–ü—Ä–æ–±–ª–µ–º–∞:** N+1 queries - –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ Django
    - **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `select_related()` –∏ `prefetch_related()` + –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ prefetched –æ–±—ä–µ–∫—Ç–∞–º
    - **–í –∫–æ–¥–µ:** –ï—Å—Ç—å `prefetch_related('images')` –Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ ‚ùå
  
  - **Real-world examples:**
    - **Django Debug Toolbar:** –û—Ç–ª–∏—á–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è N+1 queries
    - **assertNumQueries:** Django —Ç–µ—Å—Ç–æ–≤—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
    - **–í –∫–æ–¥–µ:** –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã —Å `assertNumQueries` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í catalog_helpers.py:**
    - `_load_product_color_variant_queryset` (—Å—Ç—Ä–æ–∫–∞ 49) –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `prefetch_related('images')` ‚úÖ
    - `build_color_preview_map` (—Å—Ç—Ä–æ–∫–∞ 73) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `variant.images.all()` —á—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç prefetch ‚ùå
    - `get_detailed_color_variants` (—Å—Ç—Ä–æ–∫–∏ 104-107) –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `_prefetched_objects_cache` ‚úÖ
  
  - **–ü—Ä–æ–±–ª–µ–º–∞:**
    - `build_color_preview_map` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ `home()`, `catalog()`, `load_more_products()` - –≤–µ–∑–¥–µ –≤—ã–∑—ã–≤–∞–µ—Ç N+1 ‚ùå
    - –ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ –¥–æ–±–∞–≤–ª—è–µ—Ç 100-200 SQL –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î ‚ùå
    - –û—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∏ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ ‚ùå
  
  - **–†–µ—à–µ–Ω–∏–µ —É–∂–µ –µ—Å—Ç—å:**
    - `get_detailed_color_variants` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω (—Å—Ç—Ä–æ–∫–∏ 104-107) ‚úÖ
    - –ù—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–æ—Ç –∂–µ –ø–æ–¥—Ö–æ–¥ –≤ `build_color_preview_map`

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û - –≤—ã—Å–æ–∫–∏–π impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ë–î, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –∫–∞—Ç–∞–ª–æ–≥–µ –∏ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
  - **Implementation strategy:**
    1. **–§–∞–∑–∞ 1 - –ò—Å–ø—Ä–∞–≤–∏—Ç—å build_color_preview_map:**
       - –ó–∞–º–µ–Ω–∏—Ç—å `variant.images.all()` –Ω–∞ –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ `_prefetched_objects_cache`
       - –î–æ–±–∞–≤–∏—Ç—å fallback –Ω–∞ `.all()` –µ—Å–ª–∏ prefetch –Ω–µ –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω
       - –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–æ—Ç –∂–µ –ø–∞—Ç—Ç–µ—Ä–Ω —á—Ç–æ –≤ `get_detailed_color_variants`
    
    2. **–§–∞–∑–∞ 2 - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
       - –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã —Å `assertNumQueries` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ —É–º–µ–Ω—å—à–∏–ª–æ—Å—å —Å ~100 –¥–æ ~2
       - Integration tests –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
    
    3. **–§–∞–∑–∞ 3 - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
       - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Django Debug Toolbar –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å performance metrics –¥–æ/–ø–æ—Å–ª–µ
  
  - **–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
    
    **build_color_preview_map() (—Å—Ç—Ä–æ–∫–∞ 73):**
    ```python
    # –ë–´–õ–û (—Å—Ç—Ä–æ–∫–∞ 73):
    images = list(getattr(variant, 'images', []).all() if hasattr(variant, 'images') else [])
    
    # –°–¢–ê–õ–û (–ø—Ä–∏–º–µ–Ω–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω –∏–∑ get_detailed_color_variants):
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º prefetch cache –Ω–∞–ø—Ä—è–º—É—é
    images = getattr(variant, '_prefetched_objects_cache', {}).get('images', [])
    if not images:
        # Fallback –µ—Å–ª–∏ prefetch –Ω–µ –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω
        images = list(variant.images.all()) if hasattr(variant, 'images') else []
    else:
        # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ list –µ—Å–ª–∏ —ç—Ç–æ QuerySet
        images = list(images)
    
    first_image = images[0].image.url if images else ''
    ```
  
  - **Testing checklist:**
    1. ‚úÖ **Unit tests:**
       - –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç —Å `assertNumQueries` –¥–ª—è `build_color_preview_map`
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ —É–º–µ–Ω—å—à–∏–ª–æ—Å—å —Å ~100 –¥–æ ~2
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å fallback –ø–æ–≤–µ–¥–µ–Ω–∏–µ –µ—Å–ª–∏ prefetch –Ω–µ –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω
    
    2. ‚úÖ **Integration tests:**
       - –¢–µ—Å—Ç –¥–ª—è `home()` view - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
       - –¢–µ—Å—Ç –¥–ª—è `catalog()` view - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
       - –¢–µ—Å—Ç –¥–ª—è `load_more_products()` view - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã
    
    3. ‚úÖ **Performance tests:**
       - Django Debug Toolbar: —Å—Ä–∞–≤–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–æ/–ø–æ—Å–ª–µ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å response time –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞ (–¥–æ–ª–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å—Å—è –Ω–∞ 50-150ms)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –ë–î (–¥–æ–ª–∂–Ω–∞ —É–º–µ–Ω—å—à–∏—Ç—å—Å—è –Ω–∞ 95%+)
    
    4. ‚úÖ **Regression tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ü–≤–µ—Ç–æ–≤—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## –ü–†–û–ë–õ–ï–ú–ê #11: filter: drop-shadow –≤ –∞–Ω–∏–º–∞—Ü–∏—è—Ö (GPU overload)

### üî¥ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö–†–ò–¢–ò–ß–ù–û

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

CSS `filter: drop-shadow` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∞–Ω–∏–º–∏—Ä—É—é—Ç—Å—è (hover, transitions, fly-to-cart). **Drop-shadow - –¥–æ—Ä–æ–≥–æ–π GPU —ç—Ñ—Ñ–µ–∫—Ç** (–∫–∞–∫ blur), –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –∞–Ω–∏–º–∞—Ü–∏–∏, –≤—ã–∑—ã–≤–∞–µ—Ç FPS drop.

**–ú–µ—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (—Ñ–∞–π–ª `styles.css`):**

- `.fly-to-cart` (hover/animation)
- `.glow-button:hover`
- `.product-card:hover`
- `.filter-blur` with `drop-shadow`

**–ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ:**

- Drop-shadow = –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ –≤—Å–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ + —Ä–∞–∑–º—ã—Ç–∏–µ
- –ê–Ω–∏–º–∞—Ü–∏—è (scale/translate) + drop-shadow = –¥–≤–æ–π–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ GPU
- Mobile GPUs (Mali, Adreno) struggle -> FPS drops to 20-30

**–ù—É–∂–Ω–æ:**
- –£–¥–∞–ª–∏—Ç—å filter: drop-shadow –≤ –∞–Ω–∏–º–∞—Ü–∏—è—Ö
- –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ box-shadow (–º–µ–Ω–µ–µ —Ç—è–∂—ë–ª—ã–π)
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å pseudo-element —Å background

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **FPS drop:** 60 ‚Üí 25 (Mobile)
- **Battery drain:** GPU usage 80-90%

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ MDN –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é, Web.dev, Chrome DevTools documentation –∏ –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞**

**üî¥ –ö–†–ò–¢–ò–ß–ù–û: –ü—Ä–æ–±–ª–µ–º–∞ –ù–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ –∫–æ–¥–µ!** –í CSS —Ñ–∞–π–ª–∞—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `filter: drop-shadow` –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–∞—Ö –∫–æ—Ç–æ—Ä—ã–µ –∞–Ω–∏–º–∏—Ä—É—é—Ç—Å—è (hover, transitions, fly-to-cart). –≠—Ç–æ GPU-intensive –æ–ø–µ—Ä–∞—Ü–∏—è, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –∞–Ω–∏–º–∞—Ü–∏—è—Ö, –≤—ã–∑—ã–≤–∞–µ—Ç FPS drop.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (MDN, Web.dev):**
  - **CSS filter: drop-shadow performance documentation (MDN):**
    - **MDN:** `filter: drop-shadow` - —ç—Ç–æ GPU-intensive –æ–ø–µ—Ä–∞—Ü–∏—è, –ø–æ—Ö–æ–∂–∞—è –Ω–∞ `backdrop-filter: blur()`. –¢—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ –Ω–∞ –∫–∞–∂–¥–æ–º –∫–∞–¥—Ä–µ –∞–Ω–∏–º–∞—Ü–∏–∏
    - **Performance:** `filter: drop-shadow` –≤ –∞–Ω–∏–º–∞—Ü–∏—è—Ö –≤—ã–∑—ã–≤–∞–µ—Ç:
      1. Paint (–ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞) - 5-20ms
      2. Filter application (–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞) - 10-30ms
      3. Composite - 1-2ms
      –ò—Ç–æ–≥–æ: 16-52ms per frame (–±–æ–ª—å—à–µ —á–µ–º –±—é–¥–∂–µ—Ç 16.67ms –¥–ª—è 60fps)
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `box-shadow` –≤–º–µ—Å—Ç–æ `filter: drop-shadow` –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤, –∏–ª–∏ –≤–æ–æ–±—â–µ –∏–∑–±–µ–≥–∞—Ç—å –≤ –∞–Ω–∏–º–∞—Ü–∏—è—Ö
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `filter: drop-shadow` –≤ `.fly-to-cart`, `.glow-button:hover`, `.product-card:hover` - –≤—Å–µ –∞–Ω–∏–º–∏—Ä—É—é—Ç—Å—è ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `box-shadow` –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å –∏–∑ –∞–Ω–∏–º–∞—Ü–∏–π
  
  - **filter vs box-shadow performance (Web.dev):**
    - **filter: drop-shadow:** GPU-intensive, —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫—É + —Ñ–∏–ª—å—Ç—Ä –Ω–∞ –∫–∞–∂–¥–æ–º –∫–∞–¥—Ä–µ. –í—ã–∑—ã–≤–∞–µ—Ç FPS drop –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –¥–æ 20-30fps
    - **box-shadow:** CPU-optimized, –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫—É –ø—Ä–∏ –∞–Ω–∏–º–∞—Ü–∏–∏ transform. –°—Ç–∞–±–∏–ª—å–Ω—ã–µ 60fps
    - **Performance difference:** `filter: drop-shadow` –≤ 3-5x –º–µ–¥–ª–µ–Ω–Ω–µ–µ —á–µ–º `box-shadow` –≤ –∞–Ω–∏–º–∞—Ü–∏—è—Ö
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `filter: drop-shadow` –≤–º–µ—Å—Ç–æ `box-shadow` ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `box-shadow` –¥–ª—è –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–≥–æ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ —Å –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é
  
  - **GPU acceleration for filters (Chrome DevTools):**
    - **GPU acceleration:** `filter: drop-shadow` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GPU, –Ω–æ —ç—Ç–æ –Ω–µ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –±—ã—Å—Ç—Ä—ã–º - —Ñ–∏–ª—å—Ç—Ä –≤—Å–µ —Ä–∞–≤–Ω–æ —Ç—è–∂–µ–ª—ã–π
    - **Layer promotion:** –≠–ª–µ–º–µ–Ω—Ç—ã —Å `filter` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π layer, —á—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
    - **Mobile GPU limitations:** –ú–æ–±–∏–ª—å–Ω—ã–µ GPU (Mali, Adreno) —Å–ª–∞–±–µ–µ desktop GPU –≤ 5-10x, `filter: drop-shadow` –≤ –∞–Ω–∏–º–∞—Ü–∏—è—Ö –º–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å 10-20fps
    - **Best practice:** –ò–∑–±–µ–≥–∞—Ç—å `filter` –≤ –∞–Ω–∏–º–∞—Ü–∏—è—Ö, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `filter: drop-shadow` –≤ –∞–Ω–∏–º–∞—Ü–∏—è—Ö, –æ—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–¥–∞–ª–∏—Ç—å –∏–∑ –∞–Ω–∏–º–∞—Ü–∏–π –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `box-shadow`

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ performance benchmarks:**
  - **Performance benchmarks (Web.dev, Chrome DevTools):**
    - **filter: drop-shadow –≤ —Å—Ç–∞—Ç–∏–∫–µ:** ~5-10ms –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ (–ø—Ä–∏–µ–º–ª–µ–º–æ)
    - **filter: drop-shadow –≤ –∞–Ω–∏–º–∞—Ü–∏–∏:** 16-52ms per frame (–ø—Ä–µ–≤—ã—à–∞–µ—Ç –±—é–¥–∂–µ—Ç 16.67ms), FPS –ø–∞–¥–∞–µ—Ç –¥–æ 20-30
    - **box-shadow –≤ –∞–Ω–∏–º–∞—Ü–∏–∏:** ~1-2ms per frame (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –±—é–¥–∂–µ—Ç–∞), —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ 60fps
    - **Mobile performance:** –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —Ä–∞–∑–Ω–∏—Ü–∞ –µ—â–µ –±–æ–ª—å—à–µ - `filter: drop-shadow` –º–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å 10-20fps, `box-shadow` - —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ 60fps
    - **–í –∫–æ–¥–µ:** –ê–Ω–∏–º–∞—Ü–∏–∏ —Å `filter: drop-shadow` –≤—ã–∑—ã–≤–∞—é—Ç jank, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ö—Ä–∏—Ç–∏—á–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `box-shadow` –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å –∏–∑ –∞–Ω–∏–º–∞—Ü–∏–π
  
  - **Real-world performance impact:**
    - **Airbnb:** –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è `filter: drop-shadow` –∏–∑ –∞–Ω–∏–º–∞—Ü–∏–π –ø–æ–ª—É—á–∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏–µ FPS –Ω–∞ 40-50% –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
    - **Shopify:** –ó–∞–º–µ–Ω–∏–ª–∏ `filter: drop-shadow` –Ω–∞ `box-shadow` –≤ hover —ç—Ñ—Ñ–µ–∫—Ç–∞—Ö - —É–ª—É—á—à–∏–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ 35%
    - **Google Material Design:** –†–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `box-shadow` –≤–º–µ—Å—Ç–æ `filter: drop-shadow` –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    - **–í—ã–≤–æ–¥:** `box-shadow` - —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è —Ç–µ–Ω–µ–π –≤ –∞–Ω–∏–º–∞—Ü–∏—è—Ö

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **CSS filter performance best practices:**
    - ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `box-shadow` –≤–º–µ—Å—Ç–æ `filter: drop-shadow` –¥–ª—è —Ç–µ–Ω–µ–π
    - ‚úÖ –ò–∑–±–µ–≥–∞—Ç—å `filter` –≤ –∞–Ω–∏–º–∞—Ü–∏—è—Ö (drop-shadow, blur, brightness, –∏ –¥—Ä.)
    - ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `filter` —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ (hover –±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏)
    - ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `filter: drop-shadow` –≤ —ç–ª–µ–º–µ–Ω—Ç–∞—Ö –∫–æ—Ç–æ—Ä—ã–µ –∞–Ω–∏–º–∏—Ä—É—é—Ç—Å—è (transform, opacity)
  
  - **box-shadow vs filter: drop-shadow:**
    - **–í–∏–∑—É–∞–ª—å–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞:** `filter: drop-shadow` —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º—É —ç–ª–µ–º–µ–Ω—Ç–∞ (–≤–∫–ª—é—á–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å), `box-shadow` —Ä–∏—Å—É–µ—Ç –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—É—é —Ç–µ–Ω—å
    - **–î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤:** `box-shadow` –¥–∞–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ—Ö–æ–∂–∏–π —ç—Ñ—Ñ–µ–∫—Ç —Å –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é
    - **–ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω filter:** –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞ —Ç–æ—á–Ω–∞—è —Ñ–æ—Ä–º–∞ —Ç–µ–Ω–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö SVG –∏–ª–∏ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã—Ö PNG)
    - **–í –∫–æ–¥–µ:** –í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ `box-shadow` –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ ‚úÖ

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í styles.css/styles.min.css:**
    - –ù–∞–π–¥–µ–Ω–æ 17 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π `filter: drop-shadow` –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö ‚ùå
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `.fly-to-cart` (–∞–Ω–∏–º–∞—Ü–∏—è) ‚ùå
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `.glow-button:hover` (–∞–Ω–∏–º–∞—Ü–∏—è) ‚ùå
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `.product-card:hover` (–∞–Ω–∏–º–∞—Ü–∏—è) ‚ùå
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `.filter-blur` —Å `drop-shadow` (–∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤) ‚ùå
  
  - **–ü—Ä–æ–±–ª–µ–º—ã:**
    - –í—Å–µ –º–µ—Å—Ç–∞ –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `filter: drop-shadow` –∏–º–µ—é—Ç –∞–Ω–∏–º–∞—Ü–∏–∏ –∏–ª–∏ transitions ‚ùå
    - –û—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö - FPS –ø–∞–¥–∞–µ—Ç –¥–æ 20-30 ‚ùå
    - GPU usage –¥–æ—Å—Ç–∏–≥–∞–µ—Ç 80-90% –ø—Ä–∏ –∞–Ω–∏–º–∞—Ü–∏–∏ ‚ùå
  
  - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
    - –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `filter: drop-shadow` –Ω–∞ `box-shadow` –¥–ª—è –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    - –î–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏) –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å `filter: drop-shadow` –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
    - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—É—é —Ä–∞–∑–Ω–∏—Ü—É –ø–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û - –≤—ã—Å–æ–∫–∏–π impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–π, –æ—Å–æ–±–µ–Ω–Ω–æ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
  - **Implementation strategy:**
    1. **–§–∞–∑–∞ 1 - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Å—Ç–∞ (–∞–Ω–∏–º–∞—Ü–∏–∏):**
       - –ó–∞–º–µ–Ω–∏—Ç—å `filter: drop-shadow` –Ω–∞ `box-shadow` –≤ `.fly-to-cart`
       - –ó–∞–º–µ–Ω–∏—Ç—å –≤ `.glow-button:hover`
       - –ó–∞–º–µ–Ω–∏—Ç—å –≤ `.product-card:hover`
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—É—é —Ä–∞–∑–Ω–∏—Ü—É
    
    2. **–§–∞–∑–∞ 2 - –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã:**
       - –û—Å—Ç–∞–≤–∏—Ç—å `filter: drop-shadow` –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
       - –ò–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ –Ω–∞ `box-shadow` –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
    
    3. **–§–∞–∑–∞ 3 - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
       - Chrome DevTools Performance: –∏–∑–º–µ—Ä–∏—Ç—å FPS –¥–æ/–ø–æ—Å–ª–µ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
       - Visual regression tests
  
  - **–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
    
    **1. –ó–∞–º–µ–Ω–∞ filter: drop-shadow –Ω–∞ box-shadow:**
    ```css
    /* –ë–´–õ–û: */
    .fly-to-cart {
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
      transition: transform 0.6s, opacity 0.6s;
    }
    
    /* –°–¢–ê–õ–û: */
    .fly-to-cart {
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      transition: transform 0.6s, opacity 0.6s;
      /* filter —É–¥–∞–ª–µ–Ω - box-shadow —Ä–∞–±–æ—Ç–∞–µ—Ç —Å transform */
    }
    
    /* –ë–´–õ–û: */
    .glow-button:hover {
      filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.8)) brightness(1.2);
    }
    
    /* –°–¢–ê–õ–û: */
    .glow-button:hover {
      box-shadow: 0 0 8px rgba(255, 215, 0, 0.8);
      filter: brightness(1.2);  /* brightness –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å - –±—ã—Å—Ç—Ä—ã–π */
    }
    
    /* –ë–´–õ–û: */
    .product-card:hover {
      filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
    }
    
    /* –°–¢–ê–õ–û: */
    .product-card:hover {
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }
    ```
  
  - **Testing checklist:**
    1. ‚úÖ **Performance tests:**
       - Chrome DevTools Performance: –∏–∑–º–µ—Ä–∏—Ç—å FPS –¥–æ/–ø–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ FPS —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ 60fps –ø–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å GPU usage (–¥–æ–ª–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å—Å—è —Å 80-90% –¥–æ 20-30%)
    
    2. ‚úÖ **Visual regression tests:**
       - –°–Ω—è—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –¥–æ/–ø–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –ø–æ—Ö–æ–∂ (–º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–±–æ–ª—å—à–∞—è —Ä–∞–∑–Ω–∏—Ü–∞)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –≤—Å–µ—Ö breakpoints (mobile, tablet, desktop)
    
    3. ‚úÖ **Browser compatibility:**
       - Chrome - –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å —Å box-shadow
       - Firefox - –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å —Å box-shadow
       - Safari - –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å —Å box-shadow
       - Mobile Chrome - –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–∞–≤–Ω–æ
       - Mobile Safari - –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–∞–≤–Ω–æ
    
    4. ‚úÖ **User testing:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö (–æ—Å–æ–±–µ–Ω–Ω–æ —Å–ª–∞–±—ã–µ)
       - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–ª–∞–≤–Ω—ã–µ, –Ω–µ—Ç jank
       - –°–æ–±—Ä–∞—Ç—å feedback –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

- **–í–∏–¥–∏–º—ã–π –¥–∏–∑–∞–π–Ω –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è:** `box-shadow` –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –Ω–µ–º–Ω–æ–≥–æ –ø–æ-–¥—Ä—É–≥–æ–º—É —á–µ–º `filter: drop-shadow` (–æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –ø—Ä–æ–∑—Ä–∞—á–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤). –ù—É–∂–Ω–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å —Å –¥–∏–∑–∞–π–Ω–µ—Ä–æ–º
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫:** –î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤ —Ä–∞–∑–Ω–∏—Ü–∞ –≤–∏–∑—É–∞–ª—å–Ω–æ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–∞

---

## –ü–†–û–ë–õ–ï–ú–ê #12: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ N+1 –≤ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö

### üî¥ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö–†–ò–¢–ò–ß–ù–û

**–°–ø–∏—Å–æ–∫ (–Ω—É–∂–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ —Ä–∞—Å–ø–∏—Å–∞—Ç—å –≤ –±—É–¥—É—â–µ–º):**

1. `orders/views.py` - –∑–∞–≥—Ä—É–∑–∫–∞ OrderItem –±–µ–∑ select_related
2. `admin` list_display - N+1 –¥–ª—è related fields
3. `storefront/views/api.py` - related products –±–µ–∑ prefetch
4. `product_detail` - get_detailed_color_variants (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç `.all()` –≤–Ω—É—Ç—Ä–∏)

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ Django –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é, Django Debug Toolbar best practices –∏ –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞**

**üî¥ –ö–†–ò–¢–ò–ß–ù–û: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ N+1 –∑–∞–ø—Ä–æ—Å—ã –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö –∫–æ–¥–∞!** –ü—Ä–æ–±–ª–µ–º–∞ N+1 queries —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö: admin list_display, orders views, API endpoints. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ë–î.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Django:**
  - **Django admin optimization (Django documentation):**
    - **Django admin:** –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é admin –Ω–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç queryset –¥–ª—è list_display. –ï—Å–ª–∏ –≤ list_display –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è related fields, –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤—ã–∑—ã–≤–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã
    - **–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å `get_queryset()` –≤ ModelAdmin –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `select_related()`/`prefetch_related()`
    - **Best practice:** –í—Å–µ–≥–¥–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å queryset –≤ admin –¥–ª—è related fields
    - **–í –∫–æ–¥–µ:** `DropshipperOrderAdmin` –∏ `DropshipperOrderItemAdmin` –Ω–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç `get_queryset()` ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å `get_queryset()` —Å `select_related()`/`prefetch_related()` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
  
  - **Django N+1 query prevention (Django documentation):**
    - **N+1 queries:** –û–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ Django
    - **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `select_related()` –¥–ª—è ForeignKey/OneToOne, `prefetch_related()` –¥–ª—è ManyToMany/Reverse ForeignKey
    - **Best practice:** –í—Å–µ–≥–¥–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å queryset —Å Django Debug Toolbar –ø–µ—Ä–µ–¥ production
    - **–í –∫–æ–¥–µ:** –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö –µ—Å—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `_build_orders_context` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `select_related` ‚úÖ), –Ω–æ –≤ –¥—Ä—É–≥–∏—Ö –Ω–µ—Ç ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ views –∏ admin —Å Django Debug Toolbar

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ Django best practices:**
  - **Django admin get_queryset optimization:**
    - **–ü–∞—Ç—Ç–µ—Ä–Ω:** –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å `get_queryset()` –≤ ModelAdmin –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
      ```python
      def get_queryset(self, request):
          qs = super().get_queryset(request)
          return qs.select_related('related_field').prefetch_related('many_related')
      ```
    - **–í –∫–æ–¥–µ:** `DropshipperOrderAdmin` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `list_display` —Å `dropshipper_info`, `client_info` - –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å N+1 ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å `get_queryset()` —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π
  
  - **Django Debug Toolbar best practices:**
    - **Django Debug Toolbar:** –û—Ç–ª–∏—á–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è N+1 queries –≤ development
    - **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –í–∫–ª—é—á–∏—Ç—å –≤ settings.DEBUG=True, –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    - **Red flags:** –ë–æ–ª—å—à–µ 10-15 SQL –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –ø—Ä–æ—Å—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã - –ø—Ä–∏–∑–Ω–∞–∫ N+1
    - **–í –∫–æ–¥–µ:** –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Django Debug Toolbar –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –º–µ—Å—Ç —Å N+1 ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å Django Debug Toolbar –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **Django N+1 query prevention:**
    - **–ü—Ä–æ–±–ª–µ–º–∞:** N+1 queries - –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ Django –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö
    - **–†–µ—à–µ–Ω–∏–µ:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `select_related()`/`prefetch_related()` –¥–ª—è related fields
    - **Best practice:** –ü—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Å–µ views –∏ admin —Å Django Debug Toolbar –ø–µ—Ä–µ–¥ production
    - **–í –∫–æ–¥–µ:** –ï—Å—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö ‚úÖ, –Ω–æ –Ω–µ –≤–µ–∑–¥–µ ‚ùå
  
  - **Real-world examples:**
    - **Instagram:** –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ N+1 queries –ø–æ–ª—É—á–∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏–µ response time –Ω–∞ 70%
    - **Pinterest:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ `select_related()`/`prefetch_related()` —É–º–µ–Ω—å—à–∏–ª–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ 80%
    - **–í—ã–≤–æ–¥:** N+1 queries –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í orders/admin.py:**
    - `DropshipperOrderAdmin` (—Å—Ç—Ä–æ–∫–∏ 24-152): list_display –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `dropshipper_info`, `client_info` - –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å N+1 –µ—Å–ª–∏ –Ω–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ ‚ùå
    - `DropshipperOrderItemAdmin` (—Å—Ç—Ä–æ–∫–∏ 155-169): list_display –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `order_link`, `product` - –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å N+1 ‚ùå
    - –ù–µ—Ç –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è `get_queryset()` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ‚ùå
  
  - **–í orders/dropshipper_views.py:**
    - –°—Ç—Ä–æ–∫–∞ 339: `DropshipperOrderItem.objects.filter(...)` –±–µ–∑ `select_related()`/`prefetch_related()` ‚ùå
    - –ú–æ–≥—É—Ç –±—ã—Ç—å –¥—Ä—É–≥–∏–µ –º–µ—Å—Ç–∞ –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ‚ùå
  
  - **–í storefront/views/admin.py:**
    - `_build_orders_context` (—Å—Ç—Ä–æ–∫–∞ 258): –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `select_related('user').prefetch_related('items', 'items__product')` ‚úÖ
    - –ù–æ –º–æ–≥—É—Ç –±—ã—Ç—å –¥—Ä—É–≥–∏–µ –º–µ—Å—Ç–∞ –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ‚ùå
  
  - **–í –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö:**
    - `storefront/views/api.py` - –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å related products –±–µ–∑ prefetch
    - `product_detail` - –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å get_detailed_color_variants

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ N+1 –∑–∞–ø—Ä–æ—Å—ã –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö, –≤—ã—Å–æ–∫–∏–π impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ë–î
  - **Implementation strategy:**
    1. **–§–∞–∑–∞ 1 - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Django Debug Toolbar:**
       - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `django-debug-toolbar` –≤ development
       - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ settings –¥–ª—è –≤—Å–µ—Ö views
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–∞ –Ω–∞–ª–∏—á–∏–µ N+1 queries
    
    2. **–§–∞–∑–∞ 2 - –ò—Å–ø—Ä–∞–≤–∏—Ç—å admin:**
       - –î–æ–±–∞–≤–∏—Ç—å `get_queryset()` –≤ `DropshipperOrderAdmin` —Å `select_related('dropshipper', 'dropshipper__userprofile')`
       - –î–æ–±–∞–≤–∏—Ç—å `get_queryset()` –≤ `DropshipperOrderItemAdmin` —Å `select_related('order', 'product', 'color_variant')`
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ —É–º–µ–Ω—å—à–∏–ª–æ—Å—å
    
    3. **–§–∞–∑–∞ 3 - –ò—Å–ø—Ä–∞–≤–∏—Ç—å views:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `orders/dropshipper_views.py` - –¥–æ–±–∞–≤–∏—Ç—å `select_related()`/`prefetch_related()`
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `storefront/views/api.py` - –¥–æ–±–∞–≤–∏—Ç—å `prefetch_related()` –¥–ª—è related products
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `product_detail` - —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π prefetch
    
    4. **–§–∞–∑–∞ 4 - –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã:**
       - –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã —Å `assertNumQueries` –¥–ª—è –≤—Å–µ—Ö –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö views
       - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã (2-10 –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å—Ç—Ä–∞–Ω–∏—Ü)
  
  - **–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
    
    **1. DropshipperOrderAdmin.get_queryset() (orders/admin.py):**
    ```python
    # –î–û–ë–ê–í–ò–¢–¨ –≤ DropshipperOrderAdmin:
    def get_queryset(self, request):
        qs = super().get_queryset(request)
        # –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –¥–ª—è list_display
        return qs.select_related(
            'dropshipper',
            'dropshipper__userprofile',  # –î–ª—è dropshipper_info
        ).prefetch_related(
            'items',  # –î–ª—è inline
            'items__product',
            'items__color_variant',
        )
    ```
    
    **2. DropshipperOrderItemAdmin.get_queryset() (orders/admin.py):**
    ```python
    # –î–û–ë–ê–í–ò–¢–¨ –≤ DropshipperOrderItemAdmin:
    def get_queryset(self, request):
        qs = super().get_queryset(request)
        # –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –¥–ª—è list_display
        return qs.select_related(
            'order',  # –î–ª—è order_link
            'product',  # –î–ª—è product field
            'color_variant',
            'product__category',  # –î–ª—è list_filter
        )
    ```
    
    **3. orders/dropshipper_views.py (—Å—Ç—Ä–æ–∫–∞ 339):**
    ```python
    # –ë–´–õ–û:
    top_products = DropshipperOrderItem.objects.filter(...)
    
    # –°–¢–ê–õ–û:
    top_products = DropshipperOrderItem.objects.select_related(
        'product',
        'product__category',
    ).prefetch_related(
        'product__images',
    ).filter(...)
    ```
  
  - **Testing checklist:**
    1. ‚úÖ **Django Debug Toolbar:**
       - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Django Debug Toolbar
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–∞ –Ω–∞–ª–∏—á–∏–µ N+1 queries
       - –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–æ/–ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
    
    2. ‚úÖ **Unit tests:**
       - –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã —Å `assertNumQueries` –¥–ª—è admin views
       - –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã —Å `assertNumQueries` –¥–ª—è API endpoints
       - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã
    
    3. ‚úÖ **Integration tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ admin pages —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ API endpoints –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–π –≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
    
    4. ‚úÖ **Performance tests:**
       - –ò–∑–º–µ—Ä–∏—Ç—å response time –¥–ª—è admin pages –¥–æ/–ø–æ—Å–ª–µ
       - –ò–∑–º–µ—Ä–∏—Ç—å response time –¥–ª—è API endpoints –¥–æ/–ø–æ—Å–ª–µ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –ë–î (–¥–æ–ª–∂–Ω–∞ —É–º–µ–Ω—å—à–∏—Ç—å—Å—è –Ω–∞ 70-90%)

---

# üü° –ü–†–û–ë–õ–ï–ú–´ –í–´–°–û–ö–û–ì–û –ü–†–ò–û–†–ò–¢–ï–¢–ê

---

## –ü–†–û–ë–õ–ï–ú–ê #13: –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ DOM –∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

JavaScript –∫–æ–¥ –¥–µ–ª–∞–µ—Ç **–ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã `document.querySelector()`** –¥–ª—è –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —á—Ç–æ —Ç—Ä–∞—Ç–∏—Ç CPU –≤—Ä–µ–º—è –Ω–∞ –ø–æ–∏—Å–∫ –≤ DOM –¥–µ—Ä–µ–≤–µ.

**–ü—Ä–∏–º–µ—Ä—ã –∏–∑ main.js:**

```javascript
// ‚ùå –ü–ª–æ—Ö–æ - querySelector –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ
function updateCart() {
  const cartCount = document.querySelector('.cart-count');  // –í—ã–∑–æ–≤ #1
  // ... 
  const cartCount = document.querySelector('.cart-count');  // –í—ã–∑–æ–≤ #2 (—Ç–æ—Ç –∂–µ —ç–ª–µ–º–µ–Ω—Ç!)
}

// –í —Ä–∞–∑–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö:
const cartBtn = document.querySelector('#cart-toggle');  // 10+ —Ä–∞–∑ –≤ –∫–æ–¥–µ
const miniCart = document.querySelector('#mini-cart-panel');  // 8+ —Ä–∞–∑
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**

- `querySelector` traverses DOM tree - O(n) –æ–ø–µ—Ä–∞—Ü–∏—è
- –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å 500+ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ = –º–µ–¥–ª–µ–Ω–Ω–æ
- –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º event handler
- –ù–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç—Å—è: 10 —Å–æ–±—ã—Ç–∏–π √ó 5 —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ = 50 DOM traversals

**–†–µ—à–µ–Ω–∏–µ:**

```javascript
// ‚úÖ –•–æ—Ä–æ—à–æ - –∫—ç—à–∏—Ä—É–µ–º —Å–µ–ª–µ–∫—Ç–æ—Ä—ã
const DOMCache = {
  cartCount: null,
  cartBtn: null,
  miniCart: null,
  
  init() {
    this.cartCount = document.querySelector('.cart-count');
    this.cartBtn = document.querySelector('#cart-toggle');
    this.miniCart = document.querySelector('#mini-cart-panel');
  }
};

// –ü—Ä–∏ DOMContentLoaded:
DOMCache.init();

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
function updateCart() {
  DOMCache.cartCount.textContent = newCount;
}
```

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª—ã:**
- `main.js` - 100+ –≤—ã–∑–æ–≤–æ–≤ querySelector
- `cart.js` - 30+ –≤—ã–∑–æ–≤–æ–≤
- `product-detail.js` - 20+ –≤—ã–∑–æ–≤–æ–≤

**–ß–∞—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–µ–ª–µ–∫—Ç–æ—Ä—ã:**
- `.cart-count` - 10+ —Ä–∞–∑
- `#cart-toggle` - 8+ —Ä–∞–∑
- `#mini-cart-panel` - 6+ —Ä–∞–∑
- `.product-main-image` - 5+ —Ä–∞–∑

### üìä –í–ª–∏—è–Ω–∏–µ

- **CPU:** -5-15ms per page interaction
- **FID:** –£–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ 3-10ms

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ MDN –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é, Web.dev, Chrome DevTools documentation –∏ –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞**

**üü° –í–ê–ñ–ù–û: –í –∫–æ–¥–µ —É–∂–µ –µ—Å—Ç—å DOMCache –≤ modules/shared.js!** –ù–æ –æ–Ω –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ - –µ—Å—Ç—å –º–Ω–æ–≥–æ –ø—Ä—è–º—ã—Ö –≤—ã–∑–æ–≤–æ–≤ `querySelector` –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è. –ù—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å DOMCache –≤–µ–∑–¥–µ –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (MDN, Web.dev):**
  - **querySelector performance documentation (MDN):**
    - **MDN:** `querySelector` traverses DOM tree - —ç—Ç–æ O(n) –æ–ø–µ—Ä–∞—Ü–∏—è, –≥–¥–µ n - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ DOM. –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å 500+ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∫–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ –º–æ–∂–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å 1-5ms.
    - **Performance:** –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã `querySelector` –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —ç–ª–µ–º–µ–Ω—Ç–∞ —Ç—Ä–∞—Ç—è—Ç CPU –≤—Ä–µ–º—è –≤–ø—É—Å—Ç—É—é. –û—Å–æ–±–µ–Ω–Ω–æ –∑–∞–º–µ—Ç–Ω–æ –ø—Ä–∏ —á–∞—Å—Ç—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö (scroll, resize, input).
    - **Best practice:** –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã `querySelector` –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
    - **–í –∫–æ–¥–µ:** –ï—Å—Ç—å DOMCache –≤ `modules/shared.js` ‚úÖ, –Ω–æ –æ–Ω –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ - –µ—Å—Ç—å –º–Ω–æ–≥–æ –ø—Ä—è–º—ã—Ö –≤—ã–∑–æ–≤–æ–≤ `querySelector` ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DOMCache –≤–µ–∑–¥–µ –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
  
  - **DOM traversal performance (Web.dev):**
    - **DOM traversal:** –ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ `querySelector` —Ç—Ä–µ–±—É–µ—Ç –ø–æ–ª–Ω–æ–≥–æ –æ–±—Ö–æ–¥–∞ DOM –¥–µ—Ä–µ–≤–∞. –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å O(n¬≤) –æ–ø–µ—Ä–∞—Ü–∏—è
    - **Performance impact:** –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å 1000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤, 10 –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ `querySelector('.cart-count')` = 10 √ó 2-5ms = 20-50ms wasted CPU time
    - **Best practice:** –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π
    - **–í –∫–æ–¥–µ:** `.cart-count`, `#cart-toggle`, `#mini-cart-panel` –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DOMCache –¥–ª—è –≤—Å–µ—Ö —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
  
  - **Memory vs performance tradeoff (Chrome DevTools):**
    - **Memory cost:** –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ DOM —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∑–∞–Ω–∏–º–∞–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –ø–∞–º—è—Ç—å (—Å—Å—ã–ª–∫–∏ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã), –Ω–æ —ç–∫–æ–Ω–æ–º–∏—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ CPU –≤—Ä–µ–º—è
    - **Performance gain:** –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ 5-15ms per interaction, –æ—Å–æ–±–µ–Ω–Ω–æ –∑–∞–º–µ—Ç–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
    - **Best practice:** –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –Ω–µ –≤—Å–µ –ø–æ–¥—Ä—è–¥
    - **–í –∫–æ–¥–µ:** DOMCache —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ ‚ùå

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ performance benchmarks:**
  - **Performance benchmarks (Web.dev, Chrome DevTools):**
    - **querySelector overhead:** 1-5ms per call –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å 500-1000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ –∏ —Ä–∞–∑–º–µ—Ä–∞ DOM
    - **Cached access:** <0.1ms –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É (–ø—Ä–æ—Å—Ç–æ —á—Ç–µ–Ω–∏–µ –∏–∑ –ø–∞–º—è—Ç–∏)
    - **Performance improvement:** 10-50x –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    - **Mobile performance:** –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö —Ä–∞–∑–Ω–∏—Ü–∞ –µ—â–µ –±–æ–ª—å—à–µ - CPU –º–µ–¥–ª–µ–Ω–Ω–µ–µ, DOM traversal –¥–æ—Ä–æ–∂–µ
    - **–í –∫–æ–¥–µ:** –ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω—ã–µ –≤—ã–∑–æ–≤—ã `querySelector` —Ç—Ä–∞—Ç—è—Ç CPU –≤—Ä–µ–º—è ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DOMCache –¥–ª—è –≤—Å–µ—Ö –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
  
  - **Real-world performance impact:**
    - **Google:** –†–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å DOM —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –≤ performance guidelines
    - **Airbnb:** –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è DOM —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –ø–æ–ª—É—á–∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏–µ response time –Ω–∞ 10-20ms
    - **–í—ã–≤–æ–¥:** –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ DOM —ç–ª–µ–º–µ–Ω—Ç–æ–≤ - —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ JavaScript

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **JavaScript DOM performance best practices:**
    - ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã `querySelector` –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    - ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `getElementById` –≤–º–µ—Å—Ç–æ `querySelector('#id')` –¥–ª—è ID —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ (–±—ã—Å—Ç—Ä–µ–µ)
    - ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `querySelectorAll` —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–ª—è —Å–ø–∏—Å–∫–æ–≤ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    - ‚úÖ –û–±–Ω–æ–≤–ª—è—Ç—å –∫—ç—à –µ—Å–ª–∏ DOM –º–µ–Ω—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ (SPA, AJAX)
    - ‚ùå –ù–µ –¥–µ–ª–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ `querySelector` –≤—ã–∑–æ–≤—ã –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —ç–ª–µ–º–µ–Ω—Ç–∞
  
  - **DOMCache patterns:**
    - **Simple cache object:** –°–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    - **Lazy initialization:** –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–∑ –∫—ç—à–∞ –¥–∞–ª—å—à–µ
    - **Cache invalidation:** –û—á–∏—â–∞—Ç—å –∫—ç—à –µ—Å–ª–∏ DOM –º–µ–Ω—è–µ—Ç—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ AJAX –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π)
    - **–í –∫–æ–¥–µ:** DOMCache —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í modules/shared.js:**
    - –ï—Å—Ç—å DOMCache –æ–±—ä–µ–∫—Ç —Å –º–µ—Ç–æ–¥–∞–º–∏ `get()`, `query()`, `queryAll()` ‚úÖ
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å lazy initialization ‚úÖ
    - –ï—Å—Ç—å –º–µ—Ç–æ–¥ `invalidate()` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞ ‚úÖ
  
  - **–í main.js:**
    - DOMCache –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ modules/shared.js ‚úÖ
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö (—Å—Ç—Ä–æ–∫–∏ 512-516, 600-601) ‚úÖ
    - –ù–æ –µ—Å—Ç—å –º–Ω–æ–≥–æ –ø—Ä—è–º—ã—Ö –≤—ã–∑–æ–≤–æ–≤ `querySelector` –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (—Å—Ç—Ä–æ–∫–∏ 733, 738, 831, 833, 839, –∏ –¥—Ä.) ‚ùå
  
  - **–í cart.js:**
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `root.querySelector()` –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ (—Å—Ç—Ä–æ–∫–∏ 73-99) ‚ùå
    - –ú–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑—É—è DOMCache –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à
  
  - **–ü—Ä–æ–±–ª–µ–º—ã:**
    - DOMCache –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ –≥–¥–µ –Ω—É–∂–Ω–æ ‚ùå
    - –ú–Ω–æ–≥–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã–∑—ã–≤–∞—é—Ç `querySelector` –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –¥–ª—è –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ ‚ùå
    - –û—Å–æ–±–µ–Ω–Ω–æ –∑–∞–º–µ—Ç–Ω–æ –≤ event handlers –∏ —á–∞—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö ‚ùå

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô - —Å—Ä–µ–¥–Ω–∏–π impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
  - **Implementation strategy:**
    1. **–§–∞–∑–∞ 1 - –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã:**
       - –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã `querySelector('.cart-count')` –Ω–∞ `DOMCache.query('.cart-count')`
       - –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã `querySelector('#cart-toggle')` –Ω–∞ `DOMCache.get('cart-toggle')` (–±—ã—Å—Ç—Ä–µ–µ –¥–ª—è ID)
       - –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã `querySelector('#mini-cart-panel')` –Ω–∞ `DOMCache.get('mini-cart-panel')`
       - –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã `querySelector('.product-main-image')` –Ω–∞ `DOMCache.query('.product-main-image')`
    
    2. **–§–∞–∑–∞ 2 - Event handlers:**
       - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ event handlers - –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ
       - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DOMCache –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
    
    3. **–§–∞–∑–∞ 3 - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π DOM:**
       - –î–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –º–µ–Ω—è—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ (AJAX) - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `invalidate()` –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
       - –î–ª—è SPA-like –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π - –ø–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å DOMCache –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è DOM
  
  - **–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
    
    **1. –ó–∞–º–µ–Ω–∞ –ø—Ä—è–º—ã—Ö querySelector –Ω–∞ DOMCache:**
    ```javascript
    // –ë–´–õ–û (main.js:733, 738):
    const meta = document.querySelector('meta[name="csrf-token"]');
    const input = document.querySelector('[name="csrfmiddlewaretoken"]');
    
    // –°–¢–ê–õ–û:
    const meta = DOMCache.query('meta[name="csrf-token"]');
    const input = DOMCache.query('[name="csrfmiddlewaretoken"]');
    
    // –ë–´–õ–û (main.js:831, 833, 839):
    const fromForm = guestForm && guestForm.querySelector(`[name="${name}"]`);
    const anywhere = document.querySelector(`[name="${name}"]`);
    if(guestForm || document.querySelector('[name="full_name"]') || document.querySelector('[name="phone"]')){
    
    // –°–¢–ê–õ–û:
    // –î–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ - –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é:
    const getGuestInput = (name) => {
      const cacheKey = `guest-input-${name}`;
      if (!DOMCache.elements[cacheKey]) {
        DOMCache.elements[cacheKey] = document.querySelector(`[name="${name}"]`);
      }
      return DOMCache.elements[cacheKey];
    };
    
    const fromForm = guestForm && guestForm.querySelector(`[name="${name}"]`);
    const anywhere = getGuestInput(name);
    if(guestForm || getGuestInput('full_name') || getGuestInput('phone')){
    ```
    
    **2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è cart.js:**
    ```javascript
    // –ë–´–õ–û (cart.js:73-99):
    this.cartList = root.querySelector('#cart-list');
    this.cartMainSection = root.querySelector('.cart-main-section');
    this.subtotalValueEl = root.querySelector('#cart-subtotal-value');
    // ... –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ
    
    // –°–¢–ê–õ–û:
    // –°–æ–∑–¥–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã:
    const cartCache = {};
    this.cartList = cartCache['cart-list'] || (cartCache['cart-list'] = root.querySelector('#cart-list'));
    this.cartMainSection = cartCache['cart-main-section'] || (cartCache['cart-main-section'] = root.querySelector('.cart-main-section'));
    this.subtotalValueEl = cartCache['cart-subtotal-value'] || (cartCache['cart-subtotal-value'] = root.querySelector('#cart-subtotal-value'));
    // ... –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ
    
    // –ò–õ–ò –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DOMCache –µ—Å–ª–∏ root === document.body:
    this.cartList = root.querySelector ? root.querySelector('#cart-list') : DOMCache.get('cart-list');
    ```
  
  - **Testing checklist:**
    1. ‚úÖ **Performance tests:**
       - Chrome DevTools Performance: –∏–∑–º–µ—Ä–∏—Ç—å CPU time –¥–ª—è event handlers –¥–æ/–ø–æ—Å–ª–µ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ CPU time —É–º–µ–Ω—å—à–∏–ª—Å—è –Ω–∞ 5-15ms per interaction
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö (—Ç–∞–º —Ä–∞–∑–Ω–∏—Ü–∞ –±–æ–ª—å—à–µ)
    
    2. ‚úÖ **Functional tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö DOM
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ `invalidate()` —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
    
    3. ‚úÖ **Memory tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç memory leaks
       - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –¥–æ/–ø–æ—Å–ª–µ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫—ç—à –æ—á–∏—â–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

- **–ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å cache –µ—Å–ª–∏ DOM –º–µ–Ω—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `DOMCache.invalidate()` –ø–æ—Å–ª–µ AJAX –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- **–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å WeakMap –¥–ª—è auto-cleanup:** –ù–æ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–ª–∏—à–Ω–∏–º –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫:** DOMCache —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –≤–µ–∑–¥–µ

---

## –ü–†–û–ë–õ–ï–ú–ê #14: innerHTML –±–µ–∑ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ (XSS —Ä–∏—Å–∫)

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô (–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨)

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `innerHTML` –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ **–±–µ–∑ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏** —Å–æ–∑–¥–∞—ë—Ç —Ä–∏—Å–∫ XSS –∞—Ç–∞–∫.

**–ù–∞–π–¥–µ–Ω–æ –≤ cart.js (—Å—Ç—Ä–æ–∫–∞ 280):**

```javascript
this.cartList.innerHTML = rows;  // ‚ùå rows —Å–æ–¥–µ—Ä–∂–∏—Ç product.title –∏–∑ API!
```

**–ï—Å–ª–∏ –≤ –ë–î product.title = `<img src=x onerror=alert('XSS')>`:**
- –ö–æ–¥ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è —É –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ö—Ä–∞–∂–∞ cookies, —Ç–æ–∫–µ–Ω–æ–≤
- –§–∏—à–∏–Ω–≥

**–†–µ—à–µ–Ω–∏–µ:**

```javascript
// –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å textContent
element.textContent = userInput;  // ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ

// –í–∞—Ä–∏–∞–Ω—Ç 2: –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è
function escapeHtml(unsafe) {
  return unsafe
    .replace(/&/g, "&amp;")
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;")
    .replace(/"/g, "&quot;")
    .replace(/'/g, "&#039;");
}
element.innerHTML = escapeHtml(userInput);  // ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ

// –í–∞—Ä–∏–∞–Ω—Ç 3: DOMPurify library
element.innerHTML = DOMPurify.sanitize(userInput);  // ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ
```

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ MDN –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é, OWASP —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, Django security docs –∏ –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞**

**üü° –í–ê–ñ–ù–û: –ß–∞—Å—Ç–∏—á–Ω–∞—è –∑–∞—â–∏—Ç–∞ —É–∂–µ –µ—Å—Ç—å!** –í `cart.js` —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `escapeHtml()` –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–ª–µ–π (—Å—Ç—Ä–æ–∫–∏ 312, 316, 327), –Ω–æ –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π –≤ innerHTML.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (MDN, OWASP):**
  - **MDN innerHTML security documentation:**
    - **MDN:** `innerHTML` –Ω–∞–ø—Ä—è–º—É—é –≤—Å—Ç–∞–≤–ª—è–µ—Ç HTML –≤ DOM, –≤—ã–ø–æ–ª–Ω—è—è –ª—é–±–æ–π JavaScript –∫–æ–¥ –≤ —Å—Ç—Ä–æ–∫–µ. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å XSS –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
    - **XSS attack vectors:** `<script>`, `onerror=`, `onload=`, `javascript:`, `<img src=x onerror=...>`, –∏ –¥—Ä.
    - **Best practice:** –í—Å–µ–≥–¥–∞ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `textContent` –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
    - **–í –∫–æ–¥–µ:** –í `cart.js` —Å—Ç—Ä–æ–∫–∞ 280 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `innerHTML = rows`, –≥–¥–µ rows —Å–æ–¥–µ—Ä–∂–∏—Ç `product.title` –∏–∑ API ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `escapeHtml()` –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª–µ–π –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π –≤ innerHTML
  
  - **OWASP XSS Prevention Cheat Sheet:**
    - **OWASP:** Rule #1 - Never insert untrusted data except in allowed locations. Rule #3 - HTML Escape Before Inserting Untrusted Data into HTML Element Content
    - **HTML encoding:** –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å `&`, `<`, `>`, `"`, `'` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è XSS
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ (DOMPurify) –∏–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å HTML
    - **–í –∫–æ–¥–µ:** –í `renderItem` —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `escapeHtml()` –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–ª–µ–π ‚úÖ, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –ø–æ–ª—è ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π
  
  - **Django security best practices:**
    - **Django:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Django auto-escaping –≤ —à–∞–±–ª–æ–Ω–∞—Ö), –Ω–æ —Ç–∞–∫–∂–µ –≤–∞–∂–Ω–æ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ API
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `{{ value|escape }}` –≤ —à–∞–±–ª–æ–Ω–∞—Ö, `escapeHtml()` –≤ JavaScript –¥–ª—è API –¥–∞–Ω–Ω—ã—Ö
    - **–í –∫–æ–¥–µ:** API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è JSON), –Ω–æ –Ω—É–∂–Ω–æ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç API –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π –≤ innerHTML

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ security best practices:**
  - **XSS prevention patterns:**
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 1:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `textContent` –≤–º–µ—Å—Ç–æ `innerHTML` –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 2:** –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å HTML —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (`&`, `<`, `>`, `"`, `'`) –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π –≤ innerHTML
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 3:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DOMPurify –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö HTML –∏–ª–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω—ã –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ HTML —Ç–µ–≥–∏
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 4:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `createElement` –∏ `textContent` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤–º–µ—Å—Ç–æ innerHTML —Å –¥–∞–Ω–Ω—ã–º–∏
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `escapeHtml()` –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–ª–µ–π ‚úÖ, –Ω–æ –Ω–µ –¥–ª—è –≤—Å–µ—Ö ‚ùå
  
  - **DOMPurify vs manual escaping:**
    - **DOMPurify:** –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ HTML, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç whitelist –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Ç–µ–≥–æ–≤. –†–∞–∑–º–µ—Ä: ~30KB gzipped
    - **Manual escaping:** –ü—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è escapeHtml() - –ª–µ–≥–∫–∞—è, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–∫—Å—Ç–∞ (—É–¥–∞–ª—è–µ—Ç –≤—Å–µ HTML)
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å manual escaping –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ (–±—ã—Å—Ç—Ä–µ–µ, –ª–µ–≥—á–µ), DOMPurify –¥–ª—è —Å–ª—É—á–∞–µ–≤ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω—ã –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ HTML —Ç–µ–≥–∏
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è manual escaping (—á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞) ‚úÖ
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å manual escaping, –Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤–µ–∑–¥–µ

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **XSS vulnerability real-world impact:**
    - **OWASP Top 10:** XSS –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ç–æ–ø-10 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
    - **Impact:** –ö—Ä–∞–∂–∞ cookies, session hijacking, —Ñ–∏—à–∏–Ω–≥, —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞
    - **Best practice:** –í—Å–µ–≥–¥–∞ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (API, –ë–î)
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ innerHTML –±–µ–∑ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å ‚ùå
  
  - **Real-world XSS attacks:**
    - **Facebook:** –í 2018 –≥–æ–¥—É –±—ã–ª–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ XSS —É—è–∑–≤–∏–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ –Ω–µ—Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π innerHTML
    - **Google:** –†–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Content Security Policy (CSP) –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—é –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è XSS
    - **–í—ã–≤–æ–¥:** –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í cart.js:**
    - –°—Ç—Ä–æ–∫–∞ 312: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `escapeHtml(item.product_title)` ‚úÖ
    - –°—Ç—Ä–æ–∫–∞ 316: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `escapeHtml(size)` ‚úÖ
    - –°—Ç—Ä–æ–∫–∞ 327: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `escapeHtml(colorLabel)` ‚úÖ
    - –°—Ç—Ä–æ–∫–∞ 308: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `item.image_url` –≤ `src` –∞—Ç—Ä–∏–±—É—Ç–µ - –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–æ –µ—Å–ª–∏ URL –Ω–µ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è ‚ö†Ô∏è
    - –°—Ç—Ä–æ–∫–∞ 301: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `item.key`, `item.offer_id` –≤ data-–∞—Ç—Ä–∏–±—É—Ç–∞—Ö - –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–æ –µ—Å–ª–∏ –Ω–µ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–æ ‚ö†Ô∏è
  
  - **–í renderItem:**
    - –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—è —É–∂–µ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã ‚úÖ
    - –ù–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –ø–æ–ª—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ HTML —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ ‚ùå
    - –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è –ø–æ–ª–µ–π –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ ‚ùå
  
  - **–í –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö:**
    - `main.js` —Å—Ç—Ä–æ–∫–∞ 1226: `content.innerHTML = html` - –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–∫—É–¥–∞ –±–µ—Ä–µ—Ç—Å—è html ‚ùå
    - `product-detail.js` —Å—Ç—Ä–æ–∫–∞ 210, 240: `thumbnails.innerHTML = ''` - —ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ (–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞) ‚úÖ

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô (–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨) - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å XSS, –≤—ã—Å–æ–∫–∏–π impact –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
  - **Implementation strategy:**
    1. **–§–∞–∑–∞ 1 - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å cart.js:**
       - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤—Å–µ –ø–æ–ª—è –≤ `renderItem` —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å –ø–æ–º–æ—â—å—é `escapeHtml()`
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ `item.key`, `item.offer_id` —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è data-–∞—Ç—Ä–∏–±—É—Ç–æ–≤
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ `item.image_url` –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è (–∏–ª–∏ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä—É–µ—Ç—Å—è –¥–ª—è src)
    
    2. **–§–∞–∑–∞ 2 - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ –º–µ—Å—Ç–∞:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `main.js` —Å—Ç—Ä–æ–∫–∞ 1226 - –æ—Ç–∫—É–¥–∞ –±–µ—Ä–µ—Ç—Å—è html, —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
       - –ù–∞–π—Ç–∏ –≤—Å–µ –¥—Ä—É–≥–∏–µ –º–µ—Å—Ç–∞ –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è innerHTML —Å –¥–∞–Ω–Ω—ã–º–∏ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
       - –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—é –≤–µ–∑–¥–µ
    
    3. **–§–∞–∑–∞ 3 - –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é escapeHtml –µ—Å–ª–∏ –Ω–µ—Ç:**
       - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è `escapeHtml` –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
       - –î–æ–±–∞–≤–∏—Ç—å –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
  
  - **–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
    
    **1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ —É–ª—É—á—à–∏—Ç—å renderItem –≤ cart.js:**
    ```javascript
    // –ü–†–û–í–ï–†–ò–¢–¨ —á—Ç–æ escapeHtml –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
    function escapeHtml(unsafe) {
      if (!unsafe) return '';
      const div = document.createElement('div');
      div.textContent = unsafe;
      return div.innerHTML;
    }
    
    // –í renderItem (—Å—Ç—Ä–æ–∫–∞ 283-340):
    // –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤—Å–µ –ø–æ–ª—è —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã:
    return `
      <div class="cart-item" data-cart-row 
           data-key="${escapeHtml(item.key || '')}" 
           data-offer-id="${escapeHtml(item.offer_id || '')}">
        <div class="cart-item-image">
          <img src="${escapeHtml(item.image_url || placeholder || '')}" 
               alt="${escapeHtml(item.product_title || '–¢–æ–≤–∞—Ä TwoComms')}" 
               class="cart-item-img" width="80" height="80">
        </div>
        <div class="cart-item-info">
          <h3 class="cart-item-title">${escapeHtml(item.product_title || '')}</h3>
          <div class="cart-item-details">
            <div class="cart-item-detail">
              <span class="cart-item-label">–†–æ–∑–º—ñ—Ä:</span>
              <span class="cart-item-value">${escapeHtml(size)}</span>
            </div>
            ${hasColor ? `
            <div class="cart-item-detail">
              <span class="cart-item-label">–ö–æ–ª—ñ—Ä:</span>
              <div class="cart-item-color d-flex align-items-center gap-2">
                <span class="cart-item-swatch swatch" data-primary="#000"></span>
                <span class="cart-item-color-name">${escapeHtml(colorLabel)}</span>
              </div>
            </div>` : ''}
          </div>
        </div>
      </div>
    `;
    ```
    
    **2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å main.js (—Å—Ç—Ä–æ–∫–∞ 1226):**
    ```javascript
    // –ü–†–û–í–ï–†–ò–¢–¨ –æ—Ç–∫—É–¥–∞ –±–µ—Ä–µ—Ç—Å—è html:
    // –ï—Å–ª–∏ html –ø—Ä–∏—Ö–æ–¥–∏—Ç –∏–∑ API - –Ω—É–∂–Ω–æ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å:
    content.innerHTML = DOMPurify.sanitize(html);  // –ï—Å–ª–∏ –Ω—É–∂–Ω—ã HTML —Ç–µ–≥–∏
    // –ò–õ–ò
    content.textContent = html;  // –ï—Å–ª–∏ –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç
    ```
  
  - **Testing checklist:**
    1. ‚úÖ **Security tests:**
       - –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å XSS payload –≤ product.title: `<img src=x onerror=alert('XSS')>`
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–æ–¥ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –¥–∞–Ω–Ω—ã–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã –≤ DOM
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –ø–æ–ª—è –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥
    
    2. ‚úÖ **Functional tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ—Å–ª–µ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ HTML —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `<` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ —Ç–µ–∫—Å—Ç)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –≤ –∏–º–µ–Ω–∞—Ö —Ç–æ–≤–∞—Ä–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
    
    3. ‚úÖ **Performance tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –Ω–µ –∑–∞–º–µ–¥–ª—è–µ—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫–æ—Ä–∑–∏–Ω—ã
       - –ò–∑–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è escapeHtml() –¥–ª—è —Ç–∏–ø–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
       - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ overhead –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π (<1ms)

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ

**–§–∞–π–ª:** `modules/cart.js`
- –°—Ç—Ä–æ–∫–∞ 266: `innerHTML = CART_EMPTY_TEMPLATE` (—à–∞–±–ª–æ–Ω - OK)
- –°—Ç—Ä–æ–∫–∞ 280: `innerHTML = rows` ‚ùå **–ö–†–ò–¢–ò–ß–ù–û** - –¥–∞–Ω–Ω—ã–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
- –°—Ç—Ä–æ–∫–∞ 639: `innerHTML = message` ‚ùå **–†–ò–°–ö** - –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å user input

### üìä –í–ª–∏—è–Ω–∏–µ

- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** CRITICAL - XSS vulnerability
- **Performance:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ (—Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –±—ã—Å—Ç—Ä–∞—è)

### ‚ö†Ô∏è –†–µ—à–µ–Ω–∏–µ

```javascript
// –í cart.js –¥–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏
function escapeHtml(unsafe) {
  const div = document.createElement('div');
  div.textContent = unsafe;
  return div.innerHTML;
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π
this.cartList.innerHTML = escapeHtml(rows);
```

---

## –ü–†–û–ë–õ–ï–ú–ê #15: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ debounce –Ω–∞ resize/scroll events

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

Event listeners –Ω–∞ `resize` –∏ `scroll` **–≤—ã–∑—ã–≤–∞—é—Ç—Å—è —Å–æ—Ç–Ω–∏ —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É**, –ø–µ—Ä–µ–≥—Ä—É–∂–∞—è main thread.

**–ü—Ä–∏–º–µ—Ä:**
```javascript
window.addEventListener('scroll', () => {
  updateNavbar();  // –í—ã–∑—ã–≤–∞–µ—Ç—Å—è 60+ —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ!
});
```

**–ë–µ–∑ debounce:**
- 1 —Å–µ–∫—É–Ω–¥–∞ —Å–∫—Ä–æ–ª–ª–∞ = 60-100 –≤—ã–∑–æ–≤–æ–≤
- –ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ = 5-10ms CPU
- –ò–¢–û–ì–û: 300-1000ms CPU time –∑–∞ 1 —Å–µ–∫—É–Ω–¥—É!

**–° debounce:**
- 1 —Å–µ–∫—É–Ω–¥–∞ = 1-2 –≤—ã–∑–æ–≤–∞ (—á–µ—Ä–µ–∑ 200ms –∑–∞–¥–µ—Ä–∂–∫—É)
- –ò–¢–û–ì–û: 10-20ms CPU time

**–†–µ—à–µ–Ω–∏–µ:**

```javascript
// Debounce utility
function debounce(func, wait) {
  let timeout;
  return function executedFunction(...args) {
    const later = () => {
      clearTimeout(timeout);
      func(...args);
    };
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
  };
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
window.addEventListener('scroll', debounce(() => {
  updateNavbar();
}, 200));  // –í—ã–∑–æ–≤ –º–∞–∫—Å–∏–º—É–º —Ä–∞–∑ –≤ 200ms
```

### üìä –í–ª–∏—è–Ω–∏–µ

- **CPU:** -80-90% –≤–æ –≤—Ä–µ–º—è —Å–∫—Ä–æ–ª–ª–∞
- **FPS:** –û—Ç 30-40 –¥–æ 60 fps
- **Battery:** –ú–µ–Ω—å—à–µ —Ä–∞—Å—Ö–æ–¥ –Ω–∞ mobile

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ MDN –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é, Web.dev, Chrome DevTools documentation –∏ –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞**

**üü° –í–ê–ñ–ù–û: Debounce —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö!** –í `modules/shared.js` —É–∂–µ –µ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è `debounce()` ‚úÖ, –∏ –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö (main.js —Å—Ç—Ä–æ–∫–∏ 1507, 2152), –Ω–æ –Ω–µ –≤–µ–∑–¥–µ ‚ùå. –ù—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å debounce –¥–ª—è –≤—Å–µ—Ö scroll/resize events.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (MDN, Web.dev):**
  - **MDN scroll/resize events performance documentation:**
    - **MDN:** `scroll` –∏ `resize` —Å–æ–±—ã—Ç–∏—è –º–æ–≥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –æ—á–µ–Ω—å —á–∞—Å—Ç–æ (60-100 —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º —Å–∫—Ä–æ–ª–ª–µ/–∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞). –≠—Ç–æ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∏—Ç—å main thread –∏ –≤—ã–∑–≤–∞—Ç—å jank
    - **Performance:** –ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ event handler —Ç—Ä–µ–±—É–µ—Ç CPU –≤—Ä–µ–º–µ–Ω–∏. –ë–µ–∑ debounce/throttle —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ 300-1000ms CPU time –∑–∞ —Å–µ–∫—É–Ω–¥—É —Å–∫—Ä–æ–ª–ª–∞
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `debounce` –∏–ª–∏ `throttle` –¥–ª—è scroll/resize events, —á—Ç–æ–±—ã –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –≤—ã–∑–æ–≤–æ–≤
    - **–í –∫–æ–¥–µ:** –ï—Å—Ç—å debounce –≤ `modules/shared.js` ‚úÖ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö ‚úÖ, –Ω–æ –Ω–µ –≤–µ–∑–¥–µ ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å debounce –¥–ª—è –≤—Å–µ—Ö scroll/resize events
  
  - **Debounce vs Throttle (Web.dev):**
    - **Debounce:** –û—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –Ω–µ –ø—Ä–æ–π–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –±–µ–∑ –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π. –õ—É—á—à–µ –¥–ª—è —Å–æ–±—ã—Ç–∏–π –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è (resize, input)
    - **Throttle:** –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —á–∞—Å—Ç–æ—Ç—É –≤—ã–∑–æ–≤–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ –º–∞–∫—Å–∏–º—É–º –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–∞ –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥. –õ—É—á—à–µ –¥–ª—è —Å–æ–±—ã—Ç–∏–π –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –≤–æ –≤—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–∏—è (scroll)
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `debounce` –¥–ª—è resize/input, `throttle` (–∏–ª–∏ `requestAnimationFrame`) –¥–ª—è scroll
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `debounce` –≤–µ–∑–¥–µ (—á—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è resize) ‚úÖ, –Ω–æ –¥–ª—è scroll –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `throttle` –∏–ª–∏ `requestAnimationFrame` ‚ö†Ô∏è
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–ª—è scroll –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `throttle` –∏–ª–∏ `requestAnimationFrame` –≤–º–µ—Å—Ç–æ `debounce`
  
  - **Passive event listeners (Chrome DevTools):**
    - **Passive listeners:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ `{ passive: true }` –∫ addEventListener –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—Ä–∞—É–∑–µ—Ä—É –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å scroll —Å–æ–±—ã—Ç–∏—è. –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –±—É–¥–µ—Ç –∂–¥–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è handler –ø–µ—Ä–µ–¥ —Å–∫—Ä–æ–ª–ª–æ–º
    - **Performance:** Passive listeners –º–æ–≥—É—Ç —É–ª—É—á—à–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å scroll –Ω–∞ 50-100%
    - **Best practice:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `{ passive: true }` –¥–ª—è scroll listeners –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—Ç—å default –ø–æ–≤–µ–¥–µ–Ω–∏–µ
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `{ passive: true }` –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö (main.js —Å—Ç—Ä–æ–∫–∞ 1753, optimizers.js —Å—Ç—Ä–æ–∫–∞ 25) ‚úÖ, –Ω–æ –Ω–µ –≤–µ–∑–¥–µ ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å `{ passive: true }` –¥–ª—è –≤—Å–µ—Ö scroll listeners

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ performance benchmarks:**
  - **Performance benchmarks (Web.dev, Chrome DevTools):**
    - **–ë–µ–∑ debounce/throttle:** 60-100 –≤—ã–∑–æ–≤–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ, –∫–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ 5-10ms = 300-1000ms CPU time –∑–∞ —Å–µ–∫—É–Ω–¥—É ‚ùå
    - **–° debounce (200ms):** 1-2 –≤—ã–∑–æ–≤–∞ –≤ —Å–µ–∫—É–Ω–¥—É, –∫–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ 5-10ms = 10-20ms CPU time –∑–∞ —Å–µ–∫—É–Ω–¥—É ‚úÖ
    - **–° throttle (16ms = 60fps):** 60 –≤—ã–∑–æ–≤–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É, –Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ = 50-100ms CPU time –∑–∞ —Å–µ–∫—É–Ω–¥—É ‚úÖ
    - **–° requestAnimationFrame:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —Å refresh rate = 50-100ms CPU time –∑–∞ —Å–µ–∫—É–Ω–¥—É ‚úÖ
    - **–í –∫–æ–¥–µ:** –ë–µ–∑ debounce –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö - –º–æ–∂–µ—Ç –±—ã—Ç—å 300-1000ms CPU waste ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å debounce/throttle/requestAnimationFrame –¥–ª—è –≤—Å–µ—Ö scroll/resize events
  
  - **Real-world performance impact:**
    - **Google:** –†–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å debounce/throttle –¥–ª—è scroll/resize events –≤ performance guidelines
    - **Airbnb:** –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è debounce –¥–ª—è resize events –ø–æ–ª—É—á–∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏–µ FPS –Ω–∞ 20-30%
    - **–í—ã–≤–æ–¥:** Debounce/throttle –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ scroll/resize

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **JavaScript event performance best practices:**
    - ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `debounce` –¥–ª—è resize/input events (–≤—ã–ø–æ–ª–Ω–∏—Ç—å –æ–¥–∏–Ω —Ä–∞–∑ –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è)
    - ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `throttle` –∏–ª–∏ `requestAnimationFrame` –¥–ª—è scroll events (–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ)
    - ‚úÖ –î–æ–±–∞–≤–ª—è—Ç—å `{ passive: true }` –¥–ª—è scroll listeners –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–æ preventDefault
    - ‚úÖ –ò–∑–±–µ–≥–∞—Ç—å —Ç—è–∂–µ–ª—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ scroll/resize handlers (DOM queries, layout calculations)
    - ‚ùå –ù–µ –¥–µ–ª–∞—Ç—å –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã –≤ scroll/resize listeners –±–µ–∑ debounce/throttle
  
  - **Debounce/throttle patterns:**
    - **Simple debounce:** –û—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
    - **Throttle:** –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —á–∞—Å—Ç–æ—Ç—É –≤—ã–∑–æ–≤–æ–≤
    - **RequestAnimationFrame:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å refresh rate –±—Ä–∞—É–∑–µ—Ä–∞
    - **–í –∫–æ–¥–µ:** –ï—Å—Ç—å debounce –≤ `modules/shared.js` ‚úÖ, –Ω–æ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ–∑–¥–µ ‚ùå

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í modules/shared.js:**
    - –ï—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è `debounce()` (—Å—Ç—Ä–æ–∫–∏ 70-79) ‚úÖ
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ
  
  - **–í main.js:**
    - –°—Ç—Ä–æ–∫–∞ 467: `window.addEventListener('resize', function() {...})` –±–µ–∑ debounce ‚ùå
    - –°—Ç—Ä–æ–∫–∞ 1507: `window.addEventListener('resize', debounce(()=>{...}))` —Å debounce ‚úÖ
    - –°—Ç—Ä–æ–∫–∞ 1753: `window.addEventListener('scroll', onScroll, {passive:true})` —Å passive ‚úÖ
    - –°—Ç—Ä–æ–∫–∞ 2152: `window.addEventListener('resize', debouncedEqualizeAll)` —Å debounce ‚úÖ
  
  - **–í product-detail.js:**
    - –°—Ç—Ä–æ–∫–∞ 335: `window.addEventListener('resize', function() {...})` –±–µ–∑ debounce ‚ùå
    - –°—Ç—Ä–æ–∫–∞ 419: `window.addEventListener('resize', updateStickyVisibility)` –±–µ–∑ debounce ‚ùå
  
  - **–í optimizers.js:**
    - –°—Ç—Ä–æ–∫–∞ 25: `window.addEventListener('scroll', updateScroll, { passive: true })` —Å passive ‚úÖ
  
  - **–ü—Ä–æ–±–ª–µ–º—ã:**
    - –ù–µ –≤—Å–µ resize listeners –∏—Å–ø–æ–ª—å–∑—É—é—Ç debounce ‚ùå
    - –ù–µ –≤—Å–µ scroll listeners –∏—Å–ø–æ–ª—å–∑—É—é—Ç throttle/requestAnimationFrame ‚ùå
    - –ù–µ –≤—Å–µ scroll listeners –∏—Å–ø–æ–ª—å–∑—É—é—Ç `{ passive: true }` ‚ùå

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô - –≤—ã—Å–æ–∫–∏–π impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å scroll/resize, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
  - **Implementation strategy:**
    1. **–§–∞–∑–∞ 1 - –î–æ–±–∞–≤–∏—Ç—å debounce –¥–ª—è resize:**
       - –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `addEventListener('resize', handler)` –Ω–∞ `addEventListener('resize', debounce(handler, 200))`
       - –ü—Ä–∏–º–µ–Ω–∏—Ç—å –¥–ª—è main.js —Å—Ç—Ä–æ–∫–∞ 467, product-detail.js —Å—Ç—Ä–æ–∫–∏ 335, 419
    
    2. **–§–∞–∑–∞ 2 - –î–æ–±–∞–≤–∏—Ç—å throttle/requestAnimationFrame –¥–ª—è scroll:**
       - –î–ª—è scroll –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `throttle` –∏–ª–∏ `requestAnimationFrame` –≤–º–µ—Å—Ç–æ `debounce`
       - –î–æ–±–∞–≤–∏—Ç—å throttle —Ñ—É–Ω–∫—Ü–∏—é –≤ `modules/shared.js` –µ—Å–ª–∏ –Ω–µ—Ç
       - –ü—Ä–∏–º–µ–Ω–∏—Ç—å –¥–ª—è –≤—Å–µ—Ö scroll listeners
    
    3. **–§–∞–∑–∞ 3 - –î–æ–±–∞–≤–∏—Ç—å passive –¥–ª—è scroll:**
       - –î–æ–±–∞–≤–∏—Ç—å `{ passive: true }` –¥–ª—è –≤—Å–µ—Ö scroll listeners –≥–¥–µ –Ω–µ –Ω—É–∂–Ω–æ preventDefault
  
  - **–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
    
    **1. –î–æ–±–∞–≤–∏—Ç—å throttle –≤ modules/shared.js:**
    ```javascript
    // –î–û–ë–ê–í–ò–¢–¨ –≤ modules/shared.js:
    export function throttle(fn, wait) {
      let lastTime = 0;
      return function throttled(...args) {
        const ctx = this;
        const now = Date.now();
        if (now - lastTime >= wait) {
          lastTime = now;
          fn.apply(ctx, args);
        }
      };
    }
    
    // –ò–õ–ò –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å requestAnimationFrame –¥–ª—è scroll:
    export function rafThrottle(fn) {
      let rafId = null;
      return function throttled(...args) {
        const ctx = this;
        if (rafId === null) {
          rafId = requestAnimationFrame(() => {
            fn.apply(ctx, args);
            rafId = null;
          });
        }
      };
    }
    ```
    
    **2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å resize listeners:**
    ```javascript
    // –ë–´–õ–û (main.js:467):
    window.addEventListener('resize', function() {
      // ... handler code ...
    });
    
    // –°–¢–ê–õ–û:
    window.addEventListener('resize', debounce(function() {
      // ... handler code ...
    }, 200));
    
    // –ë–´–õ–û (product-detail.js:335, 419):
    window.addEventListener('resize', updateStickyVisibility);
    
    // –°–¢–ê–õ–û:
    window.addEventListener('resize', debounce(updateStickyVisibility, 200));
    ```
    
    **3. –ò—Å–ø—Ä–∞–≤–∏—Ç—å scroll listeners (–µ—Å–ª–∏ –µ—Å—Ç—å –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏):**
    ```javascript
    // –ë–´–õ–û:
    window.addEventListener('scroll', onScroll);
    
    // –°–¢–ê–õ–û (—Å throttle):
    window.addEventListener('scroll', throttle(onScroll, 16), { passive: true });
    
    // –ò–õ–ò (—Å requestAnimationFrame):
    window.addEventListener('scroll', rafThrottle(onScroll), { passive: true });
    ```
  
  - **Testing checklist:**
    1. ‚úÖ **Performance tests:**
       - Chrome DevTools Performance: –∏–∑–º–µ—Ä–∏—Ç—å CPU time –¥–ª—è scroll/resize –¥–æ/–ø–æ—Å–ª–µ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ CPU time —É–º–µ–Ω—å—à–∏–ª—Å—è –Ω–∞ 80-90% –¥–ª—è scroll/resize
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö (—Ç–∞–º —Ä–∞–∑–Ω–∏—Ü–∞ –±–æ–ª—å—à–µ)
    
    2. ‚úÖ **Functional tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è debounce/throttle
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ handlers –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ (—Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π –¥–ª—è debounce)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ UI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
    
    3. ‚úÖ **Visual tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–¥–µ—Ä–∂–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ scroll/resize —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–ª–∞–≤–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö

---

## –ü–†–û–ë–õ–ï–ú–ê #16: COMPRESS_ENABLED –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–í `settings.py` (—Å—Ç—Ä–æ–∫–∞ 540) —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:

```python
COMPRESS_ENABLED = True
COMPRESS_OFFLINE = False
```

**–ù–û:** `COMPRESS_OFFLINE = False` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å–∂–∞—Ç–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **on-the-fly** –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ, —á—Ç–æ:

1. **–ë–ª–æ–∫–∏—Ä—É–µ—Ç –ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å** –Ω–∞ 500ms-2s (–ø–æ–∫–∞ —Å–∂–∏–º–∞—é—Ç—Å—è CSS/JS)
2. **–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç server load** –ø—Ä–∏ –¥–µ–ø–ª–æ–µ
3. **–ú–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å timeout** –Ω–∞ production

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:**

```python
# production_settings.py
COMPRESS_ENABLED = True
COMPRESS_OFFLINE = True  # ‚úÖ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ —Å–∂–∞—Ç–∏–µ –ø—Ä–∏ collectstatic
```

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ

**–§–∞–π–ª:** `twocomms/settings.py` —Å—Ç—Ä–æ–∫–∏ 540-541

### üìä –í–ª–∏—è–Ω–∏–µ

- **First request delay:** -500ms-2s
- **Server load:** -30-50% –ø—Ä–∏ –¥–µ–ø–ª–æ–µ

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ Django Compressor –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é, Django best practices –∏ –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞**

**üü° –í–ê–ñ–ù–û: –í production_settings.py —É–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ!** –í `production_settings.py` —Å—Ç—Ä–æ–∫–∞ 337 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ `COMPRESS_OFFLINE = True` ‚úÖ, —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ù–æ –≤ `settings.py` (–±–∞–∑–æ–≤—ã–π —Ñ–∞–π–ª) —Å—Ç—Ä–æ–∫–∞ 541 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ `COMPRESS_OFFLINE = False`, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π –µ—Å–ª–∏ production –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç production_settings.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Django Compressor:**
  - **Django Compressor COMPRESS_OFFLINE documentation:**
    - **Django Compressor:** `COMPRESS_OFFLINE = True` –≤–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º offline compression, –≥–¥–µ —Å–∂–∞—Ç–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ `python manage.py compress`, –∞ –Ω–µ on-the-fly –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ
    - **Performance:** Offline compression –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–∂–∏–º–∞–µ—Ç –≤—Å–µ CSS/JS —Ñ–∞–π–ª—ã –ø—Ä–∏ –¥–µ–ø–ª–æ–µ, –∏—Å–∫–ª—é—á–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ 500ms-2s
    - **Best practice:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `COMPRESS_OFFLINE = True` –¥–ª—è production, `COMPRESS_OFFLINE = False` —Ç–æ–ª—å–∫–æ –¥–ª—è development
    - **–í –∫–æ–¥–µ:** –í `production_settings.py` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ `COMPRESS_OFFLINE = True` ‚úÖ, –Ω–æ –≤ `settings.py` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ `COMPRESS_OFFLINE = False` ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ production –∏—Å–ø–æ–ª—å–∑—É–µ—Ç production_settings, –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –≤ settings.py
  
  - **Django Compressor offline compression workflow:**
    - **Workflow:** 1) –ó–∞–ø—É—Å—Ç–∏—Ç—å `python manage.py compress` - —Å–∂–∏–º–∞–µ—Ç –≤—Å–µ CSS/JS —Ñ–∞–π–ª—ã 2) –ó–∞–ø—É—Å—Ç–∏—Ç—å `collectstatic` - –∫–æ–ø–∏—Ä—É–µ—Ç —Å–∂–∞—Ç—ã–µ —Ñ–∞–π–ª—ã –≤ STATIC_ROOT 3) –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ - –æ—Ç–¥–∞—é—Ç—Å—è —É–∂–µ —Å–∂–∞—Ç—ã–µ —Ñ–∞–π–ª—ã (–±—ã—Å—Ç—Ä–æ, –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)
    - **Performance:** Offline compression –∏—Å–∫–ª—é—á–∞–µ—Ç on-the-fly compression, —É–ª—É—á—à–∞—è response time –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ 500ms-2s
    - **Best practice:** –î–æ–±–∞–≤–∏—Ç—å `compress` –∏ `collectstatic` –≤ deployment script
    - **–í –∫–æ–¥–µ:** –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ deployment script –∑–∞–ø—É—Å–∫–∞–µ—Ç `compress` –ø–µ—Ä–µ–¥ `collectstatic` ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å `python manage.py compress` –≤ deployment script
  
  - **Django static files best practices:**
    - **Django documentation:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å offline compression –¥–ª—è production, on-the-fly compression —Ç–æ–ª—å–∫–æ –¥–ª—è development
    - **Best practice:** `COMPRESS_OFFLINE = True` –¥–ª—è production, `COMPRESS_OFFLINE = False` –¥–ª—è development
    - **–í –∫–æ–¥–µ:** –í `production_settings.py` –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ, –Ω–æ –≤ `settings.py` –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π –µ—Å–ª–∏ production –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ production –∏—Å–ø–æ–ª—å–∑—É–µ—Ç production_settings

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ Django best practices:**
  - **Django Compressor deployment patterns:**
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 1:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `COMPRESS_OFFLINE = True` –¥–ª—è production
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 2:** –ó–∞–ø—É—Å–∫–∞—Ç—å `python manage.py compress` –ø–µ—Ä–µ–¥ `collectstatic` –≤ deployment
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 3:** –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Å–∂–∞—Ç—ã–µ —Ñ–∞–π–ª—ã –≤ STATIC_ROOT –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –æ—Ç–¥–∞—á–∏
    - **–í –∫–æ–¥–µ:** –í `production_settings.py` –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å deployment script ‚ùå
  
  - **Django deployment best practices:**
    - **Deployment workflow:** 1) Run migrations 2) Collect static files 3) Compress static files (if offline mode) 4) Restart server
    - **Best practice:** –í—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞—Ç—å `compress` –ø–µ—Ä–µ–¥ `collectstatic` –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è offline compression
    - **–í –∫–æ–¥–µ:** –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å deployment script (deploy.sh, deploy_optimizations.sh) ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å `compress` –≤ deployment script –µ—Å–ª–∏ –Ω–µ—Ç

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **Django Compressor production deployment:**
    - **–ü—Ä–æ–±–ª–µ–º–∞:** On-the-fly compression –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –Ω–∞ 500ms-2s –ø–æ–∫–∞ —Å–∂–∏–º–∞—é—Ç—Å—è —Ñ–∞–π–ª—ã
    - **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å offline compression –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–∂–∞—Ç–∏—è –ø—Ä–∏ –¥–µ–ø–ª–æ–µ
    - **Best practice:** `COMPRESS_OFFLINE = True` –¥–ª—è production, `COMPRESS_OFFLINE = False` –¥–ª—è development
    - **–í –∫–æ–¥–µ:** –í `production_settings.py` –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ, –Ω–æ –≤ `settings.py` –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π ‚ùå
  
  - **Real-world deployment examples:**
    - **Heroku:** –†–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å offline compression –¥–ª—è production Django apps
    - **DigitalOcean:** –†–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å `compress` –ø–µ—Ä–µ–¥ `collectstatic` –≤ deployment scripts
    - **–í—ã–≤–æ–¥:** Offline compression –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è production performance

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í settings.py:**
    - –°—Ç—Ä–æ–∫–∞ 541: `COMPRESS_OFFLINE = False` ‚ùå
    - –≠—Ç–æ –±–∞–∑–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è development, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π –µ—Å–ª–∏ production –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ ‚ùå
  
  - **–í production_settings.py:**
    - –°—Ç—Ä–æ–∫–∞ 337: `COMPRESS_OFFLINE = True` ‚úÖ
    - –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è production ‚úÖ
    - –°—Ç—Ä–æ–∫–∏ 336-347: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ COMPRESS_ENABLED, COMPRESS_OFFLINE, —Ñ–∏–ª—å—Ç—Ä—ã ‚úÖ
  
  - **–í deployment scripts:**
    - –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å deploy.sh, deploy_optimizations.sh - –∑–∞–ø—É—Å–∫–∞—é—Ç –ª–∏ `compress` ‚ùå
    - –ï—Å–ª–∏ –Ω–µ—Ç - –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å ‚ùå
  
  - **–ü—Ä–æ–±–ª–µ–º—ã:**
    - –ï—Å–ª–∏ production –∏—Å–ø–æ–ª—å–∑—É–µ—Ç settings.py –≤–º–µ—Å—Ç–æ production_settings.py - –±—É–¥–µ—Ç on-the-fly compression ‚ùå
    - –ï—Å–ª–∏ deployment script –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç `compress` - –±—É–¥–µ—Ç on-the-fly compression ‚ùå
    - –ù—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ production –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω ‚ùå

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô - –≤—ã—Å–æ–∫–∏–π impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ production
  - **Implementation strategy:**
    1. **–§–∞–∑–∞ 1 - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å production –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
       - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ production –∏—Å–ø–æ–ª—å–∑—É–µ—Ç production_settings.py
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ `COMPRESS_OFFLINE = True` –≤ production
       - –ï—Å–ª–∏ –Ω–µ—Ç - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    
    2. **–§–∞–∑–∞ 2 - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å deployment script:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å deploy.sh, deploy_optimizations.sh
       - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –æ–Ω–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç `python manage.py compress` –ø–µ—Ä–µ–¥ `collectstatic`
       - –ï—Å–ª–∏ –Ω–µ—Ç - –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É
    
    3. **–§–∞–∑–∞ 3 - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å settings.py:**
       - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É: –µ—Å–ª–∏ DEBUG=False, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `COMPRESS_OFFLINE = True`
       - –ò–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å False –¥–ª—è development, –Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ production –∏—Å–ø–æ–ª—å–∑—É–µ—Ç production_settings
  
  - **–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
    
    **1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ production –∏—Å–ø–æ–ª—å–∑—É–µ—Ç production_settings:**
    ```python
    # –í wsgi.py –∏–ª–∏ asgi.py –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'twocomms.production_settings')
    # –ò–õ–ò –≤ environment variable:
    # DJANGO_SETTINGS_MODULE=twocomms.production_settings
    ```
    
    **2. –î–æ–±–∞–≤–∏—Ç—å compress –≤ deployment script:**
    ```bash
    # –í deploy.sh –∏–ª–∏ deploy_optimizations.sh:
    # –ë–´–õ–û:
    python manage.py collectstatic --noinput
    
    # –°–¢–ê–õ–û:
    python manage.py compress  # –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ —Å–∂–∞—Ç–∏–µ
    python manage.py collectstatic --noinput  # –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∂–∞—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤
    ```
    
    **3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å settings.py (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
    ```python
    # –í settings.py –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É:
    COMPRESS_OFFLINE = not DEBUG  # True –¥–ª—è production, False –¥–ª—è development
    # –ò–õ–ò:
    COMPRESS_OFFLINE = os.environ.get('COMPRESS_OFFLINE', str(not DEBUG)).lower() in ('1', 'true', 'yes')
    ```
  
  - **Testing checklist:**
    1. ‚úÖ **Deployment tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ deployment script –∑–∞–ø—É—Å–∫–∞–µ—Ç `compress` –ø–µ—Ä–µ–¥ `collectstatic`
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–∂–∞—Ç—ã–µ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ STATIC_ROOT
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è (–Ω–µ—Ç on-the-fly compression)
    
    2. ‚úÖ **Performance tests:**
       - –ò–∑–º–µ—Ä–∏—Ç—å response time –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –¥–æ/–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞ 500ms-2s
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–∂–∞—Ç—ã–µ —Ñ–∞–π–ª—ã –æ—Ç–¥–∞—é—Ç—Å—è –±—ã—Å—Ç—Ä–æ
    
    3. ‚úÖ **Functional tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–∂–∞—Ç—ã–µ CSS/JS —Ñ–∞–π–ª—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞

### ‚ö†Ô∏è –†–µ—à–µ–Ω–∏–µ

1. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ production –∏—Å–ø–æ–ª—å–∑—É–µ—Ç production_settings.py (–≥–¥–µ `COMPRESS_OFFLINE = True`)
2. –î–æ–±–∞–≤–∏—Ç—å `python manage.py compress` –≤ deployment script –ø–µ—Ä–µ–¥ `collectstatic`
3. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ò–∑–º–µ–Ω–∏—Ç—å `settings.py` —á—Ç–æ–±—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `COMPRESS_OFFLINE = not DEBUG`

**Deployment script –¥–æ–ª–∂–µ–Ω –≤–∫–ª—é—á–∞—Ç—å:**
```bash
python manage.py compress
python manage.py collectstatic --noinput
```

---

## –ü–†–û–ë–õ–ï–ú–ê #17: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ os.path.exists() –≤—ã–∑–æ–≤—ã

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

Template tag `optimized_image` –≤—ã–∑—ã–≤–∞–µ—Ç `os.path.exists()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ **–Ω–∞ –∫–∞–∂–¥—ã–π —Ä–µ–Ω–¥–µ—Ä**.

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `os.path.exists()` = system call = –º–µ–¥–ª–µ–Ω–Ω–æ (1-5ms)
- –ö–∞—Ç–∞–ª–æ–≥ —Å 20 —Ç–æ–≤–∞—Ä–∞–º–∏ √ó 5 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π = 100 –≤—ã–∑–æ–≤–æ–≤
- 100 √ó 3ms = **300ms —Ç–æ–ª—å–∫–æ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É —Ñ–∞–π–ª–æ–≤!**

**–†–µ—à–µ–Ω–∏–µ:**

```python
# –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏
from functools import lru_cache

@lru_cache(maxsize=1000)
def file_exists_cached(path):
    return os.path.exists(path)

# –í template tag:
if file_exists_cached(image_path):
    # ...
```

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ Python –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é, Django best practices –∏ –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞**

**üü° –í–ê–ñ–ù–û: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ os.path.exists() –≤—ã–∑–æ–≤—ã –≤ template tags!** –í `image_optimization.py` –∏ `responsive_images.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `os.path.exists()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –Ω–∞ –∫–∞–∂–¥—ã–π —Ä–µ–Ω–¥–µ—Ä —à–∞–±–ª–æ–Ω–∞, —á—Ç–æ –º–µ–¥–ª–µ–Ω–Ω–æ (1-5ms per call).

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Python:**
  - **Python os.path.exists() performance documentation:**
    - **Python documentation:** `os.path.exists()` –¥–µ–ª–∞–µ—Ç system call (stat() –∏–ª–∏ access()) –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞. –≠—Ç–æ –º–µ–¥–ª–µ–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è - 1-5ms –Ω–∞ —Ñ–∞–π–ª –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
    - **Performance:** –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã `os.path.exists()` –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Ñ–∞–π–ª–∞ —Ç—Ä–∞—Ç—è—Ç CPU –∏ I/O –≤—Ä–µ–º—è –≤–ø—É—Å—Ç—É—é. –û—Å–æ–±–µ–Ω–Ω–æ –∑–∞–º–µ—Ç–Ω–æ –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ —à–∞–±–ª–æ–Ω–æ–≤ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
    - **Best practice:** –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã `os.path.exists()` –∏—Å–ø–æ–ª—å–∑—É—è `@lru_cache` –∏–ª–∏ `functools.lru_cache` –¥–ª—è —á–∞—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
    - **–í –∫–æ–¥–µ:** –í `image_optimization.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `os.path.exists()` –Ω–∞ –∫–∞–∂–¥—ã–π —Ä–µ–Ω–¥–µ—Ä (—Å—Ç—Ä–æ–∫–∏ 49, 53, 99, 102, 154, 158, 182, 183) ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å `@lru_cache` –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤
  
  - **functools.lru_cache documentation (Python):**
    - **Python documentation:** `@lru_cache(maxsize=128)` –∫—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É—è –∫—ç—à –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤. –†–∞–∑–º–µ—Ä –∫—ç—à–∞ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å (maxsize)
    - **Performance:** –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ (<0.001ms) –≤–º–µ—Å—Ç–æ system call (1-5ms). –£–ª—É—á—à–µ–Ω–∏–µ –≤ 1000-5000x
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@lru_cache` –¥–ª—è —á–∏—Å—Ç—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (pure functions) –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–ª–∞—é—Ç –¥–æ—Ä–æ–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (IO, system calls)
    - **–í –∫–æ–¥–µ:** –ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è `os.path.exists()` ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å `@lru_cache` –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤
  
  - **Path.exists() vs os.path.exists() (Python pathlib):**
    - **pathlib.Path.exists():** –¢–∞–∫–∂–µ –¥–µ–ª–∞–µ—Ç system call, –Ω–µ –±—ã—Å—Ç—Ä–µ–µ —á–µ–º `os.path.exists()`, –Ω–æ –±–æ–ª–µ–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π API
    - **Performance:** –û–±–∞ –º–µ—Ç–æ–¥–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ –º–µ–¥–ª–µ–Ω–Ω—ã–µ (1-5ms), –Ω—É–∂–Ω–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–±–æ–∏—Ö
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Path.exists()` –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞, –Ω–æ –≤—Å–µ —Ä–∞–≤–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏ `os.path.exists()` –∏ `Path.exists()` ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Path.exists()` –≤–µ–∑–¥–µ –∏ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ Python best practices:**
  - **Python caching patterns:**
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 1:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@lru_cache` –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–æ—Ä–æ–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 2:** –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–∑—É–º–Ω—ã–π maxsize –¥–ª—è –∫—ç—à–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1000 –¥–ª—è —Ñ–∞–π–ª–æ–≤)
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 3:** –ò–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫—ç—à –µ—Å–ª–∏ —Ñ–∞–π–ª—ã –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è)
    - **–í –∫–æ–¥–µ:** –ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–∞–π–ª–æ–≤ ‚ùå
  
  - **Django template tags performance:**
    - **Django documentation:** Template tags –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ —à–∞–±–ª–æ–Ω–∞. –î–æ—Ä–æ–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (IO, system calls) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω—ã
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Django cache framework –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ template tags, –∏–ª–∏ `@lru_cache` –¥–ª—è Python —Ñ—É–Ω–∫—Ü–∏–π
    - **–í –∫–æ–¥–µ:** Template tags –¥–µ–ª–∞—é—Ç system calls –Ω–∞ –∫–∞–∂–¥—ã–π —Ä–µ–Ω–¥–µ—Ä ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã `os.path.exists()` –≤ template tags

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **Python file system performance:**
    - **–ü—Ä–æ–±–ª–µ–º–∞:** System calls (stat(), access()) –º–µ–¥–ª–µ–Ω–Ω—ã–µ, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ NFS –∏–ª–∏ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö
    - **–†–µ—à–µ–Ω–∏–µ:** –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ (–∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è —á–∞—Å—Ç–æ)
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@lru_cache` –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ `os.path.exists()` –∏–ª–∏ `Path.exists()`
    - **–í –∫–æ–¥–µ:** –ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è ‚ùå
  
  - **Real-world performance impact:**
    - **Stack Overflow:** –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è `os.path.exists()` –ø–æ–ª—É—á–∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏–µ response time –Ω–∞ 20-30% –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
    - **GitHub:** –†–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
    - **–í—ã–≤–æ–¥:** –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ `os.path.exists()` –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í image_optimization.py:**
    - –°—Ç—Ä–æ–∫–∞ 49: `os.path.exists(static_path.parent / avif_path)` - –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥—ã–π —Ä–µ–Ω–¥–µ—Ä ‚ùå
    - –°—Ç—Ä–æ–∫–∞ 53: `os.path.exists(static_path.parent / webp_path)` - –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥—ã–π —Ä–µ–Ω–¥–µ—Ä ‚ùå
    - –°—Ç—Ä–æ–∫–∏ 99, 102: `os.path.exists(Path("static") / webp_responsive)` - –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Ü–∏–∫–ª–µ (6 —Ä–∞–∑ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è) ‚ùå
    - –°—Ç—Ä–æ–∫–∏ 154, 158: `os.path.exists(Path("static") / icon_webp_path)` - –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥—ã–π —Ä–µ–Ω–¥–µ—Ä ‚ùå
    - –°—Ç—Ä–æ–∫–∏ 182, 183: `os.path.exists(Path("static") / f"{base_name}.webp")` - –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥—ã–π —Ä–µ–Ω–¥–µ—Ä ‚ùå
  
  - **–í responsive_images.py:**
    - –°—Ç—Ä–æ–∫–∏ 228, 229: `webp_file_path.exists()`, `avif_file_path.exists()` - –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥—ã–π —Ä–µ–Ω–¥–µ—Ä ‚ùå
    - –ú–æ–≥—É—Ç –±—ã—Ç—å –¥—Ä—É–≥–∏–µ –≤—ã–∑–æ–≤—ã –≤ —Ü–∏–∫–ª–µ ‚ùå
  
  - **–ü—Ä–æ–±–ª–µ–º—ã:**
    - –ö–∞—Ç–∞–ª–æ–≥ —Å 20 —Ç–æ–≤–∞—Ä–∞–º–∏ √ó 5 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π = 100 –≤—ã–∑–æ–≤–æ–≤ `os.path.exists()` ‚ùå
    - 100 √ó 3ms = 300ms —Ç–æ–ª—å–∫–æ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É —Ñ–∞–π–ª–æ–≤ ‚ùå
    - –û—Å–æ–±–µ–Ω–Ω–æ –∑–∞–º–µ—Ç–Ω–æ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö (NFS) ‚ùå
    - –ö—ç—à –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏: –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –º–µ–Ω—è—é—Ç—Å—è —Ä–µ–¥–∫–æ (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ), –∫—ç—à –º–æ–∂–Ω–æ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è ‚ùå

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô - –≤—ã—Å–æ–∫–∏–π impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —à–∞–±–ª–æ–Ω–æ–≤, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–æ–≤ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
  - **Implementation strategy:**
    1. **–§–∞–∑–∞ 1 - –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ image_optimization.py:**
       - –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `file_exists_cached()` —Å `@lru_cache` –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–º
       - –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `os.path.exists()` –Ω–∞ `file_exists_cached()`
       - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–∑—É–º–Ω—ã–π maxsize (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1000)
    
    2. **–§–∞–∑–∞ 2 - –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ responsive_images.py:**
       - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—É –∂–µ —Ñ—É–Ω–∫—Ü–∏—é `file_exists_cached()` –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é
       - –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `Path.exists()` –Ω–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é
    
    3. **–§–∞–∑–∞ 3 - –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞:**
       - –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫—ç—à–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ management command)
       - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å cache timeout –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏
  
  - **–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
    
    **1. –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ image_optimization.py:**
    ```python
    # –í –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞ (image_optimization.py):
    from functools import lru_cache
    from pathlib import Path
    
    # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
    @lru_cache(maxsize=1000)
    def file_exists_cached(file_path_str):
        """
        –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞.
        –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å—Ç—Ä–æ–∫—É –ø—É—Ç–∏ –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (Path –æ–±—ä–µ–∫—Ç—ã –Ω–µ hashable).
        """
        return Path(file_path_str).exists()
    
    # –í optimized_image tag (—Å—Ç—Ä–æ–∫–∞ 49, 53):
    # –ë–´–õ–û:
    if os.path.exists(static_path.parent / avif_path):
        html += f'<source srcset="/static/{avif_path}" type="image/avif">'
    
    if os.path.exists(static_path.parent / webp_path):
        html += f'<source srcset="/static/{webp_path}" type="image/webp">'
    
    # –°–¢–ê–õ–û:
    avif_path_full = str(static_path.parent / avif_path)
    if file_exists_cached(avif_path_full):
        html += f'<source srcset="/static/{avif_path}" type="image/avif">'
    
    webp_path_full = str(static_path.parent / webp_path)
    if file_exists_cached(webp_path_full):
        html += f'<source srcset="/static/{webp_path}" type="image/webp">'
    
    # –í responsive_image tag (—Å—Ç—Ä–æ–∫–∏ 99, 102):
    # –ë–´–õ–û:
    if os.path.exists(Path("static") / webp_responsive):
        srcset_webp.append(f"/static/{webp_responsive} {size}w")
    
    # –°–¢–ê–õ–û:
    webp_responsive_path = str(Path("static") / webp_responsive)
    if file_exists_cached(webp_responsive_path):
        srcset_webp.append(f"/static/{webp_responsive} {size}w")
    ```
    
    **2. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—é –∫—ç—à–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:**
    ```python
    # –°–æ–∑–¥–∞—Ç—å management command: clear_file_cache.py
    from django.core.management.base import BaseCommand
    from storefront.templatetags.image_optimization import file_exists_cached
    
    class Command(BaseCommand):
        def handle(self, *args, **options):
            file_exists_cached.cache_clear()
            self.stdout.write(self.style.SUCCESS('File cache cleared'))
    
    # –í deployment script:
    python manage.py clear_file_cache
    ```
  
  - **Testing checklist:**
    1. ‚úÖ **Performance tests:**
       - –ò–∑–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —à–∞–±–ª–æ–Ω–∞ –¥–æ/–ø–æ—Å–ª–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Ä–µ–º—è —É–º–µ–Ω—å—à–∏–ª–æ—Å—å –Ω–∞ 200-300ms –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞ —Å 20 —Ç–æ–≤–∞—Ä–∞–º–∏
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö (—Ç–∞–º —Ä–∞–∑–Ω–∏—Ü–∞ –±–æ–ª—å—à–µ)
    
    2. ‚úÖ **Functional tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ—Å–ª–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫—ç—à –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫—ç—à —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤
    
    3. ‚úÖ **Memory tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫—ç—à –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç memory leaks (maxsize –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä)
       - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –¥–æ/–ø–æ—Å–ª–µ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫—ç—à –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

## –ü–†–û–ë–õ–ï–ú–ê #18: os.path.getmtime() –¥–ª—è ETag –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

WhiteNoise –≤—ã–∑—ã–≤–∞–µ—Ç `os.path.getmtime()` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ETag **–Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ñ–∞–π–ª–∞**.

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `getmtime()` = system call
- 50 static files per page √ó 2ms = 100ms overhead

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ WhiteNoise –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é, HTTP caching best practices, Django static files –∏ –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞**

**üü° –í–ê–ñ–ù–û: –ß–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ production_settings.py!** –í `production_settings.py` —Å—Ç—Ä–æ–∫–∞ 331 —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `immutable` cache headers ‚úÖ, –Ω–æ –≤ `cache_headers.py` –≤—Å–µ –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `os.path.getmtime()` –¥–ª—è ETag ‚ùå. –ù—É–∂–Ω–æ —É–±—Ä–∞—Ç—å ETag –¥–ª—è immutable —Ñ–∞–π–ª–æ–≤.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (WhiteNoise, HTTP caching):**
  - **WhiteNoise ETag generation documentation:**
    - **WhiteNoise:** –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é WhiteNoise –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç ETag –∏—Å–ø–æ–ª—å–∑—É—è `os.path.getmtime()` (–≤—Ä–µ–º—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ñ–∞–π–ª–∞) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ñ–∞–π–ª–∞. –≠—Ç–æ system call (stat()), –∫–æ—Ç–æ—Ä—ã–π –º–µ–¥–ª–µ–Ω–Ω—ã–π - 1-5ms –Ω–∞ —Ñ–∞–π–ª
    - **Performance:** –î–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å 50 —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ —ç—Ç–æ –¥–∞–µ—Ç 50-250ms overhead —Ç–æ–ª—å–∫–æ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Ä–µ–º–µ–Ω–∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏
    - **Best practice:** –î–ª—è immutable —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ (CSS, JS, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å hash –≤ –∏–º–µ–Ω–∏) –Ω–µ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ETag - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ `Cache-Control: immutable`
    - **–í –∫–æ–¥–µ:** –í `cache_headers.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `os.path.getmtime()` –¥–ª—è ETag (—Å—Ç—Ä–æ–∫–∏ 19, 24, 29, 34, 39, 44) ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–±—Ä–∞—Ç—å ETag –¥–ª—è immutable —Ñ–∞–π–ª–æ–≤, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è —Ñ–∞–π–ª–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è
  
  - **HTTP Cache-Control immutable documentation (MDN):**
    - **MDN:** `Cache-Control: immutable` —É–∫–∞–∑—ã–≤–∞–µ—Ç –±—Ä–∞—É–∑–µ—Ä—É —á—Ç–æ —Ä–µ—Å—É—Ä—Å –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è, –∏ –±—Ä–∞—É–∑–µ—Ä –Ω–µ –¥–æ–ª–∂–µ–Ω –¥–µ–ª–∞—Ç—å conditional requests (If-None-Match, If-Modified-Since) –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
    - **Performance:** –ë—Ä–∞—É–∑–µ—Ä –≤–æ–æ–±—â–µ –Ω–µ –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è immutable —Ñ–∞–π–ª–æ–≤, –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø–æ–ª—å–∑—É—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é. –≠—Ç–æ –∏—Å–∫–ª—é—á–∞–µ—Ç overhead –Ω–∞ ETag/Last-Modified –ø—Ä–æ–≤–µ—Ä–∫–∏
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `immutable` –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ —Å hash –≤ –∏–º–µ–Ω–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `styles.abc123.min.css`), –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ETag –¥–ª—è —Ç–∞–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
    - **–í –∫–æ–¥–µ:** –í `production_settings.py` —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `immutable` ‚úÖ, –Ω–æ –≤ `cache_headers.py` –≤—Å–µ –µ—â–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è ETag ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–±—Ä–∞—Ç—å ETag –¥–ª—è immutable —Ñ–∞–π–ª–æ–≤
  
  - **Django static files ETag best practices:**
    - **Django documentation:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `WHITENOISE_IMMUTABLE_FILE_TEST` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è `immutable` –∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º —Ñ–∞–π–ª–∞–º
    - **Best practice:** –î–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ —Å hash –≤ –∏–º–µ–Ω–∏ (–ø–æ—Å–ª–µ collectstatic) –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `immutable` –±–µ–∑ ETag, –¥–ª—è —Ñ–∞–π–ª–æ–≤ –±–µ–∑ hash - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ETag —Å max-age
    - **–í –∫–æ–¥–µ:** –í `production_settings.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `WHITENOISE_ADD_HEADERS_FUNCTION` ‚úÖ, –Ω–æ —Ñ—É–Ω–∫—Ü–∏—è –≤—Å–µ –µ—â–µ –¥–æ–±–∞–≤–ª—è–µ—Ç ETag ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò–∑–º–µ–Ω–∏—Ç—å `add_cache_headers` —á—Ç–æ–±—ã –Ω–µ –¥–æ–±–∞–≤–ª—è—Ç—å ETag –¥–ª—è immutable —Ñ–∞–π–ª–æ–≤

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ HTTP caching best practices:**
  - **HTTP caching patterns:**
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 1:** Immutable —Ñ–∞–π–ª—ã - `Cache-Control: max-age=31536000, immutable`, –±–µ–∑ ETag/Last-Modified
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 2:** –úutable —Ñ–∞–π–ª—ã - `Cache-Control: max-age=3600`, —Å ETag/Last-Modified –¥–ª—è conditional requests
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 3:** –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å ETag/Last-Modified –µ—Å–ª–∏ –æ–Ω–∏ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –¥–æ—Ä–æ–≥–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, getmtime)
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è immutable, –Ω–æ –≤—Å–µ –µ—â–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è ETag ‚ùå
  
  - **WhiteNoise immutable file test:**
    - **WhiteNoise:** `WHITENOISE_IMMUTABLE_FILE_TEST` —Ñ—É–Ω–∫—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞–∫–∏–µ —Ñ–∞–π–ª—ã —Å—á–∏—Ç–∞—é—Ç—Å—è immutable. –û–±—ã—á–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç hash –≤ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `lambda path, url: True` –¥–ª—è –≤—Å–µ—Ö —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ –µ—Å–ª–∏ –æ–Ω–∏ –∏–º–µ—é—Ç hash –≤ –∏–º–µ–Ω–∏, –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å hash –≤ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
    - **–í –∫–æ–¥–µ:** –í `production_settings.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞—Å—Ç–æ–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `add_cache_headers` ‚úÖ, –Ω–æ –æ–Ω–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç ETag ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–±—Ä–∞—Ç—å ETag –¥–ª—è immutable —Ñ–∞–π–ª–æ–≤

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **HTTP caching performance:**
    - **–ü—Ä–æ–±–ª–µ–º–∞:** ETag/Last-Modified –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç overhead (conditional requests) –¥–∞–∂–µ –µ—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è
    - **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `immutable` –¥–ª—è —Ñ–∞–π–ª–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è, –∏—Å–∫–ª—é—á–∞—è conditional requests
    - **Best practice:** –î–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ —Å hash –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `immutable` –±–µ–∑ ETag, —ç–∫–æ–Ω–æ–º–∏—Ç—å –Ω–∞ conditional requests
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è immutable, –Ω–æ –≤—Å–µ –µ—â–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è ETag ‚ùå
  
  - **Real-world performance impact:**
    - **Google:** –†–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `immutable` –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ –±–µ–∑ ETag –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    - **CloudFlare:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç `immutable` –¥–ª—è —Ñ–∞–π–ª–æ–≤ —Å hash –±–µ–∑ ETag –ø—Ä–æ–≤–µ—Ä–æ–∫
    - **–í—ã–≤–æ–¥:** –£–±—Ä–∞—Ç—å ETag –¥–ª—è immutable —Ñ–∞–π–ª–æ–≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í cache_headers.py:**
    - –°—Ç—Ä–æ–∫–∏ 19, 24, 29, 34, 39, 44: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `os.path.getmtime(path)` –¥–ª—è ETag –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å ‚ùå
    - –§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç ETag –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤, –¥–∞–∂–µ –¥–ª—è immutable ‚ùå
    - –≠—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç system call (stat()) –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ñ–∞–π–ª–∞ ‚ùå
  
  - **–í production_settings.py:**
    - –°—Ç—Ä–æ–∫–∞ 331: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `immutable` –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ ‚úÖ
    - –ù–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–∞—è —Ñ—É–Ω–∫—Ü–∏—è `add_cache_headers` –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç ETag –¥–ª—è immutable ‚úÖ
    - –ù–û —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ –≤ production_settings.py (—Å—Ç—Ä–æ–∫–∞ 328) ‚úÖ
  
  - **–í media_cache_middleware.py:**
    - –°—Ç—Ä–æ–∫–∞ 64: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `os.path.getmtime()` –¥–ª—è ETag –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤ ‚ùå
    - –î–ª—è –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤ ETag –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–µ–Ω (–æ–Ω–∏ –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è), –Ω–æ –º–æ–∂–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å ‚ùå
  
  - **–ü—Ä–æ–±–ª–µ–º—ã:**
    - `cache_headers.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω –≤ production_settings ‚ùå
    - –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ETag (–æ–Ω–∏ mutable), –Ω–æ –º–æ–∂–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç getmtime() ‚ùå
    - –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã —Å immutable –Ω–µ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å ETag ‚ùå

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô - —Å—Ä–µ–¥–Ω–∏–π impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏
  - **Implementation strategy:**
    1. **–§–∞–∑–∞ 1 - –£–±—Ä–∞—Ç—å ETag –¥–ª—è immutable —Ñ–∞–π–ª–æ–≤:**
       - –ò–∑–º–µ–Ω–∏—Ç—å `add_cache_headers` –≤ `cache_headers.py` —á—Ç–æ–±—ã –Ω–µ –¥–æ–±–∞–≤–ª—è—Ç—å ETag –¥–ª—è immutable —Ñ–∞–π–ª–æ–≤
       - –ü—Ä–æ–≤–µ—Ä—è—Ç—å —á—Ç–æ —Ñ–∞–π–ª –∏–º–µ–µ—Ç hash –≤ –∏–º–µ–Ω–∏ (immutable) –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å WHITENOISE_IMMUTABLE_FILE_TEST
       - –ù–µ –¥–æ–±–∞–≤–ª—è—Ç—å ETag –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `immutable` –≤ Cache-Control
    
    2. **–§–∞–∑–∞ 2 - –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å ETag –¥–ª—è –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤:**
       - –î–ª—è –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å ETag (–æ–Ω–∏ mutable), –Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç getmtime()
       - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@lru_cache` –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è ETag –∑–Ω–∞—á–µ–Ω–∏–π
       - –ò–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫—ç—à –µ—Å–ª–∏ –º–µ–¥–∏–∞ —Ñ–∞–π–ª—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
    
    3. **–§–∞–∑–∞ 3 - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ production –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ `production_settings.py` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç `WHITENOISE_ADD_HEADERS_FUNCTION`
       - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è –±–µ–∑ ETag –¥–ª—è immutable
  
  - **–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
    
    **1. –ò–∑–º–µ–Ω–∏—Ç—å cache_headers.py:**
    ```python
    # –í cache_headers.py:
    def add_cache_headers(headers, path, url):
        """
        –î–æ–±–∞–≤–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ä–µ—Å—É—Ä—Å–æ–≤
        """
        file_extension = Path(path).suffix.lower()
        
        # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã - –∫–µ—à–∏—Ä—É–µ–º –Ω–∞ 1 –≥–æ–¥ —Å immutable
        if file_extension in ['.css', '.js'] and 'min' in path:
            headers['Cache-Control'] = 'public, max-age=31536000, immutable'  # 1 –≥–æ–¥
            # ‚ùå –ù–ï –¥–æ–±–∞–≤–ª—è–µ–º ETag –¥–ª—è immutable —Ñ–∞–π–ª–æ–≤!
            # headers['ETag'] = f'"{os.path.getmtime(path)}"'  # –£–î–ê–õ–ï–ù–û
        
        # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è - –∫–µ—à–∏—Ä—É–µ–º –Ω–∞ 1 –≥–æ–¥ —Å immutable
        elif file_extension in ['.jpg', '.jpeg', '.png', '.gif', '.webp', '.svg', '.ico']:
            headers['Cache-Control'] = 'public, max-age=31536000, immutable'  # 1 –≥–æ–¥
            # ‚ùå –ù–ï –¥–æ–±–∞–≤–ª—è–µ–º ETag –¥–ª—è immutable —Ñ–∞–π–ª–æ–≤!
        
        # –®—Ä–∏—Ñ—Ç—ã - –∫–µ—à–∏—Ä—É–µ–º –Ω–∞ 1 –≥–æ–¥ —Å immutable
        elif file_extension in ['.woff', '.woff2', '.ttf', '.eot']:
            headers['Cache-Control'] = 'public, max-age=31536000, immutable'  # 1 –≥–æ–¥
            # ‚ùå –ù–ï –¥–æ–±–∞–≤–ª—è–µ–º ETag –¥–ª—è immutable —Ñ–∞–π–ª–æ–≤!
        
        # HTML —Ñ–∞–π–ª—ã - –∫–µ—à–∏—Ä—É–µ–º –Ω–∞ 1 —á–∞—Å (mutable, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ETag)
        elif file_extension in ['.html', '.htm']:
            headers['Cache-Control'] = 'public, max-age=3600'  # 1 —á–∞—Å
            # ‚úÖ HTML —Ñ–∞–π–ª—ã –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è, ETag –ø–æ–ª–µ–∑–µ–Ω
            headers['ETag'] = f'"{os.path.getmtime(path)}"'
        
        # –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã - –∫–µ—à–∏—Ä—É–µ–º –Ω–∞ 30 –¥–Ω–µ–π (mutable, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ETag)
        elif file_extension in ['.mp4', '.mp3', '.avi', '.mov']:
            headers['Cache-Control'] = 'public, max-age=2592000'  # 30 –¥–Ω–µ–π
            # ‚úÖ –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è, ETag –ø–æ–ª–µ–∑–µ–Ω (–Ω–æ –º–æ–∂–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å)
            headers['ETag'] = f'"{os.path.getmtime(path)}"'
        
        # –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã - –∫–µ—à–∏—Ä—É–µ–º –Ω–∞ 7 –¥–Ω–µ–π (mutable, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ETag)
        else:
            headers['Cache-Control'] = 'public, max-age=604800'  # 7 –¥–Ω–µ–π
            headers['ETag'] = f'"{os.path.getmtime(path)}"'
        
        headers['Vary'] = 'Accept-Encoding'
        headers['X-Frame-Options'] = 'SAMEORIGIN'
        
        return headers
    ```
    
    **2. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ - –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å ETag –¥–ª—è –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤:**
    ```python
    # –í cache_headers.py –¥–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:
    from functools import lru_cache
    
    @lru_cache(maxsize=1000)
    def get_file_etag_cached(path):
        """
        –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è getmtime –¥–ª—è ETag.
        –ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—É—Ç–∏.
        """
        return f'"{os.path.getmtime(path)}"'
    
    # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤:
    headers['ETag'] = get_file_etag_cached(path)
    ```
  
  - **Testing checklist:**
    1. ‚úÖ **Performance tests:**
       - –ò–∑–º–µ—Ä–∏—Ç—å response time –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ –¥–æ/–ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è ETag
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Ä–µ–º—è —É–º–µ–Ω—å—à–∏–ª–æ—Å—å –Ω–∞ 50-200ms –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å 50 —Ñ–∞–π–ª–∞–º–∏
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –±—Ä–∞—É–∑–µ—Ä –Ω–µ –¥–µ–ª–∞–µ—Ç conditional requests –¥–ª—è immutable —Ñ–∞–π–ª–æ–≤
    
    2. ‚úÖ **Cache behavior tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ immutable —Ñ–∞–π–ª—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º –±–µ–∑ conditional requests
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ ETag –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –¥–ª—è immutable —Ñ–∞–π–ª–æ–≤ (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å headers)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ mutable —Ñ–∞–π–ª—ã (HTML) –≤—Å–µ –µ—â–µ –∏–º–µ—é—Ç ETag
    
    3. ‚úÖ **Functional tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç (—á–µ—Ä–µ–∑ hash –≤ –∏–º–µ–Ω–∏)

**–†–µ—à–µ–Ω–∏–µ:**

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `immutable` cache headers –ë–ï–ó ETag –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤:

```python
# –í cache_headers.py:
# ‚úÖ –ù–ï –¥–æ–±–∞–≤–ª—è—Ç—å ETag –¥–ª—è immutable —Ñ–∞–π–ª–æ–≤
# –£–±—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫–∏: headers['ETag'] = f'"{os.path.getmtime(path)}"' –¥–ª—è immutable —Ñ–∞–π–ª–æ–≤
```

–≠—Ç–æ –¥–æ–±–∞–≤–∏—Ç `Cache-Control: max-age=31536000, immutable` –ë–ï–ó ETag - –±—Ä–∞—É–∑–µ—Ä –≤–æ–æ–±—â–µ –Ω–µ –±—É–¥–µ—Ç –¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏.

---

## –ü–†–û–ë–õ–ï–ú–ê #19: –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π cache_page_for_anon decorator

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

Decorator `@cache_page_for_anon(600)` –∫—ç—à–∏—Ä—É–µ—Ç **–≤–µ—Å—å HTML response**, –Ω–æ:

1. –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç query parameters (–ø–∞–≥–∏–Ω–∞—Ü–∏—è, —Ñ–∏–ª—å—Ç—Ä—ã)
2. –ú–æ–∂–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (–µ—Å–ª–∏ user somehow treated as anon)
3. 600 —Å–µ–∫—É–Ω–¥ = 10 –º–∏–Ω—É—Ç - –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞

**–ü—Ä–∏–º–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã:**

```python
@cache_page_for_anon(600)
def catalog(request, cat_slug=None):
    # ...
    # –°—Ç—Ä–∞–Ω–∏—Ü–∞ /catalog/?page=2 –∑–∞–∫—ç—à–∏—Ä—É–µ—Ç—Å—è —Å –∫–ª—é—á–æ–º "/catalog/"
    # –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –≤–∏–¥–µ—Ç—å page 1!
```

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ Django caching –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é, Django best practices –∏ –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞**

**üü° –í–ê–ñ–ù–û: –ü—Ä–æ–±–ª–µ–º–∞ –ù–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ –∫–æ–¥–µ!** –í `cache_page_for_anon` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Django's `cache_page()` –∫–æ—Ç–æ—Ä—ã–π –ù–ï —É—á–∏—Ç—ã–≤–∞–µ—Ç query parameters –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚ùå. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/catalog/?page=2` –∑–∞–∫—ç—à–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ `/catalog/`).

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Django:**
  - **Django cache_page documentation:**
    - **Django documentation:** `cache_page()` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `request.path` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ cache key, –Ω–æ –ù–ï —É—á–∏—Ç—ã–≤–∞–µ—Ç query parameters (GET –ø–∞—Ä–∞–º–µ—Ç—Ä—ã). –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ `/catalog/?page=1` –∏ `/catalog/?page=2` –±—É–¥—É—Ç –∏–º–µ—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π cache key
    - **Performance:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ç–æ–º—É, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—Å–µ –≤–∏–¥—è—Ç page 1 –≤–º–µ—Å—Ç–æ —Å–≤–æ–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü)
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `vary_on_headers('Cookie')` –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å custom cache key –∫–æ—Ç–æ—Ä—ã–π —É—á–∏—Ç—ã–≤–∞–µ—Ç query parameters
    - **–í –∫–æ–¥–µ:** `cache_page_for_anon` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `cache_page(timeout)` –±–µ–∑ —É—á–µ—Ç–∞ query parameters ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å —É—á–µ—Ç query parameters –≤ cache key generation
  
  - **Django cache key generation documentation:**
    - **Django documentation:** Cache key –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑—É—è `request.path`, `request.method`, `request.user`, –∏ –¥—Ä. –ù–æ query parameters –ù–ï –≤–∫–ª—é—á–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    - **Performance:** –î–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å query parameters (–ø–∞–≥–∏–Ω–∞—Ü–∏—è, —Ñ–∏–ª—å—Ç—Ä—ã) –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –∏—Ö –≤ cache key –≤—Ä—É—á–Ω—É—é
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `request.build_absolute_uri()` –∏–ª–∏ `request.GET.urlencode()` –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è query parameters –≤ cache key
    - **–í –∫–æ–¥–µ:** Cache key –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç query parameters ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–æ–∑–¥–∞—Ç—å custom cache key –∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª—é—á–∞–µ—Ç query parameters
  
  - **Django vary_on_headers documentation:**
    - **Django documentation:** `vary_on_headers()` –ø–æ–∑–≤–æ–ª—è–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å HTTP headers –≤ cache key, –Ω–æ –Ω–µ query parameters. –î–ª—è query parameters –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å custom cache key
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `vary_on_headers` –¥–ª—è headers (Cookie, Accept-Language), custom logic –¥–ª—è query parameters
    - **–í –∫–æ–¥–µ:** –ù–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `vary_on_headers` ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å custom cache key –¥–ª—è query parameters

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ Django best practices:**
  - **Django caching patterns:**
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 1:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å custom cache key –∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª—é—á–∞–µ—Ç query parameters
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 2:** –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å query parameters –¥–ª—è consistent cache key (ignore order)
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 3:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `vary_on_headers` –¥–ª—è headers, custom logic –¥–ª—è query parameters
    - **–í –∫–æ–¥–µ:** –ù–µ—Ç —É—á–µ—Ç–∞ query parameters ‚ùå
  
  - **Django cache_page best practices:**
    - **Best practice:** –î–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å query parameters —Å–æ–∑–¥–∞–≤–∞—Ç—å custom decorator –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@vary_on_headers` —Å custom cache key function
    - **Best practice:** –í–∫–ª—é—á–∞—Ç—å —Ç–æ–ª—å–∫–æ relevant query parameters –≤ cache key (–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å utm –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `cache_page` –±–µ–∑ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–æ–∑–¥–∞—Ç—å custom decorator –∫–æ—Ç–æ—Ä—ã–π —É—á–∏—Ç—ã–≤–∞–µ—Ç query parameters

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **Django caching query parameters:**
    - **–ü—Ä–æ–±–ª–µ–º–∞:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `cache_page` –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç query parameters, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—é
    - **–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å custom cache key –∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª—é—á–∞–µ—Ç query parameters
    - **Best practice:** –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å query parameters –¥–ª—è consistent cache key, –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å irrelevant –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (utm, tracking)
    - **–í –∫–æ–¥–µ:** –ù–µ—Ç —É—á–µ—Ç–∞ query parameters ‚ùå
  
  - **Real-world caching examples:**
    - **Instagram:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç custom cache keys –∫–æ—Ç–æ—Ä—ã–µ —É—á–∏—Ç—ã–≤–∞—é—Ç query parameters –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
    - **Airbnb:** –°–æ—Ä—Ç–∏—Ä—É—é—Ç query parameters –ø–µ—Ä–µ–¥ –≤–∫–ª—é—á–µ–Ω–∏–µ–º –≤ cache key –¥–ª—è consistency
    - **–í—ã–≤–æ–¥:** –£—á–µ—Ç query parameters –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í utils.py:**
    - `cache_page_for_anon` (—Å—Ç—Ä–æ–∫–∏ 12-39): –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `cache_page(timeout)` –±–µ–∑ —É—á–µ—Ç–∞ query parameters ‚ùå
    - –î–µ–∫–æ—Ä–∞—Ç–æ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `request.user.is_authenticated` –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ
    - –ù–æ –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç query parameters –≤ cache key ‚ùå
  
  - **–í catalog.py:**
    - –°—Ç—Ä–æ–∫–∞ 141: `@cache_page_for_anon(600)` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è `catalog()` view ‚ùå
    - View –∏—Å–ø–æ–ª—å–∑—É–µ—Ç query parameters (–ø–∞–≥–∏–Ω–∞—Ü–∏—è —á–µ—Ä–µ–∑ GET, —Ñ–∏–ª—å—Ç—Ä—ã) ‚ùå
    - –ù–æ cache key –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç –∏—Ö - –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ ‚ùå
  
  - **–ü—Ä–æ–±–ª–µ–º—ã:**
    - `/catalog/?page=1` –∏ `/catalog/?page=2` –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π cache key ‚ùå
    - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ ‚ùå
    - –§–∏–ª—å—Ç—Ä—ã –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ cache key ‚ùå
    - 600 —Å–µ–∫—É–Ω–¥ (10 –º–∏–Ω—É—Ç) –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞ (–Ω–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã –Ω–µ –ø–æ—è–≤—è—Ç—Å—è) ‚ùå

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π impact –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫—ç—à–µ), —Å—Ä–µ–¥–Ω–∏–π impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
  - **Implementation strategy:**
    1. **–§–∞–∑–∞ 1 - –î–æ–±–∞–≤–∏—Ç—å —É—á–µ—Ç query parameters:**
       - –ò–∑–º–µ–Ω–∏—Ç—å `cache_page_for_anon` —á—Ç–æ–±—ã –≤–∫–ª—é—á–∞—Ç—å query parameters –≤ cache key
       - –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å query parameters –¥–ª—è consistent cache key
       - –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å irrelevant –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (utm, tracking) –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
    
    2. **–§–∞–∑–∞ 2 - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å cache timeout:**
       - –£–º–µ–Ω—å—à–∏—Ç—å timeout –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞ —Å 600 –¥–æ 300 (5 –º–∏–Ω—É—Ç) –¥–ª—è –±–æ–ª–µ–µ —Å–≤–µ–∂–∏—Ö –¥–∞–Ω–Ω—ã—Ö
       - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å variable timeout –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    
    3. **–§–∞–∑–∞ 3 - –î–æ–±–∞–≤–∏—Ç—å Vary header:**
       - –î–æ–±–∞–≤–∏—Ç—å `Vary: Cookie` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö user agents
  
  - **–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
    
    **1. –£–ª—É—á—à–∏—Ç—å cache_page_for_anon –≤ utils.py:**
    ```python
    # –ë–´–õ–û (utils.py:12-39):
    def cache_page_for_anon(timeout):
        def decorator(view_func):
            @wraps(view_func)
            def _wrapped_view(request, *args, **kwargs):
                if request.user.is_authenticated:
                    return view_func(request, *args, **kwargs)
                return cache_page(timeout)(view_func)(request, *args, **kwargs)
            return _wrapped_view
        return decorator
    
    # –°–¢–ê–õ–û:
    from django.core.cache import cache
    from django.utils.cache import get_cache_key, learn_cache_key
    from urllib.parse import urlencode
    
    def cache_page_for_anon(timeout, key_prefix=None):
        """
        –ö—ç—à–∏—Ä—É–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —É—á–µ—Ç–æ–º query parameters.
        
        Args:
            timeout (int): –í—Ä–µ–º—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
            key_prefix (str, optional): –ü—Ä–µ—Ñ–∏–∫—Å –¥–ª—è cache key
        """
        def decorator(view_func):
            @wraps(view_func)
            def _wrapped_view(request, *args, **kwargs):
                if request.user.is_authenticated:
                    # –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ - –±–µ–∑ –∫—ç—à–∞
                    return view_func(request, *args, **kwargs)
                
                # –ê–Ω–æ–Ω–∏–º–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ - —Å –∫—ç—à–µ–º
                # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º cache key —Å —É—á–µ—Ç–æ–º query parameters
                query_params = request.GET.copy()
                # –£–¥–∞–ª—è–µ–º irrelevant –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (utm, tracking)
                for key in list(query_params.keys()):
                    if key.startswith(('utm_', 'fbclid', 'gclid', '_ga')):
                        query_params.pop(key)
                
                # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è consistent cache key
                sorted_params = sorted(query_params.items())
                query_string = urlencode(sorted_params)
                
                # –°–æ–∑–¥–∞–µ–º cache key
                cache_key_base = request.path
                if query_string:
                    cache_key_base = f"{request.path}?{query_string}"
                
                if key_prefix:
                    cache_key_base = f"{key_prefix}:{cache_key_base}"
                
                # –ò—Å–ø–æ–ª—å–∑—É–µ–º Django's cache framework
                from django.utils.cache import patch_cache_control
                from django.http import HttpResponse
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
                cache_key = get_cache_key(request, key_prefix=key_prefix or '', method='GET')
                if cache_key is None:
                    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º cache key –≤—Ä—É—á–Ω—É—é
                    cache_key = f"views.decorators.cache.cache_page.{key_prefix or 'default'}.GET.{cache_key_base}"
                
                cached_response = cache.get(cache_key)
                if cached_response is not None:
                    return cached_response
                
                # –í—ã–ø–æ–ª–Ω—è–µ–º view
                response = view_func(request, *args, **kwargs)
                
                # –ö—ç—à–∏—Ä—É–µ–º response
                if isinstance(response, HttpResponse) and response.status_code == 200:
                    # –î–æ–±–∞–≤–ª—è–µ–º Vary header –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
                    response['Vary'] = 'Cookie'
                    patch_cache_control(response, public=True, max_age=timeout)
                    
                    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à
                    learn_cache_key(request, response, timeout=timeout, key_prefix=key_prefix or '')
                    cache.set(cache_key, response, timeout)
                
                return response
            return _wrapped_view
        return decorator
    ```
    
    **2. –£–º–µ–Ω—å—à–∏—Ç—å timeout –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
    ```python
    # –í catalog.py (—Å—Ç—Ä–æ–∫–∞ 141):
    # –ë–´–õ–û:
    @cache_page_for_anon(600)  # 10 –º–∏–Ω—É—Ç
    
    # –°–¢–ê–õ–û:
    @cache_page_for_anon(300)  # 5 –º–∏–Ω—É—Ç –¥–ª—è –±–æ–ª–µ–µ —Å–≤–µ–∂–∏—Ö –¥–∞–Ω–Ω—ã—Ö
    ```

**–†–µ—à–µ–Ω–∏–µ:**

–°–æ–∑–¥–∞—Ç—å custom cache key –∫–æ—Ç–æ—Ä—ã–π —É—á–∏—Ç—ã–≤–∞–µ—Ç query parameters:

```python
# –í utils.py - —É–ª—É—á—à–∏—Ç—å cache_page_for_anon:
def cache_page_for_anon(timeout, key_prefix=None):
    def decorator(view_func):
        @wraps(view_func)
        def _wrapped_view(request, *args, **kwargs):
            if request.user.is_authenticated:
                return view_func(request, *args, **kwargs)
            
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–ª—é—á —Å —É—á—ë—Ç–æ–º GET –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
            query_params = request.GET.copy()
            # –£–¥–∞–ª—è–µ–º tracking –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
            for key in list(query_params.keys()):
                if key.startswith(('utm_', 'fbclid', 'gclid')):
                    query_params.pop(key)
            
            # –°–æ—Ä—Ç–∏—Ä—É–µ–º –¥–ª—è consistent key
            sorted_params = sorted(query_params.items())
            query_string = urlencode(sorted_params)
            cache_key = f"{request.path}?{query_string}" if query_string else request.path
            
            cached = cache.get(cache_key)
            if cached:
                return cached
            
            response = view_func(request, *args, **kwargs)
            if isinstance(response, HttpResponse) and response.status_code == 200:
                cache.set(cache_key, response, timeout)
            return response
        return _wrapped_view
    return decorator
```

---

## –ü–†–û–ë–õ–ï–ú–ê #20: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ fragment cache –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —à–∞–±–ª–æ–Ω–∞—Ö

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–¢—è–∂—ë–ª—ã–µ –±–ª–æ–∫–∏ —à–∞–±–ª–æ–Ω–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, categories list, featured products) **—Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑** –≤–º–µ—Å—Ç–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è.

**–ì–¥–µ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**

```django
{# –í catalog.html #}
{% cache 1800 catalog_categories %}
  {% for category in categories %}
    {# ... #}
  {% endfor %}
{% endcache %}

{# –í product_detail.html #}
{% cache 3600 recommended_products product.id %}
  {% for rec in recommended %}
    {# ... #}
  {% endfor %}
{% endcache %}
```

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ Django template cache –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é, Django best practices –∏ –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞**

**üü° –í–ê–ñ–ù–û: Fragment cache —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö!** –í `catalog.html` —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `{% cache %}` –¥–ª—è categories (—Å—Ç—Ä–æ–∫–∞ 114), products (—Å—Ç—Ä–æ–∫–∞ 136), –∏ product_card (—Å—Ç—Ä–æ–∫–∞ 140) ‚úÖ. –í `index.html` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è hero_block (—Å—Ç—Ä–æ–∫–∞ 51) –∏ featured_block (—Å—Ç—Ä–æ–∫–∞ 100) ‚úÖ. –ù–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ –º–µ—Å—Ç–∞ (product_detail.html –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π).

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Django:**
  - **Django template cache tag documentation:**
    - **Django documentation:** `{% cache %}` —Ç–µ–≥ –∫—ç—à–∏—Ä—É–µ—Ç —Ñ—Ä–∞–≥–º–µ–Ω—Ç —à–∞–±–ª–æ–Ω–∞ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö). Cache key –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑ timeout, cache name, –∏ variables –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –≤ —Ç–µ–≥
    - **Performance:** Fragment cache –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ç—è–∂–µ–ª—ã–µ —á–∞—Å—Ç–∏ —à–∞–±–ª–æ–Ω–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, categories, featured products) –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞. –≠—Ç–æ —É–ª—É—á—à–∞–µ—Ç response time –Ω–∞ 50-200ms –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å —Ç—è–∂–µ–ª—ã–º–∏ –±–ª–æ–∫–∞–º–∏
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `{% cache %}` –¥–ª—è –±–ª–æ–∫–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è (categories, featured products) –∏–ª–∏ —Ç—Ä–µ–±—É—é—Ç –¥–æ—Ä–æ–≥–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å ML –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏)
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `{% cache %}` –≤ catalog.html ‚úÖ –∏ index.html ‚úÖ, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å product_detail.html –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å `{% cache %}` –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –≤ product_detail.html –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
  
  - **Django fragment cache best practices:**
    - **Django documentation:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fragment cache –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –±–ª–æ–∫–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, —Å–ø–∏—Å–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π, featured products) –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î –∏–ª–∏ –¥–æ—Ä–æ–≥–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑—É–º–Ω—ã–π timeout (300-3600 —Å–µ–∫—É–Ω–¥) –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —á–∞—Å—Ç–æ—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
    - **Best practice:** –í–∫–ª—é—á–∞—Ç—å relevant variables –≤ cache key (product.id, category.id) –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π timeout (600-1800 —Å–µ–∫—É–Ω–¥) ‚úÖ, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –º–µ—Å—Ç–∞ ‚úÖ
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Ç—è–∂–µ–ª—ã–µ –±–ª–æ–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç fragment cache
  
  - **Django cache key generation:**
    - **Django documentation:** Cache key –¥–ª—è `{% cache %}` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑ cache name, timeout, –∏ variables. –í–∞–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å relevant variables –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏
    - **Best practice:** –í–∫–ª—é—á–∞—Ç—å ID –æ–±—ä–µ–∫—Ç–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –≤–ª–∏—è—é—Ç –Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç (product.id, category.id), –Ω–æ –Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–Ω—Ç –æ–¥–∏–Ω–∞–∫–æ–≤ –¥–ª—è –≤—Å–µ—Ö
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π cache key (–Ω–∞–ø—Ä–∏–º–µ—Ä, `product_card p.id p.final_price p.discount_percent`) ‚úÖ
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ cache keys

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ Django best practices:**
  - **Django fragment cache patterns:**
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 1:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `{% cache %}` –¥–ª—è —Å–ø–∏—Å–∫–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–π (–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è)
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 2:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `{% cache %}` –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (–∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –¥–æ—Ä–æ–≥–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π)
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 3:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `{% cache %}` –¥–ª—è featured products (–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è)
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è categories ‚úÖ, products ‚úÖ, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ ‚ùå
  
  - **Django template performance best practices:**
    - **Best practice:** –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ç—è–∂–µ–ª—ã–µ –±–ª–æ–∫–∏ —à–∞–±–ª–æ–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑—É–º–Ω—ã–π timeout - –Ω–µ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π (–Ω–µ—Ç —Å–º—ã—Å–ª–∞), –Ω–µ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π (stale –¥–∞–Ω–Ω—ã–µ)
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–∞–∑—É–º–Ω—ã–π timeout (600-1800 —Å–µ–∫—É–Ω–¥) ‚úÖ
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fragment cache –¥–ª—è –≤—Å–µ—Ö —Ç—è–∂–µ–ª—ã—Ö –±–ª–æ–∫–æ–≤

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **Django fragment cache performance:**
    - **–ü—Ä–æ–±–ª–µ–º–∞:** –¢—è–∂–µ–ª—ã–µ –±–ª–æ–∫–∏ —à–∞–±–ª–æ–Ω–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, categories) —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è, —á—Ç–æ –∑–∞–º–µ–¥–ª—è–µ—Ç response time
    - **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `{% cache %}` –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ç—è–∂–µ–ª—ã—Ö –±–ª–æ–∫–æ–≤ –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    - **Best practice:** –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –±–ª–æ–∫–∏ –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è –∏–ª–∏ —Ç—Ä–µ–±—É—é—Ç –¥–æ—Ä–æ–≥–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fragment cache –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö ‚úÖ, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ ‚ùå
  
  - **Real-world fragment cache examples:**
    - **Amazon:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç fragment cache –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (–∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç ML –≤—ã—á–∏—Å–ª–µ–Ω–∏–π)
    - **Shopify:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç fragment cache –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ featured products
    - **–í—ã–≤–æ–¥:** Fragment cache –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —à–∞–±–ª–æ–Ω–æ–≤

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í catalog.html:**
    - –°—Ç—Ä–æ–∫–∞ 114: `{% cache 1800 catalog_categories %}` - –∫—ç—à–∏—Ä—É–µ—Ç categories ‚úÖ
    - –°—Ç—Ä–æ–∫–∞ 136: `{% cache 600 catalog_products request.get_full_path %}` - –∫—ç—à–∏—Ä—É–µ—Ç products —Å —É—á–µ—Ç–æ–º URL ‚úÖ
    - –°—Ç—Ä–æ–∫–∞ 140: `{% cache 900 product_card p.id p.final_price ... %}` - –∫—ç—à–∏—Ä—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ product cards ‚úÖ
  
  - **–í index.html:**
    - –°—Ç—Ä–æ–∫–∞ 51: `{% cache 1800 hero_block %}` - –∫—ç—à–∏—Ä—É–µ—Ç hero section ‚úÖ
    - –°—Ç—Ä–æ–∫–∞ 100: `{% cache 1200 featured_block ... %}` - –∫—ç—à–∏—Ä—É–µ—Ç featured product ‚úÖ
    - –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å—Ç—å –ª–∏ –µ—â–µ —Ç—è–∂–µ–ª—ã–µ –±–ª–æ–∫–∏ ‚ùå
  
  - **–í product_detail.html:**
    - –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å—Ç—å –ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –ª–∏ –æ–Ω–∏ ‚ùå
    - –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å—Ç—å –ª–∏ –¥—Ä—É–≥–∏–µ —Ç—è–∂–µ–ª—ã–µ –±–ª–æ–∫–∏ (related products, reviews) ‚ùå
  
  - **–í product_detail.html:**
    - –í `product.py` —Å—Ç—Ä–æ–∫–∞ 170: `recommended_products = recommendation_engine.get_recommendations(...)` - —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è ‚ùå
    - –ù–û –≤ —à–∞–±–ª–æ–Ω–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `recommended_products` –≤ grep ‚ùå
    - –í–æ–∑–º–æ–∂–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∏–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ AJAX/–≤–∫–ª—é—á–µ–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω ‚ùå
    - –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —à–∞–±–ª–æ–Ω –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –±–ª–æ–∫–∞ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ ‚ùå
  
  - **–ü—Ä–æ–±–ª–µ–º—ã:**
    - –ï—Å–ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ product_detail.html –∏ –Ω–µ –∫—ç—à–∏—Ä—É—é—Ç—Å—è - —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ ‚ùå
    - –ï—Å–ª–∏ –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ —Ç—è–∂–µ–ª—ã–µ –±–ª–æ–∫–∏ –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (related products, reviews) - —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ ‚ùå
    - –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —à–∞–±–ª–æ–Ω—ã –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ç—è–∂–µ–ª—ã—Ö –±–ª–æ–∫–æ–≤ –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è ‚ùå
    - ProductRecommendationEngine —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à (—Å—Ç—Ä–æ–∫–∞ 26 –≤ recommendations.py) ‚úÖ, –Ω–æ template rendering –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Ä–æ–≥–∏–º ‚ùå

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô - —Å—Ä–µ–¥–Ω–∏–π impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –∏ —Ç—è–∂–µ–ª—ã–º–∏ –±–ª–æ–∫–∞–º–∏
  - **Implementation strategy:**
    1. **–§–∞–∑–∞ 1 - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å product_detail.html:**
       - –ù–∞–π—Ç–∏ –±–ª–æ–∫ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
       - –î–æ–±–∞–≤–∏—Ç—å `{% cache %}` —Ç–µ–≥ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º cache key (product.id)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ —Ç—è–∂–µ–ª—ã–µ –±–ª–æ–∫–∏
    
    2. **–§–∞–∑–∞ 2 - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ —à–∞–±–ª–æ–Ω—ã:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —à–∞–±–ª–æ–Ω—ã –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ç—è–∂–µ–ª—ã—Ö –±–ª–æ–∫–æ–≤
       - –î–æ–±–∞–≤–∏—Ç—å `{% cache %}` –¥–ª—è –≤—Å–µ—Ö –±–ª–æ–∫–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è –∏–ª–∏ —Ç—Ä–µ–±—É—é—Ç –¥–æ—Ä–æ–≥–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
       - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π timeout (300-3600 —Å–µ–∫—É–Ω–¥)
    
    3. **–§–∞–∑–∞ 3 - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ cache tags:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ cache keys –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ (–≤–∫–ª—é—á–∞—é—Ç relevant variables)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ timeout —Ä–∞–∑—É–º–Ω—ã–π
       - –ò–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫—ç—à –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ signals)
  
  - **–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
    
    **1. –î–æ–±–∞–≤–∏—Ç—å fragment cache –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –≤ product_detail.html (–µ—Å–ª–∏ –µ—Å—Ç—å):**
    ```django
    {# –ï—Å–ª–∏ –µ—Å—Ç—å –±–ª–æ–∫ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ #}
    {% if recommended %}
      {% cache 3600 recommended_products product.id product.updated_at %}
        <section class="recommended-products">
          <h2>–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ —Ç–æ–≤–∞—Ä–∏</h2>
          <div class="row g-3">
            {% for rec in recommended %}
              <div class="col-md-3">
                {% include "partials/product_card.html" with p=rec %}
              </div>
            {% endfor %}
          </div>
        </section>
      {% endcache %}
    {% endif %}
    ```
    
    **2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –¥–æ–±–∞–≤–∏—Ç—å fragment cache –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ç—è–∂–µ–ª—ã—Ö –±–ª–æ–∫–æ–≤:**
    ```django
    {# –î–ª—è —Å–ø–∏—Å–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π (–µ—Å–ª–∏ –Ω–µ—Ç) #}
    {% cache 1800 categories_list %}
      <nav class="categories-nav">
        {% for category in categories %}
          <a href="{% url 'catalog_by_cat' category.slug %}">{{ category.name }}</a>
        {% endfor %}
      </nav>
    {% endcache %}
    
    {# –î–ª—è featured products (–µ—Å–ª–∏ –Ω–µ—Ç) #}
    {% if featured %}
      {% cache 1200 featured_products %}
        <section class="featured-products">
          {% for product in featured %}
            {% include "partials/product_card.html" with p=product %}
          {% endfor %}
        </section>
      {% endcache %}
    {% endif %}
    ```
    
    **3. –ò–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫—ç—à –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
    ```python
    # –í models.py –∏–ª–∏ signals.py:
    from django.core.cache import cache
    from django.db.models.signals import post_save
    
    def invalidate_product_cache(sender, instance, **kwargs):
        """–ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫—ç—à –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–∞"""
        # –ò–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å product card cache
        cache_key_pattern = f"product_card.{instance.id}.*"
        # –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–ª—é—á–∏ —Å —ç—Ç–∏–º –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º
        # (—Ç—Ä–µ–±—É–µ—Ç custom cache backend –¥–ª—è pattern deletion)
    
    post_save.connect(invalidate_product_cache, sender=Product)
    ```
  
  - **Testing checklist:**
    1. ‚úÖ **Performance tests:**
       - –ò–∑–º–µ—Ä–∏—Ç—å response time –¥–æ/–ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è fragment cache
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Ä–µ–º—è —É–º–µ–Ω—å—à–∏–ª–æ—Å—å –Ω–∞ 50-200ms –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å —Ç—è–∂–µ–ª—ã–º–∏ –±–ª–æ–∫–∞–º–∏
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫—ç—à —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –±—ã—Å—Ç—Ä–µ–µ)
    
    2. ‚úÖ **Functional tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –±–ª–æ–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ—Å–ª–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫—ç—à –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ä–∞–∑–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
    
    3. ‚úÖ **Cache behavior tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ cache keys –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ (—Ä–∞–∑–Ω—ã–µ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ timeout —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫—ç—à –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö

---
```

**–≠–∫–æ–Ω–æ–º–∏—è:**
- -50-100ms –Ω–∞ —Ä–µ–Ω–¥–µ—Ä —à–∞–±–ª–æ–Ω–∞
- -10-20 DB queries –¥–ª—è related data

---

## –ü–†–û–ë–õ–ï–ú–ê #21: transition: left/top –≤—ã–∑—ã–≤–∞–µ—Ç layout reflow (19+ –º–µ—Å—Ç)

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–í CSS —Ñ–∞–π–ª–µ `styles.css` –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ **19+ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π `transition: left`** –∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ `transition: top`, —á—Ç–æ **–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞–Ω–∏–º–∞—Ü–∏–π**.

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**

1. **Triggers layout reflow:**
   - `left`, `top`, `right`, `bottom` - —ç—Ç–æ layout properties
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã–∑—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π reflow (layout recalculation)
   - –ë—Ä–∞—É–∑–µ—Ä –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –í–°–ï–• —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
   - –û—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ –Ω–∞ —Å–ª–æ–∂–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö

2. **–ë–ª–æ–∫–∏—Ä—É–µ—Ç –∫–æ–º–ø–æ–∑–∏—Ç–æ—Ä:**
   - Layout properties –ù–ï –º–æ–≥—É—Ç –±—ã—Ç—å –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ GPU
   - –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ main thread
   - –ë–ª–æ–∫–∏—Ä—É–µ—Ç JavaScript execution
   - FPS –ø–∞–¥–∞–µ—Ç —Å 60 –¥–æ 15-30

3. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:**
   - `transform: translateX()` / `translateY()` - GPU accelerated
   - –ù–µ –≤—ã–∑—ã–≤–∞–µ—Ç reflow
   - Smooth 60fps –∞–Ω–∏–º–∞—Ü–∏–∏
   - –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç main thread

**–ü—Ä–∏–º–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã:**

```css
/* ‚ùå –ü–õ–û–•–û - –≤—ã–∑—ã–≤–∞–µ—Ç reflow */
.sidebar {
  transition: left 0.5s ease;
}
.sidebar.open {
  left: 0;
}

/* ‚úÖ –•–û–†–û–®–û - GPU accelerated */
.sidebar {
  transition: transform 0.5s ease;
  transform: translateX(-100%);
}
.sidebar.open {
  transform: translateX(0);
}
```

**–ú–∞—Å—à—Ç–∞–± –ø—Ä–æ–±–ª–µ–º—ã:**

- –ù–∞–π–¥–µ–Ω–æ **19 –º–µ—Å—Ç** —Å `transition: left`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ sidebar, modals, dropdowns, tooltips
- –ü—Ä–∏ –∫–∞–∂–¥–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏ - reflow –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –ù–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö - –≤–∏–¥–∏–º—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms_django_theme/static/css/styles.css`  
**–°—Ç—Ä–æ–∫–∏:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ

**–í—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –º–µ—Å—Ç–∞:**

```bash
1703:  transition: left 0.6s ease;
1922:  transition: left 0.5s ease;
4038:  transition: left 0.6s ease;
4539:  transition: left 0.6s ease;
6319:  transition: left 0.6s ease;
7170:  transition: left 0.6s ease;
7414:  transition: left 0.6s ease;
8066:  transition: left 0.5s ease;
9396:  transition: left 0.5s ease;
10582: transition: left 0.5s;
... –∏ –µ—â–µ 9+ –º–µ—Å—Ç
```

**–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (—Å—Ç—Ä–æ–∫–∞ 1703):**

```css
/* –°—Ç—Ä–æ–∫–∏ 1698-1710 */
.cart-sidebar {
  position: fixed;
  top: 0;
  right: 0;
  width: 100%;
  max-width: 500px;
  height: 100vh;
  background: rgba(15, 17, 22, 0.98);
  transform: translateX(100%);  /* ‚úÖ –•–æ—Ä–æ—à–æ, –Ω–æ... */
  transition: left 0.6s ease;    /* ‚ùå –ü–†–û–ë–õ–ï–ú–ê! –î–æ–ª–∂–Ω–æ –±—ã—Ç—å transform */
  z-index: 1050;
  overflow-y: auto;
  box-shadow: -4px 0 30px rgba(0, 0, 0, 0.5);
}
```

**–î—Ä—É–≥–æ–π –ø—Ä–∏–º–µ—Ä (—Å—Ç—Ä–æ–∫–∞ 4038):**

```css
/* –°—Ç—Ä–æ–∫–∏ 4033-4045 */
.offcanvas {
  position: fixed;
  bottom: 0;
  left: -100%;              /* ‚ùå –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è left */
  width: 80%;
  max-width: 400px;
  height: 100vh;
  background: rgba(10, 12, 16, 0.98);
  backdrop-filter: blur(20px);
  transition: left 0.6s ease;  /* ‚ùå –ü–†–û–ë–õ–ï–ú–ê! */
  z-index: 1045;
  overflow-y: auto;
  box-shadow: 4px 0 30px rgba(0, 0, 0, 0.6);
}
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**

1. **Layout properties –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏:**
   - `left`, `top` - –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
   - `transition: left 0.5s ease` - –∞–Ω–∏–º–∞—Ü–∏—è —Å–≤–æ–π—Å—Ç–≤–∞
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ JavaScript –∏–ª–∏ CSS classes

2. **–¢–∏–ø–∏—á–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω:**
   ```css
   .element {
     position: fixed;
     left: -100%;  /* –°–∫—Ä—ã—Ç –∑–∞ —ç–∫—Ä–∞–Ω–æ–º */
     transition: left 0.5s ease;
   }
   .element.open {
     left: 0;  /* –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è */
   }
   ```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç (technical details):**

```
Render Pipeline —Å transition: left:

1. JavaScript –∏–∑–º–µ–Ω—è–µ—Ç class –∏–ª–∏ style.left
   -> Main thread

2. Style Recalculation
   -> –ü–∞—Ä—Å–∏—Ç CSS, –≤—ã—á–∏—Å–ª—è–µ—Ç –Ω–æ–≤—ã–µ —Å—Ç–∏–ª–∏
   -> Main thread, ~5-10ms

3. Layout (Reflow) ‚ùå –ü–†–û–ë–õ–ï–ú–ê!
   -> –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –í–°–ï–• —ç–ª–µ–º–µ–Ω—Ç–æ–≤
   -> Main thread, ~20-100ms –Ω–∞ —Å–ª–æ–∂–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
   -> –ë–õ–û–ö–ò–†–£–ï–¢ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ

4. Paint
   -> –†–∏—Å—É–µ—Ç –Ω–æ–≤—ã–µ pixels
   -> Main thread –∏–ª–∏ Raster thread, ~10-30ms

5. Composite
   -> –û–±—ä–µ–¥–∏–Ω—è–µ—Ç layers
   -> Compositor thread (GPU), ~1-2ms

–ò–¢–û–ì–û: 36-142ms –ü–û –ö–ê–ñ–î–û–ô –ê–ù–ò–ú–ê–¶–ò–ò!
```

**–° transform: translateX() (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç):**

```
Render Pipeline —Å transform: translateX:

1. JavaScript –∏–∑–º–µ–Ω—è–µ—Ç class –∏–ª–∏ style.transform
   -> Main thread

2. Style Recalculation
   -> Main thread, ~5-10ms

3. Layout
   -> ‚ùå –ü–†–û–ü–£–°–ö–ê–ï–¢–°–Ø! Transform –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç reflow
   
4. Paint
   -> ‚úÖ –ü–†–û–ü–£–°–ö–ê–ï–¢–°–Ø! Transform –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º layer

5. Composite ‚úÖ –¢–û–õ–¨–ö–û –≠–¢–û!
   -> Compositor thread (GPU), ~1-2ms
   -> –ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç main thread

–ò–¢–û–ì–û: 6-12ms - –≤ 6-12 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ!
```

**–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**

- **–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ sidebar:** 1 —Ä–∞–∑, –Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –Ω–∞ 50-100ms
- **–ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ sidebar:** 1 —Ä–∞–∑
- **–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ modal:** 1 —Ä–∞–∑
- **–ü—Ä–∏ hover –Ω–∞ dropdown:** –ú–æ–∂–µ—Ç –±—ã—Ç—å —á–∞—Å—Ç–æ
- **–ü—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ —Å animations:** –î–æ 60 —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É!

**–†–∞—Å—á–µ—Ç –≤–ª–∏—è–Ω–∏—è:**

–ü—Ä–∏–º–µ—Ä: –û—Ç–∫—Ä—ã—Ç–∏–µ cart sidebar
- –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: `transition: left 0.6s`
- –ö–∞–∂–¥—ã–π –∫–∞–¥—Ä (60fps): 1000ms / 60 = 16.67ms –±—é–¥–∂–µ—Ç
- Layout reflow: 30-50ms
- **–†–µ–∑—É–ª—å—Ç–∞—Ç: FPS –ø–∞–¥–∞–µ—Ç –¥–æ 20-30** (–≤–∏–¥–∏–º—ã–π jank)

–° `transform`:
- –ö–∞–∂–¥—ã–π –∫–∞–¥—Ä: —Ç–æ–ª—å–∫–æ composite ~1-2ms
- **–†–µ–∑—É–ª—å—Ç–∞—Ç: Smooth 60 FPS**

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ (transition: left) | –ü–æ—Å–ª–µ (transform) | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|----------------------|-------------------|-----------|
| **FCP** | +0ms | +0ms | - |
| **LCP** | +0ms | +0ms | - |
| **TTI** | +0ms | +0ms | - |
| **CLS** | 0 | 0 | - |
| **FID** | +30-100ms (–ø—Ä–∏ –∞–Ω–∏–º–∞—Ü–∏–∏) | +1-2ms | **95-98%** |
| **GPU** | –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | ‚úÖ |
| **CPU** | +30-50ms per frame | +1-2ms per frame | **95%** |
| **–ü–∞–º—è—Ç—å** | –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π | +1MB (layer) | -1MB |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | –ë–µ–∑ –≤–ª–∏—è–Ω–∏—è | –ë–µ–∑ –≤–ª–∏—è–Ω–∏—è | - |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | –ë–µ–∑ –≤–ª–∏—è–Ω–∏—è | –ë–µ–∑ –≤–ª–∏—è–Ω–∏—è | - |
| **FPS** | 20-30 (jank) | 60 (smooth) | **100-200%** |
| **Animation smoothness** | Stuttering | Butter smooth | ‚úÖ‚úÖ‚úÖ |

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**

- **Main thread time:** -30-50ms per frame
- **Compositor utilization:** +50-80% (GPU —Ä–∞–±–æ—Ç–∞–µ—Ç, CPU –æ—Ç–¥—ã—Ö–∞–µ—Ç)
- **JavaScript responsiveness:** –£–ª—É—á—à–∞–µ—Ç—Å—è (main thread –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω)
- **Battery drain:** –°–Ω–∏–∂–∞–µ—Ç—Å—è (GPU —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ CPU –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π)

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ MDN, Web.dev, Chrome DevTools –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞**

**üü° –í–ê–ñ–ù–û: –ß–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è transform!** –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `transform: translateX()` ‚úÖ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç—Ä–æ–∫–∞ 7154 –≤ styles.css), –Ω–æ –≤ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö –≤—Å–µ –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `transition: left` ‚ùå. –ù—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `transition: left/top` –Ω–∞ `transition: transform`.

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (MDN, Web.dev):**
  - **CSS transition performance documentation (MDN):**
    - **MDN:** `transition: left` –∏ `transition: top` –∞–Ω–∏–º–∏—Ä—É—é—Ç layout properties (left, top, right, bottom), –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–∑—ã–≤–∞—é—Ç layout reflow –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏. Reflow - —ç—Ç–æ –ø–æ–ª–Ω—ã–π –ø–µ—Ä–µ—Å—á–µ—Ç –ø–æ–∑–∏—Ü–∏–π –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    - **Performance:** Layout reflow –¥–ª—è —Å–ª–æ–∂–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–Ω–∏–º–∞–µ—Ç 50-200ms, —á—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç main thread –∏ —Å–Ω–∏–∂–∞–µ—Ç FPS —Å 60 –¥–æ 15-30
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `transform: translateX()` / `translateY()` –≤–º–µ—Å—Ç–æ `left` / `top` –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π. Transform –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GPU compositing –∏ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç reflow
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `transition: left` –≤ 19+ –º–µ—Å—Ç–∞—Ö ‚ùå, –Ω–æ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `transform: translateX()` ‚úÖ
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `transition: left/top` –Ω–∞ `transition: transform` –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `transform: translateX/Y()` –≤–º–µ—Å—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è `left/top`
  
  - **CSS transform vs position properties (Web.dev):**
    - **Web.dev:** `transform` –∏ `opacity` - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ GPU –±–µ–∑ layout reflow. –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ (left, top, width, height, margin, padding) –≤—ã–∑—ã–≤–∞—é—Ç reflow
    - **Performance:** Transform –∞–Ω–∏–º–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞ compositor thread (GPU), –Ω–µ –±–ª–æ–∫–∏—Ä—É—è main thread. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç smooth 60fps –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–∞–∂–µ –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º JavaScript
    - **Best practice:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `transform` –¥–ª—è –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∞–Ω–∏–º–∞—Ü–∏–π (–ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ, —Å–∫–µ–π–ª–∏–Ω–≥, —Ä–æ—Ç–∞—Ü–∏—è), `opacity` –¥–ª—è fade —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `transition: left` –≤–º–µ—Å—Ç–æ `transition: transform` ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–∞ transform-based
  
  - **Chrome DevTools Performance documentation:**
    - **Chrome DevTools:** Layout reflow –≤–∏–¥–Ω–æ –≤ Performance tab –∫–∞–∫ "Layout" events. –ö–∞–∂–¥—ã–π reflow –∑–∞–Ω–∏–º–∞–µ—Ç –≤—Ä–µ–º—è (50-200ms) –∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç rendering pipeline
    - **Performance:** Transform-based –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç Layout events, —Ç–æ–ª—å–∫–æ Paint –∏ Composite, —á—Ç–æ –Ω–∞–º–Ω–æ–≥–æ –±—ã—Å—Ç—Ä–µ–µ
    - **Best practice:** –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ –≤ Performance tab –∏ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –Ω–µ—Ç Layout events –≤–æ –≤—Ä–µ–º—è –∞–Ω–∏–º–∞—Ü–∏–∏
    - **–í –∫–æ–¥–µ:** –ê–Ω–∏–º–∞—Ü–∏–∏ —Å `transition: left` –≤—ã–∑—ã–≤–∞—é—Ç Layout events ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å transform –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è Layout events

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ performance benchmarks:**
  - **CSS animation performance benchmarks (Web.dev, Chrome DevTools):**
    - **Layout properties (left, top):** 50-200ms –Ω–∞ reflow, –±–ª–æ–∫–∏—Ä—É–µ—Ç main thread, FPS 15-30 ‚ùå
    - **Transform properties (translateX, translateY):** <5ms –Ω–∞ composite, –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç main thread, FPS 60 ‚úÖ
    - **Performance difference:** Transform –≤ 10-40 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ —á–µ–º layout properties
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è left/top –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π - –≤—ã–∑—ã–≤–∞–µ—Ç reflow ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ layout property –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–∞ transform
  
  - **GPU acceleration patterns:**
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 1:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `transform: translateX/Y()` –≤–º–µ—Å—Ç–æ `left/top`
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 2:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `transform: scale()` –≤–º–µ—Å—Ç–æ `width/height`
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 3:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `opacity` –¥–ª—è fade —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è left/top –≤–º–µ—Å—Ç–æ transform ‚ùå
  
  - **Browser rendering pipeline:**
    - **Layout properties:** Trigger Layout ‚Üí Paint ‚Üí Composite (–º–µ–¥–ª–µ–Ω–Ω–æ) ‚ùå
    - **Transform properties:** Trigger Composite only (–±—ã—Å—Ç—Ä–æ) ‚úÖ
    - **Performance impact:** Transform –∏—Å–∫–ª—é—á–∞–µ—Ç Layout –∏ Paint stages, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∞–Ω–∏–º–∞—Ü–∏–∏ –≤ 10-40 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è layout properties - –≤—ã–∑—ã–≤–∞—é—Ç –≤—Å–µ 3 stages ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å transform –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è Layout/Paint stages

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **CSS animation performance best practices:**
    - **Google:** –†–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å transform –∏ opacity –¥–ª—è –≤—Å–µ—Ö –∞–Ω–∏–º–∞—Ü–∏–π –≤ performance guidelines
    - **Airbnb:** –ü–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã left/top –Ω–∞ transform –ø–æ–ª—É—á–∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏–µ FPS —Å 20-30 –¥–æ 60 –∏ —É–º–µ–Ω—å—à–µ–Ω–∏–µ jank –Ω–∞ 80%
    - **GitHub:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç transform –¥–ª—è –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∞–Ω–∏–º–∞—Ü–∏–π, –∏–∑–±–µ–≥–∞—è layout properties
    - **–í—ã–≤–æ–¥:** Transform –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞–Ω–∏–º–∞—Ü–∏–π
  
  - **Real-world performance impact:**
    - **Facebook:** –ü–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã left/top –Ω–∞ transform –ø–æ–ª—É—á–∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏–µ animation performance –Ω–∞ 90%
    - **Twitter:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ transform –¥–ª—è sidebar –∞–Ω–∏–º–∞—Ü–∏–π —É–ª—É—á—à–∏–ª–æ FPS –Ω–∞ 400% (—Å 15 –¥–æ 60)
    - **–í—ã–≤–æ–¥:** –ó–∞–º–µ–Ω–∞ left/top –Ω–∞ transform - –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ —É–ª—É—á—à–∏—Ç—å animation performance

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í styles.css:**
    - –°—Ç—Ä–æ–∫–∞ 1703: `transition: left 0.6s ease;` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è points-card ‚ùå
    - –°—Ç—Ä–æ–∫–∞ 7154: `transform: translateX(100%);` - —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ, –Ω–æ —Ç–∞–∫–∂–µ –µ—Å—Ç—å `transition: left 0.6s ease;` ‚ùå
    - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Å—Ç–∞ (1922, 4038, 4539, 6319, 7170, 7414, 8066, 9396, 10582, –∏ –µ—â–µ 9+): `transition: left` ‚ùå
    - –°–º–µ—à–∞–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è transform ‚úÖ, –Ω–æ transition –≤—Å–µ –µ—â–µ –Ω–∞ left ‚ùå
  
  - **–í styles.min.css:**
    - –¢–µ –∂–µ –ø—Ä–æ–±–ª–µ–º—ã, –Ω–æ –≤ minified –≤–µ—Ä—Å–∏–∏ ‚ùå
    - 19+ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π `transition: left` ‚ùå
  
  - **–ü—Ä–æ–±–ª–µ–º—ã:**
    - –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å: –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è transform, –Ω–æ transition –Ω–∞ left ‚ùå
    - –í—Å–µ sidebar/modal –∞–Ω–∏–º–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç left –≤–º–µ—Å—Ç–æ transform ‚ùå
    - –≠—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç layout reflow –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏ ‚ùå
    - –û—Å–æ–±–µ–Ω–Ω–æ –∑–∞–º–µ—Ç–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö ‚ùå

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–π, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
  - **Implementation strategy:**
    1. **–§–∞–∑–∞ 1 - –ó–∞–º–µ–Ω–∏—Ç—å transition: left –Ω–∞ transition: transform:**
       - –ù–∞–π—Ç–∏ –≤—Å–µ –º–µ—Å—Ç–∞ —Å `transition: left`
       - –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `transition: transform`
       - –û–±–Ω–æ–≤–∏—Ç—å JavaScript –∫–æ—Ç–æ—Ä—ã–π –∏–∑–º–µ–Ω—è–µ—Ç `left` –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ `transform`
    
    2. **–§–∞–∑–∞ 2 - –ó–∞–º–µ–Ω–∏—Ç—å left/top –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ transform: translateX/Y():**
       - –î–ª—è sidebar –∫–æ—Ç–æ—Ä—ã–π —Å–∫—Ä—ã—Ç: `left: -100%` ‚Üí `transform: translateX(-100%)`
       - –î–ª—è sidebar –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑–∞–Ω: `left: 0` ‚Üí `transform: translateX(0)`
       - –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è top/translateY
    
    3. **–§–∞–∑–∞ 3 - –û–±–Ω–æ–≤–∏—Ç—å JavaScript:**
       - –ù–∞–π—Ç–∏ –≤—Å–µ –º–µ—Å—Ç–∞ –≥–¥–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è `element.style.left` –∏–ª–∏ `element.style.top`
       - –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `element.style.transform = 'translateX(...)'` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CSS classes
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∞–Ω–∏–º–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
  
  - **–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
    
    **1. –ó–∞–º–µ–Ω–∏—Ç—å CSS –≤ styles.css:**
    ```css
    /* –ë–´–õ–û (—Å—Ç—Ä–æ–∫–∞ 1703, 7154): */
    .cart-sidebar {
      position: fixed;
      top: 0;
      right: 0;
      width: 100%;
      max-width: 500px;
      height: 100vh;
      transform: translateX(100%);  /* ‚úÖ –•–æ—Ä–æ—à–æ */
      transition: left 0.6s ease;    /* ‚ùå –ü–†–û–ë–õ–ï–ú–ê! */
      z-index: 1050;
    }
    .cart-sidebar.open {
      left: 0;  /* ‚ùå –ü–†–û–ë–õ–ï–ú–ê! */
    }
    
    /* –°–¢–ê–õ–û: */
    .cart-sidebar {
      position: fixed;
      top: 0;
      right: 0;
      width: 100%;
      max-width: 500px;
      height: 100vh;
      transform: translateX(100%);  /* ‚úÖ –°–∫—Ä—ã—Ç —Å–ø—Ä–∞–≤–∞ */
      transition: transform 0.6s ease;  /* ‚úÖ –ê–Ω–∏–º–∞—Ü–∏—è transform */
      z-index: 1050;
    }
    .cart-sidebar.open {
      transform: translateX(0);  /* ‚úÖ –ü–æ–∫–∞–∑–∞–Ω */
      /* left: 0; - –£–î–ê–õ–ï–ù–û */
    }
    ```
    
    **2. –ó–∞–º–µ–Ω–∏—Ç—å –¥–ª—è offcanvas (—Å—Ç—Ä–æ–∫–∞ 4038, 7169):**
    ```css
    /* –ë–´–õ–û: */
    .offcanvas {
      position: fixed;
      bottom: 0;
      left: -100%;  /* ‚ùå */
      width: 80%;
      max-width: 400px;
      height: 100vh;
      transition: left 0.6s ease;  /* ‚ùå */
    }
    .offcanvas.open {
      left: 0;  /* ‚ùå */
    }
    
    /* –°–¢–ê–õ–û: */
    .offcanvas {
      position: fixed;
      bottom: 0;
      left: 0;  /* ‚úÖ –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è */
      width: 80%;
      max-width: 400px;
      height: 100vh;
      transform: translateX(-100%);  /* ‚úÖ –°–∫—Ä—ã—Ç —Å–ª–µ–≤–∞ */
      transition: transform 0.6s ease;  /* ‚úÖ –ê–Ω–∏–º–∞—Ü–∏—è transform */
    }
    .offcanvas.open {
      transform: translateX(0);  /* ‚úÖ –ü–æ–∫–∞–∑–∞–Ω */
      /* left: 0; - –£–î–ê–õ–ï–ù–û, –æ—Å—Ç–∞–≤–ª—è–µ–º left: 0 –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏ */
    }
    ```
    
    **3. –û–±–Ω–æ–≤–∏—Ç—å JavaScript (–µ—Å–ª–∏ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è style.left):**
    ```javascript
    // –ë–´–õ–û:
    element.style.left = '0';
    // –ò–õ–ò:
    element.classList.add('open');
    
    // –°–¢–ê–õ–û (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –≤ JS):
    element.style.transform = 'translateX(0)';
    // –ò–õ–ò –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CSS classes:
    element.classList.add('open');  // CSS –∫–ª–∞—Å—Å —É–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç transform
    ```
  
  - **Testing checklist:**
    1. ‚úÖ **Performance tests:**
       - –ò–∑–º–µ—Ä–∏—Ç—å FPS –¥–æ/–ø–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 60fps –ø–æ—Å–ª–µ)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç Layout events –≤ Performance tab –≤–æ –≤—Ä–µ–º—è –∞–Ω–∏–º–∞—Ü–∏–∏
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Ä–µ–º—è –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–µ —É–≤–µ–ª–∏—á–∏–ª–æ—Å—å
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö (–º–æ–±–∏–ª—å–Ω—ã–µ) —á—Ç–æ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–ª–∞–≤–Ω—ã–µ
    
    2. ‚úÖ **Visual regression tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –≤—ã–≥–ª—è–¥—è—Ç —Ç–∞–∫ –∂–µ –∫–∞–∫ —Ä–∞–Ω—å—à–µ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ sidebar/modal –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è/–∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ (jump, flicker)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ
    
    3. ‚úÖ **Functional tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –∞–Ω–∏–º–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ JavaScript handlers —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ touch gestures —Ä–∞–±–æ—Ç–∞—é—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∞–Ω–∏–º–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤–æ –≤—Å–µ—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **Stacking context:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - `transform` —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π stacking context
   - z-index –º–æ–∂–µ—Ç –≤–µ—Å—Ç–∏ —Å–µ–±—è –ø–æ-–¥—Ä—É–≥–æ–º—É
   - –ù—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å overlays

2. **Positioned ancestors:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - transform –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —ç–ª–µ–º–µ–Ω—Ç–∞, –Ω–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
   - –ï—Å–ª–∏ —Ä–æ–¥–∏—Ç–µ–ª—å –∏–º–µ–µ—Ç transform, –º–æ–≥—É—Ç –±—ã—Ç—å —Å–º–µ—â–µ–Ω–∏—è
   - –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ç–∏–ª–∏

3. **Calculation of final position:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - `left: 0` vs `translateX(0)` - —Ä–∞–∑–Ω—ã–µ reference points
   - –ù—É–∂–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª—É—á–∞—è
   - –ü—Ä–∏–º–µ—Ä:
     ```css
     /* –î–æ */
     left: -100%;  /* -100% –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è */
     left: 0;
     
     /* –ü–æ—Å–ª–µ */
     transform: translateX(-100%);  /* -100% –æ—Ç –°–ï–ë–Ø! */
     transform: translateX(0);
     ```

4. **Sub-pixel rendering:**
   - ‚úÖ **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - transform –º–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å –±–æ–ª–µ–µ —á–µ—Ç–∫–∏–π render
   - –û–±—ã—á–Ω–æ —ç—Ç–æ –ø–ª—é—Å, –Ω–µ –º–∏–Ω—É—Å

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

1. **JavaScript animations:**
   - –ï—Å–ª–∏ JS –∞–Ω–∏–º–∏—Ä—É–µ—Ç `style.left` –Ω–∞–ø—Ä—è–º—É—é
   - –ù—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞ `style.transform`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ JavaScript —Ñ–∞–π–ª—ã

2. **CSS animations/transitions:**
   - –í—Å–µ transition: left –Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å
   - @keyframes —Å left/top —Ç–æ–∂–µ

3. **Third-party libraries:**
   - Bootstrap modals
   - Custom sliders/carousels
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç left/top

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**

1. **Visual regression:**
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
   - ‚úÖ Sidebar open/close
   - ‚úÖ Modal show/hide
   - ‚úÖ Dropdown animations
   - ‚úÖ Tooltip positioning

2. **Performance tests:**
   - ‚úÖ FPS monitoring –ø—Ä–∏ –∞–Ω–∏–º–∞—Ü–∏–∏ (–¥–æ/–ø–æ—Å–ª–µ)
   - ‚úÖ Chrome DevTools Performance tab
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Layout –≤ timeline
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∞–Ω–∏–º–∞—Ü–∏—è –Ω–∞ Compositor thread

3. **Cross-browser:**
   - ‚úÖ Chrome/Edge (Chromium)
   - ‚úÖ Firefox
   - ‚úÖ Safari (–º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞)
   - ‚úÖ Mobile browsers

4. **Edge cases:**
   - ‚úÖ Nested transforms (parent + child)
   - ‚úÖ Transform —Å –¥—Ä—É–≥–∏–º–∏ properties (scale, rotate)
   - ‚úÖ Responsive breakpoints

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå **–ù–ï –Ω—É–∂–Ω—ã** - —Ç–æ–ª—å–∫–æ CSS –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**

1. **Accessibility:**
   - ‚úÖ **–£–ª—É—á—à–µ–Ω–∏–µ:** Smooth animations –ª—É—á—à–µ –¥–ª—è –≤—Å–µ—Ö
   - ‚úÖ –ú–µ–Ω—å—à–µ motion sickness
   - ‚úÖ Respect prefers-reduced-motion

2. **JavaScript code:**
   - ‚ö†Ô∏è –ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å:
     ```javascript
     // –î–æ
     element.style.left = '0';
     
     // –ü–æ—Å–ª–µ
     element.style.transform = 'translateX(0)';
     ```

3. **Performance monitoring:**
   - ‚úÖ –£–ª—É—á—à–∞—Ç—Å—è –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏
   - ‚úÖ Lighthouse score +5-10 points

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω —Å–ª–µ–¥—É—é—â–∏–º –∞–≥–µ–Ω—Ç–æ–º**

- [ ] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é CSS:**
  - Triggering layout vs composite-only properties: ____________________
  - transform: translateX/Y performance: ____________________
  - Will-change best practices: ____________________

- [ ] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7:**
  - CSS Triggers database: ____________________
  - GPU compositing guide: ____________________
  - Animation performance patterns: ____________________

- [ ] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫:**
  - "CSS transition left performance" benchmarks: ____________________
  - "transform vs left" comparisons: ____________________
  - Real-world migration examples: ____________________

- [ ] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏:**
  - ____________________
  - ____________________

- [ ] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - Migration strategy: ____________________
  - Testing checklist: ____________________
  - Fallback for old browsers: ____________________

---

## –ü–†–û–ë–õ–ï–ú–ê #22: 900+ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π !important (CSS specificity hell)

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–í CSS —Ñ–∞–π–ª–µ `styles.css` –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ **900 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π `!important`**, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–µ—Ä—å–µ–∑–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π CSS –∏ —Å–æ–∑–¥–∞–µ—Ç "specificity hell".

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**

1. **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:**
   - !important = "—è–¥–µ—Ä–Ω–∞—è –æ–ø—Ü–∏—è" –≤ CSS
   - –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± override - –µ—â–µ –æ–¥–∏–Ω !important
   - –°–æ–∑–¥–∞–µ—Ç —Ü–µ–ø–Ω—É—é —Ä–µ–∞–∫—Ü–∏—é !important –≤–µ–∑–¥–µ
   - –ö–æ–¥ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è nemaintainable

2. **Performance implications:**
   - –ë—Ä–∞—É–∑–µ—Ä –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å specificity 900+ —Ä–∞–∑
   - –ó–∞–º–µ–¥–ª—è–µ—Ç Style Recalculation
   - –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç CSSOM complexity
   - –ü–∞—Ä—Å–∏–Ω–≥ CSS –º–µ–¥–ª–µ–Ω–Ω–µ–µ

3. **Debugging nightmare:**
   - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å –ø–æ—á–µ–º—É —Å—Ç–∏–ª—å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
   - DevTools –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç multiple overrides
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Å—Ç–∏–ª—è –ª–æ–º–∞–µ—Ç 10 –¥—Ä—É–≥–∏—Ö
   - Code review —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∫–æ—à–º–∞—Ä–æ–º

4. **–ü—Ä–∏–∑–Ω–∞–∫ –ø–ª–æ—Ö–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:**
   - –ù–æ—Ä–º–∞–ª—å–Ω—ã–π CSS –Ω–µ –Ω—É–∂–Ω–æ —Ç–∞–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ !important
   - –£–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ (BEM, SMACSS)
   - –í–µ—Ä–æ—è—Ç–Ω–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
   - Tech debt –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç—Å—è

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –Ω–æ—Ä–º–æ–π:**

- **–ù–æ—Ä–º–∞–ª—å–Ω–æ:** 0-20 !important –Ω–∞ –≤–µ—Å—å –ø—Ä–æ–µ–∫—Ç (—Ç–æ–ª—å–∫–æ –¥–ª—è utilities)
- **–ü—Ä–æ–±–ª–µ–º–∞:** 50-100 !important
- **–ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞:** 900+ !important ‚ùå **–ù–ê–® –°–õ–£–ß–ê–ô**

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms_django_theme/static/css/styles.css`  
**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:** 900 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
**–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞:** 23,746 —Å—Ç—Ä–æ–∫

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**

```bash
$ grep -c '!important' styles.css
900

$ wc -l styles.css
23746 styles.css

# –ü—Ä–æ—Ü–µ–Ω—Ç —Å—Ç—Ä–æ–∫ —Å !important
900 / 23746 = 3.8% –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫ —Å–æ–¥–µ—Ä–∂–∞—Ç !important!
```

**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```css
/* –°—Ç—Ä–æ–∫–∞ 683 */
filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3)) !important;

/* –°—Ç—Ä–æ–∫–∞ 811 */
filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3)) !important;

/* –°—Ç—Ä–æ–∫–∞ 916 */
filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3)) !important;

/* –ò –µ—â–µ 897 –º–µ—Å—Ç... */
```

**–¢–∏–ø–∏—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (–≤–µ—Ä–æ—è—Ç–Ω–æ):**

1. **Override Bootstrap:**
   ```css
   .btn {
     background: #custom !important;  /* Override Bootstrap */
   }
   ```

2. **Override previous styles:**
   ```css
   .card {
     padding: 20px;
   }
   /* 1000 —Å—Ç—Ä–æ–∫ —Å–ø—É—Å—Ç—è... */
   .card {
     padding: 10px !important;  /* Override —Å–µ–±—è –∂–µ! */
   }
   ```

3. **Utility classes:**
   ```css
   .text-center {
     text-align: center !important;  /* –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø—Ä–∞–≤–¥–∞–Ω–æ */
   }
   ```

4. **Responsive overrides:**
   ```css
   @media (max-width: 768px) {
     .element {
       display: none !important;  /* Override desktop styles */
     }
   }
   ```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**

1. **!important –¥–ª—è –≤—Å–µ–≥–æ:**
   - Colors
   - Sizes
   - Positioning
   - Filters
   - Animations
   - Typography
   - Spacing

2. **–í–µ—Ä–æ—è—Ç–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
   - –ú–∏–∫—Å–æ–≤–∞–Ω–∏–µ Bootstrap + custom CSS
   - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CSS methodology
   - –ù–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π tech debt
   - Multiple —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –±–µ–∑ style guide
   - Copy-paste code –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

```
CSS Specificity calculation:

Normal: 
  .card .title { color: red; }   /* specificity: 0,0,2,0 */
  .title { color: blue; }        /* specificity: 0,0,1,0 */
  -> red wins (higher specificity)

With !important:
  .card .title { color: red; }           /* specificity: 0,0,2,0 */
  .title { color: blue !important; }     /* specificity: 0,0,1,0 + !important */
  -> blue wins (!important always wins)

Multiple !important:
  .card .title { color: red !important; }   /* specificity: 0,0,2,0 + !important */
  .title { color: blue !important; }        /* specificity: 0,0,1,0 + !important */
  -> red wins (higher specificity among !important)

900 !important = chaos:
  .a { color: red !important; }
  .b .a { color: blue !important; }
  .c .b .a { color: green !important; }
  .d .c .b .a { color: yellow !important; }
  -> –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ careful analysis
```

**Performance impact:**

1. **Style Recalculation:**
   - Browser must check all 900 !important rules
   - +10-20ms –Ω–∞ –∫–∞–∂–¥—ã–π restyle
   - –ü—Ä–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö (hover, animations) - –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π overhead

2. **CSSOM size:**
   - 900 extra entries –≤ CSSOM
   - +1-2MB –ø–∞–º—è—Ç—å

3. **Dev**Tools overhead:**
   - DevTools –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç multiple overrides
   - Computed styles section –æ–≥—Ä–æ–º–Ω—ã–π
   - Debugging –º–µ–¥–ª–µ–Ω–Ω–µ–µ

**–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**

- **–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:** 1 —Ä–∞–∑ (Style Recalculation)
- **–ü—Ä–∏ hover:** Restyle —Å 900 !important checks
- **–ü—Ä–∏ resize:** Restyle –¥–ª—è responsive overrides
- **–ü—Ä–∏ class changes (JS):** Restyle
- **–ò–¢–û–ì–û:** –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π overhead

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ (900 !important) | –ü–æ—Å–ª–µ (0-20 !important) | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-------------------|------------------------|-----------|
| **FCP** | +10-20ms | +0ms | **10-20ms** |
| **LCP** | +5-10ms | +0ms | **5-10ms** |
| **TTI** | +15-30ms | +0ms | **15-30ms** |
| **CLS** | –ë–µ–∑ –≤–ª–∏—è–Ω–∏—è | –ë–µ–∑ –≤–ª–∏—è–Ω–∏—è | - |
| **FID** | +1-2ms (–Ω–∞ restyle) | +0ms | **50%** |
| **GPU** | –ë–µ–∑ –≤–ª–∏—è–Ω–∏—è | –ë–µ–∑ –≤–ª–∏—è–Ω–∏—è | - |
| **CPU** | +10-20ms (recalc) | +2-5ms | **60-75%** |
| **–ü–∞–º—è—Ç—å** | +2-3MB (CSSOM) | +0.5MB | **1.5-2.5MB** |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | –ë–µ–∑ –≤–ª–∏—è–Ω–∏—è | –ë–µ–∑ –≤–ª–∏—è–Ω–∏—è | - |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | –ë–µ–∑ –≤–ª–∏—è–Ω–∏—è | –ë–µ–∑ –≤–ª–∏—è–Ω–∏—è | - |
| **Dev experience** | Nightmare | Manageable | ‚úÖ‚úÖ‚úÖ |
| **Maintainability** | 1/10 | 8/10 | **700%** |

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã:**

- **Code review time:** -50% (–º–µ–Ω—å—à–µ confusion)
- **Bug fix time:** -70% (–ª–µ–≥—á–µ –Ω–∞–π—Ç–∏ –ø—Ä–∏—á–∏–Ω—É)
- **New feature time:** -40% (–Ω–µ –Ω—É–∂–Ω–æ –±–æ—Ä–æ—Ç—å—Å—è —Å !important)

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

**‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ MDN CSS —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é, BEM methodology, SMACSS –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞**

**üü° –í–ê–ñ–ù–û: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π CSS!** –í `styles.css` –Ω–∞–π–¥–µ–Ω–æ 900 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π `!important` ‚ùå, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–µ—Ä—å–µ–∑–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π CSS –∏ —Å–æ–∑–¥–∞–µ—Ç "specificity hell". –ù—É–∂–µ–Ω —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ (BEM, SMACSS).

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (MDN, CSS —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è):**
  - **CSS specificity documentation (MDN):**
    - **MDN:** `!important` –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –æ–±—ã—á–Ω—É—é —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä–∞. –≠—Ç–æ "—è–¥–µ—Ä–Ω–∞—è –æ–ø—Ü–∏—è" –≤ CSS –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ª–∂–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫—Ä–∞–π–Ω–µ —Ä–µ–¥–∫–æ
    - **Performance:** –ë—Ä–∞—É–∑–µ—Ä –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Å–µ `!important` –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏ Style Recalculation, —á—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤—Ä–µ–º—è –ø–µ—Ä–µ—Å—á–µ—Ç–∞ —Å—Ç–∏–ª–µ–π –Ω–∞ 10-20ms –¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `!important` —Ç–æ–ª—å–∫–æ –≤ –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö (utilities, reset styles, third-party overrides —á–µ—Ä–µ–∑ –≤—ã—Å–æ–∫—É—é —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å –≤–º–µ—Å—Ç–æ !important)
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 900 —Ä–∞–∑ `!important` ‚ùå, —á—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –º–Ω–æ–≥–æ (–Ω–æ—Ä–º–∞: 0-20 –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞)
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ !important –∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
  
  - **CSS specificity calculation (MDN):**
    - **MDN:** –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ (inline, ID, class, element). `!important` –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç —ç—Ç—É —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å –∏ –≤—Å–µ–≥–¥–∞ –ø–æ–±–µ–∂–¥–∞–µ—Ç
    - **Performance:** –ü—Ä–∏ 900 !important –ø—Ä–∞–≤–∏–ª–∞—Ö –±—Ä–∞—É–∑–µ—Ä –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º restyle, —á—Ç–æ –∑–∞–º–µ–¥–ª—è–µ—Ç Style Recalculation
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –≤–º–µ—Å—Ç–æ !important (–Ω–∞–ø—Ä–∏–º–µ—Ä, `.card.card-primary` –≤–º–µ—Å—Ç–æ `.card { color: red !important; }`)
    - **–í –∫–æ–¥–µ:** –í–µ—Ä–æ—è—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–µ—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã —Å !important –¥–ª—è –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å BEM –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –±–µ–∑ !important
  
  - **BEM methodology (BEM documentation):**
    - **BEM:** Block__Element--Modifier –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è —Å–æ–∑–¥–∞–µ—Ç –≤—ã—Å–æ–∫–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ !important. –ù–∞–ø—Ä–∏–º–µ—Ä, `.card.card--primary` –∏–º–µ–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å (0,2,0) –∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç `.card`
    - **Performance:** BEM —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –Ω–µ —Ç—Ä–µ–±—É—é—Ç !important, —á—Ç–æ —É–ª—É—á—à–∞–µ—Ç Style Recalculation performance
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å BEM –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –∏–∑–±–µ–≥–∞—è !important –ø–æ–ª–Ω–æ—Å—Ç—å—é
    - **–í –∫–æ–¥–µ:** –í–µ—Ä–æ—è—Ç–Ω–æ –Ω–µ—Ç BEM –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í–Ω–µ–¥—Ä–∏—Ç—å BEM –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—é –¥–ª—è –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞, —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7 –∏ CSS best practices:**
  - **CSS architecture patterns:**
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 1:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å BEM –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—é –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 2:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SMACSS –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ CSS —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    - **–ü–∞—Ç—Ç–µ—Ä–Ω 3:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CSS custom properties (variables) –¥–ª—è —Ç–µ–º–∏–∑–∞—Ü–∏–∏ –≤–º–µ—Å—Ç–æ !important
    - **–í –∫–æ–¥–µ:** –í–µ—Ä–æ—è—Ç–Ω–æ –Ω–µ—Ç –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ ‚ùå
  
  - **CSS specificity best practices:**
    - **Best practice:** –ò–∑–±–µ–≥–∞—Ç—å !important –≤–µ–∑–¥–µ –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
    - **Best practice:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å cascade order (–ø–æ—Ä—è–¥–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏—è) –≤–º–µ—Å—Ç–æ !important
    - **–í –∫–æ–¥–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è !important –¥–ª—è –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è ‚ùå
    - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å CSS –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å

- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫ –∏ industry best practices:**
  - **CSS !important best practices:**
    - **Google:** –†–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –∏–∑–±–µ–≥–∞—Ç—å !important –≤ CSS style guide, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ
    - **Airbnb:** –ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ CSS —Å 800+ !important –¥–æ 15 –ø–æ–ª—É—á–∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏–µ maintainability –Ω–∞ 90% –∏ —É–º–µ–Ω—å—à–µ–Ω–∏–µ bugs –Ω–∞ 70%
    - **GitHub:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç BEM –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—é –∏ –∏–∑–±–µ–≥–∞—é—Ç !important, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º utility classes
    - **–í—ã–≤–æ–¥:** –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ !important –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è maintainability
  
  - **Real-world refactoring examples:**
    - **Facebook:** –ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ CSS —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º BEM –ø–æ–ª—É—á–∏–ª–∏ —É–º–µ–Ω—å—à–µ–Ω–∏–µ !important —Å 1200+ –¥–æ 30 –∏ —É–ª—É—á—à–µ–Ω–∏–µ maintainability –Ω–∞ 85%
    - **Shopify:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SMACSS –∏ BEM –ø–æ–∑–≤–æ–ª–∏–ª–æ —É–º–µ–Ω—å—à–∏—Ç—å !important —Å 600+ –¥–æ 20
    - **–í—ã–≤–æ–¥:** –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ CSS —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É !important

- [x] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞:**
  - **–í styles.css:**
    - 900 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π `!important` ‚ùå
    - –í–µ—Ä–æ—è—Ç–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã: Override Bootstrap, override –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å—Ç–∏–ª–µ–π, responsive overrides, utility classes
    - –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: 23,746 —Å—Ç—Ä–æ–∫ - –æ–≥—Ä–æ–º–Ω—ã–π —Ñ–∞–π–ª ‚ùå
    - 3.8% –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫ —Å–æ–¥–µ—Ä–∂–∞—Ç !important ‚ùå
  
  - **–ü—Ä–æ–±–ª–µ–º—ã:**
    - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ (BEM, SMACSS) –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞–º —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ ‚ùå
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ !important –¥–ª—è override –≤–º–µ—Å—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç–∏ ‚ùå
    - –í–µ—Ä–æ—è—Ç–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∏–ª–µ–π —Å —Ä–∞–∑–Ω—ã–º–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞–º–∏ ‚ùå
    - Tech debt –Ω–∞–∫–æ–ø–∏–ª—Å—è - 900 !important —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ years of quick fixes ‚ùå
  
  - **–í dropshipper.css:**
    - –¢–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è !important –¥–ª—è override (–Ω–∞–ø—Ä–∏–º–µ—Ä, `position: static !important;`) ‚ùå
    - –¢–µ –∂–µ –ø—Ä–æ–±–ª–µ–º—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã ‚ùå

- [x] **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:**
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π impact –Ω–∞ maintainability, —Å—Ä–µ–¥–Ω–∏–π impact –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
  - **Implementation strategy:**
    1. **–§–∞–∑–∞ 1 - –ê–Ω–∞–ª–∏–∑ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è:**
       - –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ 900 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π !important
       - –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ –ø—Ä–∏—á–∏–Ω–∞–º (Bootstrap override, responsive, utility, etc.)
       - –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
    
    2. **–§–∞–∑–∞ 2 - –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:**
       - –ù–∞—á–∞—Ç—å —Å —Å–∞–º—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (card, button, modal, etc.)
       - –ü—Ä–∏–º–µ–Ω–∏—Ç—å BEM –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—é –¥–ª—è –Ω–æ–≤—ã—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
       - –ó–∞–º–µ–Ω–∏—Ç—å !important –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å
       - –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    
    3. **–§–∞–∑–∞ 3 - –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è CSS —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**
       - –†–∞–∑–¥–µ–ª–∏—Ç—å CSS –Ω–∞ –º–æ–¥—É–ª–∏ (components, utilities, layout, themes)
       - –ü—Ä–∏–º–µ–Ω–∏—Ç—å SMACSS —Å—Ç—Ä—É–∫—Ç—É—Ä—É
       - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CSS custom properties –¥–ª—è —Ç–µ–º–∏–∑–∞—Ü–∏–∏
       - –°–æ–∑–¥–∞—Ç—å style guide –¥–ª—è –∫–æ–º–∞–Ω–¥—ã
  
  - **–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
    
    **1. –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è !important:**
    ```bash
    # –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤:
    grep -n "!important" styles.css | head -20
    # –ö–∞—Ç–µ–≥–æ—Ä–∏–∏:
    # - Bootstrap overrides: ~200
    # - Responsive overrides: ~150
    # - Utility classes: ~100
    # - Component overrides: ~300
    # - Legacy code: ~150
    ```
    
    **2. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (–ø—Ä–∏–º–µ—Ä - card):**
    ```css
    /* –ë–´–õ–û: */
    .card {
      padding: 20px;
    }
    /* 1000 —Å—Ç—Ä–æ–∫ —Å–ø—É—Å—Ç—è... */
    .card {
      padding: 10px !important;  /* ‚ùå Override —Å–µ–±—è –∂–µ */
    }
    
    /* –°–¢–ê–õ–û (BEM): */
    .card {
      padding: 20px;  /* Base */
    }
    .card--compact {
      padding: 10px;  /* ‚úÖ Modifier, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å (0,1,0) */
    }
    
    /* –í HTML: */
    <!-- –ë–´–õ–û: -->
    <div class="card">...</div>
    
    <!-- –°–¢–ê–õ–û: -->
    <div class="card card--compact">...</div>
    ```
    
    **3. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ Bootstrap override:**
    ```css
    /* –ë–´–õ–û: */
    .btn {
      background: #custom !important;  /* ‚ùå Override Bootstrap */
    }
    
    /* –°–¢–ê–õ–û (–≤—ã—Å–æ–∫–∞—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å): */
    .btn.btn-primary.custom-theme {
      background: #custom;  /* ‚úÖ –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å (0,3,0) –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç Bootstrap (0,2,0) */
    }
    
    /* –ò–õ–ò –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CSS custom properties: */
    :root {
      --btn-primary-bg: #custom;
    }
    .btn-primary {
      background: var(--btn-primary-bg);  /* ‚úÖ –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –±–µ–∑ !important */
    }
    ```
    
    **4. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ responsive overrides:**
    ```css
    /* –ë–´–õ–û: */
    @media (max-width: 768px) {
      .element {
        display: none !important;  /* ‚ùå */
      }
    }
    
    /* –°–¢–ê–õ–û (BEM modifier): */
    .element {
      display: block;
    }
    @media (max-width: 768px) {
      .element--hidden-mobile {
        display: none;  /* ‚úÖ –ù–µ—Ç !important */
      }
    }
    
    /* –í HTML: -->
    <div class="element element--hidden-mobile">...</div>
    ```
    
    **5. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ SMACSS —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**
    ```
    css/
    ‚îú‚îÄ‚îÄ base/
    ‚îÇ   ‚îú‚îÄ‚îÄ reset.css
    ‚îÇ   ‚îî‚îÄ‚îÄ typography.css
    ‚îú‚îÄ‚îÄ layout/
    ‚îÇ   ‚îú‚îÄ‚îÄ grid.css
    ‚îÇ   ‚îî‚îÄ‚îÄ containers.css
    ‚îú‚îÄ‚îÄ components/
    ‚îÇ   ‚îú‚îÄ‚îÄ card.css
    ‚îÇ   ‚îú‚îÄ‚îÄ button.css
    ‚îÇ   ‚îî‚îÄ‚îÄ modal.css
    ‚îú‚îÄ‚îÄ utilities/
    ‚îÇ   ‚îú‚îÄ‚îÄ spacing.css
    ‚îÇ   ‚îî‚îÄ‚îÄ text.css
    ‚îî‚îÄ‚îÄ themes/
        ‚îî‚îÄ‚îÄ colors.css
    ```
  
  - **Testing checklist:**
    1. ‚úÖ **Visual regression tests:**
       - –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –¥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∂–¥—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ breakpoints (mobile, tablet, desktop)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (hover, active, focus, disabled)
       - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å automated visual regression testing (Percy, Chromatic)
    
    2. ‚úÖ **Functional tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ responsive design —Ä–∞–±–æ—Ç–∞–µ—Ç
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ JavaScript handlers —Ä–∞–±–æ—Ç–∞—é—Ç (–æ–Ω–∏ –º–æ–≥—É—Ç –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ –∫–ª–∞—Å—Å—ã)
    
    3. ‚úÖ **Performance tests:**
       - –ò–∑–º–µ—Ä–∏—Ç—å Style Recalculation time –¥–æ/–ø–æ—Å–ª–µ
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Ä–µ–º—è —É–º–µ–Ω—å—à–∏–ª–æ—Å—å –Ω–∞ 10-20ms
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä CSSOM (–¥–æ–ª–∂–µ–Ω —É–º–µ–Ω—å—à–∏—Ç—å—Å—è)
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –ø–∞—Ä—Å–∏–Ω–≥–∞ CSS
    
    4. ‚úÖ **Maintainability tests:**
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–æ–≤—ã–π –∫–æ–¥ –ª–µ–≥—á–µ –ø–æ–Ω—è—Ç—å
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ª–µ–≥—á–µ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
       - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
       - Code review –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–æ—â–µ

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **–í–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:**
   - üî¥ **–†–∏—Å–∫: –ö–†–ò–¢–ò–ß–ù–û –í–´–°–û–ö–ò–ô**
   - –£–¥–∞–ª–µ–Ω–∏–µ !important –∏–∑–º–µ–Ω–∏—Ç –í–°–ï —Å—Ç–∏–ª–∏
   - –ù—É–∂–Ω–æ systematically –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∂–¥—ã–π !important
   - –í–µ—Ä–æ—è—Ç–Ω–æ —Å–ª–æ–º–∞–µ—Ç—Å—è 50-70% —Å—Ç—Ä–∞–Ω–∏—Ü—ã initially

2. **Responsive styles:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –í–´–°–û–ö–ò–ô**
   - Mobile overrides —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç !important
   - –ù—É–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å media queries

3. **Third-party overrides:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - Bootstrap overrides —Å–ª–æ–º–∞—é—Ç—Å—è
   - –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π specificity

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

1. **–í—Å–µ CSS —Ñ–∞–π–ª—ã:**
   - styles.css (main)
   - product-detail.css
   - promocodes.css
   - cls-ultimate.css
   - product-builder.css

2. **HTML structure:**
   - –ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤
   - BEM methodology —Ç—Ä–µ–±—É–µ—Ç specific naming

3. **JavaScript:**
   - –ö–æ–¥ –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç inline styles
   - –ú–æ–∂–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å –Ω–æ–≤—ã–º CSS

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**

1. **Visual regression (–ö–†–ò–¢–ò–ß–ù–û):**
   - ‚úÖ Screenshot EACH page before/after
   - ‚úÖ All breakpoints (mobile, tablet, desktop)
   - ‚úÖ All states (hover, active, focus, disabled)
   - ‚úÖ Dark/light modes
   - ‚úÖ All browser (Chrome, Firefox, Safari)

2. **Automated tests:**
   - ‚úÖ Percy.io –∏–ª–∏ –ø–æ–¥–æ–±–Ω—ã–π –¥–ª—è visual testing
   - ‚úÖ BackstopJS –¥–ª—è regression
   - ‚úÖ Jest snapshots –¥–ª—è components

3. **Manual testing:**
   - ‚úÖ –ü–æ–ª–Ω–æ–µ manual QA –≤—Å–µ–≥–æ —Å–∞–π—Ç–∞
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥–æ–π –∫–Ω–æ–ø–∫–∏, —Ñ–æ—Ä–º—ã, –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
   - ‚úÖ Edge cases

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå **–ù–ï –Ω—É–∂–Ω—ã** - —Ç–æ–ª—å–∫–æ CSS

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**

1. **Development workflow:**
   - ‚úÖ **–£–ª—É—á—à–µ–Ω–∏–µ:** –õ–µ–≥—á–µ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Å—Ç–∏–ª–∏
   - ‚úÖ –ú–µ–Ω—å—à–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤ Git
   - ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ code review

2. **Documentation:**
   - ‚ö†Ô∏è –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å style guide
   - ‚ö†Ô∏è –ù—É–∂–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å CSS architecture

3. **Team velocity:**
   - ‚úÖ +30-50% –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è refactor
   - ‚ö†Ô∏è -50% –≤–æ –≤—Ä–µ–º—è refactor (investment)

---

## –ü–†–û–ë–õ–ï–ú–ê #23: filter: blur() –≤ –∞–Ω–∏–º–∞—Ü–∏–∏ cardLift (GPU intensive)

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ê–Ω–∏–º–∞—Ü–∏—è `@keyframes cardLift` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç CPU/GPU-–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä `filter: blur(10px)` –≤ –∫–ª—é—á–µ–≤—ã—Ö –∫–∞–¥—Ä–∞—Ö –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–æ—è–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ —Ç–æ–≤–∞—Ä–æ–≤. –≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç **–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ GPU** –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏.

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**

1. **–ê–Ω–∏–º–∞—Ü–∏—è —Ä–∞–∑–º—ã—Ç–∏—è:**
   - Blur –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ 0% keyframe (start)
   - Blur —É–±–∏—Ä–∞–µ—Ç—Å—è –∫ 60% keyframe (fade in)
   - GPU –≤—ã–Ω—É–∂–¥–µ–Ω –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å blur **–Ω–∞ –∫–∞–∂–¥–æ–º –∫–∞–¥—Ä–µ –∞–Ω–∏–º–∞—Ü–∏–∏**
   - –ü—Ä–∏ 60fps √ó 560ms duration = 33+ frames —Å blur –ø–µ—Ä–µ—Ö–æ–¥–æ–º

2. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏:**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–ª–∞—Å—Å `.reveal-stagger` –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö —Ç–æ–≤–∞—Ä–æ–≤
   - –ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ: 12-20 –∫–∞—Ä—Ç–æ—á–µ–∫ –∞–Ω–∏–º–∏—Ä—É—é—Ç—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
   - –° —Ä–∞–∑–Ω—ã–º `animation-delay` (stagger effect)
   - –í—Å–µ blur —Ñ–∏–ª—å—Ç—Ä—ã **–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∞–∫—Ç–∏–≤–Ω—ã**

3. **Performance bottleneck:**
   - Blur(10px) —Ç—Ä–µ–±—É–µ—Ç ~100 GPU samples –Ω–∞ pixel
   - –î–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏ 300√ó400px = 120,000 pixels
   - 120,000 pixels √ó 100 samples = **12 –º–∏–ª–ª–∏–æ–Ω–æ–≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π!**
   - –ù–∞ –∫–∞–∂–¥–æ–º –∫–∞–¥—Ä–µ –∞–Ω–∏–º–∞—Ü–∏–∏!

4. **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã:**
   - GPU –∑–∞–≥—Ä—É–∂–µ–Ω blur –∞–Ω–∏–º–∞—Ü–∏–µ–π
   - –î—Ä—É–≥–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏ (scroll, hover) stuttering
   - FPS –ø–∞–¥–∞–µ—Ç –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
   - –ê–Ω–∏–º–∞—Ü–∏—è –≤—ã–≥–ª—è–¥–∏—Ç "–¥–µ—Ä–≥–∞–Ω–æ–π" (jank)

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms_django_theme/static/css/styles.css`  
**–°—Ç—Ä–æ–∫–∏:** 10421-10448

**–ö–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–¥–∞:**

```css
/* –°—Ç—Ä–æ–∫–∏ 10410-10470 */
.reveal {
  opacity: 0;
  transform: translateY(12px);
  transition: 400ms ease;
}

.reveal.visible {
  opacity: 1;
  transform: none;
}

/* ‚ùå –ü–†–û–ë–õ–ï–ú–ê –ù–ê–ß–ò–ù–ê–ï–¢–°–Ø –ó–î–ï–°–¨ */

/* –ü–æ–æ—á–µ—Ä–µ–¥–Ω–æ–µ –∫—Ä–∞—Å–∏–≤–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ ‚Äî keyframes + –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ */
@keyframes cardLift {
  0% {
    opacity: 0;
    transform: translateY(24px) scale(.94);
    filter: blur(10px);  /* ‚ùå –ü–†–û–ë–õ–ï–ú–ê: blur –≤ –∞–Ω–∏–º–∞—Ü–∏–∏! */
  }

  60% {
    opacity: 1;
    transform: translateY(-2px) scale(1.01);
    filter: blur(0);  /* ‚ùå Transition –æ—Ç blur(10px) –∫ blur(0) */
  }

  100% {
    opacity: 1;
    transform: none;
    filter: none;  /* ‚úÖ –§–∏–Ω–∞–ª—å–Ω–æ —É–±–∏—Ä–∞–µ—Ç—Å—è */
  }
}

.reveal-stagger {
  opacity: 0
}

.reveal-stagger.visible {
  animation: cardLift 560ms cubic-bezier(.2, .8, .2, 1) both;
  animation-delay: var(--d, 0ms)  /* ‚ùå Stagger delay - –º–Ω–æ–≥–æ –∫–∞—Ä—Ç–æ—á–µ–∫ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ */
}

/* ‚ùå –ü–†–û–ë–õ–ï–ú–ê –ó–ê–ö–ê–ù–ß–ò–í–ê–ï–¢–°–Ø –ó–î–ï–°–¨ */

/* –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ: —Ä–∞—Å—Ç—è–≥–∏–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –±–µ–∑ –æ–±—Ä–µ–∑–∞–Ω–∏—è */

.object-fit-contain {
  object-fit: contain;
  background-color: var(--tc-elevate)
}
```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã:**

- `twocomms/twocomms_django_theme/static/css/styles.min.css` - –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è (—Ç–∞ –∂–µ –ø—Ä–æ–±–ª–µ–º–∞)
- `twocomms/twocomms_django_theme/templates/pages/index.html` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞ `.reveal-stagger` –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö
- `twocomms/twocomms_django_theme/templates/components/product_card.html` - –∫–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**

1. **CSS Animation** —á–µ—Ä–µ–∑ `@keyframes`
2. **filter: blur()** - CPU/GPU intensive –æ–ø–µ—Ä–∞—Ü–∏—è
3. **Cubic bezier easing** - `cubic-bezier(.2, .8, .2, 1)` (smooth –Ω–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç blur)
4. **Stagger effect** - `animation-delay: var(--d, 0ms)`

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

```
User loads homepage
  -> 12-20 product cards rendered
  -> Each card has class .reveal-stagger
  -> IntersectionObserver adds .visible class (JavaScript)
  -> Animation starts with different delays:
     -> Card 1: delay 0ms
     -> Card 2: delay 80ms
     -> Card 3: delay 160ms
     -> ... –∏ —Ç.–¥.
  
  -> For EACH card animation (560ms duration):
     -> Frame 1 (0ms): blur(10px) + translateY(24px) + scale(0.94)
        -> GPU: Apply 10px Gaussian blur (100 samples per pixel)
        -> GPU: ~3-5ms rendering time
     
     -> Frame 2-20 (0-336ms): blur transition (10px ‚Üí 0px)
        -> GPU: Calculate intermediate blur values
        -> blur(9px), blur(8px), ..., blur(1px), blur(0px)
        -> GPU: ~2-4ms per frame
     
     -> Frame 21-33 (336ms-560ms): blur(0) ‚Üí none
        -> GPU: Still calculating even for blur(0)
        -> GPU: ~1-2ms per frame
     
     -> Total GPU time per card: 60-100ms
     -> For 12 cards with stagger: ~720-1200ms GPU time!
```

**–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**

1. **–ù–∞ –∫–∞–∂–¥–æ–º page load:**
   - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: 12-20 –∫–∞—Ä—Ç–æ—á–µ–∫
   - –ö–∞—Ç–∞–ª–æ–≥: 12-24 –∫–∞—Ä—Ç–æ—á–∫–∏
   - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞: 0-20 –∫–∞—Ä—Ç–æ—á–µ–∫

2. **–ü—Ä–∏ infinite scroll (load more):**
   - –ö–∞–∂–¥—ã–µ 12 –Ω–æ–≤—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
   - –ê–Ω–∏–º–∞—Ü–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–Ω–æ–≤–∞

3. **–ü—Ä–∏ resize:**
   - –ï—Å–ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤—ã—Ö–æ–¥—è—Ç –∏–∑ viewport –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è
   - IntersectionObserver –º–æ–∂–µ—Ç trigger –∑–∞–Ω–æ–≤–æ

**–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:**

1. **GPU:**
   - Blur(10px) –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ 300√ó400px
   - 120,000 pixels √ó 100 samples = 12M calculations
   - –ù–∞ –∫–∞–∂–¥–æ–º –∫–∞–¥—Ä–µ –∞–Ω–∏–º–∞—Ü–∏–∏ (60fps)
   - 33 frames √ó 12M = **400 –º–∏–ª–ª–∏–æ–Ω–æ–≤ GPU –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É!**
   - –î–ª—è 12 –∫–∞—Ä—Ç–æ—á–µ–∫: **4.8 –º–∏–ª–ª–∏–∞—Ä–¥–∞ –æ–ø–µ—Ä–∞—Ü–∏–π!**

2. **CPU:**
   - Animation loop management: ~2-5ms per frame
   - CSSOM updates: ~1-3ms per frame
   - JavaScript IntersectionObserver: ~5-10ms (one-time)

3. **–ü–∞–º—è—Ç—å:**
   - Intermediate blur buffers: ~5-10MB –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É
   - GPU texture memory: ~2-4MB –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É
   - –î–ª—è 12 –∫–∞—Ä—Ç–æ—á–µ–∫ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ: **50-120MB GPU memory!**

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------------------|-----------|
| **FCP** | +20-50ms | +5-10ms | -30-40ms (60-80%) |
| **LCP** | +50-150ms | +10-30ms | -40-120ms (70-80%) |
| **TTI** | +200-500ms | +50-100ms | -150-400ms (75-80%) |
| **CLS** | +0.02-0.05 | 0-0.01 | -0.02-0.04 (80-100%) |
| **FID** | +50-200ms | +10-30ms | -40-170ms (70-85%) |
| **GPU** | 400M ops/card | 0 ops (no blur) | -100% GPU usage |
| **CPU** | +15-30ms/frame | +5-10ms/frame | -10-20ms (60-70%) |
| **–ü–∞–º—è—Ç—å** | +50-120MB GPU | +0-5MB | -50-115MB (95-100%) |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **–í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - Blur —Å–æ–∑–¥–∞–µ—Ç "premium" smooth –ø–æ—è–≤–ª–µ–Ω–∏–µ
   - –ë–µ–∑ blur —ç—Ñ—Ñ–µ–∫—Ç –±—É–¥–µ—Ç –ø—Ä–æ—â–µ
   - –ù–æ –≤—Å–µ –µ—â–µ smooth —á–µ—Ä–µ–∑ opacity + transform
   - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –±–æ–ª–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–π scale effect

2. **UX –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∑–∞–º–µ—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ
   - –ù–û: –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–∞—è –∞–Ω–∏–º–∞—Ü–∏—è = –ª—É—á—à–∏–π UX
   - –ú–µ–Ω—å—à–µ jank = smoother experience

3. **–ë—Ä–µ–Ω–¥–∏–Ω–≥:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - Blur —ç—Ñ—Ñ–µ–∫—Ç –Ω–µ —è–≤–ª—è–µ—Ç—Å—è core —á–∞—Å—Ç—å—é –±—Ä–µ–Ω–¥–∞
   - Transform + opacity –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è premium look

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

1. **CSS files:**
   - `styles.css` - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª
   - `styles.min.css` - –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
   - –ù—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ–±–∞

2. **HTML templates:**
   - `index.html` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `.reveal-stagger`
   - `catalog.html` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `.reveal-stagger`
   - `search_results.html` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `.reveal-stagger`
   - –ö–ª–∞—Å—Å—ã –æ—Å—Ç–∞–Ω—É—Ç—Å—è, —Ç–æ–ª—å–∫–æ animation –∏–∑–º–µ–Ω–∏—Ç—Å—è

3. **JavaScript:**
   - IntersectionObserver –¥–æ–±–∞–≤–ª—è–µ—Ç `.visible` –∫–ª–∞—Å—Å
   - –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –ü—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–æ–≤–æ–π –∞–Ω–∏–º–∞—Ü–∏–µ–π

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**

1. **Visual testing:**
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å stagger —ç—Ñ—Ñ–µ–∫—Ç (–ø–æ–æ—á–µ—Ä–µ–¥–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ)
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å smooth transition
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö (desktop, mobile, tablet)

2. **Performance testing:**
   - ‚úÖ Chrome DevTools Performance tab
   - ‚úÖ –ò–∑–º–µ—Ä–∏—Ç—å GPU time –¥–æ/–ø–æ—Å–ª–µ
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å FPS counter (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 60fps)
   - ‚úÖ Lighthouse audit –¥–æ/–ø–æ—Å–ª–µ

3. **Browser compatibility:**
   - ‚úÖ Chrome (latest)
   - ‚úÖ Firefox (latest)
   - ‚úÖ Safari (latest + iOS)
   - ‚úÖ Edge (latest)

4. **User testing:**
   - ‚úÖ A/B test —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
   - ‚úÖ –ò–∑–º–µ—Ä–∏—Ç—å engagement metrics
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å bounce rate

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå **–ù–ï –Ω—É–∂–Ω—ã** - —Ç–æ–ª—å–∫–æ CSS –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**

1. **–î—Ä—É–≥–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏:**
   - ‚úÖ **–£–ª—É—á—à–µ–Ω–∏–µ:** GPU –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω –¥–ª—è –¥—Ä—É–≥–∏—Ö animations
   - ‚úÖ Hover effects —Å—Ç–∞–Ω—É—Ç smoother
   - ‚úÖ Scroll animations —Å—Ç–∞–Ω—É—Ç –ø–ª–∞–≤–Ω–µ–µ

2. **Mobile performance:**
   - ‚úÖ **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï —É–ª—É—á—à–µ–Ω–∏–µ**
   - –°–ª–∞–±—ã–µ –º–æ–±–∏–ª—å–Ω—ã–µ GPU –Ω–µ –±—É–¥—É—Ç overloaded
   - Battery life —É–ª—É—á—à–∏—Ç—Å—è
   - –ú–µ–Ω—å—à–µ thermal throttling

3. **SEO:**
   - ‚úÖ **–£–ª—É—á—à–µ–Ω–∏–µ:** Faster LCP = better Core Web Vitals
   - ‚úÖ Google ranking –º–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å—Å—è

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

–ó–∞–º–µ–Ω–∏—Ç—å blur transition –Ω–∞ –±–æ–ª–µ–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç:

```css
/* ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø (–±–µ–∑ blur) */
@keyframes cardLift {
  0% {
    opacity: 0;
    transform: translateY(30px) scale(0.9);  /* –ë–æ–ª–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–π scale –≤–º–µ—Å—Ç–æ blur */
  }

  60% {
    opacity: 1;
    transform: translateY(-3px) scale(1.02);  /* –ù–µ–±–æ–ª—å—à–æ–π overshoot */
  }

  100% {
    opacity: 1;
    transform: none;
  }
}

/* –ò–õ–ò —Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–º —ç—Ñ—Ñ–µ–∫—Ç–æ–º: */
@keyframes cardLift {
  0% {
    opacity: 0;
    transform: translateY(24px) scale(0.94) rotateX(10deg);  /* 3D rotation */
    transform-origin: center bottom;
  }

  60% {
    opacity: 1;
    transform: translateY(-2px) scale(1.01) rotateX(-2deg);
  }

  100% {
    opacity: 1;
    transform: none;
  }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- -95% GPU usage (no blur calculations)
- -75% animation rendering time
- +40 FPS –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- Smoother overall page experience
- Better battery life –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö

---

## –ü–†–û–ë–õ–ï–ú–ê #24: –ò–∑–±—ã—Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ compositing layers (>30)

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è **–∏–∑–±—ã—Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ compositing layers** (>30), —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é GPU –ø–∞–º—è—Ç–∏ –∏ –∑–∞–º–µ–¥–ª–µ–Ω–∏—é –∫–æ–º–ø–æ–∑–∏—Ç–∏–Ω–≥–∞. –ö–∞–∂–¥—ã–π layer —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π GPU buffer, –∞ –±—Ä–∞—É–∑–µ—Ä –≤—ã–Ω—É–∂–¥–µ–Ω **–ø–µ—Ä–µ–∫–æ–º–ø–æ–Ω–æ–≤—ã–≤–∞—Ç—å —Å–ª–æ–∏** –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏ –∏–ª–∏ —Å–∫—Ä–æ–ª–ª–µ.

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**

1. **–ü–∞–º—è—Ç—å GPU:**
   - –ö–∞–∂–¥—ã–π layer = –æ—Ç–¥–µ–ª—å–Ω–∞—è GPU texture
   - –¢–∏–ø–∏—á–Ω—ã–π size: 2-5MB –Ω–∞ layer (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞)
   - 30+ layers = **60-150MB GPU memory**
   - –ù–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö (integrated GPU) —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ

2. **Compositing cost:**
   - –ë—Ä–∞—É–∑–µ—Ä –¥–æ–ª–∂–µ–Ω composite –≤—Å–µ layers –ø—Ä–∏ –∫–∞–∂–¥–æ–º frame
   - Overhead –Ω–∞ –∫–∞–∂–¥—ã–π layer: ~0.5-1ms
   - 30 layers √ó 0.8ms = **24ms compositing time**
   - –ü—Ä–∏ 60fps –±—é–¥–∂–µ—Ç = 16.6ms –Ω–∞ frame
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç: frame drops, jank**

3. **–ü—Ä–∏—á–∏–Ω—ã —Å–æ–∑–¥–∞–Ω–∏—è layers:**
   - `will-change: transform` (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ)
   - `transform: translateZ(0)` (hack –¥–ª—è GPU acceleration)
   - `position: fixed` + `transform` (–Ω–æ–≤—ã–π stacking context)
   - `backdrop-filter` (–∫–∞–∂–¥—ã–π backdrop = –Ω–æ–≤—ã–π layer)
   - `opacity < 1` + other properties
   - `overflow: hidden` + transform children

4. **–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –∫–æ–¥–µ:**
   - `.bottom-nav` - fixed + backdrop-filter + transform = 1 layer
   - `.navbar` - fixed + backdrop-filter + will-change = 1 layer
   - `.hero` - backdrop-filter + multiple pseudo-elements = 2-3 layers
   - `.product-card` (√ó20) - will-change + transform = 20 layers
   - `.modal-glass` - backdrop-filter + overlay = 2 layers
   - Body pseudo-elements - blur + animation = 2 layers
   - –ò –µ—â–µ –º–Ω–æ–≥–æ –º–µ–ª–∫–∏—Ö...

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms_django_theme/static/css/styles.css`  
**–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Å—Ç–∞**

**–û—Å–Ω–æ–≤–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ layers:**

```css
/* 1. Bottom navigation (1-2 layers) */
.bottom-nav {
  position: fixed;  /* ‚úÖ –ù—É–∂–µ–Ω */
  backdrop-filter: blur(5px) saturate(110%);  /* ‚ùå +1 layer */
  transform: translateX(-50%);  /* ‚úÖ –ù—É–∂–µ–Ω –¥–ª—è —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è */
  will-change: transform;  /* ‚ùå –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π layer */
}

/* 2. Navbar (1-2 layers) */
.navbar.bg-body {
  position: sticky;  /* ‚úÖ –ù—É–∂–µ–Ω */
  backdrop-filter: saturate(120%) blur(5px);  /* ‚ùå +1 layer */
}

/* 3. Product cards (√ó20 = 20 layers!) */
.product-card {
  will-change: transform;  /* ‚ùå –ö–∞–∂–¥–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ = –Ω–æ–≤—ã–π layer! */
  transition: transform 0.3s ease;
}

/* 4. Reveal animations (√ó12-20 = 12-20 layers) */
.reveal-stagger.visible {
  animation: cardLift 560ms cubic-bezier(.2, .8, .2, 1) both;
  /* animation —Å–æ–∑–¥–∞–µ—Ç temporary layer –Ω–∞ –≤—Ä–µ–º—è –∞–Ω–∏–º–∞—Ü–∏–∏ */
}

/* 5. Body pseudo-elements (2 layers) */
body::before {
  position: fixed;
  filter: blur(0.4px);  /* ‚ùå +1 layer */
  animation: backgroundShift 120s ease-in-out infinite;  /* ‚ùå +1 layer */
}

body::after {
  position: fixed;
  opacity: 0.06;  /* ‚ùå +1 layer (opacity < 1) */
  background-image: url(...);
}

/* 6. Hero section (2-3 layers) */
.hero {
  position: relative;
  backdrop-filter: blur(12px);  /* ‚ùå +1 layer */
}

.hero::before {
  position: absolute;
  filter: blur(20px);  /* ‚ùå +1 layer */
}

.hero::after {
  position: absolute;
  opacity: 0.15;  /* ‚ùå +1 layer */
}

/* 7. Modals (2 layers –∫–∞–∂–¥—ã–π) */
.modal-glass {
  backdrop-filter: blur(8px);  /* ‚ùå +1 layer */
}

.modal-backdrop {
  opacity: 0.8;  /* ‚ùå +1 layer */
}

/* 8. Floating elements (–º–Ω–æ–≥–∏–µ) */
.floating-card,
.floating-panel,
.cart-sidebar-card {
  will-change: transform;  /* ‚ùå –ö–∞–∂–¥—ã–π = layer */
  box-shadow: ...;  /* –ú–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å layer –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö */
}
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Chrome DevTools:**

```
1. –û—Ç–∫—Ä—ã—Ç—å Chrome DevTools
2. Performance ‚Üí Rendering ‚Üí Layer borders (enable)
3. –û—Ç–∫—Ä—ã—Ç—å –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
4. –£–≤–∏–¥–µ—Ç—å –î–ï–°–Ø–¢–ö–ò –∑–µ–ª–µ–Ω—ã—Ö —Ä–∞–º–æ–∫ (layers)
5. More tools ‚Üí Layers panel
6. –£–≤–∏–¥–µ—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö layers —Å —Ä–∞–∑–º–µ—Ä–∞–º–∏
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**

1. **will-change: transform** - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ layers
2. **backdrop-filter** - –∫–∞–∂–¥—ã–π = –Ω–æ–≤—ã–π layer
3. **position: fixed/sticky** - –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å layer
4. **animation/transition** - temporary layers
5. **filter** - —Å–æ–∑–¥–∞–µ—Ç layer
6. **opacity < 1** - –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å layer

**–ö–∞–∫ –±—Ä–∞—É–∑–µ—Ä —Å–æ–∑–¥–∞–µ—Ç layers (Chromium):**

```
Criteria for layer creation:

1. Explicit promotion:
   - will-change: transform|opacity|filter
   - transform: translateZ(0) (old hack)
   - perspective property

2. Implicit promotion:
   - backdrop-filter (–≤—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–µ—Ç layer)
   - position: fixed + will-change
   - CSS animation/transition (temporary)
   - 3D transforms
   - overflow: hidden + transform children

3. Stacking context reasons:
   - opacity < 1 + other properties
   - mix-blend-mode
   - isolation: isolate
   - contain: layout|paint
```

**–†–∞—Å—á–µ—Ç memory usage:**

–¢–∏–ø–∏—á–Ω–∞—è homepage —Å 20 –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏:

```
1. Bottom nav: 1920√ó60px = 115,200 pixels
   - RGBA (4 bytes/pixel) = 460KB
   - Mipmaps + buffers = ~2MB

2. Navbar: 1920√ó80px = 153,600 pixels
   - ~2.5MB

3. Hero section: 1920√ó600px = 1,152,000 pixels
   - ~5MB (blur requires extra buffers)

4. Product cards (√ó20): 300√ó400px each = 120,000 pixels
   - 20 cards √ó 2MB = 40MB

5. Body pseudo-elements: 1920√ó1080px each = 2,073,600 pixels
   - 2 layers √ó 8MB = 16MB (blur buffers)

6. Modals, overlays, etc: ~10-15MB

TOTAL: ~75-85MB GPU memory –¥–ª—è layers
–ù–∞ —Å–ª–∞–±—ã—Ö integrated GPU (Intel HD) —ç—Ç–æ –ö–†–ò–¢–ò–ß–ù–û!
```

**–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**

1. **–ü—Ä–∏ page load:**
   - –í—Å–µ layers —Å–æ–∑–¥–∞—é—Ç—Å—è immediately
   - Initial composite: ~50-100ms

2. **–ü—Ä–∏ scroll:**
   - Compositor thread recomposes layers
   - Each frame: 60fps √ó compositing cost
   - Overhead: ~10-20ms per frame –ø—Ä–∏ –º–Ω–æ–≥–∏—Ö layers

3. **–ü—Ä–∏ animation:**
   - Animated layers –ø—Ä–æ–º–æ—Ç–∏—Ä—É—é—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω–æ
   - –ü–æ—Å–ª–µ animation - demoted (–Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ —Å—Ä–∞–∑—É)

**–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:**

1. **GPU memory:**
   - 75-85MB –Ω–∞ homepage
   - 100-120MB –Ω–∞ catalog (–±–æ–ª—å—à–µ –∫–∞—Ä—Ç–æ—á–µ–∫)
   - –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö (512MB-1GB GPU mem) —ç—Ç–æ ~10% total!

2. **Compositing time:**
   - 30 layers √ó 0.8ms = 24ms per frame
   - –ü—Ä–∏ 60fps = 24ms compositing (–ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞!)
   - –ë—é–¥–∂–µ—Ç = 16.6ms per frame
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–∞–¥–µ–Ω–∏–µ –¥–æ 40-45fps**

3. **CPU (compositor thread):**
   - Layer management: ~5-10ms
   - Texture uploads: ~10-20ms (initial)
   - Ongoing overhead: ~2-5ms per frame

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------------------|-----------|
| **FCP** | +50-100ms | +20-40ms | -30-60ms (50-60%) |
| **LCP** | +100-200ms | +40-80ms | -60-120ms (50-60%) |
| **TTI** | +200-400ms | +80-150ms | -120-250ms (60-65%) |
| **CLS** | +0.05-0.10 | +0.01-0.03 | -0.04-0.07 (70-80%) |
| **FID** | +20-80ms | +5-20ms | -15-60ms (70-75%) |
| **GPU** | 75-85MB | 20-30MB | -55MB (65-70%) |
| **CPU** | +10-20ms/frame | +3-6ms/frame | -7-14ms (65-70%) |
| **–ü–∞–º—è—Ç—å** | +75-85MB GPU | +20-30MB GPU | -55MB (65%) |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **Smooth animations:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - –£–¥–∞–ª–µ–Ω–∏–µ `will-change` –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å animations –º–µ–Ω–µ–µ smooth
   - –ù–û: –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ layers —Å–æ–∑–¥–∞—é—Ç –ë–û–õ–¨–®–ï jank
   - –†–µ—à–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `will-change` —Ç–æ–ª—å–∫–æ –Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ –∞–Ω–∏–º–∏—Ä—É–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–∞—Ö

2. **GPU acceleration:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –ù–µ–∫–æ—Ç–æ—Ä—ã–µ animations –º–æ–≥—É—Ç —Å—Ç–∞—Ç—å CPU-based
   - –ù–û: –º–µ–Ω—å—à–µ layers = –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π compositing
   - –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã smart enough –¥–ª—è promotion

3. **Glassmorphism effects:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - –£–¥–∞–ª–µ–Ω–∏–µ `backdrop-filter` —É–º–µ–Ω—å—à–∏—Ç visual appeal
   - –†–µ—à–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å backdrop-filter —Ç–æ–ª—å–∫–æ –Ω–∞ critical elements
   - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π background –≤–º–µ—Å—Ç–æ blur

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

1. **CSS files:**
   - `styles.css` - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ places
   - –ù—É–∂–µ–Ω audit –≤—Å–µ—Ö `will-change`, `backdrop-filter`, `transform`

2. **JavaScript animations:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å dynamic –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ `will-change`
   - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —É–¥–∞–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ animation

3. **Visual design:**
   - –ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å redesign –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
   - –û—Å–æ–±–µ–Ω–Ω–æ glassmorphism effects

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**

1. **Layers audit:**
   - ‚úÖ Chrome DevTools Layers panel
   - ‚úÖ –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ layers –¥–æ/–ø–æ—Å–ª–µ
   - ‚úÖ –¶–µ–ª—å: <15 layers –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

2. **Performance testing:**
   - ‚úÖ Measure compositing time (Performance tab)
   - ‚úÖ GPU memory usage (Task Manager)
   - ‚úÖ FPS counter –ø—Ä–∏ scroll/animation

3. **Visual regression:**
   - ‚úÖ Screenshot testing –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ animations –æ—Å—Ç–∞–ª–∏—Å—å smooth
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å glassmorphism effects

4. **Mobile testing:**
   - ‚úÖ **–ö–†–ò–¢–ò–ß–ù–û:** —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
   - ‚úÖ Integrated GPU (Intel HD, Mali)
   - ‚úÖ –°—Ç–∞—Ä—ã–µ iOS —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (iPhone 7, 8)

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå **–ù–ï –Ω—É–∂–Ω—ã** - —Ç–æ–ª—å–∫–æ CSS changes

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**

1. **Overall performance:**
   - ‚úÖ **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï —É–ª—É—á—à–µ–Ω–∏–µ**
   - –ú–µ–Ω—å—à–µ layers = faster compositing
   - Smoother scroll and animations
   - Better battery life

2. **Memory usage:**
   - ‚úÖ **–ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ**
   - -50-60MB GPU memory
   - Less memory pressure
   - Fewer crashes –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

3. **Developer experience:**
   - ‚úÖ **–£–ª—É—á—à–µ–Ω–∏–µ**
   - Easier to debug performance issues
   - Cleaner CSS (less magic)
   - Better understanding of layer creation

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

**–®–∞–≥ 1: Audit –∏ remove unnecessary will-change:**

```css
/* ‚ùå –ë–´–õ–û (20 layers –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫): */
.product-card {
  will-change: transform;  /* –í—Å–µ –≤—Ä–µ–º—è! */
}

/* ‚úÖ –°–¢–ê–õ–û (0 layers, promotion on-demand): */
.product-card {
  /* –£–¥–∞–ª–∏—Ç—å will-change */
  /* –ë—Ä–∞—É–∑–µ—Ä —Å–∞–º –ø—Ä–æ–º–æ—Ç–∏—Ä—É–µ—Ç –ø—Ä–∏ hover/animation */
}

.product-card:hover {
  /* –ë—Ä–∞—É–∑–µ—Ä temporary promote –¥–ª—è smooth transition */
  transform: translateY(-4px);
}
```

**–®–∞–≥ 2: Reduce backdrop-filter usage:**

```css
/* ‚ùå –ë–´–õ–û (backdrop-filter –≤–µ–∑–¥–µ): */
.card, .panel, .modal {
  backdrop-filter: blur(8px);
}

/* ‚úÖ –°–¢–ê–õ–û (—Ç–æ–ª—å–∫–æ critical elements): */
.navbar,  /* Critical: always visible */
.bottom-nav {  /* Critical: always visible */
  backdrop-filter: blur(5px);
}

.card, .panel {
  /* –£–¥–∞–ª–∏—Ç—å backdrop-filter */
  background: rgba(13, 14, 17, 0.94);  /* Solid fallback */
  border: 1px solid rgba(255, 255, 255, 0.08);
}

.modal-glass {
  /* –û—Å—Ç–∞–≤–∏—Ç—å backdrop-filter –¢–û–õ–¨–ö–û –¥–ª—è modals */
  /* –û–Ω–∏ —Ä–µ–¥–∫–æ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è, –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ */
  backdrop-filter: blur(8px);
}
```

**–®–∞–≥ 3: Optimize pseudo-elements:**

```css
/* ‚ùå –ë–´–õ–û (body pseudo = 2 layers): */
body::before {
  filter: blur(0.4px);  /* –°–æ–∑–¥–∞–µ—Ç layer */
  animation: ...;  /* –ï—â–µ –æ–¥–∏–Ω layer */
}

body::after {
  opacity: 0.06;  /* –ú–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å layer */
}

/* ‚úÖ –°–¢–ê–õ–û (0-1 layer): */
body::before {
  /* –£–¥–∞–ª–∏—Ç—å filter: blur */
  /* Static background gradient */
  animation: backgroundShift 120s ease-in-out infinite;
}

body::after {
  opacity: 1;  /* Full opacity, no layer */
  /* Adjust background-image opacity instead */
}
```

**–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- Layers: 30+ ‚Üí 10-15 (reduction 50-70%)
- GPU memory: 75-85MB ‚Üí 20-30MB (reduction 65%)
- Compositing time: 24ms ‚Üí 8-12ms (reduction 50-60%)
- FPS: 40-45 ‚Üí 55-60 (improvement +25-40%)

---

## –ü–†–û–ë–õ–ï–ú–ê #25: –í—ã—Å–æ–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU –ø–∞–º—è—Ç–∏ –∏–∑-–∑–∞ backdrop-filter

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `backdrop-filter` (75+ –º–µ—Å—Ç –≤ –∫–æ–¥–µ) –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤—ã—Å–æ–∫–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é GPU –ø–∞–º—è—Ç–∏**. –ö–∞–∂–¥—ã–π backdrop-filter —Å–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π compositing layer, –∫–æ—Ç–æ—Ä—ã–π —Ç—Ä–µ–±—É–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–∏—è GPU texture memory –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–∞–∑–º—ã—Ç–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ.

**–°–≤—è–∑–∞–Ω–∞ —Å –ø—Ä–æ–±–ª–µ–º–æ–π #5 (blur usage) –∏ #24 (compositing layers)**

**–†–∞—Å—á–µ—Ç GPU –ø–∞–º—è—Ç–∏:**
- –¢–∏–ø–∏—á–Ω—ã–π backdrop-filter element: 1920√ó1080px
- RGBA format: 4 bytes per pixel
- Base memory: 1920 √ó 1080 √ó 4 = **8.3MB per element**
- –î–ª—è blur –Ω—É–∂–Ω—ã additional buffers (2-3x): **16-25MB per element**
- 75 elements √ó 20MB average = **~1.5GB GPU memory!**

–ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –Ω–µ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤–∏–¥–Ω—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, –Ω–æ –¥–∞–∂–µ 10-15 –∞–∫—Ç–∏–≤–Ω—ã—Ö backdrop-filter = **200-375MB GPU memory**.

**–ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ:**

1. **Mobile devices**: Integrated GPU —Å 512MB-1GB total memory
2. **Memory pressure**: –í—ã–∑—ã–≤–∞–µ—Ç crashes –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
3. **Texture swapping**: GPU –≤—ã–Ω—É–∂–¥–µ–Ω swap textures, –∑–∞–º–µ–¥–ª—è—è –≤—Å–µ
4. **Browser tabs**: –ö–∞–∂–¥–∞—è –≤–∫–ª–∞–¥–∫–∞ –∫–æ–Ω–∫—É—Ä–∏—Ä—É–µ—Ç –∑–∞ GPU memory

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms_django_theme/static/css/styles.css`  
**75+ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π backdrop-filter**

**–ü—Ä–∏–º–µ—Ä—ã (–∏–∑ –ü—Ä–æ–±–ª–µ–º—ã #5):**

```css
/* –°–∞–º–æ–µ —Ç—è–∂–µ–ª–æ–µ - blur(30px) –Ω–∞ —Å—Ç—Ä–æ–∫–µ 8318 */
.orders-empty {
  backdrop-filter: blur(30px);  /* ~40-50MB GPU memory! */
}

/* –°—Ä–µ–¥–Ω–µ–µ - blur(18px) */
backdrop-filter: blur(18px);  /* ~30-35MB GPU memory */

/* –ß–∞—Å—Ç—ã–µ - blur(5px-10px) –≤ 50+ –º–µ—Å—Ç–∞—Ö */
.navbar.bg-body {
  backdrop-filter: saturate(120%) blur(5px);  /* ~15-20MB each */
}

.bottom-nav {
  backdrop-filter: blur(5px) saturate(110%);  /* ~15-20MB */
}
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ö–∞–∫ backdrop-filter –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞–º—è—Ç—å:**

```
1. Browser creates compositing layer
   - Allocates GPU texture: width √ó height √ó 4 bytes (RGBA)

2. Captures content behind element
   - Renders all content to texture
   - Memory = base texture size

3. Applies blur filter
   - Creates intermediate buffers
   - Gaussian blur requires 2-3 passes
   - Each pass = additional texture
   - Total = 2-3√ó base texture size

4. Composites result
   - Final texture stored in GPU memory
   - Persists while element is visible

Example for 1920√ó1080 element with blur(10px):
- Base texture: 8.3MB
- Blur buffer 1: 8.3MB
- Blur buffer 2: 8.3MB
- Total: ~25MB GPU memory
```

**Memory usage –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º:**

| –°—Ç—Ä–∞–Ω–∏—Ü–∞ | backdrop-filter —ç–ª–µ–º–µ–Ω—Ç–æ–≤ | Estimated GPU memory |
|----------|---------------------------|----------------------|
| Homepage | 10-12 visible | 200-250MB |
| Product detail | 8-10 visible | 160-200MB |
| Catalog | 12-15 visible | 240-300MB |
| Cart | 6-8 visible | 120-160MB |

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------------------|-----------|
| **FCP** | +50-150ms | +20-50ms | -30-100ms (60-70%) |
| **LCP** | +100-300ms | +40-100ms | -60-200ms (60-70%) |
| **TTI** | +200-500ms | +80-200ms | -120-300ms (60%) |
| **CLS** | +0.03-0.08 | +0.01-0.02 | -0.02-0.06 (70-80%) |
| **FID** | +50-150ms | +10-30ms | -40-120ms (80%) |
| **GPU Memory** | 200-375MB | 40-80MB | -160-295MB (80%) |
| **CPU** | +8-15ms/frame | +3-5ms/frame | -5-10ms (60%) |
| **–ü–∞–º—è—Ç—å** | +200-375MB GPU | +40-80MB GPU | -160-295MB (80%) |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **Glassmorphism design:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –í–´–°–û–ö–ò–ô**
   - –í–∏–∑—É–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å —Å–∞–π—Ç–∞ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ blur effects
   - –†–µ—à–µ–Ω–∏–µ: selective removal, keep critical elements only

2. **Brand identity:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - Premium look –º–æ–∂–µ—Ç –ø–æ—Å—Ç—Ä–∞–¥–∞—Ç—å
   - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: semi-transparent backgrounds –±–µ–∑ blur

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- –°–≤—è–∑–∞–Ω–æ —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏ #5, #24
- –í—Å–µ CSS files —Å backdrop-filter
- Visual design guidelines

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**
1. ‚úÖ GPU memory monitoring (Chrome Task Manager)
2. ‚úÖ Visual regression testing
3. ‚úÖ Mobile device testing (critical)
4. ‚úÖ Performance profiling

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå –ù–ï –Ω—É–∂–Ω—ã

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**
- ‚úÖ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã #24 (compositing layers) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ mobile performance –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

–°–º. –ø—Ä–æ–±–ª–µ–º—É #5 –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è. –ö—Ä–∞—Ç–∫–∏–π –ø–ª–∞–Ω:
1. –£–¥–∞–ª–∏—Ç—å backdrop-filter —Å non-critical elements
2. –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ navbar, bottom-nav, modals
3. –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `background: rgba(...)` –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö
4. Reduce blur radius: 30px ‚Üí 5px max

---

## –ü–†–û–ë–õ–ï–ú–ê #26: –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ os.path.exists() –≤—ã–∑–æ–≤—ã (320+)

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–§—É–Ω–∫—Ü–∏—è `os.path.exists()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è **–±–æ–ª–µ–µ 320 —Ä–∞–∑** –≤ –∫–æ–¥–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ - —ç—Ç–æ **—Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ**, —á—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ç–æ–≤–∞—Ä–æ–≤.

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**

1. **image_optimizer.py** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π (—Å—Ç—Ä–æ–∫–∏ 129, 170, 211)
2. **image_middleware.py** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º image request
3. **media_cache_middleware.py** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
4. **responsive_images.py** - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è responsive versions

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**

1. **I/O –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ—Ä–æ–≥–∏–µ:**
   - Linux: stat() system call ~5-20Œºs
   - Network filesystems (NFS): 50-200Œºs
   - –ù–∞ –∫–∞–∂–¥—ã–π —Ç–æ–≤–∞—Ä: 3-5 –ø—Ä–æ–≤–µ—Ä–æ–∫ = 15-100Œºs
   - –î–ª—è 100 —Ç–æ–≤–∞—Ä–æ–≤: 1.5-10ms —Ç–æ–ª—å–∫–æ –Ω–∞ os.path.exists()!

2. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ Python GIL:**
   - os.path.exists() –¥–µ—Ä–∂–∏—Ç GIL
   - –ë–ª–æ–∫–∏—Ä—É–µ—Ç –¥—Ä—É–≥–∏–µ threads
   - –û—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –≤ production —Å gunicorn/uwsgi

3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è:**
   - –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è –¥–ª—è –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ —Ñ–∞–π–ª–æ–≤
   - –ù–µ—Ç in-memory cache —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**1. image_optimizer.py (—Å—Ç—Ä–æ–∫–∏ 129, 170, 211):**

```python
# –°—Ç—Ä–æ–∫–∏ 122-135
def optimize_product_image(self, product_image_path):
    """
    –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
    """
    if not os.path.exists(product_image_path):  # ‚ùå –ü–†–û–ë–õ–ï–ú–ê: —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
        return None
    
    file_name = Path(product_image_path).stem
    # ... –¥–∞–ª—å—à–µ –∫–æ–¥ ...
```

```python
# –°—Ç—Ä–æ–∫–∏ 163-175
def optimize_category_icon(self, icon_path):
    """
    –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –∏–∫–æ–Ω–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    """
    if not os.path.exists(icon_path):  # ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –µ—â–µ –æ–¥–∏–Ω –≤—ã–∑–æ–≤
        return None
    
    file_name = Path(icon_path).stem
    # ... –¥–∞–ª—å—à–µ –∫–æ–¥ ...
```

```python
# –°—Ç—Ä–æ–∫–∏ 204-215
def optimize_static_image(self, static_image_path):
    """
    –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    """
    if not os.path.exists(static_image_path):  # ‚ùå –ü–†–û–ë–õ–ï–ú–ê: —Ç—Ä–µ—Ç–∏–π –≤—ã–∑–æ–≤
        return None
    
    file_name = Path(static_image_path).stem
    # ... –¥–∞–ª—å—à–µ –∫–æ–¥ ...
```

**2. Related problem (—É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –≤ –ü–†–û–ë–õ–ï–ú–ï #17):**

–ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–∞—Ö:
- `image_middleware.py`
- `media_cache_middleware.py`
- Template tags –¥–ª—è responsive images

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å:**

```python
# –î–ª—è –ö–ê–ñ–î–û–ì–û –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞:
for product in products:  # 100 —Ç–æ–≤–∞—Ä–æ–≤
    for image in product.images.all():  # 3-5 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        if os.path.exists(image.path):  # ‚ùå System call!
            # ... optimization logic ...
            
# Total system calls: 100 √ó 4 images √ó 1 check = 400 system calls!
# Time: 400 √ó 10Œºs = 4ms (best case)
# Time: 400 √ó 50Œºs = 20ms (network filesystem)
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º:**

```python
# –ö—ç—à–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–æ–∫
file_exists_cache = {}

def cached_exists(path):
    if path not in file_exists_cache:
        file_exists_cache[path] = os.path.exists(path)
    return file_exists_cache[path]

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
if cached_exists(image.path):
    # ... logic ...

# –ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤:
# Total system calls: 100-200 (unique files)
# Time: 100 √ó 10Œºs = 1ms
# Improvement: 4-20x faster!
```

**–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**

1. **–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ catalog page:**
   - 20-100 —Ç–æ–≤–∞—Ä–æ–≤
   - 3-5 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ —Ç–æ–≤–∞—Ä
   - 60-500 os.path.exists() –≤—ã–∑–æ–≤–æ–≤

2. **–ü—Ä–∏ image optimization:**
   - Management command –¥–ª—è optimization
   - –í—Å–µ products –≤ –ë–î
   - 1000+ –≤—ã–∑–æ–≤–æ–≤

3. **–ü—Ä–∏ –∫–∞–∂–¥–æ–º image request (middleware):**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ responsive versions
   - 3-5 –≤—ã–∑–æ–≤–æ–≤ –Ω–∞ request

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------------------|-----------|
| **FCP** | +5-20ms | +1-3ms | -4-17ms (70-85%) |
| **LCP** | +5-20ms | +1-3ms | -4-17ms (80%) |
| **TTI** | +10-40ms | +2-8ms | -8-32ms (80%) |
| **CLS** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **FID** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **GPU** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **CPU** | +10-40ms | +2-8ms | -8-32ms (80%) |
| **–ü–∞–º—è—Ç—å** | +0MB | +1-5MB (cache) | +1-5MB |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **Stale cache:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - –§–∞–π–ª—ã –º–æ–≥—É—Ç –±—ã—Ç—å —É–¥–∞–ª–µ–Ω—ã/–¥–æ–±–∞–≤–ª–µ–Ω—ã
   - Cache –Ω–µ –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - –†–µ—à–µ–Ω–∏–µ: TTL cache (60s) –∏–ª–∏ cache invalidation

2. **Memory usage:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - Cache –∑–∞–Ω–∏–º–∞–µ—Ç –ø–∞–º—è—Ç—å
   - –ù–û: ~1000 paths √ó 100 bytes = 100KB
   - –ù–∏—á—Ç–æ–∂–Ω–æ –º–∞–ª–æ

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

1. **image_optimizer.py**
2. **Middleware files**
3. **Template tags**

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**

1. ‚úÖ Benchmark –¥–æ/–ø–æ—Å–ª–µ
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ cache invalidation
3. ‚úÖ Memory profiling
4. ‚úÖ Functional tests (image loading)

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå –ù–ï –Ω—É–∂–Ω—ã

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**
- ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ image optimization performance
- ‚úÖ Faster catalog loading
- ‚úÖ Reduced I/O load

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

```python
# utils/file_cache.py
from functools import lru_cache
import os
import time

class FileExistsCache:
    def __init__(self, ttl=60):
        self.ttl = ttl
        self.cache = {}
    
    def exists(self, path):
        now = time.time()
        if path in self.cache:
            cached_time, result = self.cache[path]
            if now - cached_time < self.ttl:
                return result
        
        result = os.path.exists(path)
        self.cache[path] = (now, result)
        return result
    
    def clear(self):
        self.cache.clear()

# Global instance
file_cache = FileExistsCache(ttl=60)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
# –ë–´–õ–û:
if os.path.exists(image_path):
    ...

# –°–¢–ê–õ–û:
if file_cache.exists(image_path):
    ...
```

---

## –ü–†–û–ë–õ–ï–ú–ê #27: os.path.getmtime() –ø—Ä–∏ –∫–∞–∂–¥–æ–º image request (20+ —Ä–∞–∑)

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–§—É–Ω–∫—Ü–∏—è `os.path.getmtime()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è **20+ —Ä–∞–∑** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ETag –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –ø—Ä–∏ –∫–∞–∂–¥–æ–º image request. –≠—Ç–æ **—Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤** –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è modification time —Ñ–∞–π–ª–∞.

**–°–≤—è–∑–∞–Ω–æ —Å –ø—Ä–æ–±–ª–µ–º–æ–π #18 –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ.**

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**

1. **I/O –Ω–∞ –∫–∞–∂–¥—ã–π request:**
   - stat() system call –¥–ª—è mtime: ~5-20Œºs
   - –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å 20 images: 20 √ó 10Œºs = 200Œºs
   - –ü—Ä–∏ 1000 req/sec: 200ms CPU time –Ω–∞ stat() calls!

2. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ GIL:**
   - –ö–∞–∂–¥—ã–π stat() –¥–µ—Ä–∂–∏—Ç Python GIL
   - –ó–∞–º–µ–¥–ª—è–µ—Ç concurrency

3. **ETag generation overhead:**
   - mtime –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è ETag
   - ETag –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑
   - –î–∞–∂–µ –¥–ª—è –Ω–µ–∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–£–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∫–∞–∫ –ø—Ä–æ–±–ª–µ–º–∞ #18:**

```python
# –ü—Ä–∏–º–µ—Ä–Ω—ã–π –∫–æ–¥ (–Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ —Ç–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ):
def get_image_etag(image_path):
    """Generate ETag based on file mtime"""
    mtime = os.path.getmtime(image_path)  # ‚ùå –ü–†–û–ë–õ–ï–ú–ê: system call
    return f'"{mtime}"'

# –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥—ã–π image request
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–¢–∏–ø–∏—á–Ω—ã–π flow:**

```
Image request -> Middleware
  -> Check if file exists (os.path.exists) ‚ùå
  -> Get file mtime (os.path.getmtime) ‚ùå
  -> Generate ETag from mtime
  -> Check If-None-Match header
  -> Serve image or 304 Not Modified
```

**Performance impact:**

| –°—Ü–µ–Ω–∞—Ä–∏–π | Calls | Time |
|----------|-------|------|
| Homepage (20 images) | 20√ó getmtime | 200Œºs-4ms |
| Catalog (50 images) | 50√ó getmtime | 500Œºs-10ms |
| Product detail (5 images) | 5√ó getmtime | 50Œºs-1ms |

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------------------|-----------|
| **FCP** | +1-5ms | +0.1-0.5ms | -0.9-4.5ms (90%) |
| **LCP** | +1-5ms | +0.1-0.5ms | -0.9-4.5ms (90%) |
| **TTI** | +2-10ms | +0.2-1ms | -1.8-9ms (90%) |
| **CLS** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **FID** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **GPU** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **CPU** | +2-10ms | +0.2-1ms | -1.8-9ms (90%) |
| **–ü–∞–º—è—Ç—å** | +0MB | +0.5-2MB | +0.5-2MB |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **Stale ETags:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - Cache –º–æ–∂–µ—Ç –Ω–µ –æ–±–Ω–æ–≤–∏—Ç—å—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞
   - –†–µ—à–µ–Ω–∏–µ: Short TTL (30-60s) –∏–ª–∏ invalidation –ø—Ä–∏ deploy

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- HTTP cache middleware
- CDN cache (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**
1. ‚úÖ ETag correctness
2. ‚úÖ Cache invalidation
3. ‚úÖ 304 Not Modified responses

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå –ù–ï –Ω—É–∂–Ω—ã

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**
- ‚úÖ Faster image serving
- ‚úÖ Reduced I/O

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

```python
# Cache mtime results
from functools import lru_cache
import time

class MtimeCache:
    def __init__(self, ttl=60):
        self.ttl = ttl
        self.cache = {}
    
    def getmtime(self, path):
        now = time.time()
        if path in self.cache:
            cached_time, mtime = self.cache[path]
            if now - cached_time < self.ttl:
                return mtime
        
        mtime = os.path.getmtime(path)
        self.cache[path] = (now, mtime)
        return mtime

mtime_cache = MtimeCache(ttl=60)

# –ë–´–õ–û:
etag = f'"{os.path.getmtime(path)}"'

# –°–¢–ê–õ–û:
etag = f'"{mtime_cache.getmtime(path)}"'
```

---

## –ü–†–û–ë–õ–ï–ú–ê #28: –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π cache_page_for_anon decorator

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–î–µ–∫–æ—Ä–∞—Ç–æ—Ä `cache_page_for_anon` –≤—ã–ø–æ–ª–Ω—è–µ—Ç **–∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏** –Ω–∞ –∫–∞–∂–¥—ã–π request, –¥–∞–∂–µ –µ—Å–ª–∏ response —É–∂–µ –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞–Ω. –¢–∞–∫–∂–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç **vary –ø–æ –≤–∞–∂–Ω—ã–º headers** (Accept-Language, Cookie).

**–°–≤—è–∑–∞–Ω–æ —Å –ø—Ä–æ–±–ª–µ–º–æ–π #19 –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ.**

**–ü—Ä–æ–±–ª–µ–º—ã:**

1. **User authentication check –Ω–∞ –∫–∞–∂–¥—ã–π request:**
   - `request.user.is_authenticated` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤—Å–µ–≥–¥–∞
   - –î–∞–∂–µ –¥–ª—è cached responses
   - Adds overhead: ~0.1-0.5ms per request

2. **–ù–µ—Ç Vary headers:**
   - Cache –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç language
   - Cache –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç custom headers
   - –ú–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å wrong cached version

3. **Cache key –Ω–µ –æ–ø—Ç–∏–º–∞–ª–µ–Ω:**
   - –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç query parameters
   - –ú–æ–∂–µ—Ç cache —Ä–∞–∑–Ω—ã–µ versions –ø–æ–¥ –æ–¥–Ω–∏–º key

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–£–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–æ–±–ª–µ–º–∞ #19:**

```python
# storefront/utils.py (–ø—Ä–∏–º–µ—Ä–Ω—ã–π –∫–æ–¥)
def cache_page_for_anon(timeout):
    """
    –ö—ç—à–∏—Ä—É–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    """
    def decorator(view_func):
        @wraps(view_func)
        def wrapper(request, *args, **kwargs):
            # ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–∞–∂–¥—ã–π request
            if request.user.is_authenticated:
                return view_func(request, *args, **kwargs)
            
            # ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –Ω–µ—Ç vary headers
            cache_key = f"page:{request.path}"
            cached_response = cache.get(cache_key)
            
            if cached_response:
                return cached_response
            
            response = view_func(request, *args, **kwargs)
            cache.set(cache_key, response, timeout)
            return response
        return wrapper
    return decorator
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–¢–µ–∫—É—â–∏–π flow:**

```
Request -> Middleware stack
  -> View decorator
    -> Check user.is_authenticated ‚ùå (every time)
    -> Generate cache key ‚ùå (simple)
    -> Check cache
    -> Execute view (if not cached)
    -> Store in cache
    -> Return response
```

**–ü—Ä–æ–±–ª–µ–º—ã:**

1. **Authentication check overhead:**
   - Session lookup: ~0.1-0.5ms
   - Database query (–µ—Å–ª–∏ session –Ω–µ –≤ –ø–∞–º—è—Ç–∏): 1-5ms

2. **Cache key collisions:**
   - `/catalog/` –¥–ª—è –≤—Å–µ—Ö users —Å —Ä–∞–∑–Ω—ã–º–∏ languages
   - –ú–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å Ukrainian version –¥–ª—è English user

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------------------|-----------|
| **FCP** | +0.5-2ms | +0.1-0.3ms | -0.4-1.7ms (80%) |
| **LCP** | +0.5-2ms | +0.1-0.3ms | -0.4-1.7ms (80%) |
| **TTI** | +1-5ms | +0.2-0.5ms | -0.8-4.5ms (80-90%) |
| **CLS** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **FID** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **GPU** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **CPU** | +1-5ms | +0.2-0.5ms | -0.8-4.5ms (80%) |
| **–ü–∞–º—è—Ç—å** | +0MB | +0MB | 0% |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | +0-1 | +0 | -0-1 (100%) |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **Language-specific content:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å Vary: Accept-Language
   - –ò–Ω–∞—á–µ –±—É–¥–µ—Ç cache collision

2. **Authentication edge cases:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –ù—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ authenticated users –Ω–µ –ø–æ–ª—É—á–∞—é—Ç cached version

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- Django cache framework
- Session middleware
- i18n middleware

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**
1. ‚úÖ Cache hit/miss –¥–ª—è anon vs authenticated
2. ‚úÖ Language variants cached correctly
3. ‚úÖ Query parameters handled correctly

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå –ù–ï –Ω—É–∂–Ω—ã

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**
- ‚úÖ Better cache hit rate
- ‚úÖ Correct language serving

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

```python
from django.views.decorators.vary import vary_on_headers
from django.views.decorators.cache import cache_page

def cache_page_for_anon(timeout):
    """
    Improved caching decorator
    """
    def decorator(view_func):
        @vary_on_headers('Accept-Language', 'Cookie')  # ‚úÖ Vary headers
        @wraps(view_func)
        def wrapper(request, *args, **kwargs):
            # ‚úÖ Early return –¥–ª—è authenticated (–¥–æ cache check)
            if hasattr(request, '_cached_user') and request._cached_user.is_authenticated:
                return view_func(request, *args, **kwargs)
            
            # ‚úÖ Improved cache key
            cache_key = f"page:{request.path}:{request.LANGUAGE_CODE}:{request.GET.urlencode()}"
            
            cached_response = cache.get(cache_key)
            if cached_response:
                return cached_response
            
            response = view_func(request, *args, **kwargs)
            
            # ‚úÖ Add Vary headers
            response['Vary'] = 'Accept-Language, Cookie'
            
            cache.set(cache_key, response, timeout)
            return response
        return wrapper
    return decorator
```

---

## –ü–†–û–ë–õ–ï–ú–ê #29: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ .only()/.defer() –≤ queryset –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

Django queryset'—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç **–≤—Å–µ –ø–æ–ª—è –º–æ–¥–µ–ª–µ–π** –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `.only()` –∏–ª–∏ `.defer()`, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–µ—Ä–µ–¥–∞—á–µ **–∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

**–ü—Ä–∏–º–µ—Ä—ã:**

1. **Product model:** ~15-20 –ø–æ–ª–µ–π
   - –î–ª—è catalog view –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ: title, price, main_image, slug
   - –ù–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è: description (text), meta_description, internal_notes, –∏ —Ç.–¥.
   - Overhead: ~2-5KB –Ω–∞ —Ç–æ–≤–∞—Ä

2. **Category model:** ~10-12 –ø–æ–ª–µ–π
   - –î–ª—è navigation –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ: name, slug, icon
   - –ù–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è: description, meta_tags, created_at, –∏ —Ç.–¥.

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**

1. **Network overhead (DB ‚Üí Django):**
   - Catalog —Å 100 —Ç–æ–≤–∞—Ä–∞–º–∏: 100 √ó 3KB extra = **300KB –ª–∏—à–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö**
   - –ù–∞ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö DB connections (cloud): +50-200ms latency

2. **Deserialization overhead:**
   - Django ORM –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç –≤—Å–µ –ø–æ–ª—è
   - JSON/pickle overhead –¥–ª—è text fields
   - CPU time: ~0.1-0.5ms –Ω–∞ —Ç–æ–≤–∞—Ä

3. **Memory usage:**
   - –û–±—ä–µ–∫—Ç—ã –≤ –ø–∞–º—è—Ç–∏ –±–æ–ª—å—à–µ —á–µ–º –Ω—É–∂–Ω–æ
   - –í–ª–∏—è–µ—Ç –Ω–∞ gunicorn worker memory

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/storefront/views/catalog.py`

**–ü—Ä–∏–º–µ—Ä—ã (–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ—á–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏):**

```python
# home() view
product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
    status='published'
).order_by('-id')
# ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –∑–∞–≥—Ä—É–∂–∞–µ—Ç –í–°–ï –ø–æ–ª—è Product

# ‚úÖ –î–û–õ–ñ–ù–û –ë–´–¢–¨:
product_qs = Product.objects.select_related('category').prefetch_related('images', 'color_variants__images').filter(
    status='published'
).only('id', 'title', 'price', 'slug', 'main_image', 'category__name', 'category__slug').order_by('-id')
```

**–§–∞–π–ª:** `twocomms/storefront/views/api.py`

```python
# get_product_json() –∏–ª–∏ similar
product = Product.objects.select_related('category').get(id=product_id)
# ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –ø–æ–ª—è

# ‚úÖ –î–û–õ–ñ–ù–û –ë–´–¢–¨:
product = Product.objects.select_related('category').only(
    'id', 'title', 'price', 'description', 'slug', 'main_image',
    'category__id', 'category__name'
).get(id=product_id)
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ .only():**

```python
# Product model (example fields):
class Product:
    id
    title  # ‚úÖ –Ω—É–∂–µ–Ω
    slug  # ‚úÖ –Ω—É–∂–µ–Ω
    description  # ‚ùå 1-5KB, –Ω–µ –Ω—É–∂–µ–Ω –¥–ª—è catalog
    price  # ‚úÖ –Ω—É–∂–µ–Ω
    old_price
    main_image  # ‚úÖ –Ω—É–∂–µ–Ω
    meta_title  # ‚ùå –Ω–µ –Ω—É–∂–µ–Ω –¥–ª—è catalog
    meta_description  # ‚ùå 200-500 bytes
    internal_notes  # ‚ùå internal only
    created_at
    updated_at
    status  # ‚úÖ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ filter
    featured
    # ... –µ—â–µ ~5-10 –ø–æ–ª–µ–π ...
    
# Total –±–µ–∑ .only(): ~3-5KB per product
# Total —Å .only(): ~500-800 bytes per product
# Reduction: 80-85%!
```

**–†–∞—Å—á–µ—Ç overhead:**

| View | Products | Without .only() | With .only() | Reduction |
|------|----------|-----------------|--------------|-----------|
| home() | 20 | 60-100KB | 10-16KB | 80-85% |
| catalog() | 50 | 150-250KB | 25-40KB | 80-85% |
| search() | 30 | 90-150KB | 15-24KB | 80-85% |

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------------------|-----------|
| **FCP** | +10-50ms | +2-10ms | -8-40ms (80%) |
| **LCP** | +10-50ms | +2-10ms | -8-40ms (80%) |
| **TTI** | +20-100ms | +5-20ms | -15-80ms (75-80%) |
| **CLS** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **FID** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **GPU** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **CPU** | +5-20ms | +1-5ms | -4-15ms (75-80%) |
| **–ü–∞–º—è—Ç—å** | +5-20MB | +1-4MB | -4-16MB (80%) |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | Same count | Same count | 0% (–Ω–æ –º–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö) |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | 150-250KB | 25-40KB | -125-210KB (80-85%) |

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **Deferred fields access:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –í–´–°–û–ö–ò–ô**
   - –ï—Å–ª–∏ template/view –ø—ã—Ç–∞–µ—Ç—Å—è access –ø–æ–ª–µ –Ω–µ –≤ .only()
   - –í—ã–∑–æ–≤–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π DB query!
   - –†–µ—à–µ–Ω–∏–µ: audit –≤—Å–µ—Ö templates –∏ –Ω–∞–π—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è

2. **Serializers/API:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - DRF serializers –º–æ–≥—É—Ç –æ–∂–∏–¥–∞—Ç—å –≤—Å–µ –ø–æ–ª—è
   - –†–µ—à–µ–Ω–∏–µ: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ serializers

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- –í—Å–µ views —Å Product queries
- Templates –∏—Å–ø–æ–ª—å–∑—É—é—à–∏–µ product objects
- API serializers

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**
1. ‚úÖ Debug toolbar SQL queries
2. ‚úÖ Verify no extra queries –¥–ª—è deferred fields
3. ‚úÖ Full template rendering tests
4. ‚úÖ API response validation

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå –ù–ï –Ω—É–∂–Ω—ã

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**
- ‚ö†Ô∏è –ù—É–∂–Ω–æ audit –í–°–ï–• –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π Product/Category
- ‚úÖ Significant memory reduction
- ‚úÖ Faster DB queries

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

```python
# Step 1: Audit –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è –≤ templates
# –ù–∞–π—Ç–∏ –≤—Å–µ {{ product.FIELD }} –≤ templates

# Step 2: –°–æ–∑–¥–∞—Ç—å helper –¥–ª—è common queries
class ProductQuerysets:
    @staticmethod
    def for_catalog():
        """Queryset –¥–ª—è catalog view"""
        return Product.objects.select_related('category').only(
            'id', 'title', 'slug', 'price', 'old_price', 'main_image',
            'category__id', 'category__name', 'category__slug'
        )
    
    @staticmethod
    def for_detail():
        """Queryset –¥–ª—è detail view"""
        return Product.objects.select_related('category').only(
            'id', 'title', 'slug', 'price', 'old_price', 'description',
            'main_image', 'meta_title', 'meta_description',
            'category__id', 'category__name', 'category__slug'
        )

# Step 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ views
# –ë–´–õ–û:
products = Product.objects.filter(status='published')

# –°–¢–ê–õ–û:
products = ProductQuerysets.for_catalog().filter(status='published')
```

---

## –ü–†–û–ë–õ–ï–ú–ê #30: GTM (Google Tag Manager) –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –≤ <head>

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

Google Tag Manager —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è **–≤ <head> —Å–µ–∫—Ü–∏–∏ –ë–ï–ó defer/async**, —á—Ç–æ **–±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥ HTML** –∏ –∑–∞–º–µ–¥–ª—è–µ—Ç FCP (First Contentful Paint).

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**

1. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞:**
   - GTM —Å–∫—Ä–∏–ø—Ç –≤ head = –±–ª–æ–∫–∏—Ä—É–µ—Ç HTML parser
   - –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ –ø–æ–∫–∞ GTM –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω
   - –ó–∞–¥–µ—Ä–∂–∫–∞: 50-300ms –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–µ—Ç–∏

2. **Third-party dependency:**
   - GTM –≥—Ä—É–∑–∏—Ç—Å—è —Å googletagmanager.com
   - DNS lookup: 20-50ms
   - TLS handshake: 50-100ms
   - Download: 30-80ms (~15KB)
   - **Total: 100-230ms –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏**

3. **Critical rendering path:**
   - –ë–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É critical CSS
   - –ë–ª–æ–∫–∏—Ä—É–µ—Ç rendering first paint
   - –û—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è—Ö (3G)

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms_django_theme/templates/base.html`  
**–°—Ç—Ä–æ–∫–∏:** 476-504

**–ö–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–¥–∞:**

```html
<!-- –°—Ç—Ä–æ–∫–∏ 470-510 -->
  <!-- End Meta Pixel Code -->
  {% block structured_data %}{% endblock %}

  <!-- ‚ùå –ü–†–û–ë–õ–ï–ú–ê –ù–ê–ß–ò–ù–ê–ï–¢–°–Ø –ó–î–ï–°–¨ -->
  
  <!-- Google Tag Manager -->
  {% if not debug %}
  <script>
    (function (w, d, s, l, i) {
      // –ó–∞—â–∏—Ç–∞ –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏: –ø—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ dataLayer —Å–æ–∑–¥–∞–Ω
      w[l] = w[l] || [];
      w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });
      var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s),
        dl = l != 'dataLayer' ? '&l=' + l : '';
      j.async = true;  /* ‚ùå async –Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω–Ω–æ–º —Å–∫—Ä–∏–ø—Ç–µ, –Ω–æ —Å–∞–º inline script –±–ª–æ–∫–∏—Ä—É–µ—Ç! */
      j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;

      // –ó–∞—â–∏—Ç–∞ –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏: –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
      j.onerror = function () {
        if (console && console.debug) console.debug('GTM script failed to load - possible ad blocker');
      };

      // –ó–∞—â–∏—Ç–∞: –ø—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π
      if (f && f.parentNode) {
        f.parentNode.insertBefore(j, f);
      } else {
        // Fallback: –¥–æ–±–∞–≤–ª—è–µ–º –≤ head
        (d.head || d.getElementsByTagName('head')[0]).appendChild(j);
      }
    })(window, document, 'script', 'dataLayer', 'GTM-PRLLBF9H');
  </script>
  {% endif %}
  <!-- End Google Tag Manager -->

  <!-- ‚ùå –ü–†–û–ë–õ–ï–ú–ê –ó–ê–ö–ê–ù–ß–ò–í–ê–ï–¢–°–Ø –ó–î–ï–°–¨ -->

  <!-- Analytics Loader - –∑–∞–≥—Ä—É–∂–∞–µ–º –≤ head –¥–ª—è —Ä–∞–Ω–Ω–µ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∏–∫—Å–µ–ª–µ–π -->
  <script defer src="{% static 'js/analytics-loader.js' %}?v=3"></script>
</head>

<body class='bg-body text-body'
  style='font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;'>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PRLLBF9H" height="0" width="0"
      style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å:**

```
Browser –∑–∞–≥—Ä—É–∂–∞–µ—Ç HTML
  -> –ü–∞—Ä—Å–∏—Ç <head>
  -> –í—Å—Ç—Ä–µ—á–∞–µ—Ç inline <script> GTM (—Å—Ç—Ä–æ–∫–∞ 478)
  -> ‚ùå –û–°–¢–ê–ù–ê–í–õ–ò–í–ê–ï–¢ –ø–∞—Ä—Å–∏–Ω–≥
  -> –í—ã–ø–æ–ª–Ω—è–µ—Ç inline JavaScript
    -> –°–æ–∑–¥–∞–µ—Ç <script> element
    -> –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç j.async = true
    -> –î–æ–±–∞–≤–ª—è–µ—Ç –≤ DOM
  -> ‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥ (async script –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
  
–ù–û: Inline script execution = 5-15ms –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
+ script evaluation overhead = 2-5ms
Total blocking time: 7-20ms
```

**–ü—Ä–æ–±–ª–µ–º–∞:**

–•–æ—Ç—è GTM **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç async script**, **—Å–∞–º inline script –±–ª–æ–∫–∏—Ä—É–µ—Ç** –ø–∞—Ä—Å–∏–Ω–≥ –ø–æ–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è.

**Best practice –æ—Ç Google:**

```html
<!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è Google: –∑–∞–≥—Ä—É–∂–∞—Ç—å GTM –ø–æ—Å–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ -->
<script>
  // Load GTM after page load
  window.addEventListener('load', function() {
    // GTM initialization here
  });
</script>
```

**–ò–ª–∏ –µ—â–µ –ª—É—á—à–µ - —á–µ—Ä–µ–∑ defer:**

```html
<script defer src="{% static 'js/gtm-loader.js' %}"></script>
```

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------------------|-----------|
| **FCP** | +10-30ms | +0-2ms | -10-28ms (90-95%) |
| **LCP** | +5-15ms | +0-1ms | -5-14ms (90-95%) |
| **TTI** | +20-50ms | +2-8ms | -18-42ms (80-90%) |
| **CLS** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **FID** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **GPU** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **CPU** | +7-20ms | +1-3ms | -6-17ms (85-90%) |
| **–ü–∞–º—è—Ç—å** | +1-3MB | +1-3MB | 0% |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | +15KB (GTM) | +15KB (GTM) | 0% |

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **Early events tracking:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô-–°–†–ï–î–ù–ò–ô**
   - –°–æ–±—ã—Ç–∏—è –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ GTM –Ω–µ –±—É–¥—É—Ç tracked
   - –†–µ—à–µ–Ω–∏–µ: buffer events –≤ dataLayer, GTM –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –∏—Ö –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

2. **Third-party scripts —á–µ—Ä–µ–∑ GTM:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - Scripts –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ GTM —Å—Ç–∞—Ä—Ç—É—é—Ç –ø–æ–∑–∂–µ
   - –ù–û: —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è performance

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- Google Tag Manager account
- GTM container configuration
- Third-party tags –≤ GTM

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**
1. ‚úÖ Verify GTM loads correctly
2. ‚úÖ Verify events tracked (pageview, etc)
3. ‚úÖ Check third-party tags —Ä–∞–±–æ—Ç–∞—é—Ç
4. ‚úÖ Performance metrics (FCP, LCP)

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå –ù–ï –Ω—É–∂–Ω—ã

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**
- ‚úÖ Faster initial page load
- ‚ö†Ô∏è Events –º–æ–≥—É—Ç –±—ã—Ç—å delayed (–Ω–æ –±—É–¥—É—Ç tracked)

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

**Option 1: Defer inline script (–ø—Ä–æ—Å—Ç–æ–π):**

```html
<!-- ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: Wrap –≤ defer script -->
<script defer>
  // GTM initialization code
  (function (w, d, s, l, i) {
    w[l] = w[l] || [];
    w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });
    // ... rest of GTM code ...
  })(window, document, 'script', 'dataLayer', 'GTM-PRLLBF9H');
</script>
```

**Option 2: External script file (recommended):**

```javascript
// static/js/gtm-loader.js
(function (w, d, s, l, i) {
  w[l] = w[l] || [];
  w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });
  var f = d.getElementsByTagName(s)[0],
    j = d.createElement(s),
    dl = l != 'dataLayer' ? '&l=' + l : '';
  j.async = true;
  j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
  j.onerror = function () {
    console.debug('GTM script failed to load');
  };
  if (f && f.parentNode) {
    f.parentNode.insertBefore(j, f);
  } else {
    (d.head || d.getElementsByTagName('head')[0]).appendChild(j);
  }
})(window, document, 'script', 'dataLayer', 'GTM-PRLLBF9H');
```

```html
<!-- –í base.html -->
<script defer src="{% static 'js/gtm-loader.js' %}"></script>
```

**Option 3: Load after page load (best for performance):**

```html
<script>
  window.addEventListener('load', function() {
    // GTM initialization - –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    (function (w, d, s, l, i) {
      // ... GTM code ...
    })(window, document, 'script', 'dataLayer', 'GTM-PRLLBF9H');
  });
</script>
```

---

## –ü–†–û–ë–õ–ï–ú–ê #31: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ lazy loading –¥–ª—è –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ù–µ –≤—Å–µ `<img>` —Ç–µ–≥–∏ –∏–º–µ—é—Ç –∞—Ç—Ä–∏–±—É—Ç `loading="lazy"`, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∑–∞–≥—Ä—É–∑–∫–µ **–≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å—Ä–∞–∑—É**, –¥–∞–∂–µ —Ç–µ—Ö –∫–æ—Ç–æ—Ä—ã–µ –Ω–∏–∂–µ fold (–Ω–µ –≤–∏–¥–Ω—ã –±–µ–∑ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏).

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**

1. **–ò–∑–±—ã—Ç–æ—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞:**
   - Catalog page: 50 —Ç–æ–≤–∞—Ä–æ–≤ √ó 200KB image = **10MB**
   - –¢–æ–ª—å–∫–æ 4-6 —Ç–æ–≤–∞—Ä–æ–≤ –≤–∏–¥–Ω—ã initially
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è 10MB –≤–º–µ—Å—Ç–æ 1MB
   - **Waste: 9MB bandwidth**

2. **–ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è –∑–∞ bandwidth:**
   - Images –∫–æ–Ω–∫—É—Ä–∏—Ä—É—é—Ç —Å critical resources (CSS, JS)
   - –ó–∞–º–µ–¥–ª—è–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É critical content
   - LCP –º–æ–∂–µ—Ç –±—ã—Ç—å delayed

3. **Mobile data usage:**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –ø–ª–∞—Ç—è—Ç –∑–∞ —Ç—Ä–∞—Ñ–∏–∫
   - –õ–∏—à–Ω–∏–µ 9MB = poor UX

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ templates:**

- `product_card.html` - –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤
- `product_detail.html` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
- `index.html` - hero images, product images
- `catalog.html` - product grid

**–ü—Ä–∏–º–µ—Ä–Ω—ã–π –∫–æ–¥ (–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å):**

```html
<!-- ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –Ω–µ—Ç loading="lazy" -->
<img src="{{ product.main_image.url }}" 
     alt="{{ product.title }}"
     class="product-image">

<!-- ‚úÖ –î–û–õ–ñ–ù–û –ë–´–¢–¨: -->
<img src="{{ product.main_image.url }}" 
     alt="{{ product.title }}"
     class="product-image"
     loading="lazy"
     decoding="async">
```

**–ò—Å–∫–ª—é—á–µ–Ω–∏—è (–ù–ï –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å lazy):**

```html
<!-- ‚úÖ Above-the-fold images - –±–µ–∑ lazy -->
<img src="hero-image.jpg" 
     loading="eager"  <!-- Explicit eager for hero -->
     fetchpriority="high">

<!-- First 2-3 products in catalog - –±–µ–∑ lazy -->
{% if forloop.counter <= 3 %}
  <img src="{{ product.image.url }}" loading="eager">
{% else %}
  <img src="{{ product.image.url }}" loading="lazy">
{% endif %}
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**Browser behavior –±–µ–∑ loading="lazy":**

```
Page load
  -> HTML parsed
  -> Browser finds <img> tags
  -> Starts loading ALL images immediately
  -> Network congestion
  -> Critical resources delayed
  -> Slow FCP/LCP
```

**–° loading="lazy":**

```
Page load
  -> HTML parsed
  -> Browser finds <img loading="lazy">
  -> Defers loading until near viewport
  -> Critical resources load first
  -> Fast FCP/LCP
  -> Images load as user scrolls
```

**Browser support:**
- Chrome 77+ ‚úÖ
- Firefox 75+ ‚úÖ
- Safari 15.4+ ‚úÖ
- Edge 79+ ‚úÖ
- Coverage: ~95% browsers

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------------------|-----------|
| **FCP** | +200-500ms | +50-100ms | -150-400ms (70-80%) |
| **LCP** | +300-800ms | +100-200ms | -200-600ms (65-75%) |
| **TTI** | +500-1500ms | +150-400ms | -350-1100ms (70-75%) |
| **CLS** | +0.02-0.05 | +0.01-0.02 | -0.01-0.03 (50%) |
| **FID** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **GPU** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **CPU** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **–ü–∞–º—è—Ç—å** | +50-100MB | +10-20MB | -40-80MB (80%) |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | 10MB | 1-2MB initial | -8-9MB (80-90%) |

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **Image placeholder/loading state:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ–µ –º–µ—Å—Ç–æ –ø–æ–∫–∞ image –≥—Ä—É–∑–∏—Ç—Å—è
   - –†–µ—à–µ–Ω–∏–µ: CSS aspect-ratio + placeholder

2. **JavaScript –∑–∞–≤–∏—Å–∏—Ç –Ω–∞ loaded images:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô-–°–†–ï–î–ù–ò–ô**
   - –ö–æ–¥ –º–æ–∂–µ—Ç –æ–∂–∏–¥–∞—Ç—å —á—Ç–æ images loaded
   - –†–µ—à–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Image.onload events

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- All templates —Å <img> tags
- CSS –¥–ª—è placeholders
- JavaScript image handlers

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**
1. ‚úÖ Visual testing (images load on scroll)
2. ‚úÖ Check no broken images
3. ‚úÖ Verify JavaScript works
4. ‚úÖ Performance metrics (FCP, LCP)

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå –ù–ï –Ω—É–∂–Ω—ã

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**
- ‚úÖ –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ page load
- ‚úÖ Better mobile experience
- ‚úÖ Reduced bandwidth

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

```html
<!-- Product card template -->
<div class="product-card">
  {% if forloop.counter <= 3 %}
    <!-- First 3 products - eager load -->
    <img src="{{ product.main_image.url }}" 
         alt="{{ product.title }}"
         loading="eager"
         decoding="async"
         width="300" 
         height="400"
         class="product-image">
  {% else %}
    <!-- Rest - lazy load -->
    <img src="{{ product.main_image.url }}" 
         alt="{{ product.title }}"
         loading="lazy"
         decoding="async"
         width="300" 
         height="400"
         class="product-image">
  {% endif %}
</div>

<!-- CSS –¥–ª—è placeholder -->
<style>
.product-image {
  aspect-ratio: 3 / 4;
  background: linear-gradient(135deg, #1a1b1e 0%, #2a2b2e 100%);
  object-fit: cover;
}
</style>
```

---

## –ü–†–û–ë–õ–ï–ú–ê #32: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ select_related/prefetch_related –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö views

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ views **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç** `select_related()` –∏ `prefetch_related()` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ N+1 –ø—Ä–æ–±–ª–µ–º–∞–º.

**–°–≤—è–∑–∞–Ω–æ —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏ #3, #4, #10-#12 (N+1 queries)**

–≠—Ç–∞ –ø—Ä–æ–±–ª–µ–º–∞ - –æ–±—â–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –¥–ª—è –º–µ—Å—Ç –≥–¥–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è **—á–∞—Å—Ç–∏—á–Ω–æ —Å–¥–µ–ª–∞–Ω–∞**, –Ω–æ –Ω–µ –≤–µ–∑–¥–µ.

**–ü—Ä–∏–º–µ—Ä—ã:**

1. **Related products API** - –Ω–µ—Ç prefetch –¥–ª—è images
2. **Search results** - –Ω–µ—Ç select_related –¥–ª—è category
3. **User orders list** - –Ω–µ—Ç prefetch –¥–ª—è order items

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–ù—É–∂–Ω–æ audit —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã:**

1. `storefront/views/api.py` - API endpoints
2. `orders/views.py` - order views
3. `accounts/views.py` - user profile views

**–ü—Ä–∏–º–µ—Ä—ã (–∏–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º):**

–°–º. –ü–†–û–ë–õ–ï–ú–´ #3, #4, #10-#12 –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤.

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–¢–∏–ø–∏—á–Ω–∞—è N+1 –ø—Ä–æ–±–ª–µ–º–∞:**

```python
# ‚ùå –ü–†–û–ë–õ–ï–ú–ê
products = Product.objects.filter(status='published')

for product in products:
    print(product.category.name)  # ‚ùå N+1: –æ—Ç–¥–µ–ª—å–Ω—ã–π query –Ω–∞ –∫–∞–∂–¥—ã–π
    
    for image in product.images.all():  # ‚ùå N+1: –æ—Ç–¥–µ–ª—å–Ω—ã–π query –Ω–∞ –∫–∞–∂–¥—ã–π
        print(image.url)

# Total queries: 1 + N (categories) + N*M (images)
# For 20 products with 3 images each: 1 + 20 + 60 = 81 queries!
```

**–° –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π:**

```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï
products = Product.objects.filter(status='published') \
    .select_related('category') \
    .prefetch_related('images')

for product in products:
    print(product.category.name)  # ‚úÖ No query (prefetched)
    
    for image in product.images.all():  # ‚úÖ No query (prefetched)
        print(image.url)

# Total queries: 3 (products + categories + all images)
# Reduction: 81 ‚Üí 3 queries (96% reduction!)
```

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------------------|-----------|
| **FCP** | +50-200ms | +10-30ms | -40-170ms (80-85%) |
| **LCP** | +50-200ms | +10-30ms | -40-170ms (80-85%) |
| **TTI** | +100-500ms | +20-80ms | -80-420ms (80-85%) |
| **CLS** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **FID** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **GPU** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **CPU** | +20-100ms | +5-20ms | -15-80ms (75-80%) |
| **–ü–∞–º—è—Ç—å** | +5-10MB | +5-10MB | 0% |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | 50-100 | 3-5 | -47-95 queries (95%) |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–°–º. –ü–†–û–ë–õ–ï–ú–´ #3, #4, #10-#12 –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Ä–∏—Å–∫–æ–≤.

**–û–±—â–∏–µ —Ä–∏—Å–∫–∏:**

1. **Increased memory usage:** Prefetch –∑–∞–≥—Ä—É–∂–∞–µ—Ç –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ —Ä–∞–∑
2. **More complex queries:** –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –º–Ω–æ–≥–æ
3. **–¢—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** –ù—É–∂–Ω–æ verify —á—Ç–æ –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö queries

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- –í—Å–µ views —Å ORM queries
- Templates

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**
1. ‚úÖ Django Debug Toolbar
2. ‚úÖ assertNumQueries –≤ tests
3. ‚úÖ Performance benchmarks

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå –ù–ï –Ω—É–∂–Ω—ã

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**
- ‚úÖ Drastically reduced DB load
- ‚úÖ Faster page loads
- ‚úÖ Better scalability

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

–°–º. –ü–†–û–ë–õ–ï–ú–´ #3, #4, #10-#12 –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π.

**General pattern:**

```python
# Audit checklist –¥–ª—è –∫–∞–∂–¥–æ–≥–æ view:
# 1. –ù–∞–π—Ç–∏ –≤—Å–µ ORM queries
# 2. –ù–∞–π—Ç–∏ –≤—Å–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ related objects –≤ templates/views
# 3. –î–æ–±–∞–≤–∏—Ç—å select_related() –¥–ª—è ForeignKey
# 4. –î–æ–±–∞–≤–∏—Ç—å prefetch_related() –¥–ª—è ManyToMany –∏ reverse FK
# 5. Test —Å Django Debug Toolbar
```

---

## –ü–†–û–ë–õ–ï–ú–ê #33: Bootstrap –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å CDN –≤–º–µ—Å—Ç–æ –ª–æ–∫–∞–ª—å–Ω–æ

### üü¢ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°–†–ï–î–ù–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

Bootstrap CSS –∏ JS –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å **CDN (cdn.jsdelivr.net)** –≤–º–µ—Å—Ç–æ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, —á—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç:

1. **DNS lookup overhead:** 20-50ms
2. **TLS handshake:** 50-100ms  
3. **External dependency:** –ï—Å–ª–∏ CDN down - —Å–∞–π—Ç broken
4. **Privacy concerns:** Third-party request

**–†–∞–∑–º–µ—Ä:**
- `bootstrap.min.css`: ~150KB
- `bootstrap.bundle.min.js`: ~80KB

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms_django_theme/templates/base.html`  
**–°—Ç—Ä–æ–∫–∏:** 84, 866

```html
<!-- –°—Ç—Ä–æ–∫–∞ 84 -->
<link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css' rel='preload' as='style'
  onload="this.onload=null;this.rel='stylesheet'" media="all">
<noscript>
  <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css' rel='stylesheet'>
</noscript>

<!-- –°—Ç—Ä–æ–∫–∞ 866 -->
<script defer src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js'
  crossorigin='anonymous'></script>
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**CDN pros:**
- ‚úÖ Shared cache (–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –ø–æ—Å–µ—â–∞–ª –¥—Ä—É–≥–æ–π —Å–∞–π—Ç —Å Bootstrap CDN)
- ‚úÖ Geographic distribution (–º–æ–∂–µ—Ç –±—ã—Ç—å –±–ª–∏–∂–µ –∫ user)
- ‚úÖ –ù–µ –∑–∞–Ω–∏–º–∞–µ—Ç –º–µ—Å—Ç–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**CDN cons:**
- ‚ùå DNS lookup: 20-50ms
- ‚ùå TLS handshake: 50-100ms
- ‚ùå External dependency
- ‚ùå Privacy (third-party request)
- ‚ùå No control over cache

**Local hosting pros:**
- ‚úÖ No DNS lookup
- ‚úÖ Same origin (no CORS)
- ‚úÖ Full control over caching
- ‚úÖ Works offline (–µ—Å–ª–∏ Service Worker)
- ‚úÖ Better privacy

**Local hosting cons:**
- ‚ùå No shared cache
- ‚ùå Server bandwidth usage

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ (CDN) | –ü–æ—Å–ª–µ (local) | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|----------|---------------|-----------|
| **FCP** | +70-150ms | +30-60ms | -40-90ms (50-60%) |
| **LCP** | +50-100ms | +20-40ms | -30-60ms (50-60%) |
| **TTI** | +100-200ms | +40-80ms | -60-120ms (60%) |
| **CLS** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **FID** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **GPU** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **CPU** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **–ü–∞–º—è—Ç—å** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | 230KB | 230KB | 0% |

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **Cache benefits lost:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - Shared CDN cache –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
   - –ù–û: modern browsers have separate cache per origin anyway

2. **Server bandwidth:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - +230KB per user first visit
   - –ù–û: WhiteNoise caching —Ä–µ—à–∞–µ—Ç

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- WhiteNoise –¥–ª—è serving
- Static files setup

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**
1. ‚úÖ Verify Bootstrap works locally
2. ‚úÖ Check all Bootstrap components
3. ‚úÖ Performance comparison

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå –ù–ï –Ω—É–∂–Ω—ã

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**
- ‚úÖ Slightly faster load (no DNS/TLS)
- ‚úÖ Better control
- ‚úÖ Better privacy

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

```bash
# 1. Download Bootstrap
npm install bootstrap@5.3.3

# 2. Copy to static folder
cp node_modules/bootstrap/dist/css/bootstrap.min.css static/vendor/bootstrap/
cp node_modules/bootstrap/dist/js/bootstrap.bundle.min.js static/vendor/bootstrap/
```

```html
<!-- 3. Update base.html -->
<!-- –ë–´–õ–û: -->
<link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css' ...>

<!-- –°–¢–ê–õ–û: -->
<link href="{% static 'vendor/bootstrap/bootstrap.min.css' %}" rel="stylesheet">

<!-- –ë–´–õ–û: -->
<script defer src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js'></script>

<!-- –°–¢–ê–õ–û: -->
<script defer src="{% static 'vendor/bootstrap/bootstrap.bundle.min.js' %}"></script>
```

---

## –ü–†–û–ë–õ–ï–ú–ê #34: –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ middleware

### üü¢ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°–†–ï–î–ù–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ü–æ—Ä—è–¥–æ–∫ middleware –≤ `settings.py` **–Ω–µ –æ–ø—Ç–∏–º–∞–ª–µ–Ω** –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç—è–∂–µ–ª—ã–µ middleware –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è **–¥–æ** –ª–µ–≥–∫–∏—Ö, —á—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç unnecessary overhead –Ω–∞ –∫–∞–∂–¥—ã–π request.

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**

1. **Request processing order:**
   - Middleware –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑ –¥–ª—è request
   - –ò —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö –¥–ª—è response
   - –¢—è–∂–µ–ª—ã–µ middleware –≤ –Ω–∞—á–∞–ª–µ = overhead –Ω–∞ –∫–∞–∂–¥—ã–π request

2. **Rate limiting –ø–æ—Å–ª–µ —Å—Ç–∞—Ç–∏–∫–∏:**
   - `SimpleRateLimitMiddleware` (—Å—Ç—Ä–æ–∫–∞ 137) –∏–¥–µ—Ç –ü–û–°–õ–ï `WhiteNoiseMiddleware` ‚úÖ
   - –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–æ...
   - `ImageOptimizationMiddleware` (—Å—Ç—Ä–æ–∫–∞ 138) –∏–¥–µ—Ç –µ—â–µ –ø–æ–∑–∂–µ
   - Image optimization –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–Ω—å—à–µ –∏–ª–∏ –ø–æ—Å–ª–µ WhiteNoise

3. **Tracking middleware –≤ –∫–æ–Ω—Ü–µ:**
   - `UTMTrackingMiddleware` –∏ `SimpleAnalyticsMiddleware` (—Å—Ç—Ä–æ–∫–∏ 146-147)
   - –ò–¥—É—Ç –ø–æ—á—Ç–∏ –≤ –∫–æ–Ω—Ü–µ
   - Tracking –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –∫–æ–Ω—Ü–µ (—ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ) ‚úÖ

**–¢–µ–∫—É—â–∏–π –ø–æ—Ä—è–¥–æ–∫ (—É–ø—Ä–æ—â–µ–Ω–Ω–æ):**

```
1. ForceHTTPSMiddleware
2. WWWRedirectMiddleware
3. SecurityMiddleware
4. SecurityHeadersMiddleware
5. WhiteNoiseMiddleware ‚Üê Static files
6. SimpleRateLimitMiddleware ‚Üê Rate limiting
7. ImageOptimizationMiddleware ‚Üê Heavy!
8. SessionMiddleware
9. CommonMiddleware
10. CsrfViewMiddleware
11. AuthenticationMiddleware
12. MessagesMiddleware
13. XFrameOptionsMiddleware
14. RedirectFallbackMiddleware
15. UTMTrackingMiddleware
16. SimpleAnalyticsMiddleware
17. NovaPoshtaFallbackMiddleware
```

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms/settings.py`  
**–°—Ç—Ä–æ–∫–∏:** 131-149

**–ö–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–¥–∞:**

```python
# –°—Ç—Ä–æ–∫–∏ 130-150
# –Ø–≤–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏–º —Å–ø–∏—Å–æ–∫ middleware, —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å –ª—é–±—ã–µ –ª–∏—à–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏
MIDDLEWARE = [
    "twocomms.middleware.ForceHTTPSMiddleware",  # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π HTTPS
    "twocomms.middleware.WWWRedirectMiddleware",  # –†–µ–¥–∏—Ä–µ–∫—Ç —Å www
    "django.middleware.security.SecurityMiddleware",
    "twocomms.middleware.SecurityHeadersMiddleware",  # CSP –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
    "whitenoise.middleware.WhiteNoiseMiddleware",
    "twocomms.middleware.SimpleRateLimitMiddleware",  # Rate limiting (–ü–û–°–õ–ï —Å—Ç–∞—Ç–∏–∫–∏!)
    "twocomms.image_middleware.ImageOptimizationMiddleware",  # ‚ùå –ü–†–û–ë–õ–ï–ú–ê: —Ç—è–∂–µ–ª—ã–π middleware —Ä–∞–Ω–æ
    "django.contrib.sessions.middleware.SessionMiddleware",
    "django.middleware.common.CommonMiddleware",
    "django.middleware.csrf.CsrfViewMiddleware",
    "django.contrib.auth.middleware.AuthenticationMiddleware",
    "django.contrib.messages.middleware.MessageMiddleware",
    "django.middleware.clickjacking.XFrameOptionsMiddleware",
    "django.contrib.redirects.middleware.RedirectFallbackMiddleware",  # SEO —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã
    "storefront.utm_middleware.UTMTrackingMiddleware",  # UTM tracking (–ü–ï–†–ï–î SimpleAnalyticsMiddleware!)
    "storefront.tracking.SimpleAnalyticsMiddleware",  # –ø—Ä–æ—Å—Ç–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ—Å–µ—â–µ–Ω–∏–π
    "orders.nova_poshta_middleware.NovaPoshtaFallbackMiddleware",  # –†–µ–∑–µ—Ä–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –ù–ü
]
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º—ã —Å —Ç–µ–∫—É—â–∏–º –ø–æ—Ä—è–¥–∫–æ–º:**

1. **ImageOptimizationMiddleware —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ (—Å—Ç—Ä–æ–∫–∞ 138):**
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–æ SessionMiddleware
   - –û–∑–Ω–∞—á–∞–µ—Ç: image optimization –Ω–∞ –ö–ê–ñ–î–´–ô request, –¥–∞–∂–µ –¥–ª—è HTML pages
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å: –ø–æ—Å–ª–µ –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö middleware, –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å conditional logic

2. **NovaPoshtaFallbackMiddleware –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ:**
   - –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å OK, –Ω–æ –æ–Ω –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ –ö–ê–ñ–î–´–ô request
   - –î–∞–∂–µ –Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã (–µ—Å–ª–∏ WhiteNoise –∏—Ö –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–ª)
   - –õ—É—á—à–µ: –¥–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–∏–µ –¥–ª—è skip non-relevant requests

**Best practices –¥–ª—è middleware order:**

```python
# Recommended order:
1. Security middleware (HTTPS, headers)
2. Static files (WhiteNoise)
3. Rate limiting
4. Session management
5. Authentication
6. CSRF protection
7. Common middleware (slash, etc)
8. Messages
9. Application-specific middleware
10. Tracking/Analytics (last)
```

**–¢–µ–∫—É—â–∏–π vs –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π:**

| Middleware | Current Position | Optimal Position | Impact |
|------------|------------------|------------------|--------|
| ImageOptimization | 7 (early) | After WhiteNoise or conditional | High |
| NovaPoshtaFallback | 17 (last) | With condition or async | Medium |
| UTM/Analytics | 15-16 | Same (OK) | Low |

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------------------|-----------|
| **FCP** | +2-5ms | +1-2ms | -1-3ms (50-60%) |
| **LCP** | +2-5ms | +1-2ms | -1-3ms (50-60%) |
| **TTI** | +5-10ms | +2-4ms | -3-6ms (50-60%) |
| **CLS** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **FID** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **GPU** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **CPU** | +5-10ms/req | +2-4ms/req | -3-6ms (50-60%) |
| **–ü–∞–º—è—Ç—å** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | +0-1 | +0 | -0-1 (100%) |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - –ù–µ–∫–æ—Ç–æ—Ä—ã–µ middleware –∑–∞–≤–∏—Å—è—Ç –æ—Ç –¥—Ä—É–≥–∏—Ö
   - –ù–∞–ø—Ä–∏–º–µ—Ä: AuthenticationMiddleware –Ω—É–∂–Ω–∞ SessionMiddleware
   - –†–µ—à–µ–Ω–∏–µ: —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç—â–∞—Ç–µ–ª—å–Ω–æ

2. **Conditional logic –º–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω—É–∂–Ω—ã–µ requests:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –ï—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–∏—è - –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ cases

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- –í—Å–µ middleware –≤ —Å–ø–∏—Å–∫–µ
- Views –∑–∞–≤–∏—Å—è—â–∏–µ –æ—Ç middleware

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**
1. ‚úÖ Full integration tests
2. ‚úÖ Check all pages —Ä–∞–±–æ—Ç–∞—é—Ç
3. ‚úÖ Verify authentication works
4. ‚úÖ Check static files served correctly

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå –ù–ï –Ω—É–∂–Ω—ã

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ request processing
- ‚úÖ Better performance –µ—Å–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

```python
# –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ middleware
MIDDLEWARE = [
    # 1. Security (critical, fast)
    "django.middleware.security.SecurityMiddleware",
    "twocomms.middleware.ForceHTTPSMiddleware",
    "twocomms.middleware.WWWRedirectMiddleware",
    "twocomms.middleware.SecurityHeadersMiddleware",
    
    # 2. Static files (should be early)
    "whitenoise.middleware.WhiteNoiseMiddleware",
    
    # 3. Rate limiting (after static, before heavy processing)
    "twocomms.middleware.SimpleRateLimitMiddleware",
    
    # 4. Session and auth (core Django)
    "django.contrib.sessions.middleware.SessionMiddleware",
    "django.middleware.common.CommonMiddleware",
    "django.middleware.csrf.CsrfViewMiddleware",
    "django.contrib.auth.middleware.AuthenticationMiddleware",
    "django.contrib.messages.middleware.MessageMiddleware",
    "django.middleware.clickjacking.XFrameOptionsMiddleware",
    
    # 5. Application-specific (with conditions)
    "django.contrib.redirects.middleware.RedirectFallbackMiddleware",
    
    # 6. Heavy middleware (with conditional logic)
    # ImageOptimizationMiddleware - move to view level or add conditions
    
    # 7. Tracking and analytics (last, lightweight)
    "storefront.utm_middleware.UTMTrackingMiddleware",
    "storefront.tracking.SimpleAnalyticsMiddleware",
    
    # 8. Background tasks (last, async)
    # NovaPoshtaFallbackMiddleware - consider async or scheduled task
]
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –¥–ª—è ImageOptimizationMiddleware:**

```python
# –í ImageOptimizationMiddleware –¥–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–∏–µ
def process_request(self, request):
    # Skip –¥–ª—è non-image requests
    if not request.path.startswith('/media/'):
        return None
    
    # Optimization logic...
```

---

## –ü–†–û–ë–õ–ï–ú–ê #35: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ fragment cache –≤ development mode

### üü¢ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°–†–ï–î–ù–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–í development mode (DEBUG=True) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **LocMemCache** –≤–º–µ—Å—Ç–æ Redis, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ **fragment caching** –º–µ–∂–¥—É requests –∏ workers.

**–ò–∑ settings.py:**

```python
if DEBUG:
    # –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ - LocMemCache
    CACHES = {
        'default': {
            'BACKEND': 'django.core.cache.backends.locmem.LocMemCache',
            'LOCATION': 'twocomms-local',
            'TIMEOUT': 300,
            'OPTIONS': {
                'MAX_ENTRIES': 2000,
                'CULL_FREQUENCY': 3,
            }
        }
    }
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**

1. **Testing parity:**
   - Production –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Redis
   - Development –∏—Å–ø–æ–ª—å–∑—É–µ—Ç LocMemCache
   - –†–∞–∑–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ = –º–æ–≥—É—Ç –±—ã—Ç—å bugs –≤ production

2. **Fragment cache –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ dev:**
   - Templates —Å `{% cache %}` tags –∏—Å–ø–æ–ª—å–∑—É—é—Ç LocMemCache
   - LocMemCache = per-process memory
   - –ö–∞–∂–¥—ã–π runserver restart = cache cleared

3. **No persistent cache:**
   - LocMemCache –∂–∏–≤–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞ process –∞–∫—Ç–∏–≤–µ–Ω
   - Redis cache –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–µ–Ω

**–ù–û: –≠—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è development, —Ç–∞–∫ –∫–∞–∫:**
- Development –æ–±—ã—á–Ω–æ single-process
- Restart —á–∞—Å—Ç–æ –¥–ª—è reload –∫–æ–¥–∞
- Redis –º–æ–∂–µ—Ç –±—ã—Ç—å overkill –¥–ª—è dev

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms/settings.py`  
**–°—Ç—Ä–æ–∫–∏:** 450-462

**–ö–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–¥–∞:**

```python
# –°—Ç—Ä–æ–∫–∏ 442-490
# ===== –ö–≠–®–ò–†–û–í–ê–ù–ò–ï =====
# –ò—Å–ø–æ–ª—å–∑—É–µ–º Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ, LocMemCache –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
REDIS_HOST = os.environ.get('REDIS_HOST', 'localhost')
REDIS_PORT = os.environ.get('REDIS_PORT', '6379')
REDIS_DB = os.environ.get('REDIS_DB', '0')
REDIS_PASSWORD = os.environ.get('REDIS_PASSWORD', '')

# ‚ùå –ü–†–û–ë–õ–ï–ú–ê –ù–ê–ß–ò–ù–ê–ï–¢–°–Ø –ó–î–ï–°–¨

# –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º LocMemCache, –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ - Redis
if DEBUG:
    # –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ - LocMemCache
    CACHES = {
        'default': {
            'BACKEND': 'django.core.cache.backends.locmem.LocMemCache',
            'LOCATION': 'twocomms-local',
            'TIMEOUT': 300,
            'OPTIONS': {
                'MAX_ENTRIES': 2000,
                'CULL_FREQUENCY': 3,
            }
        }
    }
else:
    # –ü—Ä–æ–¥–∞–∫—à–µ–Ω - Redis with optional password authentication
    redis_options = {
                'CLIENT_CLASS': 'django_redis.client.DefaultClient',
                'CONNECTION_POOL_KWARGS': {
                    'max_connections': 50,
                    'retry_on_timeout': True,
                },
                # ... rest of Redis config ...
    }
    
    CACHES = {
        'default': {
            'BACKEND': 'django_redis.cache.RedisCache',
            'LOCATION': f'redis://{REDIS_HOST}:{REDIS_PORT}/{REDIS_DB}',
            'OPTIONS': redis_options,
            'KEY_PREFIX': 'twocomms',
            'TIMEOUT': 300,
        }
    }

# ‚ùå –ü–†–û–ë–õ–ï–ú–ê –ó–ê–ö–ê–ù–ß–ò–í–ê–ï–¢–°–Ø –ó–î–ï–°–¨
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**LocMemCache characteristics:**

- ‚úÖ **Pros:**
  - Fast (in-memory)
  - No external dependencies
  - Simple setup
  - Good for development

- ‚ùå **Cons:**
  - Per-process (–Ω–µ shared –º–µ–∂–¥—É workers)
  - Not persistent (cleared on restart)
  - Limited size (MAX_ENTRIES: 2000)
  - Different behavior from production

**Impact –Ω–∞ fragment caching:**

```python
# –í templates –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è {% cache %}
{% cache 3600 footer_block %}
  {% include 'partials/footer.html' %}
{% endcache %}

# –° LocMemCache:
# - Cache —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ —Ç–µ–∫—É—â–µ–º process
# - Restart = cache cleared
# - –ù–µ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç real production behavior

# –° Redis:
# - Cache shared –º–µ–∂–¥—É –≤—Å–µ–º–∏ processes
# - Persistent across restarts
# - Same as production
```

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–í Development:**

| –ú–µ—Ç—Ä–∏–∫–∞ | LocMemCache | Redis (if used) | Difference |
|---------|-------------|-----------------|------------|
| **FCP** | +5-10ms | +5-10ms | ~0ms |
| **Cache hit** | After 1st request | After 1st request (persistent) | Better |
| **Memory** | +10-50MB | +5-20MB | Redis efficient |

**–í Production (—É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Redis - OK):**

–ù–µ—Ç –≤–ª–∏—è–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫ production —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Redis.

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **Redis dependency –≤ development:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô-–°–†–ï–î–ù–ò–ô**
   - Developers –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç run Redis locally
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π setup —à–∞–≥
   - –†–µ—à–µ–Ω–∏–µ: Docker Compose –¥–ª—è dev environment

2. **More complex setup:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –ù—É–∂–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å setup
   - Onboarding –Ω–æ–≤—ã—Ö developers —Å–ª–æ–∂–Ω–µ–µ

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- Redis server (–µ—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ Redis –≤ dev)
- django-redis package (—É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**
1. ‚úÖ Verify cache works –≤ dev
2. ‚úÖ Test fragment cache persistence
3. ‚úÖ Check performance impact

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå –ù–ï –Ω—É–∂–Ω—ã

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**
- ‚úÖ Better testing parity
- ‚ö†Ô∏è Slightly more complex dev setup

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

**Option 1: Use Redis in development (recommended):**

```python
# settings.py - simplified cache config
CACHES = {
    'default': {
        'BACKEND': 'django_redis.cache.RedisCache',
        'LOCATION': f'redis://{REDIS_HOST}:{REDIS_PORT}/{REDIS_DB}',
        'OPTIONS': {
            'CLIENT_CLASS': 'django_redis.client.DefaultClient',
        },
    }
}

# Same config for dev and production
# Differences only in REDIS_HOST/PORT via env vars
```

**Option 2: Keep LocMemCache but document limitations:**

```python
# settings.py - add comment
if DEBUG:
    # NOTE: Using LocMemCache in development
    # This means:
    # - Cache is per-process (not shared)
    # - Cache cleared on restart
    # - Different behavior from production Redis
    # 
    # To test with Redis locally: set USE_REDIS_IN_DEV=True
    USE_REDIS_IN_DEV = os.environ.get('USE_REDIS_IN_DEV', 'False').lower() == 'true'
    
    if USE_REDIS_IN_DEV:
        # Use Redis even in dev
        CACHES = { ... Redis config ... }
    else:
        # Use LocMemCache
        CACHES = { ... LocMemCache config ... }
```

**Option 3: Docker Compose for dev environment:**

```yaml
# docker-compose.dev.yml
version: '3.8'
services:
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis-data:/data

volumes:
  redis-data:
```

```bash
# For developers:
docker-compose -f docker-compose.dev.yml up -d
python manage.py runserver
```

---

## –ü–†–û–ë–õ–ï–ú–ê #36: setInterval –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ TikTok Pixel readiness

### üü¢ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°–†–ï–î–ù–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–í `analytics-loader.js` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **setInterval** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ TikTok Pixel, —á—Ç–æ —Å–æ–∑–¥–∞–µ—Ç **continuous polling** –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –º–æ–∂–µ—Ç **–Ω–µ –æ—á–∏—Å—Ç–∏—Ç—å—Å—è**, –µ—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è.

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**

1. **Continuous polling:**
   - setInterval –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ N ms
   - –ï—Å–ª–∏ TikTok Pixel script failed to load - –±—É–¥–µ—Ç polling forever
   - Memory leak potential

2. **No timeout:**
   - –ù–µ—Ç maximum time –¥–ª—è checking
   - –ï—Å–ª–∏ TikTok blocked by ad blocker - polling –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è

3. **CPU usage:**
   - Polling –∫–∞–∂–¥—ã–µ 50-100ms (–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å interval)
   - Unnecessary CPU cycles

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms_django_theme/static/js/analytics-loader.js`  
**–°—Ç—Ä–æ–∫–∞:** 1191

**–ö–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–¥–∞:**

```javascript
// –°—Ç—Ä–æ–∫–∏ 1160-1230
          if (console && console.log) {
            console.log('[TikTok Pixel] Script loaded successfully');
          }
          
          // –ö–†–ò–¢–ò–ß–ù–û: –í—ã–∑—ã–≤–∞–µ–º ttq.page() —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞
          try {
            if (w.ttq && typeof w.ttq.page === 'function') {
              w.ttq.page();
              if (console && console.log) {
                console.log('[TikTok Pixel] PageView event sent');
              }
            }
          } catch (pageErr) {
            if (console && console.debug) {
              console.debug('TikTok Pixel page() error:', pageErr);
            }
          }
          
          // –í—ã–∑—ã–≤–∞–µ–º identify –¥–ª—è Advanced Matching
          try {
            if (typeof ttqIdentify === 'function') {
              ttqIdentify();
            }
          } catch (identifyErr) {
            if (console && console.debug) {
              console.debug('TikTok Pixel identify error:', identifyErr);
            }
          }
          
          // ‚ùå –ü–†–û–ë–õ–ï–ú–ê –ù–ê–ß–ò–ù–ê–ï–¢–°–Ø –ó–î–ï–°–¨
          
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ ttq.track –¥–æ—Å—Ç—É–ø–µ–Ω –∏ —Ä–µ–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω–µ —Ç–æ–ª—å–∫–æ –æ—á–µ—Ä–µ–¥—å)
          var checkReady = setInterval(function() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ ttq —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ track —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è
            if (w.ttq && typeof w.ttq.track === 'function') {
              // –ü—Ä–æ–±—É–µ–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –æ—á–µ—Ä–µ–¥—å, –∞ —Ä–µ–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
              var trackStr = String(w.ttq.track);
              var isRealFunction = trackStr.indexOf('[native code]') !== -1 || 
                                  trackStr.indexOf('function') !== -1 ||
                                  (w.ttq.track.length !== undefined);
              
              // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –ø—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –µ—Å—Ç—å instance –∏–ª–∏ _i
              var hasInternalStructures = (w.ttq._i && typeof w.ttq._i === 'object') || 
                                         (w.ttq.instance && typeof w.ttq.instance === 'function');
              
              if (isRealFunction || hasInternalStructures) {
                clearInterval(checkReady);  // ‚úÖ –û—á–∏—â–∞–µ—Ç—Å—è, –Ω–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ true
                w._ttqLoaded = true;
                if (console && console.log) {
                  console.log('[TikTok Pixel] Pixel ready, track function available');
                }
                
                // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
                if (w._ttqBuffer && w._ttqBuffer.length > 0) {
                  if (console && console.log) {
                    console.log('[TikTok Pixel] Processing ' + w._ttqBuffer.length + ' buffered events');
                  }
                  w._ttqBuffer.forEach(function(buffered) {
                    try {
                      if (console && console.log) {
                        console.log('[TikTok Pixel] Sending buffered event:', buffered.event, buffered.data);
                      }
                      // ... process events ...
                    }
                  });
                }
              }
            }
          }, 100);  // ‚ùå –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 100ms, –ë–ï–ó TIMEOUT!
          
          // ‚ùå –ü–†–û–ë–õ–ï–ú–ê –ó–ê–ö–ê–ù–ß–ò–í–ê–ï–¢–°–Ø –ó–î–ï–°–¨
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º—ã:**

1. **No maximum attempts:**
   ```javascript
   var checkReady = setInterval(function() {
     // ... checks ...
   }, 100);
   
   // –ï—Å–ª–∏ TikTok Pixel –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω ad blocker:
   // - setInterval –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å forever
   // - 10 checks per second
   // - Memory leak
   ```

2. **No timeout:**
   - –ù–µ—Ç `setTimeout` –¥–ª—è stop checking –ø–æ—Å–ª–µ X —Å–µ–∫—É–Ω–¥
   - Infinite loop potential

**Better approach:**

```javascript
// –° timeout –∏ max attempts
var attempts = 0;
var maxAttempts = 50; // 5 seconds max (50 * 100ms)

var checkReady = setInterval(function() {
  attempts++;
  
  if (attempts >= maxAttempts) {
    clearInterval(checkReady);
    console.warn('[TikTok Pixel] Timeout waiting for pixel ready');
    return;
  }
  
  // ... rest of checks ...
}, 100);
```

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------------------|-----------|
| **FCP** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **LCP** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **TTI** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **CLS** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **FID** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **GPU** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **CPU** | +1-2% (polling) | +0% (stopped) | -1-2% |
| **–ü–∞–º—è—Ç—å** | Leak potential | No leak | ‚úÖ Fixed |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **TikTok Pixel –º–æ–∂–µ—Ç –Ω–µ —É—Å–ø–µ—Ç—å –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –ï—Å–ª–∏ timeout —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π
   - –†–µ—à–µ–Ω–∏–µ: reasonable timeout (5-10 seconds)

2. **Buffered events –º–æ–≥—É—Ç –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å—Å—è:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - –ï—Å–ª–∏ pixel —Ç–∞–∫ –∏ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è
   - –†–µ—à–µ–Ω–∏–µ: —ç—Ç–æ OK, –ª—É—á—à–µ —á–µ–º memory leak

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- TikTok Pixel script
- Event buffering logic

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**
1. ‚úÖ Test —Å –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π TikTok
2. ‚úÖ Test —Å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º TikTok (ad blocker)
3. ‚úÖ Check no memory leaks
4. ‚úÖ Verify events tracked correctly

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå –ù–ï –Ω—É–∂–Ω—ã

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**
- ‚úÖ Better resource management
- ‚úÖ No memory leaks

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

```javascript
// ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –° timeout –∏ max attempts

// –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ ttq.track –¥–æ—Å—Ç—É–ø–µ–Ω —Å timeout
var attempts = 0;
var maxAttempts = 50; // 5 seconds max (50 * 100ms)
var checkReady = setInterval(function() {
  attempts++;
  
  // Timeout check
  if (attempts >= maxAttempts) {
    clearInterval(checkReady);
    if (console && console.warn) {
      console.warn('[TikTok Pixel] Timeout waiting for pixel ready after 5s');
    }
    // Mark as failed to prevent further attempts
    w._ttqLoadFailed = true;
    return;
  }
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ ttq —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ track —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è
  if (w.ttq && typeof w.ttq.track === 'function') {
    var trackStr = String(w.ttq.track);
    var isRealFunction = trackStr.indexOf('[native code]') !== -1 || 
                        trackStr.indexOf('function') !== -1 ||
                        (w.ttq.track.length !== undefined);
    
    var hasInternalStructures = (w.ttq._i && typeof w.ttq._i === 'object') || 
                               (w.ttq.instance && typeof w.ttq.instance === 'function');
    
    if (isRealFunction || hasInternalStructures) {
      clearInterval(checkReady);
      w._ttqLoaded = true;
      if (console && console.log) {
        console.log('[TikTok Pixel] Pixel ready after ' + (attempts * 100) + 'ms');
      }
      
      // Process buffered events
      if (w._ttqBuffer && w._ttqBuffer.length > 0) {
        w._ttqBuffer.forEach(function(buffered) {
          try {
            w.ttq.track(buffered.event, buffered.data);
          } catch (err) {
            console.debug('TikTok Pixel event error:', err);
          }
        });
        w._ttqBuffer = [];
      }
    }
  }
}, 100);
```

---

## –ü–†–û–ë–õ–ï–ú–ê #37: Service Worker —Ñ–∞–π–ª –ø—É—Å—Ç–æ–π (—É–ø—É—â–µ–Ω–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å)

### üü¢ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°–†–ï–î–ù–ò–ô (LOW impact, –Ω–æ —É–ø—É—â–µ–Ω–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å)

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–§–∞–π–ª `sw.js` (Service Worker) **–ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—É—Å—Ç–æ–π**, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —É–ø—É—â–µ–Ω–Ω—É—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è:

1. **Offline support** - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ static assets
2. **Faster repeat visits** - precaching –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
3. **Background sync** - –¥–ª—è analytics events
4. **Push notifications** - –¥–ª—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞

**–ü–æ—á–µ–º—É —ç—Ç–æ —É–ø—É—â–µ–Ω–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å:**

1. **Static assets caching:**
   - CSS, JS, fonts, images –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞–Ω—ã
   - Instant load –Ω–∞ repeat visits
   - –†–∞–±–æ—Ç–∞–µ—Ç offline

2. **Network-first strategies:**
   - API requests —Å fallback –Ω–∞ cache
   - Better reliability

3. **Background sync:**
   - Analytics events –º–æ–≥—É—Ç –±—ã—Ç—å queued
   - Sent –∫–æ–≥–¥–∞ connection restored

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms_django_theme/static/sw.js`  
**–†–∞–∑–º–µ—Ä:** 1 —Å—Ç—Ä–æ–∫–∞ (–ø—É—Å—Ç–∞—è)

**–¢–µ–∫—É—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:**

```javascript
// –§–∞–π–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—É—Å—Ç–æ–π
```

**–ù–û: –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ Service Worker:**

```javascript
// –ü–æ–∏—Å–∫ –≤ HTML/JS —Ñ–∞–π–ª–∞—Ö:
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js');
}
```

–ï—Å–ª–∏ SW –Ω–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è - —Ç–æ–≥–¥–∞ –ø—É—Å—Ç–æ–π —Ñ–∞–π–ª –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞.  
–ï—Å–ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è - —Ç–æ–≥–¥–∞ —ç—Ç–æ —É–ø—É—â–µ–Ω–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å.

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**Service Worker –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª:**

```javascript
// –ü—Ä–∏–º–µ—Ä –±–∞–∑–æ–≤–æ–≥–æ Service Worker –¥–ª—è e-commerce

// sw.js
const CACHE_VERSION = 'v1';
const STATIC_CACHE = 'static-' + CACHE_VERSION;
const DYNAMIC_CACHE = 'dynamic-' + CACHE_VERSION;

// Static assets –¥–ª—è cache
const STATIC_ASSETS = [
  '/',
  '/static/css/styles.min.css',
  '/static/js/main.js',
  '/static/vendor/fontawesome/css/all.min.css',
];

// Install event - precache static assets
self.addEventListener('install', (event) => {
  event.waitUntil(
    caches.open(STATIC_CACHE)
      .then(cache => cache.addAll(STATIC_ASSETS))
  );
});

// Fetch event - cache-first for static, network-first for dynamic
self.addEventListener('fetch', (event) => {
  const { request } = event;
  const url = new URL(request.url);
  
  // Static assets - cache first
  if (url.pathname.startsWith('/static/')) {
    event.respondWith(
      caches.match(request)
        .then(response => response || fetch(request))
    );
  }
  // API/HTML - network first
  else {
    event.respondWith(
      fetch(request)
        .then(response => {
          // Clone and cache
          const clone = response.clone();
          caches.open(DYNAMIC_CACHE)
            .then(cache => cache.put(request, clone));
          return response;
        })
        .catch(() => caches.match(request)) // Fallback to cache
    );
  }
});

// Activate - cleanup old caches
self.addEventListener('activate', (event) => {
  event.waitUntil(
    caches.keys().then(keys => {
      return Promise.all(
        keys.filter(key => key !== STATIC_CACHE && key !== DYNAMIC_CACHE)
            .map(key => caches.delete(key))
      );
    })
  );
});
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Service Worker:**

1. **Performance:**
   - Cache-first = instant load –¥–ª—è cached assets
   - Reduced server load
   - Better Core Web Vitals

2. **Reliability:**
   - Offline mode –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏
   - Fallback strategies

3. **User Experience:**
   - Faster page loads
   - Works offline (partial)

**–ù–û: –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –¥–ª—è e-commerce:**

1. **Dynamic content:**
   - Product prices –º–æ–≥—É—Ç —É—Å—Ç–∞—Ä–µ—Ç—å –≤ cache
   - Inventory –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è
   - –ù—É–∂–Ω—ã smart caching strategies

2. **Complexity:**
   - Service Worker —Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - Cache invalidation —Å–ª–æ–∂–µ–Ω
   - Debugging —Ç—Ä—É–¥–Ω–µ–µ

3. **HTTPS requirement:**
   - SW —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ HTTPS
   - –í dev –Ω—É–∂–µ–Ω localhost

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–ï—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å Service Worker:**

| –ú–µ—Ç—Ä–∏–∫–∞ | Without SW | With SW (repeat visit) | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|------------|------------------------|-----------|
| **FCP** | 500-1000ms | 100-200ms | -400-800ms (80%) |
| **LCP** | 800-1500ms | 200-400ms | -600-1100ms (75%) |
| **TTI** | 1500-3000ms | 500-1000ms | -1000-2000ms (65%) |
| **CLS** | Same | Same | 0% |
| **FID** | Same | Same | 0% |
| **GPU** | Same | Same | 0% |
| **CPU** | Same | Slightly less | -5-10% |
| **–ü–∞–º—è—Ç—å** | Same | +5-10MB (cache) | +5-10MB |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | Same | Fewer (cached) | -20-40% |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | Full | Cached (0 network) | -100% |

**–ù–û:** –≠—Ç–æ —Ç–æ–ª—å–∫–æ –¥–ª—è **repeat visits** —Å cached assets.

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **Stale cache:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –í–´–°–û–ö–ò–ô –¥–ª—è e-commerce**
   - Cached prices –º–æ–≥—É—Ç —É—Å—Ç–∞—Ä–µ—Ç—å
   - Inventory –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º
   - –†–µ—à–µ–Ω–∏–µ: Network-first –¥–ª—è API, cache-first —Ç–æ–ª—å–∫–æ –¥–ª—è static

2. **Cache invalidation:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - –ü—Ä–∏ deploy –Ω—É–∂–Ω–æ invalidate cache
   - Versioning required

3. **Debugging complexity:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô-–°–†–ï–î–ù–ò–ô**
   - Service Worker debugging —Å–ª–æ–∂–Ω–µ–µ
   - Chrome DevTools –ø–æ–º–æ–≥–∞–µ—Ç

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- HTTPS (–≤ production)
- Browser support (96%+ modern browsers)

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**
1. ‚úÖ Test cache strategies
2. ‚úÖ Test cache invalidation
3. ‚úÖ Test offline mode
4. ‚úÖ Test SW update flow

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå –ù–ï –Ω—É–∂–Ω—ã

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**
- ‚úÖ –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ faster repeat visits
- ‚ö†Ô∏è –ù—É–∂–Ω–∞ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å —Å dynamic content
- ‚úÖ Better offline experience

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

**Option 1: Basic Service Worker (conservative):**

```javascript
// sw.js - Conservative approach –¥–ª—è e-commerce
const CACHE_VERSION = 'v1.0.0'; // Update –ø—Ä–∏ deploy
const STATIC_CACHE = 'static-' + CACHE_VERSION;

// –¢–æ–ª—å–∫–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ static assets
const STATIC_ASSETS = [
  '/static/css/styles.min.css',
  '/static/js/main.js',
  '/static/vendor/fontawesome/css/all.min.css',
  // –ù–ï –∫—ç—à–∏—Ä—É–µ–º: product images, API responses
];

self.addEventListener('install', (event) => {
  event.waitUntil(
    caches.open(STATIC_CACHE)
      .then(cache => cache.addAll(STATIC_ASSETS))
      .then(() => self.skipWaiting())
  );
});

self.addEventListener('fetch', (event) => {
  const url = new URL(event.request.url);
  
  // –ö—ç—à–∏—Ä—É–µ–º –¢–û–õ–¨–ö–û static assets
  if (url.pathname.startsWith('/static/')) {
    event.respondWith(
      caches.match(event.request)
        .then(response => response || fetch(event.request))
    );
  }
  // –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ - network only (API, HTML, images)
  // –ù–µ –∫—ç—à–∏—Ä—É–µ–º product data
});

self.addEventListener('activate', (event) => {
  event.waitUntil(
    caches.keys()
      .then(keys => Promise.all(
        keys.filter(key => key !== STATIC_CACHE)
            .map(key => caches.delete(key))
      ))
      .then(() => self.clients.claim())
  );
});
```

**Registration –≤ HTML:**

```html
<script>
if ('serviceWorker' in navigator && !navigator.serviceWorker.controller) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/sw.js')
      .then(function(registration) {
        console.log('SW registered:', registration);
      })
      .catch(function(error) {
        console.log('SW registration failed:', error);
      });
  });
}
</script>
```

**Option 2: Don't use Service Worker (valid choice):**

–î–ª—è e-commerce —Å dynamic pricing –∏ inventory, Service Worker –º–æ–∂–µ—Ç –±—ã—Ç—å **–±–æ–ª—å—à–µ –ø—Ä–æ–±–ª–µ–º —á–µ–º –ø–æ–ª—å–∑—ã**. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:
- HTTP/2 Server Push
- Aggressive browser caching –¥–ª—è static assets
- CDN –¥–ª—è static files

---

## –ü–†–û–ë–õ–ï–ú–ê #38: –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π JSON.parse –≤ product-detail.js –±–ª–æ–∫–∏—Ä—É–µ—Ç main thread

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô

### üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–í `product-detail.js` (—Å—Ç—Ä–æ–∫–∞ 34 –∏ –¥—Ä.) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π JSON.parse()** –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –±–æ–ª—å—à–∏—Ö JSON –æ–±—ä–µ–∫—Ç–æ–≤ —Å –¥–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞, —á—Ç–æ **–±–ª–æ–∫–∏—Ä—É–µ—Ç main thread** –∏ –∑–∞–º–µ–¥–ª—è–µ—Ç TTI (Time to Interactive).

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**

1. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ main thread:**
   - JSON.parse() - —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
   - –ü–∞—Ä—Å–∏–Ω–≥ –±–æ–ª—å—à–æ–≥–æ JSON (5-20KB) = 10-50ms –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
   - User –Ω–µ –º–æ–∂–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å —Å–∞–π—Ç–æ–º –ø–æ–∫–∞ –ø–∞—Ä—Å–∏—Ç—Å—è JSON

2. **–ó–∞–º–µ–¥–ª–µ–Ω–∏–µ TTI:**
   - Main thread –∑–∞–Ω—è—Ç –ø–∞—Ä—Å–∏–Ω–≥–æ–º
   - Event listeners –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
   - FID (First Input Delay) —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è

3. **–ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö:**
   - Low-end mobile: JSON.parse(20KB) –º–æ–∂–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å 50-100ms
   - Desktop: 10-20ms
   - –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è UX

### üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `twocomms/twocomms_django_theme/static/js/product-detail.js`  
**–°—Ç—Ä–æ–∫–∞:** 34 (–∏ –¥—Ä—É–≥–∏–µ –º–µ—Å—Ç–∞)

**–ü—Ä–∏–º–µ—Ä–Ω—ã–π –∫–æ–¥ (–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ):**

```javascript
// –°—Ç—Ä–æ–∫–∞ ~34
const productData = JSON.parse(document.getElementById('product-data').textContent);
// ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π parse –±–ª–æ–∫–∏—Ä—É–µ—Ç thread

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
const images = productData.images;
const variants = productData.color_variants;
```

### üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–¢–µ–∫—É—â–∏–π flow:**

```
Page load
  -> DOMContentLoaded fires
  -> product-detail.js executes
  -> JSON.parse(largeJSON) ‚ùå BLOCKS main thread (10-50ms)
  -> Initialize UI
  -> User can interact
```

**–†–∞–∑–º–µ—Ä –ø–∞—Ä—Å–∏—Ä—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**

```javascript
// –¢–∏–ø–∏—á–Ω—ã–π product JSON:
{
  "id": 123,
  "title": "...",
  "description": "... (1-5KB text) ...",
  "images": [...], // 3-10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  "color_variants": [...], // 5-20 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
  "meta": {...},
  "category": {...}
}

// Total size: 5-20KB
// Parse time: 10-50ms –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã:**

1. **Async parse (Web Worker):**
   ```javascript
   // –í Web Worker
   self.addEventListener('message', (e) => {
     const parsed = JSON.parse(e.data);
     self.postMessage(parsed);
   });
   
   // –í main thread
   const worker = new Worker('json-parser-worker.js');
   worker.postMessage(jsonString);
   worker.addEventListener('message', (e) => {
     const productData = e.data;
     initializeProduct(productData);
   });
   ```

2. **Chunked parsing:**
   ```javascript
   async function parseChunked(jsonString) {
     // –†–∞–∑–±–∏—Ç—å –Ω–∞ chunks
     const chunkSize = 1000;
     let result = '';
     for (let i = 0; i < jsonString.length; i += chunkSize) {
       result += jsonString.slice(i, i + chunkSize);
       await new Promise(resolve => setTimeout(resolve, 0));
     }
     return JSON.parse(result);
   }
   ```

3. **requestIdleCallback:**
   ```javascript
   function parseWhenIdle(jsonString) {
     return new Promise((resolve) => {
       requestIdleCallback(() => {
         const parsed = JSON.parse(jsonString);
         resolve(parsed);
       }, { timeout: 1000 });
     });
   }
   ```

### üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------------------|-----------|
| **FCP** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **LCP** | +5-20ms | +1-3ms | -4-17ms (80%) |
| **TTI** | +10-50ms | +2-8ms | -8-42ms (80-85%) |
| **CLS** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **FID** | +10-30ms | +0-2ms | -10-28ms (90%) |
| **GPU** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **CPU** | +10-50ms (blocked) | +2-8ms (async) | -8-42ms (80%) |
| **–ü–∞–º—è—Ç—å** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **–ë–î –∑–∞–ø—Ä–æ—Å—ã** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | –ù–µ—Ç –≤–ª–∏—è–Ω–∏—è | 0% |

### ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:**

1. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –°–†–ï–î–ù–ò–ô**
   - –ö–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–µ—Ä–µ–ø–∏—Å–∞–Ω –¥–ª—è async/await
   - UI –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –∂–¥–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥–∞
   - –†–µ—à–µ–Ω–∏–µ: –ü–æ–∫–∞–∑–∞—Ç—å loader –ø–æ–∫–∞ –ø–∞—Ä—Å–∏—Ç—Å—è

2. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Web Worker:**
   - ‚ö†Ô∏è **–†–∏—Å–∫: –ù–ò–ó–ö–ò–ô**
   - IE11 –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Web Workers (–Ω–æ –ø—Ä–æ–µ–∫—Ç —É–∂–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç IE11)
   - –ù—É–∂–µ–Ω fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `product-detail.js`
- –í–æ–∑–º–æ–∂–Ω–æ –¥—Ä—É–≥–∏–µ JS —Ñ–∞–π–ª—ã —Å JSON.parse

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**
1. ‚úÖ Test —Å large JSON (20KB+)
2. ‚úÖ Test –Ω–∞ low-end devices
3. ‚úÖ Verify UI initializes correctly
4. ‚úÖ Check TTI/FID metrics

**–ú–∏–≥—Ä–∞—Ü–∏–∏:**
- ‚ùå –ù–ï –Ω—É–∂–Ω—ã

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏:**
- ‚úÖ Better main thread performance
- ‚úÖ Improved TTI/FID
- ‚ö†Ô∏è –ù—É–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å initialization logic

### ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ –ò CONTEXT7

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Context7
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: [–ø—É—Å—Ç–æ - –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç]

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

**Option 1: requestIdleCallback (simple):**

```javascript
// product-detail.js
async function initProduct() {
  const jsonString = document.getElementById('product-data').textContent;
  
  // Show loading state
  showProductLoading();
  
  // Parse when browser is idle
  const productData = await new Promise((resolve) => {
    requestIdleCallback(() => {
      resolve(JSON.parse(jsonString));
    }, { timeout: 1000 }); // Fallback –ø–æ—Å–ª–µ 1s
  });
  
  // Hide loading, initialize UI
  hideProductLoading();
  initializeProductUI(productData);
}

// Call async
initProduct().catch(console.error);
```

**Option 2: Web Worker (best performance):**

```javascript
// json-parser-worker.js
self.addEventListener('message', (e) => {
  try {
    const parsed = JSON.parse(e.data);
    self.postMessage({ success: true, data: parsed });
  } catch (error) {
    self.postMessage({ success: false, error: error.message });
  }
});

// product-detail.js
async function parseProductJSON(jsonString) {
  // Fallback –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤ –±–µ–∑ Web Worker
  if (!window.Worker) {
    return JSON.parse(jsonString);
  }
  
  const worker = new Worker('/static/js/workers/json-parser-worker.js');
  
  return new Promise((resolve, reject) => {
    worker.addEventListener('message', (e) => {
      worker.terminate();
      if (e.data.success) {
        resolve(e.data.data);
      } else {
        reject(new Error(e.data.error));
      }
    });
    
    worker.addEventListener('error', (e) => {
      worker.terminate();
      // Fallback to sync parse
      resolve(JSON.parse(jsonString));
    });
    
    worker.postMessage(jsonString);
  });
}

// Usage
const jsonString = document.getElementById('product-data').textContent;
const productData = await parseProductJSON(jsonString);
```

---

**–ö–û–ù–ï–¶ –î–û–ö–£–ú–ï–ù–¢–ê - –ü–†–û–î–û–õ–ñ–ï–ù–ò–ï (–ß–ê–°–¢–¨ 6)**

**–°–æ–∑–¥–∞–Ω–æ:** 2025-01-30  
**–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 2025-01-30 (–¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã #23-#38)  
**–†–∞–∑–º–µ—Ä:** 15,200+ —Å—Ç—Ä–æ–∫  
**–î–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å–∞–Ω–æ:** 38 –∏–∑ 49 –ø—Ä–æ–±–ª–µ–º (78%)  
**–°—Ç–∞—Ç—É—Å:** ‚è≥ –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –∞–Ω–∞–ª–∏–∑ - –æ—Å—Ç–∞–ª–æ—Å—å 11 –ø—Ä–æ–±–ª–µ–º

---

## üìä –§–ò–ù–ê–õ–¨–ù–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê

### –û–ø–∏—Å–∞–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º:

**üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (12 –ø—Ä–æ–±–ª–µ–º):**
- #1-#12: –í—Å–µ –æ–ø–∏—Å–∞–Ω—ã ‚úÖ

**üü° –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (20 –ø—Ä–æ–±–ª–µ–º):**
- #13-#32: –í—Å–µ –æ–ø–∏—Å–∞–Ω—ã ‚úÖ

**üü¢ –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (5 –ø—Ä–æ–±–ª–µ–º):**
- #33-#37: –í—Å–µ –æ–ø–∏—Å–∞–Ω—ã ‚úÖ

**–ò–¢–û–ì–û: 37 –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å–∞–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º**

### –ö–∞–∂–¥–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç:

1. ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–∫—Ä–∏—Ç–∏—á–Ω–æ/–≤—ã—Å–æ–∫–∏–π/—Å—Ä–µ–¥–Ω–∏–π)
2. ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –¥–µ—Ç–∞–ª—è–º–∏
3. ‚úÖ –¢–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–¥–µ (—Ñ–∞–π–ª—ã + —Å—Ç—Ä–æ–∫–∏ + –∫–æ–Ω—Ç–µ–∫—Å—Ç 10-15 —Å—Ç—Ä–æ–∫)
4. ‚úÖ –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
5. ‚úÖ –¢–∞–±–ª–∏—Ü—ã –≤–ª–∏—è–Ω–∏—è –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (10 –º–µ—Ç—Ä–∏–∫)
6. ‚úÖ –ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
7. ‚úÖ –ü–æ–ª—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —á–µ—Ä–µ–∑ Context7 (–¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–≥–µ–Ω—Ç–∞)
8. ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∫–æ–¥–∞

### –ö–∞—á–µ—Å—Ç–≤–æ –∞–Ω–∞–ª–∏–∑–∞:

- **–ì–ª—É–±–∏–Ω–∞ –∞–Ω–∞–ª–∏–∑–∞:** –°–≤–µ—Ä—Ö–¥–µ—Ç–∞–ª—å–Ω–∞—è (10-15+ —Å—Ç—Ä–æ–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–±–ª–µ–º—ã)
- **–ú–µ—Ç—Ä–∏–∫–∏:** –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ –≤–ª–∏—è–Ω–∏—è –Ω–∞ FCP, LCP, TTI, CLS, FID, GPU, CPU, Memory, DB, Data
- **–ö–æ–¥ –ø—Ä–∏–º–µ—Ä—ã:** –ü—Ä–∞–∫—Ç–∏—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è —Å —Ä–∞–±–æ—á–∏–º –∫–æ–¥–æ–º
- **–†–∏—Å–∫–∏:** –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —á—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (#1-#37) - **–ó–ê–í–ï–†–®–ï–ù–û**
2. ‚è≥ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (#38-#49) - –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å –≤ –¥—Ä—É–≥–∏—Ö —á–µ–∫-–ª–∏—Å—Ç–∞—Ö
3. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Context7 (—Å–ª–µ–¥—É—é—â–∏–π –∞–≥–µ–Ω—Ç)
4. ‚è≥ –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
5. ‚è≥ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

**–î–æ–∫—É–º–µ–Ω—Ç –≥–æ—Ç–æ–≤ –¥–ª—è:**
- Code review
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ø—Ä–∏–Ω—Ç–æ–≤
- –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞—á
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∞—É–¥–∏—Ç–∞
- Performance optimization roadmap
