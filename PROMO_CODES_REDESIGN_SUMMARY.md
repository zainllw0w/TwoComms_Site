# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ TwoComms

## üéØ –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π, –≤–∞—É—á–µ—Ä–∞–º–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

## üì¶ –ù–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### 1. PromoCodeGroup (–ì—Ä—É–ø–ø—ã –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º "–æ–¥–∏–Ω –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç"
- **–ü–æ–ª—è**:
  - `name` - –ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
  - `description` - –û–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
  - `one_per_account` - –§–ª–∞–≥ "–æ–¥–∏–Ω –ø—Ä–æ–º–æ–∫–æ–¥ –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç –∏–∑ –≥—Ä—É–ø–ø—ã"
  - `is_active` - –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≥—Ä—É–ø–ø—ã
  - `created_at`, `updated_at` - –î–∞—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### 2. PromoCode (–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å)
**–ù–æ–≤—ã–µ –ø–æ–ª—è**:
- `promo_type` - –¢–∏–ø –ø—Ä–æ–º–æ–∫–æ–¥–∞ (regular/voucher/grouped)
- `group` - –°–≤—è–∑—å —Å –≥—Ä—É–ø–ø–æ–π (FK –∫ PromoCodeGroup)
- `description` - –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞
- `one_time_per_user` - –û–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `min_order_amount` - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞
- `valid_from`, `valid_until` - –ü–µ—Ä–∏–æ–¥ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞

**–ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
- `can_be_used_by_user(user)` - –ü—Ä–æ–≤–µ—Ä–∫–∞, –º–æ–∂–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥
- `record_usage(user, order)` - –ó–∞–ø–∏—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞
- `is_valid_now()` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

### 3. PromoCodeUsage (–ò—Å—Ç–æ—Ä–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- **–ü–æ–ª—è**:
  - `user` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
  - `promo_code` - –ü—Ä–æ–º–æ–∫–æ–¥
  - `group` - –ì—Ä—É–ø–ø–∞ (–µ—Å–ª–∏ –ø—Ä–æ–º–æ–∫–æ–¥ –∏–∑ –≥—Ä—É–ø–ø—ã)
  - `order` - –°–≤—è–∑–∞–Ω–Ω—ã–π –∑–∞–∫–∞–∑
  - `used_at` - –î–∞—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## üîê –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### views/cart.py - apply_promo_code()
**–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞**:
1. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. ‚úÖ –ï—Å–ª–∏ –≥–æ—Å—Ç—å - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `auth_required: true`
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –≥—Ä—É–ø–ø—ã (one_per_account)
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ one_time_per_user
5. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å—É–º–º—ã –∑–∞–∫–∞–∑–∞
6. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–∏–æ–¥–∞ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞
7. ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π

### cart.html - –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
**–ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**:
- üé® –ö—Ä–∞—Å–∏–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –±—Ä–µ–Ω–¥–æ–≤—ã–º –¥–∏–∑–∞–π–Ω–æ–º
- üîó –í—Ö–æ–¥ —á–µ—Ä–µ–∑ Google OAuth
- üîó –û–±—ã—á–Ω—ã–π –≤—Ö–æ–¥/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- ‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- ‚ö° –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### JavaScript –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ü–µ—Ä–µ—Ö–≤–∞—Ç `auth_required` –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
- –ü–æ–∫–∞–∑ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–ª—è –≥–æ—Å—Ç–µ–π
- –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

## üé® –ê–¥–º–∏–Ω-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π admin_promocodes view
**–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**:
- üìä –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º (–≤—Å–µ/–≤–∞—É—á–µ—Ä—ã/–≥—Ä—É–ø–ø–æ–≤—ã–µ/–æ–±—ã—á–Ω—ã–µ)
- üìÅ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≥—Ä—É–ø–ø–∞–º
- üìà –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
  - –í—Å–µ–≥–æ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
  - –ê–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
  - –í–∞—É—á–µ—Ä–æ–≤
  - –ì—Ä—É–ø–ø
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π

### PromoCodeForm (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è)
**–ù–æ–≤—ã–µ –ø–æ–ª—è**:
- –¢–∏–ø –ø—Ä–æ–º–æ–∫–æ–¥–∞ (regular/voucher/grouped)
- –ì—Ä—É–ø–ø–∞ (select —Å –≤—ã–±–æ—Ä–æ–º –≥—Ä—É–ø–ø—ã)
- –û–ø–∏—Å–∞–Ω–∏–µ
- –û–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞
- –ü–µ—Ä–∏–æ–¥ –¥–µ–π—Å—Ç–≤–∏—è (datetime-local inputs)

## üìã –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –û–±—ã—á–Ω—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã
- –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–Ω–æ–≥–æ —Ä–∞–∑ (–¥–æ max_uses)
- –ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å one_time_per_user
- –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –ª–æ–≥–∏–∫–µ —Å–∫–∏–¥–æ–∫

### –í–∞—É—á–µ—Ä—ã
- `promo_type = 'voucher'`
- –í—Å–µ–≥–¥–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—É–º–º–∞ (`discount_type = 'fixed'`)
- –í—Å–µ–≥–¥–∞ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ (`one_time_per_user = True`)
- –û–±—ã—á–Ω–æ –≤—ã–¥–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∑–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

### –ì—Ä—É–ø–ø–æ–≤—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã
- `promo_type = 'grouped'`
- –°–≤—è–∑–∞–Ω—ã —Å –≥—Ä—É–ø–ø–æ–π (`group` != NULL)
- –ï—Å–ª–∏ `group.one_per_account = True`:
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¢–û–õ–¨–ö–û –û–î–ò–ù –ø—Ä–æ–º–æ–∫–æ–¥ –∏–∑ –≤—Å–µ–π –≥—Ä—É–ø–ø—ã
  - –ù–∞–ø—Ä–∏–º–µ—Ä: –≥—Ä—É–ø–ø–∞ "Instagram —Ä–µ–∫–ª–∞–º–∞" —Å 5 –ø—Ä–æ–º–æ–∫–æ–¥–∞–º–∏ - —é–∑–µ—Ä –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ 1

## üöÄ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ö–µ–π—Å 1: –†–µ–∫–ª–∞–º–∞ –≤ Instagram
```python
# –°–æ–∑–¥–∞–µ–º –≥—Ä—É–ø–ø—É
group = PromoCodeGroup.objects.create(
    name="Instagram —Ä–µ–∫–ª–∞–º–∞ - –Ø–Ω–≤–∞—Ä—å 2025",
    description="–ü—Ä–æ–º–æ–∫–æ–¥—ã –¥–ª—è —Ä–µ–∫–ª–∞–º—ã –≤ Instagram",
    one_per_account=True
)

# –°–æ–∑–¥–∞–µ–º 5 —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ –≤ –≥—Ä—É–ø–ø–µ
for i in range(5):
    PromoCode.objects.create(
        code=f"INSTA{i+1}0OFF",
        promo_type='grouped',
        group=group,
        discount_type='percentage',
        discount_value=10,
        max_uses=100
    )
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∏–∑ 5 –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤. –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Ç–æ—Ä–æ–π - –ø–æ–ª—É—á–∏—Ç –æ—à–∏–±–∫—É "–í–∏ –≤–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–ª–∏ –ø—Ä–æ–º–æ–∫–æ–¥ –∑ –≥—Ä—É–ø–∏ 'Instagram —Ä–µ–∫–ª–∞–º–∞ - –Ø–Ω–≤–∞—Ä—å 2025'"

### –ö–µ–π—Å 2: –í–∞—É—á–µ—Ä –∑–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
```python
voucher = PromoCode.objects.create(
    code='REWARD500',
    promo_type='voucher',
    discount_type='fixed',
    discount_value=500,
    one_time_per_user=True,
    min_order_amount=2000
)
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í–∞—É—á–µ—Ä –Ω–∞ 500 –≥—Ä–Ω, —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞–∫–∞–∑–µ –æ—Ç 2000 –≥—Ä–Ω, –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π

### –ö–µ–π—Å 3: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
```python
promo = PromoCode.objects.create(
    code='BLACKFRIDAY',
    promo_type='regular',
    discount_type='percentage',
    discount_value=25,
    max_uses=1000,
    valid_from=datetime(2025, 11, 25),
    valid_until=datetime(2025, 11, 26),
    min_order_amount=1500
)
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –°–∫–∏–¥–∫–∞ 25% —Ç–æ–ª—å–∫–æ –≤ –ß–µ—Ä–Ω—É—é –ø—è—Ç–Ω–∏—Ü—É, –ø—Ä–∏ –∑–∞–∫–∞–∑–µ –æ—Ç 1500 –≥—Ä–Ω, –º–∞–∫—Å 1000 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Backend
- ‚úÖ `twocomms/storefront/models.py` - –ù–æ–≤—ã–µ –º–æ–¥–µ–ª–∏
- ‚úÖ `twocomms/storefront/views.py` - –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è PromoCodeForm –∏ admin_promocodes
- ‚úÖ `twocomms/storefront/views/cart.py` - –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ apply_promo_code –∏ remove_promo_code

### Frontend
- ‚úÖ `twocomms/twocomms_django_theme/templates/pages/cart.html` - –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ + JavaScript

## üóÑÔ∏è –ú–∏–≥—Ä–∞—Ü–∏–∏

**–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**:
```bash
cd /home/qlknpodo/TWC/TwoComms_Site/twocomms
source /home/qlknpodo/virtualenv/TWC/TwoComms_Site/twocomms/3.13/bin/activate
python manage.py makemigrations storefront
python manage.py migrate storefront
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –°—Ç–∞—Ä—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã –ø—Ä–æ–¥–æ–ª–∂–∞—Ç —Ä–∞–±–æ—Ç–∞—Ç—å (—Ç–∏–ø `regular`)
2. **–ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**: –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã –ø–æ–ª—É—á–∞—Ç `promo_type='regular'`
3. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞**: –ì–æ—Å—Ç–∏ –±–æ–ª—å—à–µ –Ω–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥—ã
4. **–ò—Å—Ç–æ—Ä–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**: –í—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ —Ç–µ–ø–µ—Ä—å –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### PromoCodeUsage –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å, –∫—Ç–æ –∏ –∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø—Ä–æ–º–æ–∫–æ–¥
- –í–∏–¥–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≥—Ä—É–ø–ø –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- –°–≤—è–∑—ã–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –∑–∞–∫–∞–∑–∞–º–∏

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:
```python
# –ö—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø—Ä–æ–º–æ–∫–æ–¥—ã –∏–∑ –≥—Ä—É–ø–ø—ã Instagram
usages = PromoCodeUsage.objects.filter(group__name__contains="Instagram")

# –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø—Ä–æ–º–æ–∫–æ–¥—ã
user_usages = PromoCodeUsage.objects.filter(user=user).count()

# –¢–æ–ø-5 —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
top_promos = PromoCode.objects.annotate(
    usage_count=Count('usages')
).order_by('-usage_count')[:5]
```

## ‚ú® –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

- üé® –ö—Ä–∞—Å–∏–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –Ω–∞ —É–∫—Ä–∞–∏–Ω—Å–∫–æ–º
- üì± –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
- üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ backend
- üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ (select_related, prefetch_related)
- üìù –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (cart_logger)
- ‚ö° –ü–ª–∞–≤–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ—Ö–æ–¥—ã

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤—ã—Ö –≥—Ä—É–ø–ø
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
4. ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
5. ‚úÖ –û–±—É—á–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

---

**–î–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**: 27 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è**: 2.0  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é

